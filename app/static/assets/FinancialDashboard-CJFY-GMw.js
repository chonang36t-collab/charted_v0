import{c as T,j as e,u as k,b as F,d as O,r as l,B as f}from"./index-C-ijiT9j.js";import{U as $,L as j,D as A}from"./DashboardLayout-B9aleQ7j.js";import{u as H,L as U,R as z}from"./LoadingOverlay-EDuSwInh.js";import{M as o,T as E,u as B,c as q,R as G}from"./RankingList-CpVnc_ii.js";import{D as I}from"./DashboardHeader-CDS4WE8m.js";import{P as v}from"./pound-sterling-Cmnmq9nK.js";import{T as C}from"./users-j0LY2CtT.js";import{C as W,a as J,b as K,d as Q}from"./card-BTzBTY9M.js";import"./popover-BP2f3grz.js";import"./generateCategoricalChart-Czi_8Orn.js";import"./AreaChart-CqT3FKGV.js";import"./progress-ClkMLgHL.js";import"./ellipsis-CGLpmWc7.js";import"./locationUtils-KTfsPdOC.js";import"./index-DG0gl-bB.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=T("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]),Y=({metrics:s,selectedMetric:r,onMetricSelect:a,onViewDetails:t})=>e.jsxs("div",{className:"grid gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 w-full",children:[e.jsx(o,{title:"Total Revenue",value:`£${s.revenue.value.toLocaleString()}`,subtitle:s.revenue.text,trend:s.revenue.trend,icon:v,isSelected:r==="revenue",onClick:()=>a==null?void 0:a("revenue"),onViewDetails:()=>t==null?void 0:t("revenue")}),e.jsx(o,{title:"Average Client Pay",value:`£${s.clientPay.value.toFixed(2)}`,subtitle:s.clientPay.text,trend:s.clientPay.trend,icon:C}),e.jsx(o,{title:"Total Cost (Staff Pay)",value:`£${s.staffPay.value.toFixed(2)}`,subtitle:s.staffPay.text,trend:s.staffPay.trend,icon:E,isSelected:r==="cost",onClick:()=>a==null?void 0:a("cost"),onViewDetails:()=>t==null?void 0:t("cost")})]}),Z=({salesData:s,selectedMetric:r,onMetricSelect:a,onViewDetails:t})=>{var u,g,c,d;return e.jsxs("div",{className:"grid gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 w-full",children:[e.jsx(o,{title:"Avg Client Rate",value:`£${((u=s==null?void 0:s.avgClientPayPerHour)==null?void 0:u.toFixed(2))||"0.00"}`,icon:v,isSelected:r==="clientRate",onClick:()=>a==null?void 0:a("clientRate"),onViewDetails:()=>t==null?void 0:t("clientRate"),subtitle:"Per hour charged"}),e.jsx(o,{title:"Avg Staff Rate",value:`£${((g=s==null?void 0:s.avgStaffPayPerHour)==null?void 0:g.toFixed(2))||"0.00"}`,icon:$,isSelected:r==="staffRate",onClick:()=>a==null?void 0:a("staffRate"),onViewDetails:()=>t==null?void 0:t("staffRate"),subtitle:"Per hour paid"}),e.jsx(o,{title:"Total Overheads",value:`£${((c=s==null?void 0:s.totalOverheads)==null?void 0:c.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}))||"0.00"}`,icon:j,isSelected:r==="overheads",onClick:()=>a==null?void 0:a("overheads"),onViewDetails:()=>t==null?void 0:t("overheads"),subtitle:"Fixed & Variable expenses"}),e.jsx(o,{title:"Profit Margin",value:`${((d=s==null?void 0:s.profitMargin)==null?void 0:d.toFixed(1))||0}%`,icon:X,isSelected:r==="profit",onClick:()=>a==null?void 0:a("profit"),onViewDetails:()=>t==null?void 0:t("profit"),subtitle:"Net margin (after overheads)"})]})},le=()=>{const s=k();F();const{dateRange:r,setDateRange:a}=O(),[t,u]=l.useState(!1),[g,c]=l.useState(r),[d,y]=l.useState([]),[m,R]=l.useState([]),[n,p]=l.useState("revenue"),h=x=>{s(`/dashboard/metrics/${x}`)},{financialData:i,isLoading:b}=H(r,d,m),{topClientsRevenue:N,isLoadingClientsRev:P}=B(r,d,m),L=q(i,r);return e.jsx(A,{fullWidth:!0,children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx(I,{dateRange:r,onDateRangeChange:a,calendarOpen:t,onCalendarOpenChange:u,tempDateRange:g,onTempDateRangeChange:c,selectedLocations:d,onLocationsChange:y,selectedSites:m,onSitesChange:R}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsxs("div",{className:"px-4 pt-6 pb-6 space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-2 px-1 py-1 bg-muted rounded-lg",children:[e.jsxs(f,{variant:"secondary",size:"sm",className:"gap-2 shadow-sm",children:[e.jsx(C,{className:"h-4 w-4"}),"Financial View"]}),e.jsxs(f,{variant:"ghost",size:"sm",className:"gap-2 text-muted-foreground hover:text-foreground",onClick:()=>s("/dashboard/operational"),children:[e.jsx(j,{className:"h-4 w-4"}),"Operational View"]})]})}),b&&e.jsx(U,{}),e.jsx(Y,{metrics:L,selectedMetric:n,onMetricSelect:p,onViewDetails:h}),e.jsx(Z,{salesData:i,selectedMetric:n,onMetricSelect:p,onViewDetails:h}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-7",children:[e.jsxs(W,{className:"col-span-5",children:[e.jsx(J,{children:e.jsxs(K,{children:[n==="revenue"&&"Revenue Overview",n==="cost"&&"Cost Overview",n==="profit"&&"Profit Trend",n==="shifts"&&"Shifts Trend",n==="clients"&&"New vs Returning Clients",n==="employees"&&"Active Employees Trend"]})}),e.jsx(Q,{className:"pl-2",children:e.jsx(z,{data:(i==null?void 0:i.timeSeries)||[],aggregationLevel:(i==null?void 0:i.aggregationLevel)||"monthly",selectedMetric:n})})]}),e.jsx("div",{className:"col-span-2 flex flex-col gap-4 h-full",children:e.jsx(G,{title:"Top Clients (Revenue)",data:N,isLoading:P,valueFormatter:x=>`£${x.toLocaleString()}`,icon:e.jsx(v,{className:"h-4 w-4"}),className:"h-full",barColor:"bg-green-500"})})]})]})})]})})};export{le as FinancialDashboard,le as default};
