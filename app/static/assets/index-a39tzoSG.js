const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MetricPalette-cOCgFfqu.js","assets/index-But1f_Ig.js","assets/index-nWE9PeuT.css","assets/card-hifMVSRR.js","assets/trending-up-Df-BRkHg.js","assets/popover-l4hf0WR1.js","assets/button-CFrfQFFQ.js","assets/DashboardLayout-CoOSzqAZ.js","assets/users-D3OLqueu.js","assets/ChartCanvas-D7W1fb6M.js","assets/badge-BEE9CvmL.js","assets/AreaChart-ucVqR_fe.js","assets/BarChart-BQUdAjL_.js"])))=>i.map(i=>d[i]);
import{c as Ee,r as s,P as T,g as J,j as n,b as $,X as Ue,a as Ye,S as Ge,_ as Re}from"./index-But1f_Ig.js";import{u as K,R as He,P as Xe,O as We,a as Je,D as Qe}from"./DashboardLayout-CoOSzqAZ.js";import{e as Ze,S as et,a as tt,b as rt,c as nt,d as te}from"./select-8cheqwXQ.js";import{B as ne}from"./button-CFrfQFFQ.js";import{P as de,b as ue,c as me,h as be,C as we,f as re,d as je}from"./popover-l4hf0WR1.js";import"./dialog-CTO0TKKy.js";import{C as at,a as lt,b as st,d as ot}from"./card-hifMVSRR.js";import"./users-D3OLqueu.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=Ee("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=Ee("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),dt=()=>{const[e,r]=s.useState({dimensions:[],metrics:[],chartType:"bar",dateRange:{from:void 0,to:void 0},customMetrics:[],chartData:[],draggedItem:void 0});return{state:e,setDimensions:l=>{r(u=>({...u,dimensions:l}))},setMetrics:l=>{r(u=>({...u,metrics:l}))},setChartType:l=>{r(u=>({...u,chartType:l}))},setDateRange:l=>{r(u=>({...u,dateRange:l}))},addCustomMetric:l=>{r(u=>({...u,customMetrics:[...u.customMetrics,l]}))},setChartData:l=>{r(u=>({...u,chartData:l}))},setDraggedItem:l=>{r(u=>({...u,draggedItem:l}))}}};var Ce=1,ut=.9,mt=.8,ft=.17,oe=.1,ie=.999,ht=.9999,pt=.99,xt=/[\\\/_+.#"@\[\(\{&]/,vt=/[\\\/_+.#"@\[\(\{&]/g,gt=/[\s-]/,Ie=/[\s-]/g;function fe(e,r,t,f,i,c,m){if(c===r.length)return i===e.length?Ce:pt;var o=`${i},${c}`;if(m[o]!==void 0)return m[o];for(var h=f.charAt(c),l=t.indexOf(h,i),u=0,y,N,C,A;l>=0;)y=fe(e,r,t,f,l+1,c+1,m),y>u&&(l===i?y*=Ce:xt.test(e.charAt(l-1))?(y*=mt,C=e.slice(i,l-1).match(vt),C&&i>0&&(y*=Math.pow(ie,C.length))):gt.test(e.charAt(l-1))?(y*=ut,A=e.slice(i,l-1).match(Ie),A&&i>0&&(y*=Math.pow(ie,A.length))):(y*=ft,i>0&&(y*=Math.pow(ie,l-i))),e.charAt(l)!==r.charAt(c)&&(y*=ht)),(y<oe&&t.charAt(l-1)===f.charAt(c+1)||f.charAt(c+1)===f.charAt(c)&&t.charAt(l-1)!==f.charAt(c))&&(N=fe(e,r,t,f,l+1,c+2,m),N*oe>y&&(y=N*oe)),y>u&&(u=y),l=t.indexOf(h,l+1);return m[o]=u,u}function Se(e){return e.toLowerCase().replace(Ie," ")}function yt(e,r,t){return e=t&&t.length>0?`${e+" "+t.join(" ")}`:e,fe(e,r,Se(e),Se(r),0,0,{})}var W='[cmdk-group=""]',ce='[cmdk-group-items=""]',bt='[cmdk-group-heading=""]',De='[cmdk-item=""]',Ne=`${De}:not([aria-disabled="true"])`,he="cmdk-item-select",V="data-value",wt=(e,r,t)=>yt(e,r,t),Ae=s.createContext(void 0),Q=()=>s.useContext(Ae),Me=s.createContext(void 0),pe=()=>s.useContext(Me),$e=s.createContext(void 0),Le=s.forwardRef((e,r)=>{let t=q(()=>{var a,p;return{search:"",value:(p=(a=e.value)!=null?a:e.defaultValue)!=null?p:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),f=q(()=>new Set),i=q(()=>new Map),c=q(()=>new Map),m=q(()=>new Set),o=Pe(e),{label:h,children:l,value:u,onValueChange:y,filter:N,shouldFilter:C,loop:A,disablePointerSelection:U=!1,vimBindings:L=!0,...M}=e,Y=K(),Z=K(),G=K(),P=s.useRef(null),w=Mt();_(()=>{if(u!==void 0){let a=u.trim();t.current.value=a,S.emit()}},[u]),_(()=>{w(6,I)},[]);let S=s.useMemo(()=>({subscribe:a=>(m.current.add(a),()=>m.current.delete(a)),snapshot:()=>t.current,setState:(a,p,v)=>{var d,g,b,D;if(!Object.is(t.current[a],p)){if(t.current[a]=p,a==="search")X(),F(),w(1,H);else if(a==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let E=document.getElementById(G);E?E.focus():(d=document.getElementById(Y))==null||d.focus()}if(w(7,()=>{var E;t.current.selectedItemId=(E=O())==null?void 0:E.id,S.emit()}),v||w(5,I),((g=o.current)==null?void 0:g.value)!==void 0){let E=p??"";(D=(b=o.current).onValueChange)==null||D.call(b,E);return}}S.emit()}},emit:()=>{m.current.forEach(a=>a())}}),[]),x=s.useMemo(()=>({value:(a,p,v)=>{var d;p!==((d=c.current.get(a))==null?void 0:d.value)&&(c.current.set(a,{value:p,keywords:v}),t.current.filtered.items.set(a,j(p,v)),w(2,()=>{F(),S.emit()}))},item:(a,p)=>(f.current.add(a),p&&(i.current.has(p)?i.current.get(p).add(a):i.current.set(p,new Set([a]))),w(3,()=>{X(),F(),t.current.value||H(),S.emit()}),()=>{c.current.delete(a),f.current.delete(a),t.current.filtered.items.delete(a);let v=O();w(4,()=>{X(),(v==null?void 0:v.getAttribute("id"))===a&&H(),S.emit()})}),group:a=>(i.current.has(a)||i.current.set(a,new Set),()=>{c.current.delete(a),i.current.delete(a)}),filter:()=>o.current.shouldFilter,label:h||e["aria-label"],getDisablePointerSelection:()=>o.current.disablePointerSelection,listId:Y,inputId:G,labelId:Z,listInnerRef:P}),[]);function j(a,p){var v,d;let g=(d=(v=o.current)==null?void 0:v.filter)!=null?d:wt;return a?g(a,t.current.search,p):0}function F(){if(!t.current.search||o.current.shouldFilter===!1)return;let a=t.current.filtered.items,p=[];t.current.filtered.groups.forEach(d=>{let g=i.current.get(d),b=0;g.forEach(D=>{let E=a.get(D);b=Math.max(E,b)}),p.push([d,b])});let v=P.current;k().sort((d,g)=>{var b,D;let E=d.getAttribute("id"),ee=g.getAttribute("id");return((b=a.get(ee))!=null?b:0)-((D=a.get(E))!=null?D:0)}).forEach(d=>{let g=d.closest(ce);g?g.appendChild(d.parentElement===g?d:d.closest(`${ce} > *`)):v.appendChild(d.parentElement===v?d:d.closest(`${ce} > *`))}),p.sort((d,g)=>g[1]-d[1]).forEach(d=>{var g;let b=(g=P.current)==null?void 0:g.querySelector(`${W}[${V}="${encodeURIComponent(d[0])}"]`);b==null||b.parentElement.appendChild(b)})}function H(){let a=k().find(v=>v.getAttribute("aria-disabled")!=="true"),p=a==null?void 0:a.getAttribute(V);S.setState("value",p||void 0)}function X(){var a,p,v,d;if(!t.current.search||o.current.shouldFilter===!1){t.current.filtered.count=f.current.size;return}t.current.filtered.groups=new Set;let g=0;for(let b of f.current){let D=(p=(a=c.current.get(b))==null?void 0:a.value)!=null?p:"",E=(d=(v=c.current.get(b))==null?void 0:v.keywords)!=null?d:[],ee=j(D,E);t.current.filtered.items.set(b,ee),ee>0&&g++}for(let[b,D]of i.current)for(let E of D)if(t.current.filtered.items.get(E)>0){t.current.filtered.groups.add(b);break}t.current.filtered.count=g}function I(){var a,p,v;let d=O();d&&(((a=d.parentElement)==null?void 0:a.firstChild)===d&&((v=(p=d.closest(W))==null?void 0:p.querySelector(bt))==null||v.scrollIntoView({block:"nearest"})),d.scrollIntoView({block:"nearest"}))}function O(){var a;return(a=P.current)==null?void 0:a.querySelector(`${De}[aria-selected="true"]`)}function k(){var a;return Array.from(((a=P.current)==null?void 0:a.querySelectorAll(Ne))||[])}function le(a){let p=k()[a];p&&S.setState("value",p.getAttribute(V))}function se(a){var p;let v=O(),d=k(),g=d.findIndex(D=>D===v),b=d[g+a];(p=o.current)!=null&&p.loop&&(b=g+a<0?d[d.length-1]:g+a===d.length?d[0]:d[g+a]),b&&S.setState("value",b.getAttribute(V))}function xe(a){let p=O(),v=p==null?void 0:p.closest(W),d;for(;v&&!d;)v=a>0?Dt(v,W):At(v,W),d=v==null?void 0:v.querySelector(Ne);d?S.setState("value",d.getAttribute(V)):se(a)}let ve=()=>le(k().length-1),ge=a=>{a.preventDefault(),a.metaKey?ve():a.altKey?xe(1):se(1)},ye=a=>{a.preventDefault(),a.metaKey?le(0):a.altKey?xe(-1):se(-1)};return s.createElement(T.div,{ref:r,tabIndex:-1,...M,"cmdk-root":"",onKeyDown:a=>{var p;(p=M.onKeyDown)==null||p.call(M,a);let v=a.nativeEvent.isComposing||a.keyCode===229;if(!(a.defaultPrevented||v))switch(a.key){case"n":case"j":{L&&a.ctrlKey&&ge(a);break}case"ArrowDown":{ge(a);break}case"p":case"k":{L&&a.ctrlKey&&ye(a);break}case"ArrowUp":{ye(a);break}case"Home":{a.preventDefault(),le(0);break}case"End":{a.preventDefault(),ve();break}case"Enter":{a.preventDefault();let d=O();if(d){let g=new Event(he);d.dispatchEvent(g)}}}}},s.createElement("label",{"cmdk-label":"",htmlFor:x.inputId,id:x.labelId,style:Lt},h),ae(e,a=>s.createElement(Me.Provider,{value:S},s.createElement(Ae.Provider,{value:x},a))))}),jt=s.forwardRef((e,r)=>{var t,f;let i=K(),c=s.useRef(null),m=s.useContext($e),o=Q(),h=Pe(e),l=(f=(t=h.current)==null?void 0:t.forceMount)!=null?f:m==null?void 0:m.forceMount;_(()=>{if(!l)return o.item(i,m==null?void 0:m.id)},[l]);let u=Oe(i,c,[e.value,e.children,c],e.keywords),y=pe(),N=z(w=>w.value&&w.value===u.current),C=z(w=>l||o.filter()===!1?!0:w.search?w.filtered.items.get(i)>0:!0);s.useEffect(()=>{let w=c.current;if(!(!w||e.disabled))return w.addEventListener(he,A),()=>w.removeEventListener(he,A)},[C,e.onSelect,e.disabled]);function A(){var w,S;U(),(S=(w=h.current).onSelect)==null||S.call(w,u.current)}function U(){y.setState("value",u.current,!0)}if(!C)return null;let{disabled:L,value:M,onSelect:Y,forceMount:Z,keywords:G,...P}=e;return s.createElement(T.div,{ref:J(c,r),...P,id:i,"cmdk-item":"",role:"option","aria-disabled":!!L,"aria-selected":!!N,"data-disabled":!!L,"data-selected":!!N,onPointerMove:L||o.getDisablePointerSelection()?void 0:U,onClick:L?void 0:A},e.children)}),Ct=s.forwardRef((e,r)=>{let{heading:t,children:f,forceMount:i,...c}=e,m=K(),o=s.useRef(null),h=s.useRef(null),l=K(),u=Q(),y=z(C=>i||u.filter()===!1?!0:C.search?C.filtered.groups.has(m):!0);_(()=>u.group(m),[]),Oe(m,o,[e.value,e.heading,h]);let N=s.useMemo(()=>({id:m,forceMount:i}),[i]);return s.createElement(T.div,{ref:J(o,r),...c,"cmdk-group":"",role:"presentation",hidden:y?void 0:!0},t&&s.createElement("div",{ref:h,"cmdk-group-heading":"","aria-hidden":!0,id:l},t),ae(e,C=>s.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":t?l:void 0},s.createElement($e.Provider,{value:N},C))))}),St=s.forwardRef((e,r)=>{let{alwaysRender:t,...f}=e,i=s.useRef(null),c=z(m=>!m.search);return!t&&!c?null:s.createElement(T.div,{ref:J(i,r),...f,"cmdk-separator":"",role:"separator"})}),Nt=s.forwardRef((e,r)=>{let{onValueChange:t,...f}=e,i=e.value!=null,c=pe(),m=z(l=>l.search),o=z(l=>l.selectedItemId),h=Q();return s.useEffect(()=>{e.value!=null&&c.setState("search",e.value)},[e.value]),s.createElement(T.input,{ref:r,...f,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":h.listId,"aria-labelledby":h.labelId,"aria-activedescendant":o,id:h.inputId,type:"text",value:i?e.value:m,onChange:l=>{i||c.setState("search",l.target.value),t==null||t(l.target.value)}})}),kt=s.forwardRef((e,r)=>{let{children:t,label:f="Suggestions",...i}=e,c=s.useRef(null),m=s.useRef(null),o=z(l=>l.selectedItemId),h=Q();return s.useEffect(()=>{if(m.current&&c.current){let l=m.current,u=c.current,y,N=new ResizeObserver(()=>{y=requestAnimationFrame(()=>{let C=l.offsetHeight;u.style.setProperty("--cmdk-list-height",C.toFixed(1)+"px")})});return N.observe(l),()=>{cancelAnimationFrame(y),N.unobserve(l)}}},[]),s.createElement(T.div,{ref:J(c,r),...i,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":o,"aria-label":f,id:h.listId},ae(e,l=>s.createElement("div",{ref:J(m,h.listInnerRef),"cmdk-list-sizer":""},l)))}),Et=s.forwardRef((e,r)=>{let{open:t,onOpenChange:f,overlayClassName:i,contentClassName:c,container:m,...o}=e;return s.createElement(He,{open:t,onOpenChange:f},s.createElement(Xe,{container:m},s.createElement(We,{"cmdk-overlay":"",className:i}),s.createElement(Je,{"aria-label":e.label,"cmdk-dialog":"",className:c},s.createElement(Le,{ref:r,...o}))))}),Rt=s.forwardRef((e,r)=>z(t=>t.filtered.count===0)?s.createElement(T.div,{ref:r,...e,"cmdk-empty":"",role:"presentation"}):null),It=s.forwardRef((e,r)=>{let{progress:t,children:f,label:i="Loading...",...c}=e;return s.createElement(T.div,{ref:r,...c,"cmdk-loading":"",role:"progressbar","aria-valuenow":t,"aria-valuemin":0,"aria-valuemax":100,"aria-label":i},ae(e,m=>s.createElement("div",{"aria-hidden":!0},m)))}),R=Object.assign(Le,{List:kt,Item:jt,Input:Nt,Group:Ct,Separator:St,Dialog:Et,Empty:Rt,Loading:It});function Dt(e,r){let t=e.nextElementSibling;for(;t;){if(t.matches(r))return t;t=t.nextElementSibling}}function At(e,r){let t=e.previousElementSibling;for(;t;){if(t.matches(r))return t;t=t.previousElementSibling}}function Pe(e){let r=s.useRef(e);return _(()=>{r.current=e}),r}var _=typeof window>"u"?s.useEffect:s.useLayoutEffect;function q(e){let r=s.useRef();return r.current===void 0&&(r.current=e()),r}function z(e){let r=pe(),t=()=>e(r.snapshot());return s.useSyncExternalStore(r.subscribe,t,t)}function Oe(e,r,t,f=[]){let i=s.useRef(),c=Q();return _(()=>{var m;let o=(()=>{var l;for(let u of t){if(typeof u=="string")return u.trim();if(typeof u=="object"&&"current"in u)return u.current?(l=u.current.textContent)==null?void 0:l.trim():i.current}})(),h=f.map(l=>l.trim());c.value(e,o,h),(m=r.current)==null||m.setAttribute(V,o),i.current=o}),i}var Mt=()=>{let[e,r]=s.useState(),t=q(()=>new Map);return _(()=>{t.current.forEach(f=>f()),t.current=new Map},[e]),(f,i)=>{t.current.set(f,i),r({})}};function $t(e){let r=e.type;return typeof r=="function"?r(e.props):"render"in r?r.render(e.props):e}function ae({asChild:e,children:r},t){return e&&s.isValidElement(r)?s.cloneElement($t(r),{ref:r.ref},t(r.props.children)):t(r)}var Lt={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const Te=s.forwardRef(({className:e,...r},t)=>n.jsx(R,{ref:t,className:$("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",e),...r}));Te.displayName=R.displayName;const ze=s.forwardRef(({className:e,...r},t)=>n.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[n.jsx(ct,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),n.jsx(R.Input,{ref:t,className:$("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",e),...r})]}));ze.displayName=R.Input.displayName;const Pt=s.forwardRef(({className:e,...r},t)=>n.jsx(R.List,{ref:t,className:$("max-h-[300px] overflow-y-auto overflow-x-hidden",e),...r}));Pt.displayName=R.List.displayName;const Fe=s.forwardRef((e,r)=>n.jsx(R.Empty,{ref:r,className:"py-6 text-center text-sm",...e}));Fe.displayName=R.Empty.displayName;const _e=s.forwardRef(({className:e,...r},t)=>n.jsx(R.Group,{ref:t,className:$("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",e),...r}));_e.displayName=R.Group.displayName;const Ot=s.forwardRef(({className:e,...r},t)=>n.jsx(R.Separator,{ref:t,className:$("-mx-1 h-px bg-border",e),...r}));Ot.displayName=R.Separator.displayName;const Be=s.forwardRef(({className:e,...r},t)=>n.jsx(R.Item,{ref:t,className:$("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50",e),...r}));Be.displayName=R.Item.displayName;var Tt="Separator",ke="horizontal",zt=["horizontal","vertical"],Ve=s.forwardRef((e,r)=>{const{decorative:t,orientation:f=ke,...i}=e,c=Ft(f)?f:ke,o=t?{role:"none"}:{"aria-orientation":c==="vertical"?c:void 0,role:"separator"};return n.jsx(T.div,{"data-orientation":c,...o,...i,ref:r})});Ve.displayName=Tt;function Ft(e){return zt.includes(e)}var qe=Ve;const Ke=s.forwardRef(({className:e,orientation:r="horizontal",decorative:t=!0,...f},i)=>n.jsx(qe,{ref:i,decorative:t,orientation:r,className:$("shrink-0 bg-border",r==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...f}));Ke.displayName=qe.displayName;function B({title:e,options:r,selected:t,onChange:f,placeholder:i="Select..."}){const[c,m]=s.useState(!1),o=l=>{t.includes(l)?f(t.filter(u=>u!==l)):f([...t,l])},h=l=>{l.stopPropagation(),f([])};return n.jsxs("div",{className:"flex flex-col gap-1.5 min-w-[180px]",children:[n.jsx("label",{className:"text-xs font-medium text-muted-foreground",children:e}),n.jsxs(de,{open:c,onOpenChange:m,children:[n.jsx(ue,{asChild:!0,children:n.jsxs(ne,{variant:"outline",role:"combobox","aria-expanded":c,className:"w-full justify-between h-9 px-3 text-sm",children:[n.jsxs("div",{className:"flex flex-wrap gap-1 items-center overflow-hidden",children:[t.length===0&&n.jsx("span",{className:"text-muted-foreground font-normal truncate",children:i}),t.length>0&&n.jsx("span",{className:"truncate",children:t.length===1?t[0]:`${t.length} selected`})]}),n.jsxs("div",{className:"flex items-center gap-2 shrink-0 opacity-50 ml-2",children:[t.length>0&&n.jsx(Ue,{className:"h-3 w-3 cursor-pointer hover:opacity-100",onClick:h}),n.jsx(it,{className:"h-3 w-3"})]})]})}),n.jsx(me,{className:"w-[200px] p-0",align:"start",children:n.jsxs(Te,{children:[n.jsx(ze,{placeholder:`Search ${e.toLowerCase()}...`}),n.jsxs(Fe,{children:["No ",e.toLowerCase()," found."]}),n.jsx(_e,{className:"max-h-64 overflow-auto",children:r.map(l=>n.jsxs(Be,{value:l,onSelect:()=>o(l),children:[n.jsx(Ze,{className:$("mr-2 h-4 w-4",t.includes(l)?"opacity-100":"opacity-0")}),l]},l))})]})})]})]})}function _t({availableFilters:e,filters:r,onFilterChange:t,orientation:f="vertical"}){const i=s.useMemo(()=>{if(r.locations.length===0){const h=new Set;return e.locations.forEach(l=>{l.sites.forEach(u=>h.add(u))}),Array.from(h).sort()}else{const h=new Set;return e.locations.filter(l=>r.locations.includes(l.name)).forEach(l=>{l.sites.forEach(u=>h.add(u))}),Array.from(h).sort()}},[e.locations,r.locations]),c=h=>{t({...r,clients:h})},m=h=>{t({...r,locations:h})},o=h=>{t({...r,sites:h})};return f==="horizontal"?n.jsxs("div",{className:"flex flex-wrap items-end gap-4 p-1",children:[n.jsx("div",{className:"flex items-center gap-2 text-sm font-medium text-muted-foreground mr-2 pb-2",children:n.jsx("span",{children:"ðŸŒªï¸ Filters:"})}),n.jsx(B,{title:"Clients",options:e.clients,selected:r.clients,onChange:c,placeholder:"All Clients"}),n.jsx(B,{title:"Locations",options:e.locations.map(h=>h.name),selected:r.locations,onChange:m,placeholder:"All Locations"}),n.jsx(B,{title:"Sites",options:i,selected:r.sites,onChange:o,placeholder:"All Sites"})]}):n.jsxs(at,{className:"h-full flex flex-col",children:[n.jsx(lt,{className:"pb-3",children:n.jsx(st,{className:"text-lg flex items-center gap-2",children:"ðŸŒªï¸ Filters"})}),n.jsxs(ot,{className:"space-y-4 flex-1 overflow-y-auto",children:[n.jsx(B,{title:"Clients",options:e.clients,selected:r.clients,onChange:c,placeholder:"All Clients"}),n.jsx(Ke,{}),n.jsx(B,{title:"Locations",options:e.locations.map(h=>h.name),selected:r.locations,onChange:m,placeholder:"All Locations"}),n.jsx(B,{title:"Sites",options:i,selected:r.sites,onChange:o,placeholder:"All Sites"})]})]})}const Bt=s.lazy(()=>Re(()=>import("./MetricPalette-cOCgFfqu.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]))),Vt=s.lazy(()=>Re(()=>import("./ChartCanvas-D7W1fb6M.js"),__vite__mapDeps([9,1,2,10,11,12])));function Jt(){const{state:e,setDimensions:r,setMetrics:t,setChartType:f,setDateRange:i,setChartData:c}=dt(),{toast:m}=Ye(),[o,h]=s.useState({from:new Date,to:be(new Date,30)}),[l,u]=s.useState({from:new Date,to:be(new Date,30)}),[y,N]=s.useState(!1),[C,A]=s.useState(!1),[U,L]=s.useState({clients:[],locations:[]}),[M,Y]=s.useState({clients:[],locations:[],sites:[]});s.useEffect(()=>{(async()=>{try{const j=await fetch("/api/filters",{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});if(j.ok){const F=await j.json();L(F)}}catch(j){console.error("Error fetching filters:",j)}})()},[]);const Z=()=>{u(o)};s.useEffect(()=>{(async()=>{if(e.dimensions.length===0||e.metrics.length===0||!(l!=null&&l.from)||!(l!=null&&l.to)){c([]);return}const j=e.dimensions[0],F=e.metrics,H=re(l.from,"yyyy-MM-dd"),X=re(l.to,"yyyy-MM-dd");try{const I=new URLSearchParams;I.append("start",H),I.append("end",X),I.append("dimension",j),F.forEach(k=>I.append("metrics",k)),M.clients.forEach(k=>I.append("clients",k)),M.locations.forEach(k=>I.append("locations",k)),M.sites.forEach(k=>I.append("sites",k));const O=await fetch(`/api/chart-data?${I.toString()}`,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});if(O.ok){const k=await O.json();c(k)}else console.error("Failed to fetch chart data"),c([])}catch(I){console.error("Error fetching chart data:",I),c([])}})()},[e.dimensions,e.metrics,l,M]);const G=x=>{x.type==="dimension"?e.dimensions.includes(x.name)||(r([x.name]),m({description:`Added ${x.name} to chart`,duration:2e3})):x.type==="metric"&&(e.metrics.includes(x.name)||(t([...e.metrics,x.name]),m({description:`Added ${x.name} to chart`,duration:2e3})))},P=x=>{x.type==="dimension"?e.dimensions.includes(x.name)&&(r(e.dimensions.filter(j=>j!==x.name)),m({description:`Removed ${x.name} from chart`,duration:2e3})):x.type==="metric"&&e.metrics.includes(x.name)&&(t(e.metrics.filter(j=>j!==x.name)),m({description:`Removed ${x.name} from chart`,duration:2e3}))},w=x=>{r(e.dimensions.filter(j=>j!==x))},S=x=>{t(e.metrics.filter(j=>j!==x))};return n.jsx(Qe,{children:n.jsx("div",{className:"p-4 md:p-6 h-full flex flex-col",children:n.jsxs("div",{className:"space-y-4 h-full flex flex-col",children:[n.jsx("div",{className:"sticky lg:top-0 z-30 pb-2 border-b -mx-4 md:-mx-6 px-4 md:px-6 pt-1 shadow-sm bg-background",children:n.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[n.jsx("div",{children:n.jsx("h1",{className:"text-xl font-bold",children:"Chart Builder"})}),n.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[n.jsx("div",{className:"w-32",children:n.jsxs(et,{value:e.chartType,onValueChange:f,children:[n.jsx(tt,{className:"h-8 text-xs",children:n.jsx(rt,{placeholder:"Chart Type"})}),n.jsxs(nt,{children:[n.jsx(te,{value:"bar",children:"Bar Chart"}),n.jsx(te,{value:"line",children:"Line Chart"}),n.jsx(te,{value:"area",children:"Area Chart"}),n.jsx(te,{value:"pie",children:"Pie Chart"})]})]})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs(de,{open:y,onOpenChange:N,children:[n.jsx(ue,{asChild:!0,children:n.jsxs(ne,{variant:"outline",className:$("w-32 justify-start text-left font-normal h-8 text-xs",!(o!=null&&o.from)&&"text-muted-foreground"),children:[n.jsx(we,{className:"mr-2 h-3 w-3"}),o!=null&&o.from?re(o.from,"MMM dd, y"):n.jsx("span",{children:"From"})]})}),n.jsx(me,{className:"w-auto p-0",align:"start",children:n.jsx(je,{mode:"single",selected:o==null?void 0:o.from,onSelect:x=>{h(j=>({...j,from:x})),N(!1)},defaultMonth:o==null?void 0:o.from,captionLayout:"dropdown-buttons",fromYear:2020,toYear:2030})})]}),n.jsx("span",{className:"text-muted-foreground text-xs",children:"-"}),n.jsxs(de,{open:C,onOpenChange:A,children:[n.jsx(ue,{asChild:!0,children:n.jsxs(ne,{variant:"outline",className:$("w-32 justify-start text-left font-normal h-8 text-xs",!(o!=null&&o.to)&&"text-muted-foreground"),children:[n.jsx(we,{className:"mr-2 h-3 w-3"}),o!=null&&o.to?re(o.to,"MMM dd, y"):n.jsx("span",{children:"To"})]})}),n.jsx(me,{className:"w-auto p-0",align:"start",children:n.jsx(je,{mode:"single",selected:o==null?void 0:o.to,onSelect:x=>{h(j=>({...j,to:x})),A(!1)},defaultMonth:o==null?void 0:o.to,captionLayout:"dropdown-buttons",fromYear:2020,toYear:2030,disabled:x=>x<((o==null?void 0:o.from)||new Date(0))})})]}),n.jsx(ne,{onClick:Z,size:"sm",className:"h-8 text-xs",disabled:!(o!=null&&o.from)||!(o!=null&&o.to),children:"Apply"})]})]})]})}),n.jsx("div",{className:"flex-1 min-h-0 overflow-hidden",children:n.jsx(s.Suspense,{fallback:n.jsx("div",{className:"flex-1 flex items-center justify-center",children:n.jsx(Ge,{className:"h-8 w-8 rounded-full"})}),children:n.jsxs("div",{className:"flex-1 flex flex-col lg:flex-row gap-4 min-h-0 h-full",children:[n.jsx("div",{className:"lg:w-72 shrink-0 h-full flex flex-col overflow-hidden",children:n.jsx("div",{className:"flex-1 min-h-0 overflow-y-auto pr-2",children:n.jsx(Bt,{selectedDimensions:e.dimensions,selectedMetrics:e.metrics,onItemClick:G,onItemDoubleClick:P})})}),n.jsxs("div",{className:"flex-1 min-w-0 flex flex-col h-full overflow-hidden",children:[n.jsx("div",{className:"shrink-0 pb-2 border-b mb-2",children:n.jsx(_t,{availableFilters:U,filters:M,onFilterChange:Y,orientation:"horizontal"})}),n.jsx("div",{className:"flex-1 min-h-0 overflow-y-auto",children:n.jsx(Vt,{dimensions:e.dimensions,metrics:e.metrics,chartType:e.chartType,chartData:e.chartData,onRemoveDimension:w,onRemoveMetric:S})})]})]})})})]})})})}export{Jt as default};
