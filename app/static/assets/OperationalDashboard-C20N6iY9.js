import{c as se,r as S,R as b,f as ye,a as xe,A as ve,j as a,L as ge,B as be,u as je,b as Ae,e as Se}from"./index-D_nV2UWA.js";import{D as Oe}from"./DashboardLayout-DpgmNEL3.js";import{f as ee}from"./popover-CVrZLvH6.js";import{u as we,c as Pe,D as Ne,R as te}from"./RankingList-hpAZUFCt.js";import{C as w,a as P,b as N,d as T}from"./card-CwR32d0k.js";import{D as Te,a as Ee,b as _e,c as De,d as Ce}from"./dialog-d2cMqy7q.js";import{u as ke}from"./useQuery-CyLTwL1x.js";import{S as re,a as Le,G as $e,f as U,b as $,c as Ie,d as Ke,i as B,e as ze,g as oe,E as Be,h as M,j as Me,k as Fe,l as Re,m as D,n as He,o as qe,p as ie,u as We,q as Ze,A as le,B as ce,X as ue,Y as V,r as Ue,R as Ve,C as Ge,T as Ye,L as Je}from"./generateCategoricalChart-C7Nst1bo.js";import{L as Xe}from"./Line-C-A-w6Mj.js";import{U as Qe}from"./users-DhhjNrBa.js";import"./locationUtils-MmHbcSXv.js";import"./index-CFCu5OC1.js";import"./progress-CUGyuvg8.js";import"./ellipsis-BCrEAktv.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=se("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=se("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);function C(t){"@babel/helpers - typeof";return C=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C(t)}function rt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function it(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,pe(r.key),r)}}function at(t,e,i){return e&&it(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function nt(t,e,i){return e=F(e),st(t,de()?Reflect.construct(e,i||[],F(t).constructor):e.apply(t,i))}function st(t,e){if(e&&(C(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ot(t)}function ot(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function de(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(de=function(){return!!t})()}function F(t){return F=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},F(t)}function lt(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&G(t,e)}function G(t,e){return G=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},G(t,e)}function fe(t,e,i){return e=pe(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function pe(t){var e=ct(t,"string");return C(e)=="symbol"?e:e+""}function ct(t,e){if(C(t)!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(C(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var H=function(t){function e(){return rt(this,e),nt(this,e,arguments)}return lt(e,t),at(e,[{key:"render",value:function(){return null}}])}(S.Component);fe(H,"displayName","ZAxis");fe(H,"defaultProps",{zAxisId:0,range:[64,64],scale:"auto",type:"number"});var ut=["option","isActive"];function I(){return I=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},I.apply(this,arguments)}function dt(t,e){if(t==null)return{};var i=ft(t,e),r,n;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(n=0;n<l.length;n++)r=l[n],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function ft(t,e){if(t==null)return{};var i={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;i[r]=t[r]}return i}function pt(t){var e=t.option,i=t.isActive,r=dt(t,ut);return typeof e=="string"?S.createElement(re,I({option:S.createElement(Le,I({type:e},r)),isActive:i,shapeType:"symbols"},r)):S.createElement(re,I({option:e,isActive:i,shapeType:"symbols"},r))}function k(t){"@babel/helpers - typeof";return k=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},k(t)}function K(){return K=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},K.apply(this,arguments)}function ae(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),i.push.apply(i,r)}return i}function A(t){for(var e=1;e<arguments.length;e++){var i=arguments[e]!=null?arguments[e]:{};e%2?ae(Object(i),!0).forEach(function(r){E(t,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):ae(Object(i)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(i,r))})}return t}function mt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ne(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,he(r.key),r)}}function ht(t,e,i){return e&&ne(t.prototype,e),i&&ne(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function yt(t,e,i){return e=R(e),xt(t,me()?Reflect.construct(e,i||[],R(t).constructor):e.apply(t,i))}function xt(t,e){if(e&&(k(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vt(t)}function vt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function me(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(me=function(){return!!t})()}function R(t){return R=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},R(t)}function gt(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Y(t,e)}function Y(t,e){return Y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},Y(t,e)}function E(t,e,i){return e=he(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function he(t){var e=bt(t,"string");return k(e)=="symbol"?e:e+""}function bt(t,e){if(k(t)!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var r=i.call(t,e||"default");if(k(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var q=function(t){function e(){var i;mt(this,e);for(var r=arguments.length,n=new Array(r),l=0;l<r;l++)n[l]=arguments[l];return i=yt(this,e,[].concat(n)),E(i,"state",{isAnimationFinished:!1}),E(i,"handleAnimationEnd",function(){i.setState({isAnimationFinished:!0})}),E(i,"handleAnimationStart",function(){i.setState({isAnimationFinished:!1})}),E(i,"id",We("recharts-scatter-")),i}return gt(e,t),ht(e,[{key:"renderSymbolsStatically",value:function(r){var n=this,l=this.props,d=l.shape,m=l.activeShape,f=l.activeIndex,p=U(this.props,!1);return r.map(function(o,s){var c=f===s,u=c?m:d,v=A(A({},p),o);return b.createElement($,K({className:"recharts-scatter-symbol",key:"symbol-".concat(o==null?void 0:o.cx,"-").concat(o==null?void 0:o.cy,"-").concat(o==null?void 0:o.size,"-").concat(s)},Ie(n.props,o,s),{role:"img"}),b.createElement(pt,K({option:u,isActive:c,key:"symbol-".concat(s)},v)))})}},{key:"renderSymbolsWithAnimation",value:function(){var r=this,n=this.props,l=n.points,d=n.isAnimationActive,m=n.animationBegin,f=n.animationDuration,p=n.animationEasing,o=n.animationId,s=this.state.prevPoints;return b.createElement(Ke,{begin:m,duration:f,isActive:d,easing:p,from:{t:0},to:{t:1},key:"pie-".concat(o),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(c){var u=c.t,v=l.map(function(g,y){var x=s&&s[y];if(x){var j=B(x.cx,g.cx),h=B(x.cy,g.cy),O=B(x.size,g.size);return A(A({},g),{},{cx:j(u),cy:h(u),size:O(u)})}var _=B(0,g.size);return A(A({},g),{},{size:_(u)})});return b.createElement($,null,r.renderSymbolsStatically(v))})}},{key:"renderSymbols",value:function(){var r=this.props,n=r.points,l=r.isAnimationActive,d=this.state.prevPoints;return l&&n&&n.length&&(!d||!ze(d,n))?this.renderSymbolsWithAnimation():this.renderSymbolsStatically(n)}},{key:"renderErrorBar",value:function(){var r=this.props.isAnimationActive;if(r&&!this.state.isAnimationFinished)return null;var n=this.props,l=n.points,d=n.xAxis,m=n.yAxis,f=n.children,p=oe(f,Be);return p?p.map(function(o,s){var c=o.props,u=c.direction,v=c.dataKey;return b.cloneElement(o,{key:"".concat(u,"-").concat(v,"-").concat(l[s]),data:l,xAxis:d,yAxis:m,layout:u==="x"?"vertical":"horizontal",dataPointFormatter:function(y,x){return{x:y.cx,y:y.cy,value:u==="x"?+y.node.x:+y.node.y,errorVal:M(y,x)}}})}):null}},{key:"renderLine",value:function(){var r=this.props,n=r.points,l=r.line,d=r.lineType,m=r.lineJointType,f=U(this.props,!1),p=U(l,!1),o,s;if(d==="joint")o=n.map(function(h){return{x:h.cx,y:h.cy}});else if(d==="fitting"){var c=Me(n),u=c.xmin,v=c.xmax,g=c.a,y=c.b,x=function(O){return g*O+y};o=[{x:u,y:x(u)},{x:v,y:x(v)}]}var j=A(A(A({},f),{},{fill:"none",stroke:f&&f.fill},p),{},{points:o});return b.isValidElement(l)?s=b.cloneElement(l,j):Fe(l)?s=l(j):s=b.createElement(Re,K({},j,{type:m})),b.createElement($,{className:"recharts-scatter-line",key:"recharts-scatter-line"},s)}},{key:"render",value:function(){var r=this.props,n=r.hide,l=r.points,d=r.line,m=r.className,f=r.xAxis,p=r.yAxis,o=r.left,s=r.top,c=r.width,u=r.height,v=r.id,g=r.isAnimationActive;if(n||!l||!l.length)return null;var y=this.state.isAnimationFinished,x=ye("recharts-scatter",m),j=f&&f.allowDataOverflow,h=p&&p.allowDataOverflow,O=j||h,_=D(v)?this.id:v;return b.createElement($,{className:x,clipPath:O?"url(#clipPath-".concat(_,")"):null},j||h?b.createElement("defs",null,b.createElement("clipPath",{id:"clipPath-".concat(_)},b.createElement("rect",{x:j?o:o-c/2,y:h?s:s-u/2,width:j?c:c*2,height:h?u:u*2}))):null,d&&this.renderLine(),this.renderErrorBar(),b.createElement($,{key:"recharts-scatter-symbols"},this.renderSymbols()),(!g||y)&&He.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(r,n){return r.animationId!==n.prevAnimationId?{prevAnimationId:r.animationId,curPoints:r.points,prevPoints:n.curPoints}:r.points!==n.curPoints?{curPoints:r.points}:null}}])}(S.PureComponent);E(q,"displayName","Scatter");E(q,"defaultProps",{xAxisId:0,yAxisId:0,zAxisId:0,legendType:"circle",lineType:"joint",lineJointType:"linear",data:[],shape:"circle",hide:!1,isAnimationActive:!$e.isSsr,animationBegin:0,animationDuration:400,animationEasing:"linear"});E(q,"getComposedData",function(t){var e=t.xAxis,i=t.yAxis,r=t.zAxis,n=t.item,l=t.displayedData,d=t.xAxisTicks,m=t.yAxisTicks,f=t.offset,p=n.props.tooltipType,o=oe(n.props.children,qe),s=D(e.dataKey)?n.props.dataKey:e.dataKey,c=D(i.dataKey)?n.props.dataKey:i.dataKey,u=r&&r.dataKey,v=r?r.range:H.defaultProps.range,g=v&&v[0],y=e.scale.bandwidth?e.scale.bandwidth():0,x=i.scale.bandwidth?i.scale.bandwidth():0,j=l.map(function(h,O){var _=M(h,s),J=M(h,c),L=!D(u)&&M(h,u)||"-",X=[{name:D(e.dataKey)?n.props.name:e.name||e.dataKey,unit:e.unit||"",value:_,payload:h,dataKey:s,type:p},{name:D(i.dataKey)?n.props.name:i.name||i.dataKey,unit:i.unit||"",value:J,payload:h,dataKey:c,type:p}];L!=="-"&&X.push({name:r.name||r.dataKey,unit:r.unit||"",value:L,payload:h,dataKey:u,type:p});var W=ie({axis:e,ticks:d,bandSize:y,entry:h,index:O,dataKey:s}),Z=ie({axis:i,ticks:m,bandSize:x,entry:h,index:O,dataKey:c}),Q=L!=="-"?r.scale(L):g,z=Math.sqrt(Math.max(Q,0)/Math.PI);return A(A({},h),{},{cx:W,cy:Z,x:W-z,y:Z-z,xAxis:e,yAxis:i,zAxis:r,width:2*z,height:2*z,size:Q,node:{x:_,y:J,z:L},tooltipPayload:X,tooltipPosition:{x:W,y:Z},payload:h},o&&o[O]&&o[O].props)});return A({points:j},f)});var jt=Ze({chartName:"ComposedChart",GraphicalChild:[Xe,le,ce,q],axisComponents:[{axisType:"xAxis",AxisComp:ue},{axisType:"yAxis",AxisComp:V},{axisType:"zAxis",AxisComp:H}],formatAxisMap:Ue});const At=(t,e,i)=>{const[r,n]=S.useState(null),[l,d]=S.useState(!1),{toast:m}=xe(),f=async()=>{d(!0);try{const p=new URLSearchParams({start:ee(t.from,"yyyy-MM-dd"),end:ee(t.to,"yyyy-MM-dd")});e&&e.length>0&&e.forEach(s=>p.append("locations",s)),i&&i.length>0&&i.forEach(s=>p.append("sites",s));const o=await fetch(`${ve.SALES_SUMMARY.replace("sales-summary","operational-summary")}?${p}`,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`},credentials:"include"});if(o.ok){const s=await o.json();n(s)}else m({title:"Error",description:"Could not fetch operational data",variant:"destructive"})}catch{m({title:"Error",description:"Failed to connect to server",variant:"destructive"})}finally{d(!1)}};return S.useEffect(()=>{f()},[t,e,i]),{operationalData:r,isLoading:l,refetch:f}},St=({dateRange:t})=>{const e=t!=null&&t.from?t.from.toISOString().split("T")[0]:"",i=t!=null&&t.to?t.to.toISOString().split("T")[0]:"",{data:r,isLoading:n}=ke({queryKey:["target-performance",e,i],queryFn:async()=>{if(!e||!i)return[];const s=await fetch(`/api/dashboard/targets-performance?start=${e}&end=${i}`,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});if(!s.ok)throw new Error("Failed to fetch target Data");return s.json()},enabled:!!e&&!!i});if(n)return a.jsxs(w,{children:[a.jsx(P,{children:a.jsx(N,{children:"Target Performance"})}),a.jsx(T,{children:a.jsx(ge,{className:"animate-spin"})})]});if(!r||r.length===0)return null;const l=new Map;r.forEach(s=>{const c=`${s.location}|${s.site||"null"}`,u=l.get(c);u?(u.actual+=s.actual,u.target+=s.target):l.set(c,{location:s.location,site:s.site,actual:s.actual,target:s.target})});const d=Array.from(l.values()),m=d.length,f=d.filter(s=>s.actual>=s.target).length,p=m-f,o=m>0?f/m*100:0;return a.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-2",children:[a.jsxs(w,{children:[a.jsxs(P,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(N,{className:"text-sm font-medium",children:"Target Achievement"}),a.jsx(tt,{className:"h-4 w-4 text-muted-foreground"})]}),a.jsxs(T,{children:[a.jsxs("div",{className:"text-2xl font-bold",children:[o.toFixed(0),"%"]}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:[f," of ",m," sites met target"]}),a.jsx("div",{className:"mt-4 h-2 w-full bg-secondary rounded-full overflow-hidden",children:a.jsx("div",{className:"h-full bg-primary",style:{width:`${o}%`}})})]})]}),a.jsxs(w,{children:[a.jsx(P,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:a.jsx(N,{className:"text-sm font-medium",children:"Missed Targets"})}),a.jsxs(T,{children:[a.jsx("div",{className:"text-2xl font-bold",children:p}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Sites below target"}),a.jsxs(Te,{children:[a.jsx(Ee,{asChild:!0,children:a.jsx(be,{variant:"outline",size:"sm",className:"mt-4 w-full",children:"View Details"})}),a.jsxs(_e,{className:"max-h-[80vh] overflow-y-auto",children:[a.jsx(De,{children:a.jsx(Ce,{children:"Missed Targets Report"})}),a.jsxs("div",{className:"space-y-2",children:[d.filter(s=>s.actual<s.target).map((s,c)=>a.jsxs("div",{className:"flex justify-between items-center border-b pb-2 last:border-0",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"font-medium",children:s.site||s.location}),a.jsx("span",{className:"text-xs text-muted-foreground",children:s.location})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("span",{className:"text-red-500 font-bold",children:[s.actual," / ",s.target]}),a.jsxs("span",{className:"text-xs text-muted-foreground block",children:["Deficit: ",s.actual-s.target]})]})]},c)),p===0&&a.jsx("p",{className:"text-center text-muted-foreground",children:"No missed targets!"})]})]})]})]})]})]})},Ot=({active:t,payload:e,label:i})=>t&&e&&e.length?a.jsxs("div",{className:"bg-background border border-border p-3 rounded-lg shadow-lg",children:[a.jsx("p",{className:"font-semibold text-foreground",children:i}),e.map((r,n)=>a.jsxs("p",{className:"text-sm",style:{color:r.color},children:[r.name,": ",r.name==="Paid Hours"?r.value.toLocaleString(void 0,{maximumFractionDigits:1}):r.value]},n))]}):null,wt=({data:t,aggregationLevel:e})=>{const i={dataKey:"display",interval:0};return!t||t.length===0?a.jsxs(w,{children:[a.jsx(P,{children:a.jsx(N,{children:"Hours & Shifts Trend"})}),a.jsx(T,{children:a.jsx("div",{className:"h-[400px] flex items-center justify-center",children:a.jsx("p",{className:"text-muted-foreground",children:"No data available for the selected period"})})})]}):a.jsxs(w,{children:[a.jsxs(P,{children:[a.jsx(N,{children:"Hours & Shifts Trend"}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:[e==="daily"&&"Daily view",e==="weekly"&&"Weekly view",e==="monthly"&&"Monthly view"]})]}),a.jsx(T,{children:a.jsx("div",{className:"h-[400px]",children:a.jsx(Ve,{width:"100%",height:"100%",children:a.jsxs(jt,{data:t,children:[a.jsx(Ge,{strokeDasharray:"3 3"}),a.jsx(ue,{dataKey:i.dataKey,tick:{fontSize:12},interval:i.interval}),a.jsx(V,{yAxisId:"left",orientation:"left",label:{value:"Hours",angle:-90,position:"insideLeft"}}),a.jsx(V,{yAxisId:"right",orientation:"right",label:{value:"Shifts",angle:90,position:"insideRight"}}),a.jsx(Ye,{content:a.jsx(Ot,{})}),a.jsx(Je,{}),a.jsx(le,{yAxisId:"left",type:"monotone",dataKey:"paidHours",name:"Paid Hours",stroke:"hsl(var(--primary))",fill:"hsl(var(--primary))",fillOpacity:.3,strokeWidth:2}),a.jsx(ce,{yAxisId:"right",dataKey:"totalShifts",name:"Total Shifts",barSize:20,fill:"hsl(var(--accent))",fillOpacity:.6})]})})})})]})},Mt=()=>{je(),Ae();const{dateRange:t,setDateRange:e}=Se(),[i,r]=S.useState(!1),[n,l]=S.useState(t),[d,m]=S.useState([]),[f,p]=S.useState([]),{operationalData:o,isLoading:s}=At(t,d,f),{topStaff:c,isLoadingStaff:u,topClientsShifts:v,isLoadingClientsShifts:g}=we(t,d,f),y=Pe(o,t);return a.jsx(Oe,{fullWidth:!0,children:a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsx(Ne,{dateRange:t,onDateRangeChange:e,calendarOpen:i,onCalendarOpenChange:r,tempDateRange:n,onTempDateRangeChange:l,selectedLocations:d,onLocationsChange:m,selectedSites:f,onSitesChange:p}),a.jsx("div",{className:"flex-1 overflow-auto",children:a.jsx("div",{className:"px-4 pt-6 pb-6 space-y-4",children:a.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-7",children:[a.jsxs("div",{className:"col-span-5 flex flex-col gap-4",children:[a.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[a.jsxs(w,{children:[a.jsx(P,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:a.jsx(N,{className:"text-sm font-medium",children:"Total Shifts"})}),a.jsxs(T,{children:[a.jsx("div",{className:"text-2xl font-bold",children:y.totalShifts.value}),a.jsx("p",{className:"text-xs text-muted-foreground",children:y.totalShifts.text})]})]}),a.jsxs(w,{children:[a.jsx(P,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:a.jsx(N,{className:"text-sm font-medium",children:"Total Hours"})}),a.jsxs(T,{children:[a.jsx("div",{className:"text-2xl font-bold",children:y.paidHours.value.toLocaleString()}),a.jsx("p",{className:"text-xs text-muted-foreground",children:y.paidHours.text})]})]}),a.jsxs(w,{children:[a.jsx(P,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:a.jsx(N,{className:"text-sm font-medium",children:"Active Clients"})}),a.jsxs(T,{children:[a.jsx("div",{className:"text-2xl font-bold",children:y.totalClients.value}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Distinct clients this period"})]})]})]}),a.jsx(St,{dateRange:t}),a.jsxs(w,{className:"flex-1",children:[a.jsx(P,{children:a.jsx(N,{children:"Overview"})}),a.jsx(T,{className:"pl-2",children:a.jsx(wt,{data:(o==null?void 0:o.timeSeries)||[],aggregationLevel:(o==null?void 0:o.aggregationLevel)||"monthly"})})]})]}),a.jsxs("div",{className:"col-span-2 flex flex-col gap-4",children:[a.jsx(te,{title:"Top Staff (Paid Hours)",data:c,isLoading:u,valueFormatter:x=>`${x.toLocaleString()} hrs`,icon:a.jsx(Qe,{className:"h-4 w-4"}),className:"flex-1"}),a.jsx(te,{title:"Top Clients (Shifts)",data:v,isLoading:g,valueFormatter:x=>`${x.toLocaleString()} shifts`,icon:a.jsx(et,{className:"h-4 w-4"}),className:"flex-1",barColor:"bg-blue-500"})]})]})})})]})})};export{Mt as OperationalDashboard,Mt as default};
