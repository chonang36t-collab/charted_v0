import{r as s,a as f,A as g,u as x,b as y,j as e}from"./index-BkF6eZqS.js";import{D as j,L as v}from"./DashboardLayout-DxouEvFY.js";import{f as h}from"./popover-VpNf-b-O.js";import{c as D,D as N,L as w,M as L,A as S,R as O}from"./LoadingOverlay-D7OB3x0Y.js";import{B as p}from"./button-Cedjd8aw.js";import{T as b}from"./users-WJDmUz7O.js";import"./select-Dg33NSRy.js";import"./card-C5tkn_9V.js";import"./AreaChart-CGvpsZA3.js";const M=r=>{const[l,t]=s.useState(null),[d,o]=s.useState(!1),{toast:n}=f(),i=async()=>{o(!0);try{const c=new URLSearchParams({start:h(r.from,"yyyy-MM-dd"),end:h(r.to,"yyyy-MM-dd")}),a=await fetch(`${g.SALES_SUMMARY.replace("sales-summary","operational-summary")}?${c}`,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});if(a.ok){const m=await a.json();t(m)}else n({title:"Error",description:"Could not fetch operational data",variant:"destructive"})}catch{n({title:"Error",description:"Failed to connect to server",variant:"destructive"})}finally{o(!1)}};return s.useEffect(()=>{i()},[r]),{operationalData:l,isLoading:d,refetch:i}};function B(){const r=x(),{role:l}=y(),[t,d]=s.useState({from:new Date(2025,0,1),to:new Date(2025,8,30)}),[o,n]=s.useState(!1),[i,c]=s.useState(t),{operationalData:a,isLoading:m}=M(t),u=D(a,t);return e.jsx(j,{children:e.jsxs("div",{className:"flex flex-col h-screen",children:[e.jsx(N,{dateRange:t,onDateRangeChange:d,calendarOpen:o,onCalendarOpenChange:n,tempDateRange:i,onTempDateRangeChange:c}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:l==="admin"?e.jsxs("div",{className:"flex items-center gap-2 px-1 py-1 bg-muted rounded-lg",children:[e.jsxs(p,{variant:"ghost",size:"sm",className:"gap-2 text-muted-foreground hover:text-foreground",onClick:()=>r("/dashboard/financial"),children:[e.jsx(b,{className:"h-4 w-4"}),"Financial View"]}),e.jsxs(p,{variant:"secondary",size:"sm",className:"gap-2 shadow-sm",children:[e.jsx(v,{className:"h-4 w-4"}),"Operational View"]})]}):e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Operational Dashboard"})}),m&&e.jsx(w,{}),e.jsx(L,{metrics:u}),e.jsx(S,{salesData:a}),e.jsx(O,{data:(a==null?void 0:a.timeSeries)||[],aggregationLevel:(a==null?void 0:a.aggregationLevel)||"monthly"})]})})]})})}export{B as default};
