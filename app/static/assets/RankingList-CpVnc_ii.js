import{c as U,j as t,e as T,B as O,r as N,a as V,A as H,S as J}from"./index-C-ijiT9j.js";import{C as B,a as F,b as G,d as K}from"./card-BTzBTY9M.js";import{C as Q}from"./DashboardLayout-B9aleQ7j.js";import{f as z}from"./popover-BP2f3grz.js";import{P as W}from"./progress-ClkMLgHL.js";import{E as X}from"./ellipsis-CGLpmWc7.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=U("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]),se=(e,i)=>{var C,w,b,r,n,g,R,k,A,I,L,$,q,M,_;if(!e)return{revenue:{value:0,change:0,trend:"neutral",text:"No data available"},clientPay:{value:0,change:0,trend:"neutral",text:"No data available"},staffPay:{value:0,change:0,trend:"neutral",text:"No data available"},totalShifts:{value:0,change:0,trend:"neutral",text:"No data available"},paidHours:{value:0,change:0,trend:"neutral",text:"No data available"},uniqueEmployees:{value:0,change:0,trend:"neutral",text:"No data available"},avgShiftDuration:{value:0,change:0,trend:"neutral",text:"No data available"},totalClients:{value:0,change:0,trend:"neutral",text:"No data available"}};const l=e.totalRevenue||0,p=e.avgClientPayPerHour||0,d=e.avgStaffPayPerHour||0,v=((C=e.previousPeriod)==null?void 0:C.totalRevenue)||0,h=((w=e.previousPeriod)==null?void 0:w.avgClientPayPerHour)||0,u=((b=e.previousPeriod)==null?void 0:b.avgStaffPayPerHour)||0,a=(y,j)=>j>0?(y-j)/j*100:0,o=a(l,v),s=a(p,h),P=a(d,u),m=y=>y>0?"up":y<0?"down":"neutral",x=(y,j,E)=>{if(!j)return"No previous data";let S="";return E<=7?S="last week":E<=31?S="last month":E<=93?S="last quarter":S="last period",`${y>0?"+":""}${Math.abs(y).toFixed(1)}% from ${S}`},f=Math.ceil((i.to.getTime()-i.from.getTime())/(1e3*60*60*24)),c=!!e.previousPeriod;return{revenue:{value:l,change:o,trend:m(o),text:x(o,c,f)},clientPay:{value:p,change:s,trend:m(s),text:x(s,c,f)},staffPay:{value:d,change:P,trend:m(P),text:x(P,c,f)},totalShifts:{value:e.totalShifts,change:a(e.totalShifts,((r=e.previousPeriod)==null?void 0:r.totalShifts)||0),trend:m(a(e.totalShifts,((n=e.previousPeriod)==null?void 0:n.totalShifts)||0)),text:x(a(e.totalShifts,((g=e.previousPeriod)==null?void 0:g.totalShifts)||0),c,f)},paidHours:{value:e.totalPaidHours||0,change:a(e.totalPaidHours||0,((R=e.previousPeriod)==null?void 0:R.totalPaidHours)||0)||0,trend:m(a(e.totalPaidHours||0,((k=e.previousPeriod)==null?void 0:k.totalPaidHours)||0)),text:x(a(e.totalPaidHours||0,((A=e.previousPeriod)==null?void 0:A.totalPaidHours)||0),c,f)},uniqueEmployees:{value:e.uniqueEmployees,change:a(e.uniqueEmployees,((I=e.previousPeriod)==null?void 0:I.uniqueEmployees)||0),trend:m(a(e.uniqueEmployees,((L=e.previousPeriod)==null?void 0:L.uniqueEmployees)||0)),text:x(a(e.uniqueEmployees,(($=e.previousPeriod)==null?void 0:$.uniqueEmployees)||0),c,f)},avgShiftDuration:{value:e.totalPaidHours&&e.totalShifts?e.totalPaidHours/e.totalShifts:0,change:0,trend:"neutral",text:"Average hours per shift"},totalClients:{value:e.totalClients,change:a(e.totalClients,((q=e.previousPeriod)==null?void 0:q.totalClients)||0),trend:m(a(e.totalClients,((M=e.previousPeriod)==null?void 0:M.totalClients)||0)),text:x(a(e.totalClients,((_=e.previousPeriod)==null?void 0:_.totalClients)||0),c,f)}}},ne=({title:e,value:i,subtitle:l,icon:p,trend:d,isSelected:v=!1,onClick:h,onViewDetails:u,children:a})=>{const o=!!h;return t.jsxs(B,{className:T("relative transition-all duration-200",o&&"cursor-pointer hover:shadow-md hover:border-primary/50",v&&"border-primary shadow-md ring-2 ring-primary/20"),onClick:h,children:[t.jsxs(F,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(G,{className:"text-sm font-medium",children:e}),p&&t.jsx(p,{className:T("h-4 w-4 text-muted-foreground",v&&"text-primary")})]}),t.jsxs(K,{children:[t.jsx("div",{className:"text-2xl font-bold",children:i}),l&&t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:l}),d&&t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:d}),u&&t.jsxs(O,{variant:"ghost",size:"sm",className:"mt-2 w-full justify-between text-xs h-8",onClick:s=>{s.stopPropagation(),u()},children:["View Details",t.jsx(Q,{className:"h-3 w-3"})]}),a]})]})},ie=(e,i,l)=>{const[p,d]=N.useState([]),[v,h]=N.useState([]),[u,a]=N.useState([]),[o,s]=N.useState(!1),[P,m]=N.useState(!1),[x,f]=N.useState(!1);V();const c=()=>{const r=new URLSearchParams({start:z(e.from,"yyyy-MM-dd"),end:z(e.to,"yyyy-MM-dd")});return i&&i.length>0&&i.forEach(n=>r.append("locations",n)),l&&l.length>0&&l.forEach(n=>r.append("sites",n)),r},C=async()=>{s(!0);try{const r=c();r.append("limit","100");const n=await fetch(`${H.RANKINGS_STAFF}?${r}`,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});if(n.ok){const g=await n.json();d(g)}}catch(r){console.error(r)}finally{s(!1)}},w=async()=>{m(!0);try{const r=c();r.append("limit","100"),r.append("metric","revenue");const n=await fetch(`${H.RANKINGS_CLIENTS}?${r}`,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});if(n.ok){const g=await n.json();h(g)}}catch(r){console.error(r)}finally{m(!1)}},b=async()=>{f(!0);try{const r=c();r.append("limit","100"),r.append("metric","shifts");const n=await fetch(`${H.RANKINGS_CLIENTS}?${r}`,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});if(n.ok){const g=await n.json();a(g)}}catch(r){console.error(r)}finally{f(!1)}};return N.useEffect(()=>{C(),w(),b()},[e,i,l]),{topStaff:p,isLoadingStaff:o,topClientsRevenue:v,isLoadingClientsRev:P,topClientsShifts:u,isLoadingClientsShifts:x}},le=({title:e,data:i,isLoading:l=!1,valueFormatter:p=u=>u.toLocaleString(),icon:d,className:v,barColor:h="bg-primary"})=>{const u=Math.max(...i.map(o=>o.value),0),a=o=>o.toLowerCase().split(" ").map(s=>s.charAt(0).toUpperCase()+s.slice(1)).join(" ");return t.jsxs(B,{className:T("flex flex-col h-full shadow-sm hover:shadow-md transition-shadow min-w-0",v),children:[t.jsxs(F,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[d&&t.jsx("div",{className:"p-1.5 bg-muted rounded-md",children:d}),t.jsx(G,{className:"text-sm font-medium",children:e})]}),t.jsx(X,{className:"h-4 w-4 text-muted-foreground cursor-pointer hover:text-foreground"})]}),t.jsx(K,{className:"pt-4 flex-1 min-w-0",children:l?t.jsx("div",{className:"space-y-4",children:[...Array(5)].map((o,s)=>t.jsxs("div",{className:"flex flex-col gap-2",children:[t.jsx("div",{className:"h-4 w-1/3 bg-muted animate-pulse rounded"}),t.jsx("div",{className:"h-2 w-full bg-muted animate-pulse rounded"})]},s))}):i.length===0?t.jsx("div",{className:"flex h-full items-center justify-center text-sm text-muted-foreground p-4",children:"No data available"}):t.jsx(J,{className:"h-[240px]",children:t.jsx("div",{className:"space-y-6 pr-4",children:i.map((o,s)=>t.jsxs("div",{className:"flex flex-col gap-2 group min-w-0",children:[t.jsx("div",{className:"flex items-center justify-between text-sm gap-2",children:t.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[t.jsx("span",{className:"flex h-5 w-5 flex-shrink-0 items-center justify-center rounded-full bg-muted text-[10px] font-medium text-muted-foreground group-hover:bg-primary group-hover:text-primary-foreground transition-colors",children:s+1}),t.jsx("span",{className:"font-medium",title:o.name,children:a(o.name)})]})}),t.jsxs("div",{className:"space-y-1.5",children:[t.jsx(W,{value:u>0?o.value/u*100:0,className:T("h-1.5 w-full",h&&`[&>*]:${h}`)}),t.jsx("div",{className:"flex justify-end",children:t.jsx("span",{className:"text-xs font-semibold text-muted-foreground whitespace-nowrap",children:p(o.value)})})]})]},s))})})})]})};export{ne as M,le as R,oe as T,se as c,ie as u};
