import{c as ct,r as a,j as e,d as _,y as Mn,g as ve,m as Le,z as he,P as k,i as b,k as le,h as W,C as Sn,B as q,b as lt,L as Ae,I as $,D as pe,E as dt,F as ut,G as Ge,H as mt,J as Rn,K as In,M as _n,N as En,O as Pn,Q as Dn,U as Tn,V as pt,W as An,Y as On,Z as Fn,$ as kn,a0 as Ln}from"./index-7zRWrRLI.js";import{a as Gn,b as $e,D as $n}from"./DashboardLayout-BAcofvMr.js";import{T as Kn,a as Un,b as ne,c as G,d as Vn,e as T}from"./table-B6AKFdO-.js";import{B as Bn}from"./badge-z9qf13mP.js";import{u as Hn,a as zn,b as Yn,c as qn,P as Wn,d as Xn}from"./useRecords-BBTZFEJZ.js";import{e as Jn,D as tt,b as nt,c as ot,d as st}from"./dialog-BsxHIE6D.js";import{o as Zn,s as te,c as B,b as rt,u as Qn,t as eo,C as Me,P as to,T as no}from"./types-DcL7LhMe.js";import{L as E}from"./label-Cnt6xczR.js";import{S as Se,a as Re,b as Ie,c as _e,d as re}from"./select-CTjJ7iHC.js";import{C as oo,a as so,b as ro,f as ao,c as io,d as co,e as lo,S as uo}from"./command-2fzpvsiN.js";import{P as mo,a as po,b as fo,f as Ee}from"./popover-DEIU8kBq.js";import{C as ft,a as ho}from"./index-7GwBfPSO.js";import{E as xo}from"./ellipsis-Cd75cZ1g.js";import"./users-mcHH0GO8.js";import"./useQuery-D550T-cp.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=ct("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const go=ct("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),ht=({className:t,...n})=>e.jsx("nav",{role:"navigation","aria-label":"pagination",className:_("mx-auto flex w-full justify-center",t),...n});ht.displayName="Pagination";const xt=a.forwardRef(({className:t,...n},o)=>e.jsx("ul",{ref:o,className:_("flex flex-row items-center gap-1",t),...n}));xt.displayName="PaginationContent";const fe=a.forwardRef(({className:t,...n},o)=>e.jsx("li",{ref:o,className:_("",t),...n}));fe.displayName="PaginationItem";const Ke=({className:t,isActive:n,size:o="icon",...s})=>e.jsx("a",{"aria-current":n?"page":void 0,className:_(Mn({variant:n?"outline":"ghost",size:o}),t),...s});Ke.displayName="PaginationLink";const gt=({className:t,...n})=>e.jsxs(Ke,{"aria-label":"Go to previous page",size:"default",className:_("gap-1 pl-2.5",t),...n,children:[e.jsx(Gn,{className:"h-4 w-4"}),e.jsx("span",{children:"Previous"})]});gt.displayName="PaginationPrevious";const vt=({className:t,...n})=>e.jsxs(Ke,{"aria-label":"Go to next page",size:"default",className:_("gap-1 pr-2.5",t),...n,children:[e.jsx("span",{children:"Next"}),e.jsx($e,{className:"h-4 w-4"})]});vt.displayName="PaginationNext";var je="Collapsible",[vo,xr]=ve(je),[jo,Ue]=vo(je),jt=a.forwardRef((t,n)=>{const{__scopeCollapsible:o,open:s,defaultOpen:i,disabled:r,onOpenChange:u,...f}=t,[x,m]=Le({prop:s,defaultProp:i??!1,onChange:u,caller:je});return e.jsx(jo,{scope:o,disabled:r,contentId:he(),open:x,onOpenToggle:a.useCallback(()=>m(l=>!l),[m]),children:e.jsx(k.div,{"data-state":Be(x),"data-disabled":r?"":void 0,...f,ref:n})})});jt.displayName=je;var bt="CollapsibleTrigger",wt=a.forwardRef((t,n)=>{const{__scopeCollapsible:o,...s}=t,i=Ue(bt,o);return e.jsx(k.button,{type:"button","aria-controls":i.contentId,"aria-expanded":i.open||!1,"data-state":Be(i.open),"data-disabled":i.disabled?"":void 0,disabled:i.disabled,...s,ref:n,onClick:b(t.onClick,i.onOpenToggle)})});wt.displayName=bt;var Ve="CollapsibleContent",bo=a.forwardRef((t,n)=>{const{forceMount:o,...s}=t,i=Ue(Ve,t.__scopeCollapsible);return e.jsx(le,{present:o||i.open,children:({present:r})=>e.jsx(wo,{...s,ref:n,present:r})})});bo.displayName=Ve;var wo=a.forwardRef((t,n)=>{const{__scopeCollapsible:o,present:s,children:i,...r}=t,u=Ue(Ve,o),[f,x]=a.useState(s),m=a.useRef(null),l=W(n,m),c=a.useRef(0),h=c.current,j=a.useRef(0),d=j.current,N=u.open||f,g=a.useRef(N),w=a.useRef(void 0);return a.useEffect(()=>{const y=requestAnimationFrame(()=>g.current=!1);return()=>cancelAnimationFrame(y)},[]),Sn(()=>{const y=m.current;if(y){w.current=w.current||{transitionDuration:y.style.transitionDuration,animationName:y.style.animationName},y.style.transitionDuration="0s",y.style.animationName="none";const M=y.getBoundingClientRect();c.current=M.height,j.current=M.width,g.current||(y.style.transitionDuration=w.current.transitionDuration,y.style.animationName=w.current.animationName),x(s)}},[u.open,s]),e.jsx(k.div,{"data-state":Be(u.open),"data-disabled":u.disabled?"":void 0,id:u.contentId,hidden:!N,...r,ref:l,style:{"--radix-collapsible-content-height":h?`${h}px`:void 0,"--radix-collapsible-content-width":d?`${d}px`:void 0,...t.style},children:N&&i})});function Be(t){return t?"open":"closed"}var Co=jt;const No=Co,yo=wt;function De({options:t,value:n,onChange:o,placeholder:s="Select...",searchPlaceholder:i="Search...",emptyMessage:r="No results found.",className:u,disabled:f=!1}){var l;const[x,m]=a.useState(!1);return e.jsxs(mo,{open:x,onOpenChange:m,children:[e.jsx(po,{asChild:!0,children:e.jsxs(q,{variant:"outline",role:"combobox","aria-expanded":x,className:_("w-full justify-between",u),disabled:f,children:[n?(l=t.find(c=>c.value===n))==null?void 0:l.label:s,e.jsx(oo,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(fo,{className:"w-[--radix-popover-trigger-width] p-0",align:"start",children:e.jsxs(so,{children:[e.jsx(ro,{placeholder:i}),e.jsxs(ao,{children:[e.jsx(io,{children:r}),e.jsx(co,{children:t.map(c=>e.jsxs(lo,{value:c.label,onSelect:h=>{o(c.value===n?"":c.value),m(!1)},children:[e.jsx(ft,{className:_("mr-2 h-4 w-4",n===c.value?"opacity-100":"opacity-0")}),c.label]},c.value))})]})]})})]})}const Mo=Zn({date:te().min(1,"Date is required"),employeeId:B.number().min(1,"Employee is required"),clientId:B.number().min(1,"Client is required"),jobId:B.number().min(1,"Job is required"),shiftId:B.number().min(1,"Shift is required"),startTime:te().min(1,"Start time is required"),endTime:te().min(1,"End time is required"),hours:B.number().min(.1,"Hours must be greater than 0"),hourRate:B.number().optional(),clientHourlyRate:B.number().optional(),job_name:te().optional(),role:te().optional(),jobStatus:te().optional(),additions:B.number().optional(),deductions:B.number().optional(),self_employed:rt().optional(),dns:rt().optional()}),at=({record:t,onSuccess:n,onCancel:o})=>{const{role:s}=lt(),i=s==="admin",{data:r,isLoading:u}=Hn(),f=zn(),x=Yn(),[m,l]=a.useState(""),[c,h]=a.useState(""),j=!!t,d=Qn({resolver:eo(Mo),defaultValues:{date:(t==null?void 0:t.date)||new Date().toISOString().split("T")[0],employeeId:void 0,clientId:void 0,jobId:void 0,shiftId:void 0,startTime:t!=null&&t.shiftStart?t.shiftStart.substring(0,5):"09:00",endTime:t!=null&&t.shiftEnd?t.shiftEnd.substring(0,5):"17:00",hours:(t==null?void 0:t.paidHours)||8,hourRate:(t==null?void 0:t.hourRate)||0,clientHourlyRate:(t==null?void 0:t.clientHourlyRate)||0,job_name:(t==null?void 0:t.jobName)||"",role:"Travel Retail Specialist",jobStatus:(t==null?void 0:t.jobStatus)||"Currently Working - Full Airside Pass",additions:0,deductions:0,self_employed:!1,dns:!1}}),N=d.watch("startTime"),g=d.watch("endTime"),w=d.watch("shiftId"),y=a.useMemo(()=>r!=null&&r.jobs?Array.from(new Set(r.jobs.map(p=>p.location).filter(Boolean))):[],[r]),M=a.useMemo(()=>!(r!=null&&r.jobs)||!m?[]:Array.from(new Set(r.jobs.filter(p=>p.location===m).map(p=>p.site).filter(Boolean))),[r,m]);a.useEffect(()=>{if(t&&r){const p=r.employees.find(S=>S.name===t.fullName);p&&d.setValue("employeeId",p.id);const C=r.clients.find(S=>S.name===t.clientName);C&&d.setValue("clientId",C.id);const R=r.shifts.find(S=>S.name===t.shiftName);R&&d.setValue("shiftId",R.id);let D=r.jobs.find(S=>S.name===t.jobName&&S.site===t.site);D||(D=r.jobs.find(S=>S.site===t.site&&S.location===t.location)),D&&(d.setValue("jobId",D.id),l(D.location),h(D.site))}},[t,r,d]),a.useEffect(()=>{if(N&&g){const[p,C]=N.split(":").map(Number),[R,D]=g.split(":").map(Number);let S=p*60+C,z=R*60+D;z<S&&(z+=24*60);const oe=(z-S)/60;d.setValue("hours",parseFloat(oe.toFixed(2)))}},[N,g,d]),a.useEffect(()=>{var p;if(!j&&w&&(r!=null&&r.shifts)){const C=(p=r.shifts.find(R=>R.id===w))==null?void 0:p.name;C&&d.setValue("job_name",C)}},[w,j,r,d]),a.useEffect(()=>{if(m&&c&&(r!=null&&r.jobs)){const p=r.jobs.find(C=>C.location===m&&C.site===c);p&&d.setValue("jobId",p.id)}},[m,c,r,d]);const A=p=>{j&&t?x.mutate({id:t.id,...p},{onSuccess:()=>{pe.success("Record updated successfully"),n()},onError:C=>{pe.error(`Failed to update record: ${C.message}`)}}):f.mutate(p,{onSuccess:()=>{pe.success("Record created successfully"),n()},onError:C=>{pe.error(`Failed to create record: ${C.message}`)}})},H=f.isPending||x.isPending;if(u)return e.jsx("div",{className:"flex justify-center p-4",children:e.jsx(Ae,{className:"animate-spin"})});const Z=(r==null?void 0:r.employees.map(p=>({value:p.id.toString(),label:p.name})))||[],K=(r==null?void 0:r.clients.map(p=>({value:p.id.toString(),label:p.name})))||[],I=(r==null?void 0:r.shifts.map(p=>({value:p.id.toString(),label:`${p.name} (${p.start.substring(0,5)}-${p.end.substring(0,5)})`})))||[];return e.jsxs("form",{onSubmit:d.handleSubmit(A),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"date",children:"Date"}),e.jsx($,{id:"date",type:"date",...d.register("date")}),d.formState.errors.date&&e.jsx("span",{className:"text-red-500 text-xs",children:d.formState.errors.date.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"startTime",children:"Start Time"}),e.jsx($,{id:"startTime",type:"time",...d.register("startTime")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"endTime",children:"End Time"}),e.jsx($,{id:"endTime",type:"time",...d.register("endTime")})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(E,{children:["Calculated Hours: ",d.watch("hours")]}),e.jsx($,{type:"hidden",...d.register("hours")})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:"Employee"}),e.jsx(Me,{control:d.control,name:"employeeId",render:({field:p})=>{var C;return e.jsx(De,{options:Z,value:(C=p.value)==null?void 0:C.toString(),onChange:R=>p.onChange(Number(R)),placeholder:"Select Employee...",searchPlaceholder:"Search employees..."})}}),d.formState.errors.employeeId&&e.jsx("span",{className:"text-red-500 text-xs",children:d.formState.errors.employeeId.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:"Client"}),e.jsx(Me,{control:d.control,name:"clientId",render:({field:p})=>{var C;return e.jsx(De,{options:K,value:(C=p.value)==null?void 0:C.toString(),onChange:R=>p.onChange(Number(R)),placeholder:"Select Client...",searchPlaceholder:"Search clients..."})}}),d.formState.errors.clientId&&e.jsx("span",{className:"text-red-500 text-xs",children:d.formState.errors.clientId.message})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:"Location"}),e.jsxs(Se,{value:m,onValueChange:p=>{l(p),h("")},children:[e.jsx(Re,{children:e.jsx(Ie,{placeholder:"Select Location"})}),e.jsx(_e,{children:y.map(p=>e.jsx(re,{value:p,children:p},p))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:"Site / Terminal"}),e.jsxs(Se,{value:c,onValueChange:h,disabled:!m,children:[e.jsx(Re,{children:e.jsx(Ie,{placeholder:"Select Site"})}),e.jsx(_e,{children:M.map(p=>e.jsx(re,{value:p,children:p},p))})]}),e.jsx("input",{type:"hidden",...d.register("jobId")}),d.formState.errors.jobId&&e.jsx("span",{className:"text-red-500 text-xs",children:"Job Selection Incomplete"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:"Shift"}),e.jsx(Me,{control:d.control,name:"shiftId",render:({field:p})=>{var C;return e.jsx(De,{options:I,value:(C=p.value)==null?void 0:C.toString(),onChange:R=>p.onChange(Number(R)),placeholder:"Select Shift config...",searchPlaceholder:"Search shifts..."})}}),d.formState.errors.shiftId&&e.jsx("span",{className:"text-red-500 text-xs",children:d.formState.errors.shiftId.message})]}),(i||j)&&e.jsxs("div",{className:"border-t pt-4 grid grid-cols-2 gap-4 bg-muted/20 p-4 rounded-md",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:"Role"}),e.jsx($,{...d.register("role")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:"Status"}),e.jsxs(Se,{onValueChange:p=>d.setValue("jobStatus",p),defaultValue:d.getValues("jobStatus"),children:[e.jsx(Re,{children:e.jsx(Ie,{placeholder:"Status"})}),e.jsxs(_e,{children:[e.jsx(re,{value:"Currently Working - Full Airside Pass",children:"Currently Working - Full Airside Pass"}),e.jsx(re,{value:"Completed",children:"Completed"}),e.jsx(re,{value:"Cancelled",children:"Cancelled"})]})]})]}),i&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"hourRate",children:"Pay Rate (£)"}),e.jsx($,{id:"hourRate",type:"number",step:"0.01",...d.register("hourRate")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"clientHourlyRate",children:"Client Rate (£)"}),e.jsx($,{id:"clientHourlyRate",type:"number",step:"0.01",...d.register("clientHourlyRate")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"additions",children:"Additions (£)"}),e.jsx($,{id:"additions",type:"number",step:"0.01",...d.register("additions")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"deductions",children:"Deductions (£)"}),e.jsx($,{id:"deductions",type:"number",step:"0.01",...d.register("deductions")})]})]})]}),e.jsxs(Jn,{className:"mt-6 flex justify-between items-center w-full",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:!j&&"Defaults: Role=Travel Retail, Additions=0, Deductions=0"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(q,{type:"button",variant:"outline",onClick:o,children:"Cancel"}),e.jsxs(q,{type:"submit",disabled:H,children:[H&&e.jsx(Ae,{className:"mr-2 h-4 w-4 animate-spin"}),j?"Update Record":"Create Record"]})]})]})]})};var Te="rovingFocusGroup.onEntryFocus",So={bubbles:!1,cancelable:!0},de="RovingFocusGroup",[Oe,Ct,Ro]=dt(de),[Io,Nt]=ve(de,[Ro]),[_o,Eo]=Io(de),yt=a.forwardRef((t,n)=>e.jsx(Oe.Provider,{scope:t.__scopeRovingFocusGroup,children:e.jsx(Oe.Slot,{scope:t.__scopeRovingFocusGroup,children:e.jsx(Po,{...t,ref:n})})}));yt.displayName=de;var Po=a.forwardRef((t,n)=>{const{__scopeRovingFocusGroup:o,orientation:s,loop:i=!1,dir:r,currentTabStopId:u,defaultCurrentTabStopId:f,onCurrentTabStopIdChange:x,onEntryFocus:m,preventScrollOnEntryFocus:l=!1,...c}=t,h=a.useRef(null),j=W(n,h),d=ut(r),[N,g]=Le({prop:u,defaultProp:f??null,onChange:x,caller:de}),[w,y]=a.useState(!1),M=Ge(m),A=Ct(o),H=a.useRef(!1),[Z,K]=a.useState(0);return a.useEffect(()=>{const I=h.current;if(I)return I.addEventListener(Te,M),()=>I.removeEventListener(Te,M)},[M]),e.jsx(_o,{scope:o,orientation:s,dir:d,loop:i,currentTabStopId:N,onItemFocus:a.useCallback(I=>g(I),[g]),onItemShiftTab:a.useCallback(()=>y(!0),[]),onFocusableItemAdd:a.useCallback(()=>K(I=>I+1),[]),onFocusableItemRemove:a.useCallback(()=>K(I=>I-1),[]),children:e.jsx(k.div,{tabIndex:w||Z===0?-1:0,"data-orientation":s,...c,ref:j,style:{outline:"none",...t.style},onMouseDown:b(t.onMouseDown,()=>{H.current=!0}),onFocus:b(t.onFocus,I=>{const p=!H.current;if(I.target===I.currentTarget&&p&&!w){const C=new CustomEvent(Te,So);if(I.currentTarget.dispatchEvent(C),!C.defaultPrevented){const R=A().filter(U=>U.focusable),D=R.find(U=>U.active),S=R.find(U=>U.id===N),oe=[D,S,...R].filter(Boolean).map(U=>U.ref.current);Rt(oe,l)}}H.current=!1}),onBlur:b(t.onBlur,()=>y(!1))})})}),Mt="RovingFocusGroupItem",St=a.forwardRef((t,n)=>{const{__scopeRovingFocusGroup:o,focusable:s=!0,active:i=!1,tabStopId:r,children:u,...f}=t,x=he(),m=r||x,l=Eo(Mt,o),c=l.currentTabStopId===m,h=Ct(o),{onFocusableItemAdd:j,onFocusableItemRemove:d,currentTabStopId:N}=l;return a.useEffect(()=>{if(s)return j(),()=>d()},[s,j,d]),e.jsx(Oe.ItemSlot,{scope:o,id:m,focusable:s,active:i,children:e.jsx(k.span,{tabIndex:c?0:-1,"data-orientation":l.orientation,...f,ref:n,onMouseDown:b(t.onMouseDown,g=>{s?l.onItemFocus(m):g.preventDefault()}),onFocus:b(t.onFocus,()=>l.onItemFocus(m)),onKeyDown:b(t.onKeyDown,g=>{if(g.key==="Tab"&&g.shiftKey){l.onItemShiftTab();return}if(g.target!==g.currentTarget)return;const w=Ao(g,l.orientation,l.dir);if(w!==void 0){if(g.metaKey||g.ctrlKey||g.altKey||g.shiftKey)return;g.preventDefault();let M=h().filter(A=>A.focusable).map(A=>A.ref.current);if(w==="last")M.reverse();else if(w==="prev"||w==="next"){w==="prev"&&M.reverse();const A=M.indexOf(g.currentTarget);M=l.loop?Oo(M,A+1):M.slice(A+1)}setTimeout(()=>Rt(M))}}),children:typeof u=="function"?u({isCurrentTabStop:c,hasTabStop:N!=null}):u})})});St.displayName=Mt;var Do={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function To(t,n){return n!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function Ao(t,n,o){const s=To(t.key,o);if(!(n==="vertical"&&["ArrowLeft","ArrowRight"].includes(s))&&!(n==="horizontal"&&["ArrowUp","ArrowDown"].includes(s)))return Do[s]}function Rt(t,n=!1){const o=document.activeElement;for(const s of t)if(s===o||(s.focus({preventScroll:n}),document.activeElement!==o))return}function Oo(t,n){return t.map((o,s)=>t[(n+s)%t.length])}var Fo=yt,ko=St,Fe=["Enter"," "],Lo=["ArrowDown","PageUp","Home"],It=["ArrowUp","PageDown","End"],Go=[...Lo,...It],$o={ltr:[...Fe,"ArrowRight"],rtl:[...Fe,"ArrowLeft"]},Ko={ltr:["ArrowLeft"],rtl:["ArrowRight"]},ue="Menu",[ie,Uo,Vo]=dt(ue),[X,_t]=ve(ue,[Vo,mt,Nt]),be=mt(),Et=Nt(),[Bo,J]=X(ue),[Ho,me]=X(ue),Pt=t=>{const{__scopeMenu:n,open:o=!1,children:s,dir:i,onOpenChange:r,modal:u=!0}=t,f=be(n),[x,m]=a.useState(null),l=a.useRef(!1),c=Ge(r),h=ut(i);return a.useEffect(()=>{const j=()=>{l.current=!0,document.addEventListener("pointerdown",d,{capture:!0,once:!0}),document.addEventListener("pointermove",d,{capture:!0,once:!0})},d=()=>l.current=!1;return document.addEventListener("keydown",j,{capture:!0}),()=>{document.removeEventListener("keydown",j,{capture:!0}),document.removeEventListener("pointerdown",d,{capture:!0}),document.removeEventListener("pointermove",d,{capture:!0})}},[]),e.jsx(Fn,{...f,children:e.jsx(Bo,{scope:n,open:o,onOpenChange:c,content:x,onContentChange:m,children:e.jsx(Ho,{scope:n,onClose:a.useCallback(()=>c(!1),[c]),isUsingKeyboardRef:l,dir:h,modal:u,children:s})})})};Pt.displayName=ue;var zo="MenuAnchor",He=a.forwardRef((t,n)=>{const{__scopeMenu:o,...s}=t,i=be(o);return e.jsx(Rn,{...i,...s,ref:n})});He.displayName=zo;var ze="MenuPortal",[Yo,Dt]=X(ze,{forceMount:void 0}),Tt=t=>{const{__scopeMenu:n,forceMount:o,children:s,container:i}=t,r=J(ze,n);return e.jsx(Yo,{scope:n,forceMount:o,children:e.jsx(le,{present:o||r.open,children:e.jsx(kn,{asChild:!0,container:i,children:s})})})};Tt.displayName=ze;var F="MenuContent",[qo,Ye]=X(F),At=a.forwardRef((t,n)=>{const o=Dt(F,t.__scopeMenu),{forceMount:s=o.forceMount,...i}=t,r=J(F,t.__scopeMenu),u=me(F,t.__scopeMenu);return e.jsx(ie.Provider,{scope:t.__scopeMenu,children:e.jsx(le,{present:s||r.open,children:e.jsx(ie.Slot,{scope:t.__scopeMenu,children:u.modal?e.jsx(Wo,{...i,ref:n}):e.jsx(Xo,{...i,ref:n})})})})}),Wo=a.forwardRef((t,n)=>{const o=J(F,t.__scopeMenu),s=a.useRef(null),i=W(n,s);return a.useEffect(()=>{const r=s.current;if(r)return In(r)},[]),e.jsx(qe,{...t,ref:i,trapFocus:o.open,disableOutsidePointerEvents:o.open,disableOutsideScroll:!0,onFocusOutside:b(t.onFocusOutside,r=>r.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>o.onOpenChange(!1)})}),Xo=a.forwardRef((t,n)=>{const o=J(F,t.__scopeMenu);return e.jsx(qe,{...t,ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>o.onOpenChange(!1)})}),Jo=Ln("MenuContent.ScrollLock"),qe=a.forwardRef((t,n)=>{const{__scopeMenu:o,loop:s=!1,trapFocus:i,onOpenAutoFocus:r,onCloseAutoFocus:u,disableOutsidePointerEvents:f,onEntryFocus:x,onEscapeKeyDown:m,onPointerDownOutside:l,onFocusOutside:c,onInteractOutside:h,onDismiss:j,disableOutsideScroll:d,...N}=t,g=J(F,o),w=me(F,o),y=be(o),M=Et(o),A=Uo(o),[H,Z]=a.useState(null),K=a.useRef(null),I=W(n,K,g.onContentChange),p=a.useRef(0),C=a.useRef(""),R=a.useRef(0),D=a.useRef(null),S=a.useRef("right"),z=a.useRef(0),oe=d?An:a.Fragment,U=d?{as:Jo,allowPinchZoom:!0}:void 0,yn=v=>{var ee,Qe;const O=C.current+v,L=A().filter(V=>!V.disabled),Y=document.activeElement,Ne=(ee=L.find(V=>V.ref.current===Y))==null?void 0:ee.textValue,ye=L.map(V=>V.textValue),Ze=ls(ye,O,Ne),se=(Qe=L.find(V=>V.textValue===Ze))==null?void 0:Qe.ref.current;(function V(et){C.current=et,window.clearTimeout(p.current),et!==""&&(p.current=window.setTimeout(()=>V(""),1e3))})(O),se&&setTimeout(()=>se.focus())};a.useEffect(()=>()=>window.clearTimeout(p.current),[]),_n();const Q=a.useCallback(v=>{var L,Y;return S.current===((L=D.current)==null?void 0:L.side)&&us(v,(Y=D.current)==null?void 0:Y.area)},[]);return e.jsx(qo,{scope:o,searchRef:C,onItemEnter:a.useCallback(v=>{Q(v)&&v.preventDefault()},[Q]),onItemLeave:a.useCallback(v=>{var O;Q(v)||((O=K.current)==null||O.focus(),Z(null))},[Q]),onTriggerLeave:a.useCallback(v=>{Q(v)&&v.preventDefault()},[Q]),pointerGraceTimerRef:R,onPointerGraceIntentChange:a.useCallback(v=>{D.current=v},[]),children:e.jsx(oe,{...U,children:e.jsx(En,{asChild:!0,trapped:i,onMountAutoFocus:b(r,v=>{var O;v.preventDefault(),(O=K.current)==null||O.focus({preventScroll:!0})}),onUnmountAutoFocus:u,children:e.jsx(Pn,{asChild:!0,disableOutsidePointerEvents:f,onEscapeKeyDown:m,onPointerDownOutside:l,onFocusOutside:c,onInteractOutside:h,onDismiss:j,children:e.jsx(Fo,{asChild:!0,...M,dir:w.dir,orientation:"vertical",loop:s,currentTabStopId:H,onCurrentTabStopIdChange:Z,onEntryFocus:b(x,v=>{w.isUsingKeyboardRef.current||v.preventDefault()}),preventScrollOnEntryFocus:!0,children:e.jsx(Dn,{role:"menu","aria-orientation":"vertical","data-state":Xt(g.open),"data-radix-menu-content":"",dir:w.dir,...y,...N,ref:I,style:{outline:"none",...N.style},onKeyDown:b(N.onKeyDown,v=>{const L=v.target.closest("[data-radix-menu-content]")===v.currentTarget,Y=v.ctrlKey||v.altKey||v.metaKey,Ne=v.key.length===1;L&&(v.key==="Tab"&&v.preventDefault(),!Y&&Ne&&yn(v.key));const ye=K.current;if(v.target!==ye||!Go.includes(v.key))return;v.preventDefault();const se=A().filter(ee=>!ee.disabled).map(ee=>ee.ref.current);It.includes(v.key)&&se.reverse(),is(se)}),onBlur:b(t.onBlur,v=>{v.currentTarget.contains(v.target)||(window.clearTimeout(p.current),C.current="")}),onPointerMove:b(t.onPointerMove,ce(v=>{const O=v.target,L=z.current!==v.clientX;if(v.currentTarget.contains(O)&&L){const Y=v.clientX>z.current?"right":"left";S.current=Y,z.current=v.clientX}}))})})})})})})});At.displayName=F;var Zo="MenuGroup",We=a.forwardRef((t,n)=>{const{__scopeMenu:o,...s}=t;return e.jsx(k.div,{role:"group",...s,ref:n})});We.displayName=Zo;var Qo="MenuLabel",Ot=a.forwardRef((t,n)=>{const{__scopeMenu:o,...s}=t;return e.jsx(k.div,{...s,ref:n})});Ot.displayName=Qo;var xe="MenuItem",it="menu.itemSelect",we=a.forwardRef((t,n)=>{const{disabled:o=!1,onSelect:s,...i}=t,r=a.useRef(null),u=me(xe,t.__scopeMenu),f=Ye(xe,t.__scopeMenu),x=W(n,r),m=a.useRef(!1),l=()=>{const c=r.current;if(!o&&c){const h=new CustomEvent(it,{bubbles:!0,cancelable:!0});c.addEventListener(it,j=>s==null?void 0:s(j),{once:!0}),On(c,h),h.defaultPrevented?m.current=!1:u.onClose()}};return e.jsx(Ft,{...i,ref:x,disabled:o,onClick:b(t.onClick,l),onPointerDown:c=>{var h;(h=t.onPointerDown)==null||h.call(t,c),m.current=!0},onPointerUp:b(t.onPointerUp,c=>{var h;m.current||(h=c.currentTarget)==null||h.click()}),onKeyDown:b(t.onKeyDown,c=>{const h=f.searchRef.current!=="";o||h&&c.key===" "||Fe.includes(c.key)&&(c.currentTarget.click(),c.preventDefault())})})});we.displayName=xe;var Ft=a.forwardRef((t,n)=>{const{__scopeMenu:o,disabled:s=!1,textValue:i,...r}=t,u=Ye(xe,o),f=Et(o),x=a.useRef(null),m=W(n,x),[l,c]=a.useState(!1),[h,j]=a.useState("");return a.useEffect(()=>{const d=x.current;d&&j((d.textContent??"").trim())},[r.children]),e.jsx(ie.ItemSlot,{scope:o,disabled:s,textValue:i??h,children:e.jsx(ko,{asChild:!0,...f,focusable:!s,children:e.jsx(k.div,{role:"menuitem","data-highlighted":l?"":void 0,"aria-disabled":s||void 0,"data-disabled":s?"":void 0,...r,ref:m,onPointerMove:b(t.onPointerMove,ce(d=>{s?u.onItemLeave(d):(u.onItemEnter(d),d.defaultPrevented||d.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:b(t.onPointerLeave,ce(d=>u.onItemLeave(d))),onFocus:b(t.onFocus,()=>c(!0)),onBlur:b(t.onBlur,()=>c(!1))})})})}),es="MenuCheckboxItem",kt=a.forwardRef((t,n)=>{const{checked:o=!1,onCheckedChange:s,...i}=t;return e.jsx(Ut,{scope:t.__scopeMenu,checked:o,children:e.jsx(we,{role:"menuitemcheckbox","aria-checked":ge(o)?"mixed":o,...i,ref:n,"data-state":Je(o),onSelect:b(i.onSelect,()=>s==null?void 0:s(ge(o)?!0:!o),{checkForDefaultPrevented:!1})})})});kt.displayName=es;var Lt="MenuRadioGroup",[ts,ns]=X(Lt,{value:void 0,onValueChange:()=>{}}),Gt=a.forwardRef((t,n)=>{const{value:o,onValueChange:s,...i}=t,r=Ge(s);return e.jsx(ts,{scope:t.__scopeMenu,value:o,onValueChange:r,children:e.jsx(We,{...i,ref:n})})});Gt.displayName=Lt;var $t="MenuRadioItem",Kt=a.forwardRef((t,n)=>{const{value:o,...s}=t,i=ns($t,t.__scopeMenu),r=o===i.value;return e.jsx(Ut,{scope:t.__scopeMenu,checked:r,children:e.jsx(we,{role:"menuitemradio","aria-checked":r,...s,ref:n,"data-state":Je(r),onSelect:b(s.onSelect,()=>{var u;return(u=i.onValueChange)==null?void 0:u.call(i,o)},{checkForDefaultPrevented:!1})})})});Kt.displayName=$t;var Xe="MenuItemIndicator",[Ut,os]=X(Xe,{checked:!1}),Vt=a.forwardRef((t,n)=>{const{__scopeMenu:o,forceMount:s,...i}=t,r=os(Xe,o);return e.jsx(le,{present:s||ge(r.checked)||r.checked===!0,children:e.jsx(k.span,{...i,ref:n,"data-state":Je(r.checked)})})});Vt.displayName=Xe;var ss="MenuSeparator",Bt=a.forwardRef((t,n)=>{const{__scopeMenu:o,...s}=t;return e.jsx(k.div,{role:"separator","aria-orientation":"horizontal",...s,ref:n})});Bt.displayName=ss;var rs="MenuArrow",Ht=a.forwardRef((t,n)=>{const{__scopeMenu:o,...s}=t,i=be(o);return e.jsx(Tn,{...i,...s,ref:n})});Ht.displayName=rs;var as="MenuSub",[gr,zt]=X(as),ae="MenuSubTrigger",Yt=a.forwardRef((t,n)=>{const o=J(ae,t.__scopeMenu),s=me(ae,t.__scopeMenu),i=zt(ae,t.__scopeMenu),r=Ye(ae,t.__scopeMenu),u=a.useRef(null),{pointerGraceTimerRef:f,onPointerGraceIntentChange:x}=r,m={__scopeMenu:t.__scopeMenu},l=a.useCallback(()=>{u.current&&window.clearTimeout(u.current),u.current=null},[]);return a.useEffect(()=>l,[l]),a.useEffect(()=>{const c=f.current;return()=>{window.clearTimeout(c),x(null)}},[f,x]),e.jsx(He,{asChild:!0,...m,children:e.jsx(Ft,{id:i.triggerId,"aria-haspopup":"menu","aria-expanded":o.open,"aria-controls":i.contentId,"data-state":Xt(o.open),...t,ref:pt(n,i.onTriggerChange),onClick:c=>{var h;(h=t.onClick)==null||h.call(t,c),!(t.disabled||c.defaultPrevented)&&(c.currentTarget.focus(),o.open||o.onOpenChange(!0))},onPointerMove:b(t.onPointerMove,ce(c=>{r.onItemEnter(c),!c.defaultPrevented&&!t.disabled&&!o.open&&!u.current&&(r.onPointerGraceIntentChange(null),u.current=window.setTimeout(()=>{o.onOpenChange(!0),l()},100))})),onPointerLeave:b(t.onPointerLeave,ce(c=>{var j,d;l();const h=(j=o.content)==null?void 0:j.getBoundingClientRect();if(h){const N=(d=o.content)==null?void 0:d.dataset.side,g=N==="right",w=g?-5:5,y=h[g?"left":"right"],M=h[g?"right":"left"];r.onPointerGraceIntentChange({area:[{x:c.clientX+w,y:c.clientY},{x:y,y:h.top},{x:M,y:h.top},{x:M,y:h.bottom},{x:y,y:h.bottom}],side:N}),window.clearTimeout(f.current),f.current=window.setTimeout(()=>r.onPointerGraceIntentChange(null),300)}else{if(r.onTriggerLeave(c),c.defaultPrevented)return;r.onPointerGraceIntentChange(null)}})),onKeyDown:b(t.onKeyDown,c=>{var j;const h=r.searchRef.current!=="";t.disabled||h&&c.key===" "||$o[s.dir].includes(c.key)&&(o.onOpenChange(!0),(j=o.content)==null||j.focus(),c.preventDefault())})})})});Yt.displayName=ae;var qt="MenuSubContent",Wt=a.forwardRef((t,n)=>{const o=Dt(F,t.__scopeMenu),{forceMount:s=o.forceMount,...i}=t,r=J(F,t.__scopeMenu),u=me(F,t.__scopeMenu),f=zt(qt,t.__scopeMenu),x=a.useRef(null),m=W(n,x);return e.jsx(ie.Provider,{scope:t.__scopeMenu,children:e.jsx(le,{present:s||r.open,children:e.jsx(ie.Slot,{scope:t.__scopeMenu,children:e.jsx(qe,{id:f.contentId,"aria-labelledby":f.triggerId,...i,ref:m,align:"start",side:u.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:l=>{var c;u.isUsingKeyboardRef.current&&((c=x.current)==null||c.focus()),l.preventDefault()},onCloseAutoFocus:l=>l.preventDefault(),onFocusOutside:b(t.onFocusOutside,l=>{l.target!==f.trigger&&r.onOpenChange(!1)}),onEscapeKeyDown:b(t.onEscapeKeyDown,l=>{u.onClose(),l.preventDefault()}),onKeyDown:b(t.onKeyDown,l=>{var j;const c=l.currentTarget.contains(l.target),h=Ko[u.dir].includes(l.key);c&&h&&(r.onOpenChange(!1),(j=f.trigger)==null||j.focus(),l.preventDefault())})})})})})});Wt.displayName=qt;function Xt(t){return t?"open":"closed"}function ge(t){return t==="indeterminate"}function Je(t){return ge(t)?"indeterminate":t?"checked":"unchecked"}function is(t){const n=document.activeElement;for(const o of t)if(o===n||(o.focus(),document.activeElement!==n))return}function cs(t,n){return t.map((o,s)=>t[(n+s)%t.length])}function ls(t,n,o){const i=n.length>1&&Array.from(n).every(m=>m===n[0])?n[0]:n,r=o?t.indexOf(o):-1;let u=cs(t,Math.max(r,0));i.length===1&&(u=u.filter(m=>m!==o));const x=u.find(m=>m.toLowerCase().startsWith(i.toLowerCase()));return x!==o?x:void 0}function ds(t,n){const{x:o,y:s}=t;let i=!1;for(let r=0,u=n.length-1;r<n.length;u=r++){const f=n[r],x=n[u],m=f.x,l=f.y,c=x.x,h=x.y;l>s!=h>s&&o<(c-m)*(s-l)/(h-l)+m&&(i=!i)}return i}function us(t,n){if(!n)return!1;const o={x:t.clientX,y:t.clientY};return ds(o,n)}function ce(t){return n=>n.pointerType==="mouse"?t(n):void 0}var ms=Pt,ps=He,fs=Tt,hs=At,xs=We,gs=Ot,vs=we,js=kt,bs=Gt,ws=Kt,Cs=Vt,Ns=Bt,ys=Ht,Ms=Yt,Ss=Wt,Ce="DropdownMenu",[Rs,vr]=ve(Ce,[_t]),P=_t(),[Is,Jt]=Rs(Ce),Zt=t=>{const{__scopeDropdownMenu:n,children:o,dir:s,open:i,defaultOpen:r,onOpenChange:u,modal:f=!0}=t,x=P(n),m=a.useRef(null),[l,c]=Le({prop:i,defaultProp:r??!1,onChange:u,caller:Ce});return e.jsx(Is,{scope:n,triggerId:he(),triggerRef:m,contentId:he(),open:l,onOpenChange:c,onOpenToggle:a.useCallback(()=>c(h=>!h),[c]),modal:f,children:e.jsx(ms,{...x,open:l,onOpenChange:c,dir:s,modal:f,children:o})})};Zt.displayName=Ce;var Qt="DropdownMenuTrigger",en=a.forwardRef((t,n)=>{const{__scopeDropdownMenu:o,disabled:s=!1,...i}=t,r=Jt(Qt,o),u=P(o);return e.jsx(ps,{asChild:!0,...u,children:e.jsx(k.button,{type:"button",id:r.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":r.open?r.contentId:void 0,"data-state":r.open?"open":"closed","data-disabled":s?"":void 0,disabled:s,...i,ref:pt(n,r.triggerRef),onPointerDown:b(t.onPointerDown,f=>{!s&&f.button===0&&f.ctrlKey===!1&&(r.onOpenToggle(),r.open||f.preventDefault())}),onKeyDown:b(t.onKeyDown,f=>{s||(["Enter"," "].includes(f.key)&&r.onOpenToggle(),f.key==="ArrowDown"&&r.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(f.key)&&f.preventDefault())})})})});en.displayName=Qt;var _s="DropdownMenuPortal",tn=t=>{const{__scopeDropdownMenu:n,...o}=t,s=P(n);return e.jsx(fs,{...s,...o})};tn.displayName=_s;var nn="DropdownMenuContent",on=a.forwardRef((t,n)=>{const{__scopeDropdownMenu:o,...s}=t,i=Jt(nn,o),r=P(o),u=a.useRef(!1);return e.jsx(hs,{id:i.contentId,"aria-labelledby":i.triggerId,...r,...s,ref:n,onCloseAutoFocus:b(t.onCloseAutoFocus,f=>{var x;u.current||(x=i.triggerRef.current)==null||x.focus(),u.current=!1,f.preventDefault()}),onInteractOutside:b(t.onInteractOutside,f=>{const x=f.detail.originalEvent,m=x.button===0&&x.ctrlKey===!0,l=x.button===2||m;(!i.modal||l)&&(u.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});on.displayName=nn;var Es="DropdownMenuGroup",Ps=a.forwardRef((t,n)=>{const{__scopeDropdownMenu:o,...s}=t,i=P(o);return e.jsx(xs,{...i,...s,ref:n})});Ps.displayName=Es;var Ds="DropdownMenuLabel",sn=a.forwardRef((t,n)=>{const{__scopeDropdownMenu:o,...s}=t,i=P(o);return e.jsx(gs,{...i,...s,ref:n})});sn.displayName=Ds;var Ts="DropdownMenuItem",rn=a.forwardRef((t,n)=>{const{__scopeDropdownMenu:o,...s}=t,i=P(o);return e.jsx(vs,{...i,...s,ref:n})});rn.displayName=Ts;var As="DropdownMenuCheckboxItem",an=a.forwardRef((t,n)=>{const{__scopeDropdownMenu:o,...s}=t,i=P(o);return e.jsx(js,{...i,...s,ref:n})});an.displayName=As;var Os="DropdownMenuRadioGroup",Fs=a.forwardRef((t,n)=>{const{__scopeDropdownMenu:o,...s}=t,i=P(o);return e.jsx(bs,{...i,...s,ref:n})});Fs.displayName=Os;var ks="DropdownMenuRadioItem",cn=a.forwardRef((t,n)=>{const{__scopeDropdownMenu:o,...s}=t,i=P(o);return e.jsx(ws,{...i,...s,ref:n})});cn.displayName=ks;var Ls="DropdownMenuItemIndicator",ln=a.forwardRef((t,n)=>{const{__scopeDropdownMenu:o,...s}=t,i=P(o);return e.jsx(Cs,{...i,...s,ref:n})});ln.displayName=Ls;var Gs="DropdownMenuSeparator",dn=a.forwardRef((t,n)=>{const{__scopeDropdownMenu:o,...s}=t,i=P(o);return e.jsx(Ns,{...i,...s,ref:n})});dn.displayName=Gs;var $s="DropdownMenuArrow",Ks=a.forwardRef((t,n)=>{const{__scopeDropdownMenu:o,...s}=t,i=P(o);return e.jsx(ys,{...i,...s,ref:n})});Ks.displayName=$s;var Us="DropdownMenuSubTrigger",un=a.forwardRef((t,n)=>{const{__scopeDropdownMenu:o,...s}=t,i=P(o);return e.jsx(Ms,{...i,...s,ref:n})});un.displayName=Us;var Vs="DropdownMenuSubContent",mn=a.forwardRef((t,n)=>{const{__scopeDropdownMenu:o,...s}=t,i=P(o);return e.jsx(Ss,{...i,...s,ref:n,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});mn.displayName=Vs;var Bs=Zt,Hs=en,zs=tn,pn=on,fn=sn,hn=rn,xn=an,gn=cn,vn=ln,jn=dn,bn=un,wn=mn;const Ys=Bs,qs=Hs,Ws=a.forwardRef(({className:t,inset:n,children:o,...s},i)=>e.jsxs(bn,{ref:i,className:_("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[state=open]:bg-accent focus:bg-accent",n&&"pl-8",t),...s,children:[o,e.jsx($e,{className:"ml-auto h-4 w-4"})]}));Ws.displayName=bn.displayName;const Xs=a.forwardRef(({className:t,...n},o)=>e.jsx(wn,{ref:o,className:_("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n}));Xs.displayName=wn.displayName;const Cn=a.forwardRef(({className:t,sideOffset:n=4,...o},s)=>e.jsx(zs,{children:e.jsx(pn,{ref:s,sideOffset:n,className:_("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...o})}));Cn.displayName=pn.displayName;const ke=a.forwardRef(({className:t,inset:n,...o},s)=>e.jsx(hn,{ref:s,className:_("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",n&&"pl-8",t),...o}));ke.displayName=hn.displayName;const Js=a.forwardRef(({className:t,children:n,checked:o,...s},i)=>e.jsxs(xn,{ref:i,className:_("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t),checked:o,...s,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(vn,{children:e.jsx(ft,{className:"h-4 w-4"})})}),n]}));Js.displayName=xn.displayName;const Zs=a.forwardRef(({className:t,children:n,...o},s)=>e.jsxs(gn,{ref:s,className:_("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t),...o,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(vn,{children:e.jsx(go,{className:"h-2 w-2 fill-current"})})}),n]}));Zs.displayName=gn.displayName;const Nn=a.forwardRef(({className:t,inset:n,...o},s)=>e.jsx(fn,{ref:s,className:_("px-2 py-1.5 text-sm font-semibold",n&&"pl-8",t),...o}));Nn.displayName=fn.displayName;const Qs=a.forwardRef(({className:t,...n},o)=>e.jsx(jn,{ref:o,className:_("-mx-1 my-1 h-px bg-muted",t),...n}));Qs.displayName=jn.displayName;const jr=()=>{const[t,n]=a.useState({page:1,limit:20,sort_by:"date",sort_order:"desc",search:""}),{role:o}=lt(),s=o==="admin",[i,r]=a.useState(""),[u,f]=a.useState(!1),[x,m]=a.useState(null),{data:l,isLoading:c,isError:h}=qn(t);a.useEffect(()=>{const g=setTimeout(()=>{n(w=>({...w,page:1,search:i}))},500);return()=>clearTimeout(g)},[i]);const j=g=>{g.preventDefault(),n(w=>({...w,page:1,search:i}))},d=g=>{n(w=>({...w,sort_by:g,sort_order:w.sort_by===g&&w.sort_order==="desc"?"asc":"desc"}))},N=(l==null?void 0:l.meta.pages)||1;return e.jsx($n,{fullWidth:!0,children:e.jsxs("div",{className:"flex flex-col h-full space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Shift Records"})}),e.jsx(tt,{open:u,onOpenChange:f,children:e.jsxs(nt,{className:"max-w-2xl",children:[e.jsx(ot,{children:e.jsx(st,{children:"Add New Shift Record"})}),e.jsx(at,{onSuccess:()=>f(!1),onCancel:()=>f(!1)})]})}),e.jsx(tt,{open:!!x,onOpenChange:g=>!g&&m(null),children:e.jsxs(nt,{className:"max-w-2xl",children:[e.jsx(ot,{children:e.jsx(st,{children:"Edit Shift Record"})}),x&&e.jsx(at,{record:x,onSuccess:()=>m(null),onCancel:()=>m(null)})]})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("form",{onSubmit:j,className:"flex-1 max-w-sm flex gap-2",children:[e.jsx($,{placeholder:"Search by name, client, or job...",value:i,onChange:g=>r(g.target.value)}),e.jsx(q,{type:"submit",variant:"secondary",children:e.jsx(uo,{className:"h-4 w-4"})})]}),(s||o==="manager")&&e.jsxs(q,{onClick:()=>f(!0),children:[e.jsx(Wn,{className:"mr-2 h-4 w-4"})," Add Record"]}),e.jsxs("div",{className:"ml-auto text-sm text-muted-foreground",children:[(l==null?void 0:l.meta.total)||0," records found"]})]}),e.jsx("div",{className:"border rounded-md bg-white overflow-x-auto",children:e.jsxs(Kn,{children:[e.jsx(Un,{children:e.jsxs(ne,{children:[e.jsx(G,{className:"w-[30px]"}),e.jsxs(G,{className:"cursor-pointer",onClick:()=>d("date"),children:["Date ",e.jsx(Pe,{className:"ml-2 h-4 w-4 inline"})]}),e.jsxs(G,{className:"cursor-pointer",onClick:()=>d("full_name"),children:["Employee ",e.jsx(Pe,{className:"ml-2 h-4 w-4 inline"})]}),e.jsxs(G,{className:"cursor-pointer",onClick:()=>d("client_name"),children:["Client ",e.jsx(Pe,{className:"ml-2 h-4 w-4 inline"})]}),e.jsx(G,{className:"hidden md:table-cell cursor-pointer",onClick:()=>d("location"),children:"Location"}),e.jsx(G,{children:"Shift"}),e.jsx(G,{className:"text-right",children:"Hours"}),s&&e.jsx(G,{className:"text-right",children:"Staff Pay"}),s&&e.jsx(G,{className:"text-right",children:"Client Pay"}),e.jsx(G,{className:"w-[50px]"})]})}),e.jsx(Vn,{children:c?e.jsx(ne,{children:e.jsx(T,{colSpan:s?10:8,className:"h-24 text-center",children:e.jsx(Ae,{className:"h-6 w-6 animate-spin mx-auto"})})}):h?e.jsx(ne,{children:e.jsx(T,{colSpan:s?10:8,className:"h-24 text-center text-red-500",children:"Failed to load records"})}):(l==null?void 0:l.data.length)===0?e.jsx(ne,{children:e.jsx(T,{colSpan:s?10:8,className:"h-24 text-center",children:"No records found"})}):l==null?void 0:l.data.map(g=>e.jsx(er,{record:g,isAdmin:s,role:o,onEdit:()=>m(g)},g.id))})]})}),N>1&&e.jsx(ht,{children:e.jsxs(xt,{children:[e.jsx(fe,{children:e.jsx(gt,{onClick:()=>n(g=>({...g,page:Math.max(1,g.page-1)})),className:t.page===1?"pointer-events-none opacity-50":"cursor-pointer"})}),e.jsx(fe,{children:e.jsxs("div",{className:"flex items-center justify-center px-4 text-sm font-medium",children:["Page ",t.page," of ",N]})}),e.jsx(fe,{children:e.jsx(vt,{onClick:()=>n(g=>({...g,page:Math.min(N,g.page+1)})),className:t.page===N?"pointer-events-none opacity-50":"cursor-pointer"})})]})})]})})},er=({record:t,isAdmin:n,role:o,onEdit:s})=>{var x,m,l,c,h;const[i,r]=a.useState(!1),u=Xn(),f=()=>{confirm("Are you sure you want to delete this record?")&&u.mutate(t.id)};return e.jsxs(e.Fragment,{children:[e.jsxs(ne,{className:"group",children:[e.jsx(T,{children:e.jsx(No,{open:i,onOpenChange:r,children:e.jsx(yo,{asChild:!0,children:e.jsxs(q,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",children:[i?e.jsx(ho,{className:"h-4 w-4"}):e.jsx($e,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Toggle"})]})})})}),e.jsx(T,{className:"font-medium",children:t.date?Ee(new Date(t.date),"dd MMM yyyy"):"-"}),e.jsx(T,{children:t.fullName}),e.jsx(T,{children:t.clientName}),e.jsx(T,{className:"hidden md:table-cell",children:t.location}),e.jsx(T,{children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm",children:t.shiftName}),e.jsx("span",{className:"text-xs text-muted-foreground",children:t.shiftStart&&t.shiftEnd?`${Ee(new Date(`1970-01-01T${t.shiftStart}`),"HH:mm")} - ${Ee(new Date(`1970-01-01T${t.shiftEnd}`),"HH:mm")}`:""})]})}),e.jsx(T,{className:"text-right",children:t.paidHours.toFixed(2)}),n&&e.jsxs(T,{className:"text-right",children:["£",((x=t.totalPay)==null?void 0:x.toFixed(2))||"0.00"]}),n&&e.jsxs(T,{className:"text-right font-medium",children:["£",((m=t.clientNet)==null?void 0:m.toFixed(2))||"0.00"]}),e.jsx(T,{children:(n||o==="manager")&&e.jsxs(Ys,{children:[e.jsx(qs,{asChild:!0,children:e.jsxs(q,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(xo,{className:"h-4 w-4"})]})}),e.jsxs(Cn,{align:"end",children:[e.jsx(Nn,{children:"Actions"}),e.jsxs(ke,{onClick:j=>{j.stopPropagation(),s()},children:[e.jsx(to,{className:"mr-2 h-4 w-4"})," Edit"]}),e.jsxs(ke,{onClick:j=>{j.stopPropagation(),f()},className:"text-red-600",children:[e.jsx(no,{className:"mr-2 h-4 w-4"})," Delete"]})]})]})})]}),e.jsx(ne,{className:i?"":"hidden",children:e.jsx(T,{colSpan:n?10:8,className:"p-0 border-b-0",children:e.jsxs("div",{className:`bg-muted/50 p-4 grid grid-cols-1 ${n?"md:grid-cols-3":"md:grid-cols-2"} gap-4 text-sm shadow-inner`,children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Job Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"Site:"}),e.jsx("span",{children:t.site}),e.jsx("span",{className:"text-muted-foreground",children:"Job Name:"}),e.jsx("span",{children:t.jobName}),e.jsx("span",{className:"text-muted-foreground",children:"Status:"}),e.jsx(Bn,{variant:"outline",className:"w-fit",children:t.jobStatus||"N/A"})]})]}),n&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Financial Breakdown"}),e.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"Pay Rate:"}),e.jsxs("span",{children:["£",((l=t.hourRate)==null?void 0:l.toFixed(2))||"0.00","/hr"]}),e.jsx("span",{className:"text-muted-foreground",children:"Charge Rate:"}),e.jsxs("span",{children:["£",((c=t.clientHourlyRate)==null?void 0:c.toFixed(2))||"0.00","/hr"]}),e.jsx("span",{className:"text-muted-foreground",children:"Total Charge:"}),e.jsxs("span",{children:["£",((h=t.totalCharge)==null?void 0:h.toFixed(2))||"0.00"]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Metadata"}),e.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"System ID:"}),e.jsx("span",{className:"font-mono text-xs",children:t.id})]})]})]})})})]})};export{jr as default};
