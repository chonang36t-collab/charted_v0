import{e as be,r as y,f as de,j as e,P as J,g as D,h as je,i as ge,k as Ne,l as A,b as Ce,R as S,T as ee,m as te,n as re,o as se,X as ye,A as ke}from"./index-C9Xvk_Mh.js";import{B as I}from"./button-xOT2x8Rw.js";import{a as Pe,P as $,b as z,g as U,c as X,C as ne,f as oe,d as ie,i as ae,e as we,s as G,h as K}from"./locationUtils-CzTH1835.js";import{u as Se,C as Ee,a as le,S as Te,b as Me,c as _e,d as Fe,e as L}from"./select-DiQeDqP8.js";import{B as ce}from"./badge-yvcuWxJT.js";import{C as H,a as Ie,b as He,d as O}from"./card-DKWA8Mal.js";function Q(t,i){return Pe(t,-i)}const Ge=(t,i)=>{var c,u,s,P,w,T,M,_,q,B,Y,r;if(!t)return{revenue:{value:0,change:0,trend:"neutral",text:"No data available"},clientPay:{value:0,change:0,trend:"neutral",text:"No data available"},staffPay:{value:0,change:0,trend:"neutral",text:"No data available"},totalShifts:{value:0,change:0,trend:"neutral",text:"No data available"},paidHours:{value:0,change:0,trend:"neutral",text:"No data available"},uniqueEmployees:{value:0,change:0,trend:"neutral",text:"No data available"},avgShiftDuration:{value:0,change:0,trend:"neutral",text:"No data available"}};const d=t.totalRevenue||0,m=t.avgClientPayPerHour||0,v=t.avgStaffPayPerHour||0,a=((c=t.previousPeriod)==null?void 0:c.totalRevenue)||0,l=((u=t.previousPeriod)==null?void 0:u.avgClientPayPerHour)||0,h=((s=t.previousPeriod)==null?void 0:s.avgStaffPayPerHour)||0,o=(n,N)=>N>0?(n-N)/N*100:0,j=o(d,a),C=o(m,l),f=o(v,h),x=n=>n>0?"up":n<0?"down":"neutral",g=(n,N,k)=>{if(!N)return"No previous data";let F="";return k<=7?F="last week":k<=31?F="last month":k<=93?F="last quarter":F="last period",`${n>0?"+":""}${Math.abs(n).toFixed(1)}% from ${F}`},p=Math.ceil((i.to.getTime()-i.from.getTime())/(1e3*60*60*24)),b=!!t.previousPeriod;return{revenue:{value:d,change:j,trend:x(j),text:g(j,b,p)},clientPay:{value:m,change:C,trend:x(C),text:g(C,b,p)},staffPay:{value:v,change:f,trend:x(f),text:g(f,b,p)},totalShifts:{value:t.totalShifts,change:o(t.totalShifts,((P=t.previousPeriod)==null?void 0:P.totalShifts)||0),trend:x(o(t.totalShifts,((w=t.previousPeriod)==null?void 0:w.totalShifts)||0)),text:g(o(t.totalShifts,((T=t.previousPeriod)==null?void 0:T.totalShifts)||0),b,p)},paidHours:{value:t.totalPaidHours||0,change:o(t.totalPaidHours||0,((M=t.previousPeriod)==null?void 0:M.totalPaidHours)||0)||0,trend:x(o(t.totalPaidHours||0,((_=t.previousPeriod)==null?void 0:_.totalPaidHours)||0)),text:g(o(t.totalPaidHours||0,((q=t.previousPeriod)==null?void 0:q.totalPaidHours)||0),b,p)},uniqueEmployees:{value:t.uniqueEmployees,change:o(t.uniqueEmployees,((B=t.previousPeriod)==null?void 0:B.uniqueEmployees)||0),trend:x(o(t.uniqueEmployees,((Y=t.previousPeriod)==null?void 0:Y.uniqueEmployees)||0)),text:g(o(t.uniqueEmployees,((r=t.previousPeriod)==null?void 0:r.uniqueEmployees)||0),b,p)},avgShiftDuration:{value:t.totalPaidHours&&t.totalShifts?t.totalPaidHours/t.totalShifts:0,change:0,trend:"neutral",text:"Average hours per shift"}}};var R="Checkbox",[Oe,Ke]=be(R),[Ae,W]=Oe(R);function qe(t){const{__scopeCheckbox:i,checked:d,children:m,defaultChecked:v,disabled:a,form:l,name:h,onCheckedChange:o,required:j,value:C="on",internal_do_not_use_render:f}=t,[x,g]=Ne({prop:d,defaultProp:v??!1,onChange:o,caller:R}),[p,b]=y.useState(null),[c,u]=y.useState(null),s=y.useRef(!1),P=p?!!l||!!p.closest("form"):!0,w={checked:x,disabled:a,setChecked:g,control:p,setControl:b,name:h,form:l,value:C,hasConsumerStoppedPropagationRef:s,required:j,defaultChecked:E(v)?!1:v,isFormControl:P,bubbleInput:c,setBubbleInput:u};return e.jsx(Ae,{scope:i,...w,children:Be(f)?f(w):m})}var ue="CheckboxTrigger",he=y.forwardRef(({__scopeCheckbox:t,onKeyDown:i,onClick:d,...m},v)=>{const{control:a,value:l,disabled:h,checked:o,required:j,setControl:C,setChecked:f,hasConsumerStoppedPropagationRef:x,isFormControl:g,bubbleInput:p}=W(ue,t),b=de(v,C),c=y.useRef(o);return y.useEffect(()=>{const u=a==null?void 0:a.form;if(u){const s=()=>f(c.current);return u.addEventListener("reset",s),()=>u.removeEventListener("reset",s)}},[a,f]),e.jsx(J.button,{type:"button",role:"checkbox","aria-checked":E(o)?"mixed":o,"aria-required":j,"data-state":ve(o),"data-disabled":h?"":void 0,disabled:h,value:l,...m,ref:b,onKeyDown:D(i,u=>{u.key==="Enter"&&u.preventDefault()}),onClick:D(d,u=>{f(s=>E(s)?!0:!s),p&&g&&(x.current=u.isPropagationStopped(),x.current||u.stopPropagation())})})});he.displayName=ue;var Z=y.forwardRef((t,i)=>{const{__scopeCheckbox:d,name:m,checked:v,defaultChecked:a,required:l,disabled:h,value:o,onCheckedChange:j,form:C,...f}=t;return e.jsx(qe,{__scopeCheckbox:d,checked:v,defaultChecked:a,disabled:h,required:l,onCheckedChange:j,name:m,form:C,value:o,internal_do_not_use_render:({isFormControl:x})=>e.jsxs(e.Fragment,{children:[e.jsx(he,{...f,ref:i,__scopeCheckbox:d}),x&&e.jsx(pe,{__scopeCheckbox:d})]})})});Z.displayName=R;var xe="CheckboxIndicator",me=y.forwardRef((t,i)=>{const{__scopeCheckbox:d,forceMount:m,...v}=t,a=W(xe,d);return e.jsx(je,{present:m||E(a.checked)||a.checked===!0,children:e.jsx(J.span,{"data-state":ve(a.checked),"data-disabled":a.disabled?"":void 0,...v,ref:i,style:{pointerEvents:"none",...t.style}})})});me.displayName=xe;var fe="CheckboxBubbleInput",pe=y.forwardRef(({__scopeCheckbox:t,...i},d)=>{const{control:m,hasConsumerStoppedPropagationRef:v,checked:a,defaultChecked:l,required:h,disabled:o,name:j,value:C,form:f,bubbleInput:x,setBubbleInput:g}=W(fe,t),p=de(d,g),b=Se(a),c=ge(m);y.useEffect(()=>{const s=x;if(!s)return;const P=window.HTMLInputElement.prototype,T=Object.getOwnPropertyDescriptor(P,"checked").set,M=!v.current;if(b!==a&&T){const _=new Event("click",{bubbles:M});s.indeterminate=E(a),T.call(s,E(a)?!1:a),s.dispatchEvent(_)}},[x,b,a,v]);const u=y.useRef(E(a)?!1:a);return e.jsx(J.input,{type:"checkbox","aria-hidden":!0,defaultChecked:l??u.current,required:h,disabled:o,name:j,value:C,form:f,...i,tabIndex:-1,ref:p,style:{...i.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});pe.displayName=fe;function Be(t){return typeof t=="function"}function E(t){return t==="indeterminate"}function ve(t){return E(t)?"indeterminate":t?"checked":"unchecked"}const V=y.forwardRef(({className:t,...i},d)=>e.jsx(Z,{ref:d,className:A("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),...i,children:e.jsx(me,{className:A("flex items-center justify-center text-current"),children:e.jsx(Ee,{className:"h-4 w-4"})})}));V.displayName=Z.displayName;const Qe=({dateRange:t,onDateRangeChange:i,calendarOpen:d,onCalendarOpenChange:m,tempDateRange:v,onTempDateRangeChange:a,selectedLocations:l=[],onLocationsChange:h})=>{const{role:o,locations:j}=Ce(),[C,f]=S.useState([]),[x,g]=S.useState(!1);S.useEffect(()=>{(async()=>{try{const n=await fetch(`${ke.SALES_SUMMARY.replace("sales-summary","locations")}`,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`},credentials:"include"});if(n.ok){const N=await n.json();f(o==="admin"?N:N.filter(k=>j.includes(k)))}}catch(n){console.error("Failed to fetch locations:",n)}})()},[o,j]);const p=r=>{h&&(l.includes(r)?h(l.filter(n=>n!==r)):h([...l,r]))},b=r=>{const n=new Date;let N,k;switch(r){case"this-month":N=G(n),k=K(n);break;case"last-month":N=G(Q(n,1)),k=K(Q(n,1));break;case"last-3-months":N=G(Q(n,2)),k=K(n);break;case"this-year":N=new Date(n.getFullYear(),0,1),k=new Date(n.getFullYear(),11,31);break;default:return}i({from:N,to:k})},[c,u]=S.useState(t==null?void 0:t.from),[s,P]=S.useState(t==null?void 0:t.to),[w,T]=S.useState(!1),[M,_]=S.useState(!1);S.useEffect(()=>{u(t==null?void 0:t.from),P(t==null?void 0:t.to)},[t]);const q=r=>{r&&(u(r),s&&ae(r,s)&&P(void 0))},B=r=>{r&&P(r)},Y=()=>{c&&s&&i({from:c,to:s})};return e.jsx("div",{className:"sticky top-0 z-40 bg-background border-b border-border",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Dashboard"}),e.jsx("p",{className:"text-muted-foreground",children:"Overview of your analytics"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[h&&e.jsxs($,{open:x,onOpenChange:g,children:[e.jsx(z,{asChild:!0,children:e.jsxs(I,{variant:"outline",className:"w-auto min-w-[180px] justify-between text-left font-normal",children:[e.jsx("div",{className:"flex items-center gap-2 overflow-hidden mr-2",children:e.jsx("span",{className:"truncate",children:l.length===0?"All Locations":l.length===1?U(l[0]):`${l.length} locations`})}),e.jsx(le,{className:"h-4 w-4 opacity-50 shrink-0"})]})}),e.jsx(X,{className:"w-[200px] p-0",align:"start",children:e.jsxs("div",{className:"p-2 max-h-[300px] overflow-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-2 hover:bg-muted rounded-sm cursor-pointer mb-1",onClick:r=>{r.stopPropagation(),h([])},children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(V,{checked:l.length===0,className:"pointer-events-none"}),e.jsx("span",{className:"text-sm font-medium",children:"All Locations"})]}),l.length>0&&e.jsx(I,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs text-muted-foreground hover:text-foreground",onClick:r=>{r.stopPropagation(),h([])},children:"Clear"})]}),e.jsx("div",{className:"h-px bg-border my-1"}),e.jsx(ee,{children:C.map(r=>e.jsxs("div",{className:"flex items-center space-x-2 p-2 hover:bg-muted rounded-sm cursor-pointer",onClick:n=>{n.stopPropagation(),p(r)},children:[e.jsx(V,{checked:l.includes(r),className:"pointer-events-none"}),e.jsxs(te,{children:[e.jsx(re,{asChild:!0,children:e.jsx("span",{className:"text-sm truncate font-medium",children:U(r)})}),e.jsx(se,{side:"right",children:e.jsx("p",{children:r})})]})]},r))})]})})]}),l.length>0&&h&&e.jsx("div",{className:"hidden lg:flex flex-wrap gap-1 items-center max-w-[300px]",children:e.jsxs(ee,{children:[l.slice(0,3).map(r=>e.jsxs(te,{children:[e.jsx(re,{asChild:!0,children:e.jsxs(ce,{variant:"secondary",className:"text-[10px] px-1 h-5 gap-1 max-w-[100px] truncate",children:[U(r),e.jsx(ye,{className:"h-2 w-2 cursor-pointer hover:text-destructive",onClick:n=>{n.stopPropagation(),p(r)}})]})}),e.jsx(se,{children:e.jsx("p",{children:r})})]},r)),l.length>3&&e.jsxs(ce,{variant:"secondary",className:"text-[10px] px-1 h-5",children:["+",l.length-3," more"]})]})}),e.jsxs(Te,{onValueChange:b,children:[e.jsxs(Me,{className:"w-[140px]",children:[e.jsx(_e,{placeholder:"Quick Select"}),e.jsx(le,{className:"h-4 w-4 opacity-50"})]}),e.jsxs(Fe,{children:[e.jsx(L,{value:"this-month",children:"This Month"}),e.jsx(L,{value:"last-month",children:"Last Month"}),e.jsx(L,{value:"last-3-months",children:"Last 3 Months"}),e.jsx(L,{value:"this-year",children:"This Year"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs($,{open:w,onOpenChange:T,children:[e.jsx(z,{asChild:!0,children:e.jsxs(I,{variant:"outline",className:A("w-[140px] justify-start text-left font-normal",!c&&"text-muted-foreground"),children:[e.jsx(ne,{className:"mr-2 h-4 w-4"}),c?oe(c,"LLL dd, y"):"From"]})}),e.jsx(X,{className:"w-auto p-0",align:"start",children:e.jsx("div",{className:"p-3",children:e.jsx(ie,{mode:"single",selected:c,onSelect:q,initialFocus:!0,captionLayout:"dropdown-buttons",fromYear:new Date().getFullYear()-10,toYear:new Date().getFullYear()+1,disabled:r=>s?ae(r,s):!1,className:"rounded-md border"})})})]}),e.jsx("div",{className:"text-muted-foreground",children:"to"}),e.jsxs($,{open:M,onOpenChange:_,children:[e.jsx(z,{asChild:!0,children:e.jsxs(I,{variant:"outline",className:A("w-[140px] justify-start text-left font-normal",!s&&"text-muted-foreground"),disabled:!c,children:[e.jsx(ne,{className:"mr-2 h-4 w-4"}),s?oe(s,"LLL dd, y"):"To"]})}),e.jsx(X,{className:"w-auto p-0",align:"start",children:e.jsx("div",{className:"p-3",children:e.jsx(ie,{mode:"single",selected:s,onSelect:B,initialFocus:!0,captionLayout:"dropdown-buttons",fromYear:c?c.getFullYear():new Date().getFullYear()-10,toYear:new Date().getFullYear()+1,disabled:r=>c?we(r,c):!1,className:"rounded-md border"})})})]}),e.jsx(I,{onClick:Y,disabled:!c||!s,className:"ml-2",children:"Apply"})]})]})]})})})};function Ve({title:t,value:i,change:d,trend:m="neutral"}){return e.jsxs(H,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(Ie,{className:"flex flex-row items-center justify-between pb-2",children:e.jsx(He,{className:"text-sm font-medium text-muted-foreground",children:t})}),e.jsxs(O,{children:[e.jsx("div",{className:"text-2xl font-bold",children:i}),d&&e.jsx("p",{className:A("text-xs mt-1",m==="up"&&"text-accent",m==="down"&&"text-destructive",m==="neutral"&&"text-muted-foreground"),children:d})]})]})}const Je=({salesData:t})=>{var i;return e.jsxs("div",{className:"grid gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 w-full",children:[e.jsx(H,{children:e.jsx(O,{className:"p-6",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Shifts"}),e.jsx("p",{className:"text-2xl font-bold",children:(t==null?void 0:t.totalShifts)||0})]})})})}),e.jsx(H,{children:e.jsx(O,{className:"p-6",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Clients"}),e.jsx("p",{className:"text-2xl font-bold",children:(t==null?void 0:t.totalClients)||0})]})})})}),e.jsx(H,{children:e.jsx(O,{className:"p-6",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Employees"}),e.jsx("p",{className:"text-2xl font-bold",children:(t==null?void 0:t.uniqueEmployees)||0})]})})})}),e.jsx(H,{children:e.jsx(O,{className:"p-6",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Profit Margin"}),e.jsxs("p",{className:"text-2xl font-bold",children:[((i=t==null?void 0:t.profitMargin)==null?void 0:i.toFixed(1))||0,"%"]})]})})})})]})},We=()=>e.jsx("div",{className:"fixed inset-0 bg-background/80 backdrop-blur-sm z-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Loading Dashboard"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Fetching your data..."})]})]})});export{Je as A,Qe as D,We as L,Ve as M,Ge as c};
