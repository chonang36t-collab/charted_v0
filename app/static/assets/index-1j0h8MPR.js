import{c as nt,r,j as e,e as M,t as wn,h as Te,p as st,v as Ie,P as V,q as b,w as le,o as ne,x as bn,B as k,b as ot,L as fe,I as F,y as ue,z as Nn,C as at,D as Cn,E as yn,F as Mn,G as Sn,H as Rn,J as _n,K as rt,M as Pn,N as it,O as In,Q as En,U as Dn,V as Tn,W as An,Y as On,a as kn,X as Ln}from"./index-DqRlWhRN.js";import{b as Fn,C as Ae,D as $n}from"./DashboardLayout-zE_Ymdb9.js";import{T as Gn,a as Kn,b as te,c as O,d as Vn,e as P}from"./table-C5P-gB72.js";import{B as Un}from"./badge-BS_Ozsh5.js";import{u as Bn,a as Hn,b as zn,c as Yn,d as qn,e as Wn}from"./useRecords-BF1O1DrJ.js";import{C as lt}from"./checkbox-CYMYWeKQ.js";import{e as Xn,D as We,b as Xe,c as Je,d as Qe}from"./dialog-DtKwSZhp.js";import{o as Jn,s as ee,c as K,b as Ze,u as Qn,t as Zn,C as ye,P as es}from"./types-CY4Z56Pv.js";import{L as _}from"./label-D_WPptcu.js";import{S as Me,a as Se,b as Re,c as _e,d as oe}from"./select-DZLJAaPG.js";import{C as ts,a as ns,b as ss,f as os,c as as,d as rs,e as is,S as ls}from"./command-BlduYASv.js";import{P as ct,a as dt,b as ut,f as z,C as cs,d as ds}from"./popover-D3jWoeRM.js";import{C as mt,a as us}from"./index-g3BUhGsV.js";import{c as pt,R as ms,I as ps}from"./index-Cl_bIQvk.js";import{P as fs}from"./plus-C1lWmFjw.js";import{T as ft}from"./trash-2-obfvYv63.js";import{E as hs}from"./ellipsis-D3lGvp9Q.js";import"./users-BOBInr6z.js";import"./useQuery-B4OgzMO5.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=nt("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=nt("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),ht=({className:t,...n})=>e.jsx("nav",{role:"navigation","aria-label":"pagination",className:M("mx-auto flex w-full justify-center",t),...n});ht.displayName="Pagination";const xt=r.forwardRef(({className:t,...n},s)=>e.jsx("ul",{ref:s,className:M("flex flex-row items-center gap-1",t),...n}));xt.displayName="PaginationContent";const pe=r.forwardRef(({className:t,...n},s)=>e.jsx("li",{ref:s,className:M("",t),...n}));pe.displayName="PaginationItem";const Oe=({className:t,isActive:n,size:s="icon",...o})=>e.jsx("a",{"aria-current":n?"page":void 0,className:M(wn({variant:n?"outline":"ghost",size:s}),t),...o});Oe.displayName="PaginationLink";const gt=({className:t,...n})=>e.jsxs(Oe,{"aria-label":"Go to previous page",size:"default",className:M("gap-1 pl-2.5",t),...n,children:[e.jsx(Fn,{className:"h-4 w-4"}),e.jsx("span",{children:"Previous"})]});gt.displayName="PaginationPrevious";const jt=({className:t,...n})=>e.jsxs(Oe,{"aria-label":"Go to next page",size:"default",className:M("gap-1 pr-2.5",t),...n,children:[e.jsx("span",{children:"Next"}),e.jsx(Ae,{className:"h-4 w-4"})]});jt.displayName="PaginationNext";var ge="Collapsible",[gs,la]=Te(ge),[js,ke]=gs(ge),vt=r.forwardRef((t,n)=>{const{__scopeCollapsible:s,open:o,defaultOpen:i,disabled:a,onOpenChange:c,...f}=t,[x,h]=st({prop:o,defaultProp:i??!1,onChange:c,caller:ge});return e.jsx(js,{scope:s,disabled:a,contentId:Ie(),open:x,onOpenToggle:r.useCallback(()=>h(p=>!p),[h]),children:e.jsx(V.div,{"data-state":Fe(x),"data-disabled":a?"":void 0,...f,ref:n})})});vt.displayName=ge;var wt="CollapsibleTrigger",bt=r.forwardRef((t,n)=>{const{__scopeCollapsible:s,...o}=t,i=ke(wt,s);return e.jsx(V.button,{type:"button","aria-controls":i.contentId,"aria-expanded":i.open||!1,"data-state":Fe(i.open),"data-disabled":i.disabled?"":void 0,disabled:i.disabled,...o,ref:n,onClick:b(t.onClick,i.onOpenToggle)})});bt.displayName=wt;var Le="CollapsibleContent",vs=r.forwardRef((t,n)=>{const{forceMount:s,...o}=t,i=ke(Le,t.__scopeCollapsible);return e.jsx(le,{present:s||i.open,children:({present:a})=>e.jsx(ws,{...o,ref:n,present:a})})});vs.displayName=Le;var ws=r.forwardRef((t,n)=>{const{__scopeCollapsible:s,present:o,children:i,...a}=t,c=ke(Le,s),[f,x]=r.useState(o),h=r.useRef(null),p=ne(n,h),d=r.useRef(0),m=d.current,w=r.useRef(0),u=w.current,g=c.open||f,R=r.useRef(g),S=r.useRef(void 0);return r.useEffect(()=>{const N=requestAnimationFrame(()=>R.current=!1);return()=>cancelAnimationFrame(N)},[]),bn(()=>{const N=h.current;if(N){S.current=S.current||{transitionDuration:N.style.transitionDuration,animationName:N.style.animationName},N.style.transitionDuration="0s",N.style.animationName="none";const A=N.getBoundingClientRect();d.current=A.height,w.current=A.width,R.current||(N.style.transitionDuration=S.current.transitionDuration,N.style.animationName=S.current.animationName),x(o)}},[c.open,o]),e.jsx(V.div,{"data-state":Fe(c.open),"data-disabled":c.disabled?"":void 0,id:c.contentId,hidden:!g,...a,ref:p,style:{"--radix-collapsible-content-height":m?`${m}px`:void 0,"--radix-collapsible-content-width":u?`${u}px`:void 0,...t.style},children:g&&i})});function Fe(t){return t?"open":"closed"}var bs=vt;const Ns=bs,Cs=bt;function Pe({options:t,value:n,onChange:s,placeholder:o="Select...",searchPlaceholder:i="Search...",emptyMessage:a="No results found.",className:c,disabled:f=!1}){var p;const[x,h]=r.useState(!1);return e.jsxs(ct,{open:x,onOpenChange:h,children:[e.jsx(dt,{asChild:!0,children:e.jsxs(k,{variant:"outline",role:"combobox","aria-expanded":x,className:M("w-full justify-between",c),disabled:f,children:[n?(p=t.find(d=>d.value===n))==null?void 0:p.label:o,e.jsx(ts,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(ut,{className:"w-[--radix-popover-trigger-width] p-0",align:"start",children:e.jsxs(ns,{children:[e.jsx(ss,{placeholder:i}),e.jsxs(os,{children:[e.jsx(as,{children:a}),e.jsx(rs,{children:t.map(d=>e.jsxs(is,{value:d.label,onSelect:m=>{s(d.value===n?"":d.value),h(!1)},children:[e.jsx(mt,{className:M("mr-2 h-4 w-4",n===d.value?"opacity-100":"opacity-0")}),d.label]},d.value))})]})]})})]})}const ys=Jn({date:ee().min(1,"Date is required"),employeeId:K.number().min(1,"Employee is required"),clientId:K.number().min(1,"Client is required"),jobId:K.number().min(1,"Job is required"),shiftId:K.number().min(1,"Shift is required"),startTime:ee().min(1,"Start time is required"),endTime:ee().min(1,"End time is required"),hours:K.number().min(.1,"Hours must be greater than 0"),hourRate:K.number().optional(),clientHourlyRate:K.number().optional(),job_name:ee().optional(),role:ee().optional(),jobStatus:ee().optional(),additions:K.number().optional(),deductions:K.number().optional(),self_employed:Ze().optional(),dns:Ze().optional()}),et=({record:t,onSuccess:n,onCancel:s})=>{const{role:o}=ot(),i=o==="admin",{data:a,isLoading:c}=Bn(),f=Hn(),x=zn(),[h,p]=r.useState(""),[d,m]=r.useState(""),w=!!t,u=Qn({resolver:Zn(ys),defaultValues:{date:(t==null?void 0:t.date)||new Date().toISOString().split("T")[0],employeeId:void 0,clientId:void 0,jobId:void 0,shiftId:void 0,startTime:t!=null&&t.shiftStart?t.shiftStart.substring(0,5):"09:00",endTime:t!=null&&t.shiftEnd?t.shiftEnd.substring(0,5):"17:00",hours:(t==null?void 0:t.paidHours)||8,hourRate:(t==null?void 0:t.hourRate)||0,clientHourlyRate:(t==null?void 0:t.clientHourlyRate)||0,job_name:(t==null?void 0:t.jobName)||"",role:"Travel Retail Specialist",jobStatus:(t==null?void 0:t.jobStatus)||"Currently Working - Full Airside Pass",additions:0,deductions:0,self_employed:!1,dns:!1}}),g=u.watch("startTime"),R=u.watch("endTime"),S=u.watch("shiftId"),N=r.useMemo(()=>a!=null&&a.jobs?Array.from(new Set(a.jobs.map(l=>l.location).filter(Boolean))):[],[a]),A=r.useMemo(()=>!(a!=null&&a.jobs)||!h?[]:Array.from(new Set(a.jobs.filter(l=>l.location===h).map(l=>l.site).filter(Boolean))),[a,h]);r.useEffect(()=>{if(t&&a){const l=a.employees.find(y=>y.name===t.fullName);l&&u.setValue("employeeId",l.id);const j=a.clients.find(y=>y.name===t.clientName);j&&u.setValue("clientId",j.id);const C=a.shifts.find(y=>y.name===t.shiftName);C&&u.setValue("shiftId",C.id);let E=a.jobs.find(y=>y.name===t.jobName&&y.site===t.site);E||(E=a.jobs.find(y=>y.site===t.site&&y.location===t.location)),E&&(u.setValue("jobId",E.id),p(E.location),m(E.site))}},[t,a,u]),r.useEffect(()=>{if(g&&R){const[l,j]=g.split(":").map(Number),[C,E]=R.split(":").map(Number);let y=l*60+j,Y=C*60+E;Y<y&&(Y+=24*60);const be=(Y-y)/60;u.setValue("hours",parseFloat(be.toFixed(2)))}},[g,R,u]),r.useEffect(()=>{var l;if(!w&&S&&(a!=null&&a.shifts)){const j=(l=a.shifts.find(C=>C.id===S))==null?void 0:l.name;j&&u.setValue("job_name",j)}},[S,w,a,u]),r.useEffect(()=>{if(h&&d&&(a!=null&&a.jobs)){const l=a.jobs.find(j=>j.location===h&&j.site===d);l&&u.setValue("jobId",l.id)}},[h,d,a,u]);const $=l=>{w&&t?x.mutate({id:t.id,...l},{onSuccess:()=>{ue.success("Record updated successfully"),n()},onError:j=>{ue.error(`Failed to update record: ${j.message}`)}}):f.mutate(l,{onSuccess:()=>{ue.success("Record created successfully"),n()},onError:j=>{ue.error(`Failed to create record: ${j.message}`)}})},X=f.isPending||x.isPending;if(c)return e.jsx("div",{className:"flex justify-center p-4",children:e.jsx(fe,{className:"animate-spin"})});const J=(a==null?void 0:a.employees.map(l=>({value:l.id.toString(),label:l.name})))||[],U=(a==null?void 0:a.clients.map(l=>({value:l.id.toString(),label:l.name})))||[],B=(a==null?void 0:a.shifts.map(l=>({value:l.id.toString(),label:`${l.name} (${l.start.substring(0,5)}-${l.end.substring(0,5)})`})))||[];return e.jsxs("form",{onSubmit:u.handleSubmit($),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"date",children:"Date"}),e.jsx(F,{id:"date",type:"date",...u.register("date")}),u.formState.errors.date&&e.jsx("span",{className:"text-red-500 text-xs",children:u.formState.errors.date.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"startTime",children:"Start Time"}),e.jsx(F,{id:"startTime",type:"time",...u.register("startTime")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"endTime",children:"End Time"}),e.jsx(F,{id:"endTime",type:"time",...u.register("endTime")})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(_,{children:["Calculated Hours: ",u.watch("hours")]}),e.jsx(F,{type:"hidden",...u.register("hours")})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{children:"Employee"}),e.jsx(ye,{control:u.control,name:"employeeId",render:({field:l})=>{var j;return e.jsx(Pe,{options:J,value:(j=l.value)==null?void 0:j.toString(),onChange:C=>l.onChange(Number(C)),placeholder:"Select Employee...",searchPlaceholder:"Search employees..."})}}),u.formState.errors.employeeId&&e.jsx("span",{className:"text-red-500 text-xs",children:u.formState.errors.employeeId.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{children:"Client"}),e.jsx(ye,{control:u.control,name:"clientId",render:({field:l})=>{var j;return e.jsx(Pe,{options:U,value:(j=l.value)==null?void 0:j.toString(),onChange:C=>l.onChange(Number(C)),placeholder:"Select Client...",searchPlaceholder:"Search clients..."})}}),u.formState.errors.clientId&&e.jsx("span",{className:"text-red-500 text-xs",children:u.formState.errors.clientId.message})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{children:"Location"}),e.jsxs(Me,{value:h,onValueChange:l=>{p(l),m("")},children:[e.jsx(Se,{children:e.jsx(Re,{placeholder:"Select Location"})}),e.jsx(_e,{children:N.map(l=>e.jsx(oe,{value:l,children:l},l))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{children:"Site / Terminal"}),e.jsxs(Me,{value:d,onValueChange:m,disabled:!h,children:[e.jsx(Se,{children:e.jsx(Re,{placeholder:"Select Site"})}),e.jsx(_e,{children:A.map(l=>e.jsx(oe,{value:l,children:l},l))})]}),e.jsx("input",{type:"hidden",...u.register("jobId")}),u.formState.errors.jobId&&e.jsx("span",{className:"text-red-500 text-xs",children:"Job Selection Incomplete"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{children:"Shift"}),e.jsx(ye,{control:u.control,name:"shiftId",render:({field:l})=>{var j;return e.jsx(Pe,{options:B,value:(j=l.value)==null?void 0:j.toString(),onChange:C=>l.onChange(Number(C)),placeholder:"Select Shift config...",searchPlaceholder:"Search shifts..."})}}),u.formState.errors.shiftId&&e.jsx("span",{className:"text-red-500 text-xs",children:u.formState.errors.shiftId.message})]}),(i||w)&&e.jsxs("div",{className:"border-t pt-4 grid grid-cols-2 gap-4 bg-muted/20 p-4 rounded-md",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{children:"Role"}),e.jsx(F,{...u.register("role")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{children:"Status"}),e.jsxs(Me,{onValueChange:l=>u.setValue("jobStatus",l),defaultValue:u.getValues("jobStatus"),children:[e.jsx(Se,{children:e.jsx(Re,{placeholder:"Status"})}),e.jsxs(_e,{children:[e.jsx(oe,{value:"Currently Working - Full Airside Pass",children:"Currently Working - Full Airside Pass"}),e.jsx(oe,{value:"Completed",children:"Completed"}),e.jsx(oe,{value:"Cancelled",children:"Cancelled"})]})]})]}),i&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"hourRate",children:"Pay Rate (£)"}),e.jsx(F,{id:"hourRate",type:"number",step:"0.01",...u.register("hourRate")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"clientHourlyRate",children:"Client Rate (£)"}),e.jsx(F,{id:"clientHourlyRate",type:"number",step:"0.01",...u.register("clientHourlyRate")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"additions",children:"Additions (£)"}),e.jsx(F,{id:"additions",type:"number",step:"0.01",...u.register("additions")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"deductions",children:"Deductions (£)"}),e.jsx(F,{id:"deductions",type:"number",step:"0.01",...u.register("deductions")})]})]})]}),e.jsxs(Xn,{className:"mt-6 flex justify-between items-center w-full",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:!w&&"Defaults: Role=Travel Retail, Additions=0, Deductions=0"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(k,{type:"button",variant:"outline",onClick:s,children:"Cancel"}),e.jsxs(k,{type:"submit",disabled:X,children:[X&&e.jsx(fe,{className:"mr-2 h-4 w-4 animate-spin"}),w?"Update Record":"Create Record"]})]})]})]})};var Ee=["Enter"," "],Ms=["ArrowDown","PageUp","Home"],Nt=["ArrowUp","PageDown","End"],Ss=[...Ms,...Nt],Rs={ltr:[...Ee,"ArrowRight"],rtl:[...Ee,"ArrowLeft"]},_s={ltr:["ArrowLeft"],rtl:["ArrowRight"]},ce="Menu",[re,Ps,Is]=Nn(ce),[q,Ct]=Te(ce,[Is,at,pt]),je=at(),yt=pt(),[Es,W]=q(ce),[Ds,de]=q(ce),Mt=t=>{const{__scopeMenu:n,open:s=!1,children:o,dir:i,onOpenChange:a,modal:c=!0}=t,f=je(n),[x,h]=r.useState(null),p=r.useRef(!1),d=rt(a),m=Dn(i);return r.useEffect(()=>{const w=()=>{p.current=!0,document.addEventListener("pointerdown",u,{capture:!0,once:!0}),document.addEventListener("pointermove",u,{capture:!0,once:!0})},u=()=>p.current=!1;return document.addEventListener("keydown",w,{capture:!0}),()=>{document.removeEventListener("keydown",w,{capture:!0}),document.removeEventListener("pointerdown",u,{capture:!0}),document.removeEventListener("pointermove",u,{capture:!0})}},[]),e.jsx(Tn,{...f,children:e.jsx(Es,{scope:n,open:s,onOpenChange:d,content:x,onContentChange:h,children:e.jsx(Ds,{scope:n,onClose:r.useCallback(()=>d(!1),[d]),isUsingKeyboardRef:p,dir:m,modal:c,children:o})})})};Mt.displayName=ce;var Ts="MenuAnchor",$e=r.forwardRef((t,n)=>{const{__scopeMenu:s,...o}=t,i=je(s);return e.jsx(Cn,{...i,...o,ref:n})});$e.displayName=Ts;var Ge="MenuPortal",[As,St]=q(Ge,{forceMount:void 0}),Rt=t=>{const{__scopeMenu:n,forceMount:s,children:o,container:i}=t,a=W(Ge,n);return e.jsx(As,{scope:n,forceMount:s,children:e.jsx(le,{present:s||a.open,children:e.jsx(An,{asChild:!0,container:i,children:o})})})};Rt.displayName=Ge;var T="MenuContent",[Os,Ke]=q(T),_t=r.forwardRef((t,n)=>{const s=St(T,t.__scopeMenu),{forceMount:o=s.forceMount,...i}=t,a=W(T,t.__scopeMenu),c=de(T,t.__scopeMenu);return e.jsx(re.Provider,{scope:t.__scopeMenu,children:e.jsx(le,{present:o||a.open,children:e.jsx(re.Slot,{scope:t.__scopeMenu,children:c.modal?e.jsx(ks,{...i,ref:n}):e.jsx(Ls,{...i,ref:n})})})})}),ks=r.forwardRef((t,n)=>{const s=W(T,t.__scopeMenu),o=r.useRef(null),i=ne(n,o);return r.useEffect(()=>{const a=o.current;if(a)return yn(a)},[]),e.jsx(Ve,{...t,ref:i,trapFocus:s.open,disableOutsidePointerEvents:s.open,disableOutsideScroll:!0,onFocusOutside:b(t.onFocusOutside,a=>a.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>s.onOpenChange(!1)})}),Ls=r.forwardRef((t,n)=>{const s=W(T,t.__scopeMenu);return e.jsx(Ve,{...t,ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>s.onOpenChange(!1)})}),Fs=On("MenuContent.ScrollLock"),Ve=r.forwardRef((t,n)=>{const{__scopeMenu:s,loop:o=!1,trapFocus:i,onOpenAutoFocus:a,onCloseAutoFocus:c,disableOutsidePointerEvents:f,onEntryFocus:x,onEscapeKeyDown:h,onPointerDownOutside:p,onFocusOutside:d,onInteractOutside:m,onDismiss:w,disableOutsideScroll:u,...g}=t,R=W(T,s),S=de(T,s),N=je(s),A=yt(s),$=Ps(s),[X,J]=r.useState(null),U=r.useRef(null),B=ne(n,U,R.onContentChange),l=r.useRef(0),j=r.useRef(""),C=r.useRef(0),E=r.useRef(null),y=r.useRef("right"),Y=r.useRef(0),be=u?In:r.Fragment,jn=u?{as:Fs,allowPinchZoom:!0}:void 0,vn=v=>{var Z,Ye;const D=j.current+v,L=$().filter(G=>!G.disabled),H=document.activeElement,Ne=(Z=L.find(G=>G.ref.current===H))==null?void 0:Z.textValue,Ce=L.map(G=>G.textValue),ze=Xs(Ce,D,Ne),se=(Ye=L.find(G=>G.textValue===ze))==null?void 0:Ye.ref.current;(function G(qe){j.current=qe,window.clearTimeout(l.current),qe!==""&&(l.current=window.setTimeout(()=>G(""),1e3))})(D),se&&setTimeout(()=>se.focus())};r.useEffect(()=>()=>window.clearTimeout(l.current),[]),Mn();const Q=r.useCallback(v=>{var L,H;return y.current===((L=E.current)==null?void 0:L.side)&&Qs(v,(H=E.current)==null?void 0:H.area)},[]);return e.jsx(Os,{scope:s,searchRef:j,onItemEnter:r.useCallback(v=>{Q(v)&&v.preventDefault()},[Q]),onItemLeave:r.useCallback(v=>{var D;Q(v)||((D=U.current)==null||D.focus(),J(null))},[Q]),onTriggerLeave:r.useCallback(v=>{Q(v)&&v.preventDefault()},[Q]),pointerGraceTimerRef:C,onPointerGraceIntentChange:r.useCallback(v=>{E.current=v},[]),children:e.jsx(be,{...jn,children:e.jsx(Sn,{asChild:!0,trapped:i,onMountAutoFocus:b(a,v=>{var D;v.preventDefault(),(D=U.current)==null||D.focus({preventScroll:!0})}),onUnmountAutoFocus:c,children:e.jsx(Rn,{asChild:!0,disableOutsidePointerEvents:f,onEscapeKeyDown:h,onPointerDownOutside:p,onFocusOutside:d,onInteractOutside:m,onDismiss:w,children:e.jsx(ms,{asChild:!0,...A,dir:S.dir,orientation:"vertical",loop:o,currentTabStopId:X,onCurrentTabStopIdChange:J,onEntryFocus:b(x,v=>{S.isUsingKeyboardRef.current||v.preventDefault()}),preventScrollOnEntryFocus:!0,children:e.jsx(_n,{role:"menu","aria-orientation":"vertical","data-state":Bt(R.open),"data-radix-menu-content":"",dir:S.dir,...N,...g,ref:B,style:{outline:"none",...g.style},onKeyDown:b(g.onKeyDown,v=>{const L=v.target.closest("[data-radix-menu-content]")===v.currentTarget,H=v.ctrlKey||v.altKey||v.metaKey,Ne=v.key.length===1;L&&(v.key==="Tab"&&v.preventDefault(),!H&&Ne&&vn(v.key));const Ce=U.current;if(v.target!==Ce||!Ss.includes(v.key))return;v.preventDefault();const se=$().filter(Z=>!Z.disabled).map(Z=>Z.ref.current);Nt.includes(v.key)&&se.reverse(),qs(se)}),onBlur:b(t.onBlur,v=>{v.currentTarget.contains(v.target)||(window.clearTimeout(l.current),j.current="")}),onPointerMove:b(t.onPointerMove,ie(v=>{const D=v.target,L=Y.current!==v.clientX;if(v.currentTarget.contains(D)&&L){const H=v.clientX>Y.current?"right":"left";y.current=H,Y.current=v.clientX}}))})})})})})})});_t.displayName=T;var $s="MenuGroup",Ue=r.forwardRef((t,n)=>{const{__scopeMenu:s,...o}=t;return e.jsx(V.div,{role:"group",...o,ref:n})});Ue.displayName=$s;var Gs="MenuLabel",Pt=r.forwardRef((t,n)=>{const{__scopeMenu:s,...o}=t;return e.jsx(V.div,{...o,ref:n})});Pt.displayName=Gs;var he="MenuItem",tt="menu.itemSelect",ve=r.forwardRef((t,n)=>{const{disabled:s=!1,onSelect:o,...i}=t,a=r.useRef(null),c=de(he,t.__scopeMenu),f=Ke(he,t.__scopeMenu),x=ne(n,a),h=r.useRef(!1),p=()=>{const d=a.current;if(!s&&d){const m=new CustomEvent(tt,{bubbles:!0,cancelable:!0});d.addEventListener(tt,w=>o==null?void 0:o(w),{once:!0}),En(d,m),m.defaultPrevented?h.current=!1:c.onClose()}};return e.jsx(It,{...i,ref:x,disabled:s,onClick:b(t.onClick,p),onPointerDown:d=>{var m;(m=t.onPointerDown)==null||m.call(t,d),h.current=!0},onPointerUp:b(t.onPointerUp,d=>{var m;h.current||(m=d.currentTarget)==null||m.click()}),onKeyDown:b(t.onKeyDown,d=>{const m=f.searchRef.current!=="";s||m&&d.key===" "||Ee.includes(d.key)&&(d.currentTarget.click(),d.preventDefault())})})});ve.displayName=he;var It=r.forwardRef((t,n)=>{const{__scopeMenu:s,disabled:o=!1,textValue:i,...a}=t,c=Ke(he,s),f=yt(s),x=r.useRef(null),h=ne(n,x),[p,d]=r.useState(!1),[m,w]=r.useState("");return r.useEffect(()=>{const u=x.current;u&&w((u.textContent??"").trim())},[a.children]),e.jsx(re.ItemSlot,{scope:s,disabled:o,textValue:i??m,children:e.jsx(ps,{asChild:!0,...f,focusable:!o,children:e.jsx(V.div,{role:"menuitem","data-highlighted":p?"":void 0,"aria-disabled":o||void 0,"data-disabled":o?"":void 0,...a,ref:h,onPointerMove:b(t.onPointerMove,ie(u=>{o?c.onItemLeave(u):(c.onItemEnter(u),u.defaultPrevented||u.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:b(t.onPointerLeave,ie(u=>c.onItemLeave(u))),onFocus:b(t.onFocus,()=>d(!0)),onBlur:b(t.onBlur,()=>d(!1))})})})}),Ks="MenuCheckboxItem",Et=r.forwardRef((t,n)=>{const{checked:s=!1,onCheckedChange:o,...i}=t;return e.jsx(kt,{scope:t.__scopeMenu,checked:s,children:e.jsx(ve,{role:"menuitemcheckbox","aria-checked":xe(s)?"mixed":s,...i,ref:n,"data-state":He(s),onSelect:b(i.onSelect,()=>o==null?void 0:o(xe(s)?!0:!s),{checkForDefaultPrevented:!1})})})});Et.displayName=Ks;var Dt="MenuRadioGroup",[Vs,Us]=q(Dt,{value:void 0,onValueChange:()=>{}}),Tt=r.forwardRef((t,n)=>{const{value:s,onValueChange:o,...i}=t,a=rt(o);return e.jsx(Vs,{scope:t.__scopeMenu,value:s,onValueChange:a,children:e.jsx(Ue,{...i,ref:n})})});Tt.displayName=Dt;var At="MenuRadioItem",Ot=r.forwardRef((t,n)=>{const{value:s,...o}=t,i=Us(At,t.__scopeMenu),a=s===i.value;return e.jsx(kt,{scope:t.__scopeMenu,checked:a,children:e.jsx(ve,{role:"menuitemradio","aria-checked":a,...o,ref:n,"data-state":He(a),onSelect:b(o.onSelect,()=>{var c;return(c=i.onValueChange)==null?void 0:c.call(i,s)},{checkForDefaultPrevented:!1})})})});Ot.displayName=At;var Be="MenuItemIndicator",[kt,Bs]=q(Be,{checked:!1}),Lt=r.forwardRef((t,n)=>{const{__scopeMenu:s,forceMount:o,...i}=t,a=Bs(Be,s);return e.jsx(le,{present:o||xe(a.checked)||a.checked===!0,children:e.jsx(V.span,{...i,ref:n,"data-state":He(a.checked)})})});Lt.displayName=Be;var Hs="MenuSeparator",Ft=r.forwardRef((t,n)=>{const{__scopeMenu:s,...o}=t;return e.jsx(V.div,{role:"separator","aria-orientation":"horizontal",...o,ref:n})});Ft.displayName=Hs;var zs="MenuArrow",$t=r.forwardRef((t,n)=>{const{__scopeMenu:s,...o}=t,i=je(s);return e.jsx(Pn,{...i,...o,ref:n})});$t.displayName=zs;var Ys="MenuSub",[ca,Gt]=q(Ys),ae="MenuSubTrigger",Kt=r.forwardRef((t,n)=>{const s=W(ae,t.__scopeMenu),o=de(ae,t.__scopeMenu),i=Gt(ae,t.__scopeMenu),a=Ke(ae,t.__scopeMenu),c=r.useRef(null),{pointerGraceTimerRef:f,onPointerGraceIntentChange:x}=a,h={__scopeMenu:t.__scopeMenu},p=r.useCallback(()=>{c.current&&window.clearTimeout(c.current),c.current=null},[]);return r.useEffect(()=>p,[p]),r.useEffect(()=>{const d=f.current;return()=>{window.clearTimeout(d),x(null)}},[f,x]),e.jsx($e,{asChild:!0,...h,children:e.jsx(It,{id:i.triggerId,"aria-haspopup":"menu","aria-expanded":s.open,"aria-controls":i.contentId,"data-state":Bt(s.open),...t,ref:it(n,i.onTriggerChange),onClick:d=>{var m;(m=t.onClick)==null||m.call(t,d),!(t.disabled||d.defaultPrevented)&&(d.currentTarget.focus(),s.open||s.onOpenChange(!0))},onPointerMove:b(t.onPointerMove,ie(d=>{a.onItemEnter(d),!d.defaultPrevented&&!t.disabled&&!s.open&&!c.current&&(a.onPointerGraceIntentChange(null),c.current=window.setTimeout(()=>{s.onOpenChange(!0),p()},100))})),onPointerLeave:b(t.onPointerLeave,ie(d=>{var w,u;p();const m=(w=s.content)==null?void 0:w.getBoundingClientRect();if(m){const g=(u=s.content)==null?void 0:u.dataset.side,R=g==="right",S=R?-5:5,N=m[R?"left":"right"],A=m[R?"right":"left"];a.onPointerGraceIntentChange({area:[{x:d.clientX+S,y:d.clientY},{x:N,y:m.top},{x:A,y:m.top},{x:A,y:m.bottom},{x:N,y:m.bottom}],side:g}),window.clearTimeout(f.current),f.current=window.setTimeout(()=>a.onPointerGraceIntentChange(null),300)}else{if(a.onTriggerLeave(d),d.defaultPrevented)return;a.onPointerGraceIntentChange(null)}})),onKeyDown:b(t.onKeyDown,d=>{var w;const m=a.searchRef.current!=="";t.disabled||m&&d.key===" "||Rs[o.dir].includes(d.key)&&(s.onOpenChange(!0),(w=s.content)==null||w.focus(),d.preventDefault())})})})});Kt.displayName=ae;var Vt="MenuSubContent",Ut=r.forwardRef((t,n)=>{const s=St(T,t.__scopeMenu),{forceMount:o=s.forceMount,...i}=t,a=W(T,t.__scopeMenu),c=de(T,t.__scopeMenu),f=Gt(Vt,t.__scopeMenu),x=r.useRef(null),h=ne(n,x);return e.jsx(re.Provider,{scope:t.__scopeMenu,children:e.jsx(le,{present:o||a.open,children:e.jsx(re.Slot,{scope:t.__scopeMenu,children:e.jsx(Ve,{id:f.contentId,"aria-labelledby":f.triggerId,...i,ref:h,align:"start",side:c.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:p=>{var d;c.isUsingKeyboardRef.current&&((d=x.current)==null||d.focus()),p.preventDefault()},onCloseAutoFocus:p=>p.preventDefault(),onFocusOutside:b(t.onFocusOutside,p=>{p.target!==f.trigger&&a.onOpenChange(!1)}),onEscapeKeyDown:b(t.onEscapeKeyDown,p=>{c.onClose(),p.preventDefault()}),onKeyDown:b(t.onKeyDown,p=>{var w;const d=p.currentTarget.contains(p.target),m=_s[c.dir].includes(p.key);d&&m&&(a.onOpenChange(!1),(w=f.trigger)==null||w.focus(),p.preventDefault())})})})})})});Ut.displayName=Vt;function Bt(t){return t?"open":"closed"}function xe(t){return t==="indeterminate"}function He(t){return xe(t)?"indeterminate":t?"checked":"unchecked"}function qs(t){const n=document.activeElement;for(const s of t)if(s===n||(s.focus(),document.activeElement!==n))return}function Ws(t,n){return t.map((s,o)=>t[(n+o)%t.length])}function Xs(t,n,s){const i=n.length>1&&Array.from(n).every(h=>h===n[0])?n[0]:n,a=s?t.indexOf(s):-1;let c=Ws(t,Math.max(a,0));i.length===1&&(c=c.filter(h=>h!==s));const x=c.find(h=>h.toLowerCase().startsWith(i.toLowerCase()));return x!==s?x:void 0}function Js(t,n){const{x:s,y:o}=t;let i=!1;for(let a=0,c=n.length-1;a<n.length;c=a++){const f=n[a],x=n[c],h=f.x,p=f.y,d=x.x,m=x.y;p>o!=m>o&&s<(d-h)*(o-p)/(m-p)+h&&(i=!i)}return i}function Qs(t,n){if(!n)return!1;const s={x:t.clientX,y:t.clientY};return Js(s,n)}function ie(t){return n=>n.pointerType==="mouse"?t(n):void 0}var Zs=Mt,eo=$e,to=Rt,no=_t,so=Ue,oo=Pt,ao=ve,ro=Et,io=Tt,lo=Ot,co=Lt,uo=Ft,mo=$t,po=Kt,fo=Ut,we="DropdownMenu",[ho,da]=Te(we,[Ct]),I=Ct(),[xo,Ht]=ho(we),zt=t=>{const{__scopeDropdownMenu:n,children:s,dir:o,open:i,defaultOpen:a,onOpenChange:c,modal:f=!0}=t,x=I(n),h=r.useRef(null),[p,d]=st({prop:i,defaultProp:a??!1,onChange:c,caller:we});return e.jsx(xo,{scope:n,triggerId:Ie(),triggerRef:h,contentId:Ie(),open:p,onOpenChange:d,onOpenToggle:r.useCallback(()=>d(m=>!m),[d]),modal:f,children:e.jsx(Zs,{...x,open:p,onOpenChange:d,dir:o,modal:f,children:s})})};zt.displayName=we;var Yt="DropdownMenuTrigger",qt=r.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,disabled:o=!1,...i}=t,a=Ht(Yt,s),c=I(s);return e.jsx(eo,{asChild:!0,...c,children:e.jsx(V.button,{type:"button",id:a.triggerId,"aria-haspopup":"menu","aria-expanded":a.open,"aria-controls":a.open?a.contentId:void 0,"data-state":a.open?"open":"closed","data-disabled":o?"":void 0,disabled:o,...i,ref:it(n,a.triggerRef),onPointerDown:b(t.onPointerDown,f=>{!o&&f.button===0&&f.ctrlKey===!1&&(a.onOpenToggle(),a.open||f.preventDefault())}),onKeyDown:b(t.onKeyDown,f=>{o||(["Enter"," "].includes(f.key)&&a.onOpenToggle(),f.key==="ArrowDown"&&a.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(f.key)&&f.preventDefault())})})})});qt.displayName=Yt;var go="DropdownMenuPortal",Wt=t=>{const{__scopeDropdownMenu:n,...s}=t,o=I(n);return e.jsx(to,{...o,...s})};Wt.displayName=go;var Xt="DropdownMenuContent",Jt=r.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...o}=t,i=Ht(Xt,s),a=I(s),c=r.useRef(!1);return e.jsx(no,{id:i.contentId,"aria-labelledby":i.triggerId,...a,...o,ref:n,onCloseAutoFocus:b(t.onCloseAutoFocus,f=>{var x;c.current||(x=i.triggerRef.current)==null||x.focus(),c.current=!1,f.preventDefault()}),onInteractOutside:b(t.onInteractOutside,f=>{const x=f.detail.originalEvent,h=x.button===0&&x.ctrlKey===!0,p=x.button===2||h;(!i.modal||p)&&(c.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Jt.displayName=Xt;var jo="DropdownMenuGroup",vo=r.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...o}=t,i=I(s);return e.jsx(so,{...i,...o,ref:n})});vo.displayName=jo;var wo="DropdownMenuLabel",Qt=r.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...o}=t,i=I(s);return e.jsx(oo,{...i,...o,ref:n})});Qt.displayName=wo;var bo="DropdownMenuItem",Zt=r.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...o}=t,i=I(s);return e.jsx(ao,{...i,...o,ref:n})});Zt.displayName=bo;var No="DropdownMenuCheckboxItem",en=r.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...o}=t,i=I(s);return e.jsx(ro,{...i,...o,ref:n})});en.displayName=No;var Co="DropdownMenuRadioGroup",yo=r.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...o}=t,i=I(s);return e.jsx(io,{...i,...o,ref:n})});yo.displayName=Co;var Mo="DropdownMenuRadioItem",tn=r.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...o}=t,i=I(s);return e.jsx(lo,{...i,...o,ref:n})});tn.displayName=Mo;var So="DropdownMenuItemIndicator",nn=r.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...o}=t,i=I(s);return e.jsx(co,{...i,...o,ref:n})});nn.displayName=So;var Ro="DropdownMenuSeparator",sn=r.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...o}=t,i=I(s);return e.jsx(uo,{...i,...o,ref:n})});sn.displayName=Ro;var _o="DropdownMenuArrow",Po=r.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...o}=t,i=I(s);return e.jsx(mo,{...i,...o,ref:n})});Po.displayName=_o;var Io="DropdownMenuSubTrigger",on=r.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...o}=t,i=I(s);return e.jsx(po,{...i,...o,ref:n})});on.displayName=Io;var Eo="DropdownMenuSubContent",an=r.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...o}=t,i=I(s);return e.jsx(fo,{...i,...o,ref:n,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});an.displayName=Eo;var Do=zt,To=qt,Ao=Wt,rn=Jt,ln=Qt,cn=Zt,dn=en,un=tn,mn=nn,pn=sn,fn=on,hn=an;const Oo=Do,ko=To,Lo=r.forwardRef(({className:t,inset:n,children:s,...o},i)=>e.jsxs(fn,{ref:i,className:M("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[state=open]:bg-accent focus:bg-accent",n&&"pl-8",t),...o,children:[s,e.jsx(Ae,{className:"ml-auto h-4 w-4"})]}));Lo.displayName=fn.displayName;const Fo=r.forwardRef(({className:t,...n},s)=>e.jsx(hn,{ref:s,className:M("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n}));Fo.displayName=hn.displayName;const xn=r.forwardRef(({className:t,sideOffset:n=4,...s},o)=>e.jsx(Ao,{children:e.jsx(rn,{ref:o,sideOffset:n,className:M("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...s})}));xn.displayName=rn.displayName;const De=r.forwardRef(({className:t,inset:n,...s},o)=>e.jsx(cn,{ref:o,className:M("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",n&&"pl-8",t),...s}));De.displayName=cn.displayName;const $o=r.forwardRef(({className:t,children:n,checked:s,...o},i)=>e.jsxs(dn,{ref:i,className:M("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t),checked:s,...o,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(mn,{children:e.jsx(mt,{className:"h-4 w-4"})})}),n]}));$o.displayName=dn.displayName;const Go=r.forwardRef(({className:t,children:n,...s},o)=>e.jsxs(un,{ref:o,className:M("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t),...s,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(mn,{children:e.jsx(xs,{className:"h-2 w-2 fill-current"})})}),n]}));Go.displayName=un.displayName;const gn=r.forwardRef(({className:t,inset:n,...s},o)=>e.jsx(ln,{ref:o,className:M("px-2 py-1.5 text-sm font-semibold",n&&"pl-8",t),...s}));gn.displayName=ln.displayName;const Ko=r.forwardRef(({className:t,...n},s)=>e.jsx(pn,{ref:s,className:M("-mx-1 my-1 h-px bg-muted",t),...n}));Ko.displayName=pn.displayName;const ua=()=>{const[t,n]=r.useState({page:1,limit:20,sort_by:"date",sort_order:"desc",search:""}),{role:s}=ot(),o=s==="admin",[i,a]=r.useState(""),[c,f]=r.useState(),[x,h]=r.useState(!1),[p,d]=r.useState(null),[m,w]=r.useState(new Set),{toast:u}=kn(),{data:g,isLoading:R,isError:S}=Yn(t),N=qn();r.useEffect(()=>{const l=setTimeout(()=>{n(j=>({...j,page:1,search:i}))},500);return()=>clearTimeout(l)},[i]),r.useEffect(()=>{n(l=>({...l,page:1,start:c!=null&&c.from?z(c.from,"yyyy-MM-dd"):void 0,end:c!=null&&c.to?z(c.to,"yyyy-MM-dd"):void 0}))},[c]);const A=l=>{l.preventDefault(),n(j=>({...j,page:1,search:i}))},$=l=>{n(j=>({...j,sort_by:l,sort_order:j.sort_by===l&&j.sort_order==="desc"?"asc":"desc"}))},X=l=>{l===!0&&(g!=null&&g.data)?w(new Set(g.data.map(j=>j.id))):w(new Set)},J=l=>{w(j=>{const C=new Set(j);return C.has(l)?C.delete(l):C.add(l),C})},U=async()=>{if(confirm(`Delete ${m.size} record${m.size!==1?"s":""}?`))try{await N.mutateAsync(Array.from(m)),u({title:"Success",description:`Deleted ${m.size} records`}),w(new Set)}catch(l){u({title:"Error",description:l.message||"Failed to delete records",variant:"destructive"})}},B=(g==null?void 0:g.meta.pages)||1;return e.jsx($n,{fullWidth:!0,children:e.jsxs("div",{className:"flex flex-col h-full space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Shift Records"})}),e.jsx(We,{open:x,onOpenChange:h,children:e.jsxs(Xe,{className:"max-w-2xl",children:[e.jsx(Je,{children:e.jsx(Qe,{children:"Add New Shift Record"})}),e.jsx(et,{onSuccess:()=>h(!1),onCancel:()=>h(!1)})]})}),e.jsx(We,{open:!!p,onOpenChange:l=>!l&&d(null),children:e.jsxs(Xe,{className:"max-w-2xl",children:[e.jsx(Je,{children:e.jsx(Qe,{children:"Edit Shift Record"})}),p&&e.jsx(et,{record:p,onSuccess:()=>d(null),onCancel:()=>d(null)})]})}),e.jsxs("div",{className:"flex items-center space-x-2 flex-wrap gap-y-2",children:[e.jsxs("form",{onSubmit:A,className:"flex-1 min-w-[200px] max-w-sm flex gap-2",children:[e.jsx(F,{placeholder:"Search by name, client, or job...",value:i,onChange:l=>a(l.target.value)}),e.jsx(k,{type:"submit",variant:"secondary",children:e.jsx(ls,{className:"h-4 w-4"})})]}),e.jsxs(ct,{children:[e.jsx(dt,{asChild:!0,children:e.jsxs(k,{id:"date",variant:"outline",className:M("w-[260px] justify-start text-left font-normal",!c&&"text-muted-foreground"),children:[e.jsx(cs,{className:"mr-2 h-4 w-4"}),c!=null&&c.from?c.to?e.jsxs(e.Fragment,{children:[z(c.from,"LLL dd, y")," -"," ",z(c.to,"LLL dd, y")]}):z(c.from,"LLL dd, y"):e.jsx("span",{children:"Pick a date range"})]})}),e.jsx(ut,{className:"w-auto p-0",align:"end",children:e.jsx(ds,{initialFocus:!0,mode:"range",defaultMonth:c==null?void 0:c.from,selected:c,onSelect:f,numberOfMonths:2,captionLayout:"dropdown-buttons",fromYear:2020,toYear:2030})})]}),c&&e.jsx(k,{variant:"ghost",size:"icon",onClick:()=>f(void 0),children:e.jsx(Ln,{className:"h-4 w-4"})}),(o||s==="manager")&&e.jsxs(k,{onClick:()=>h(!0),className:"ml-auto",children:[e.jsx(fs,{className:"mr-2 h-4 w-4"})," Add Record"]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground text-right w-full",children:[(g==null?void 0:g.meta.total)||0," records found"]}),m.size>0&&e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-muted rounded-md border",children:[e.jsxs("span",{className:"text-sm font-medium",children:[m.size," record",m.size!==1?"s":""," selected"]}),e.jsxs(k,{variant:"destructive",size:"sm",onClick:U,disabled:N.isPending,children:[N.isPending?e.jsx(fe,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(ft,{className:"mr-2 h-4 w-4"}),"Delete Selected"]}),e.jsx(k,{variant:"outline",size:"sm",onClick:()=>w(new Set),children:"Clear Selection"})]}),e.jsx("div",{className:"border rounded-md bg-white overflow-x-auto",children:e.jsxs(Gn,{children:[e.jsx(Kn,{children:e.jsxs(te,{children:[e.jsx(O,{className:"w-[40px]",children:e.jsx(lt,{checked:m.size>0&&m.size===(g==null?void 0:g.data.length),onCheckedChange:X})}),e.jsx(O,{className:"w-[30px]"}),e.jsxs(O,{className:"cursor-pointer",onClick:()=>$("date"),children:["Date ",e.jsx(me,{className:"ml-2 h-4 w-4 inline"})]}),e.jsxs(O,{className:"cursor-pointer",onClick:()=>$("full_name"),children:["Employee ",e.jsx(me,{className:"ml-2 h-4 w-4 inline"})]}),e.jsxs(O,{className:"cursor-pointer",onClick:()=>$("client_name"),children:["Client ",e.jsx(me,{className:"ml-2 h-4 w-4 inline"})]}),e.jsxs(O,{className:"hidden md:table-cell cursor-pointer",onClick:()=>$("location"),children:["Location ",e.jsx(me,{className:"ml-2 h-4 w-4 inline"})]}),e.jsx(O,{children:"Shift"}),e.jsx(O,{className:"text-right",children:"Hours"}),o&&e.jsx(O,{className:"text-right",children:"Staff Pay"}),o&&e.jsx(O,{className:"text-right",children:"Client Pay"}),e.jsx(O,{className:"w-[50px]"})]})}),e.jsx(Vn,{children:R?e.jsx(te,{children:e.jsx(P,{colSpan:o?10:8,className:"h-24 text-center",children:e.jsx(fe,{className:"h-6 w-6 animate-spin mx-auto"})})}):S?e.jsx(te,{children:e.jsx(P,{colSpan:o?10:8,className:"h-24 text-center text-red-500",children:"Failed to load records"})}):(g==null?void 0:g.data.length)===0?e.jsx(te,{children:e.jsx(P,{colSpan:o?10:8,className:"h-24 text-center",children:"No records found"})}):g==null?void 0:g.data.map(l=>e.jsx(Vo,{record:l,isAdmin:o,role:s,isSelected:m.has(l.id),onToggleSelect:()=>J(l.id),onEdit:()=>d(l)},l.id))})]})}),B>1&&e.jsx(ht,{children:e.jsxs(xt,{children:[e.jsx(pe,{children:e.jsx(gt,{onClick:()=>n(l=>({...l,page:Math.max(1,l.page-1)})),className:t.page===1?"pointer-events-none opacity-50":"cursor-pointer"})}),e.jsx(pe,{children:e.jsxs("div",{className:"flex items-center justify-center px-4 text-sm font-medium",children:["Page ",t.page," of ",B]})}),e.jsx(pe,{children:e.jsx(jt,{onClick:()=>n(l=>({...l,page:Math.min(B,l.page+1)})),className:t.page===B?"pointer-events-none opacity-50":"cursor-pointer"})})]})})]})})},Vo=({record:t,isAdmin:n,role:s,isSelected:o,onToggleSelect:i,onEdit:a})=>{var p,d,m,w,u;const[c,f]=r.useState(!1),x=Wn(),h=()=>{confirm("Are you sure you want to delete this record?")&&x.mutate(t.id)};return e.jsxs(e.Fragment,{children:[e.jsxs(te,{className:"group",children:[e.jsx(P,{onClick:g=>g.stopPropagation(),children:e.jsx(lt,{checked:o,onCheckedChange:i})}),e.jsx(P,{children:e.jsx(Ns,{open:c,onOpenChange:f,children:e.jsx(Cs,{asChild:!0,children:e.jsxs(k,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",children:[c?e.jsx(us,{className:"h-4 w-4"}):e.jsx(Ae,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Toggle"})]})})})}),e.jsx(P,{className:"font-medium",children:t.date?z(new Date(t.date),"dd MMM yyyy"):"-"}),e.jsx(P,{children:t.fullName}),e.jsx(P,{children:t.clientName}),e.jsx(P,{className:"hidden md:table-cell",children:t.location}),e.jsx(P,{children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm",children:t.shiftName}),e.jsx("span",{className:"text-xs text-muted-foreground",children:t.shiftStart&&t.shiftEnd?`${z(new Date(`1970-01-01T${t.shiftStart}`),"HH:mm")} - ${z(new Date(`1970-01-01T${t.shiftEnd}`),"HH:mm")}`:""})]})}),e.jsx(P,{className:"text-right",children:t.paidHours.toFixed(2)}),n&&e.jsxs(P,{className:"text-right",children:["£",((p=t.totalPay)==null?void 0:p.toFixed(2))||"0.00"]}),n&&e.jsxs(P,{className:"text-right font-medium",children:["£",((d=t.clientNet)==null?void 0:d.toFixed(2))||"0.00"]}),e.jsx(P,{children:(n||s==="manager")&&e.jsxs(Oo,{children:[e.jsx(ko,{asChild:!0,children:e.jsxs(k,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(hs,{className:"h-4 w-4"})]})}),e.jsxs(xn,{align:"end",children:[e.jsx(gn,{children:"Actions"}),e.jsxs(De,{onClick:g=>{g.stopPropagation(),a()},children:[e.jsx(es,{className:"mr-2 h-4 w-4"})," Edit"]}),e.jsxs(De,{onClick:g=>{g.stopPropagation(),h()},className:"text-red-600",children:[e.jsx(ft,{className:"mr-2 h-4 w-4"})," Delete"]})]})]})})]}),e.jsx(te,{className:c?"":"hidden",children:e.jsx(P,{colSpan:n?10:8,className:"p-0 border-b-0",children:e.jsxs("div",{className:`bg-muted/50 p-4 grid grid-cols-1 ${n?"md:grid-cols-3":"md:grid-cols-2"} gap-4 text-sm shadow-inner`,children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Job Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"Site:"}),e.jsx("span",{children:t.site}),e.jsx("span",{className:"text-muted-foreground",children:"Job Name:"}),e.jsx("span",{children:t.jobName}),e.jsx("span",{className:"text-muted-foreground",children:"Status:"}),e.jsx(Un,{variant:"outline",className:"w-fit",children:t.jobStatus||"N/A"}),e.jsx("span",{className:"text-muted-foreground",children:"Self Employed:"}),e.jsx("span",{children:t.selfEmployed?"Yes":"No"})]})]}),n&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Financial Breakdown"}),e.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"Pay Rate:"}),e.jsxs("span",{children:["£",((m=t.hourRate)==null?void 0:m.toFixed(2))||"0.00","/hr"]}),e.jsx("span",{className:"text-muted-foreground",children:"Charge Rate:"}),e.jsxs("span",{children:["£",((w=t.clientHourlyRate)==null?void 0:w.toFixed(2))||"0.00","/hr"]}),e.jsx("span",{className:"text-muted-foreground",children:"Total Charge:"}),e.jsxs("span",{children:["£",((u=t.totalCharge)==null?void 0:u.toFixed(2))||"0.00"]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Metadata"}),e.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"System ID:"}),e.jsx("span",{className:"font-mono text-xs",children:t.id})]})]})]})})})]})};export{ua as default};
