import{d as ye,r as N,e as de,j as e,P as Q,f as Z,g as Ne,h as Ce,i as ke,k as _,b as we,R as T,T as D,l as ee,m as te,n as se,X as Pe,A as Se}from"./index-BGPcJqAi.js";import{B as O}from"./button-B7gA5eLl.js";import{a as Te,P as B,b as $,g as L,c as H,C as re,f as ne,d as ae,i as oe,e as Ae,s as q,h as z}from"./locationUtils-BjqkTGWX.js";import{u as Ee,C as Me,a as ie,S as Fe,b as Oe,c as _e,d as Ie,e as R}from"./select-D9Hbf5dF.js";import{B as le}from"./badge-Dg2Jrivk.js";import{C as M,a as G,b as U,d as F}from"./card-DMedEwoy.js";import{R as Re,A as Ye,C as Be,X as $e,Y as Le,T as He,L as qe,a as ce}from"./AreaChart-CKgPg8rO.js";function K(t,s){return Te(t,-s)}const tt=(t,s)=>{var c,d,n;if(!t)return{revenue:{value:0,change:0,trend:"neutral",text:"No data available"},clientPay:{value:0,change:0,trend:"neutral",text:"No data available"},staffPay:{value:0,change:0,trend:"neutral",text:"No data available"}};const a=t.totalRevenue||0,l=t.avgClientPayPerHour||0,x=t.avgStaffPayPerHour||0,o=((c=t.previousPeriod)==null?void 0:c.totalRevenue)||0,i=((d=t.previousPeriod)==null?void 0:d.avgClientPayPerHour)||0,h=((n=t.previousPeriod)==null?void 0:n.avgStaffPayPerHour)||0,m=(j,k)=>k>0?(j-k)/k*100:0,v=m(a,o),g=m(l,i),f=m(x,h),p=j=>j>0?"up":j<0?"down":"neutral",C=(j,k,P)=>{if(!k)return"No previous data";let w="";return P<=7?w="last week":P<=31?w="last month":P<=93?w="last quarter":w="last period",`${j>0?"+":""}${Math.abs(j).toFixed(1)}% from ${w}`},b=Math.ceil((s.to.getTime()-s.from.getTime())/(1e3*60*60*24)),y=!!t.previousPeriod;return{revenue:{value:a,change:v,trend:p(v),text:C(v,y,b)},clientPay:{value:l,change:g,trend:p(g),text:C(g,y,b)},staffPay:{value:x,change:f,trend:p(f),text:C(f,y,b)}}};var Y="Checkbox",[ze,st]=ye(Y),[Ke,V]=ze(Y);function Xe(t){const{__scopeCheckbox:s,checked:a,children:l,defaultChecked:x,disabled:o,form:i,name:h,onCheckedChange:m,required:v,value:g="on",internal_do_not_use_render:f}=t,[p,C]=ke({prop:a,defaultProp:x??!1,onChange:m,caller:Y}),[b,y]=N.useState(null),[c,d]=N.useState(null),n=N.useRef(!1),j=b?!!i||!!b.closest("form"):!0,k={checked:p,disabled:o,setChecked:C,control:b,setControl:y,name:h,form:i,value:g,hasConsumerStoppedPropagationRef:n,required:v,defaultChecked:A(x)?!1:x,isFormControl:j,bubbleInput:c,setBubbleInput:d};return e.jsx(Ke,{scope:s,...k,children:Ge(f)?f(k):l})}var ue="CheckboxTrigger",xe=N.forwardRef(({__scopeCheckbox:t,onKeyDown:s,onClick:a,...l},x)=>{const{control:o,value:i,disabled:h,checked:m,required:v,setControl:g,setChecked:f,hasConsumerStoppedPropagationRef:p,isFormControl:C,bubbleInput:b}=V(ue,t),y=de(x,g),c=N.useRef(m);return N.useEffect(()=>{const d=o==null?void 0:o.form;if(d){const n=()=>f(c.current);return d.addEventListener("reset",n),()=>d.removeEventListener("reset",n)}},[o,f]),e.jsx(Q.button,{type:"button",role:"checkbox","aria-checked":A(m)?"mixed":m,"aria-required":v,"data-state":je(m),"data-disabled":h?"":void 0,disabled:h,value:i,...l,ref:y,onKeyDown:Z(s,d=>{d.key==="Enter"&&d.preventDefault()}),onClick:Z(a,d=>{f(n=>A(n)?!0:!n),b&&C&&(p.current=d.isPropagationStopped(),p.current||d.stopPropagation())})})});xe.displayName=ue;var J=N.forwardRef((t,s)=>{const{__scopeCheckbox:a,name:l,checked:x,defaultChecked:o,required:i,disabled:h,value:m,onCheckedChange:v,form:g,...f}=t;return e.jsx(Xe,{__scopeCheckbox:a,checked:x,defaultChecked:o,disabled:h,required:i,onCheckedChange:v,name:l,form:g,value:m,internal_do_not_use_render:({isFormControl:p})=>e.jsxs(e.Fragment,{children:[e.jsx(xe,{...f,ref:s,__scopeCheckbox:a}),p&&e.jsx(pe,{__scopeCheckbox:a})]})})});J.displayName=Y;var he="CheckboxIndicator",me=N.forwardRef((t,s)=>{const{__scopeCheckbox:a,forceMount:l,...x}=t,o=V(he,a);return e.jsx(Ne,{present:l||A(o.checked)||o.checked===!0,children:e.jsx(Q.span,{"data-state":je(o.checked),"data-disabled":o.disabled?"":void 0,...x,ref:s,style:{pointerEvents:"none",...t.style}})})});me.displayName=he;var fe="CheckboxBubbleInput",pe=N.forwardRef(({__scopeCheckbox:t,...s},a)=>{const{control:l,hasConsumerStoppedPropagationRef:x,checked:o,defaultChecked:i,required:h,disabled:m,name:v,value:g,form:f,bubbleInput:p,setBubbleInput:C}=V(fe,t),b=de(a,C),y=Ee(o),c=Ce(l);N.useEffect(()=>{const n=p;if(!n)return;const j=window.HTMLInputElement.prototype,P=Object.getOwnPropertyDescriptor(j,"checked").set,w=!x.current;if(y!==o&&P){const I=new Event("click",{bubbles:w});n.indeterminate=A(o),P.call(n,A(o)?!1:o),n.dispatchEvent(I)}},[p,y,o,x]);const d=N.useRef(A(o)?!1:o);return e.jsx(Q.input,{type:"checkbox","aria-hidden":!0,defaultChecked:i??d.current,required:h,disabled:m,name:v,value:g,form:f,...s,tabIndex:-1,ref:b,style:{...s.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});pe.displayName=fe;function Ge(t){return typeof t=="function"}function A(t){return t==="indeterminate"}function je(t){return A(t)?"indeterminate":t?"checked":"unchecked"}const W=N.forwardRef(({className:t,...s},a)=>e.jsx(J,{ref:a,className:_("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),...s,children:e.jsx(me,{className:_("flex items-center justify-center text-current"),children:e.jsx(Me,{className:"h-4 w-4"})})}));W.displayName=J.displayName;const rt=({dateRange:t,onDateRangeChange:s,calendarOpen:a,onCalendarOpenChange:l,tempDateRange:x,onTempDateRangeChange:o,selectedLocations:i=[],onLocationsChange:h})=>{const{role:m,locations:v}=we(),[g,f]=T.useState([]),[p,C]=T.useState(!1);T.useEffect(()=>{(async()=>{try{const u=await fetch(`${Se.SALES_SUMMARY.replace("sales-summary","locations")}`,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});if(u.ok){const S=await u.json();f(m==="admin"?S:S.filter(E=>v.includes(E)))}}catch(u){console.error("Failed to fetch locations:",u)}})()},[m,v]);const b=r=>{h&&(i.includes(r)?h(i.filter(u=>u!==r)):h([...i,r]))},y=r=>{const u=new Date;let S,E;switch(r){case"this-month":S=q(u),E=z(u);break;case"last-month":S=q(K(u,1)),E=z(K(u,1));break;case"last-3-months":S=q(K(u,2)),E=z(u);break;case"this-year":S=new Date(u.getFullYear(),0,1),E=new Date(u.getFullYear(),11,31);break;default:return}s({from:S,to:E})},[c,d]=T.useState(t==null?void 0:t.from),[n,j]=T.useState(t==null?void 0:t.to),[k,P]=T.useState(!1),[w,I]=T.useState(!1);T.useEffect(()=>{d(t==null?void 0:t.from),j(t==null?void 0:t.to)},[t]);const ve=r=>{r&&(d(r),n&&oe(r,n)&&j(void 0))},be=r=>{r&&j(r)},ge=()=>{c&&n&&s({from:c,to:n})};return e.jsx("div",{className:"sticky top-0 z-40 bg-background border-b border-border",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Dashboard"}),e.jsx("p",{className:"text-muted-foreground",children:"Overview of your analytics"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[h&&e.jsxs(B,{open:p,onOpenChange:C,children:[e.jsx($,{asChild:!0,children:e.jsxs(O,{variant:"outline",className:"w-auto min-w-[180px] justify-between text-left font-normal",children:[e.jsx("div",{className:"flex items-center gap-2 overflow-hidden mr-2",children:e.jsx("span",{className:"truncate",children:i.length===0?"All Locations":i.length===1?L(i[0]):`${i.length} locations`})}),e.jsx(ie,{className:"h-4 w-4 opacity-50 shrink-0"})]})}),e.jsx(H,{className:"w-[200px] p-0",align:"start",children:e.jsxs("div",{className:"p-2 max-h-[300px] overflow-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-2 hover:bg-muted rounded-sm cursor-pointer mb-1",onClick:r=>{r.stopPropagation(),h([])},children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(W,{checked:i.length===0,className:"pointer-events-none"}),e.jsx("span",{className:"text-sm font-medium",children:"All Locations"})]}),i.length>0&&e.jsx(O,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs text-muted-foreground hover:text-foreground",onClick:r=>{r.stopPropagation(),h([])},children:"Clear"})]}),e.jsx("div",{className:"h-px bg-border my-1"}),e.jsx(D,{children:g.map(r=>e.jsxs("div",{className:"flex items-center space-x-2 p-2 hover:bg-muted rounded-sm cursor-pointer",onClick:u=>{u.stopPropagation(),b(r)},children:[e.jsx(W,{checked:i.includes(r),className:"pointer-events-none"}),e.jsxs(ee,{children:[e.jsx(te,{asChild:!0,children:e.jsx("span",{className:"text-sm truncate font-medium",children:L(r)})}),e.jsx(se,{side:"right",children:e.jsx("p",{children:r})})]})]},r))})]})})]}),i.length>0&&h&&e.jsx("div",{className:"hidden lg:flex flex-wrap gap-1 items-center max-w-[300px]",children:e.jsxs(D,{children:[i.slice(0,3).map(r=>e.jsxs(ee,{children:[e.jsx(te,{asChild:!0,children:e.jsxs(le,{variant:"secondary",className:"text-[10px] px-1 h-5 gap-1 max-w-[100px] truncate",children:[L(r),e.jsx(Pe,{className:"h-2 w-2 cursor-pointer hover:text-destructive",onClick:u=>{u.stopPropagation(),b(r)}})]})}),e.jsx(se,{children:e.jsx("p",{children:r})})]},r)),i.length>3&&e.jsxs(le,{variant:"secondary",className:"text-[10px] px-1 h-5",children:["+",i.length-3," more"]})]})}),e.jsxs(Fe,{onValueChange:y,children:[e.jsxs(Oe,{className:"w-[140px]",children:[e.jsx(_e,{placeholder:"Quick Select"}),e.jsx(ie,{className:"h-4 w-4 opacity-50"})]}),e.jsxs(Ie,{children:[e.jsx(R,{value:"this-month",children:"This Month"}),e.jsx(R,{value:"last-month",children:"Last Month"}),e.jsx(R,{value:"last-3-months",children:"Last 3 Months"}),e.jsx(R,{value:"this-year",children:"This Year"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(B,{open:k,onOpenChange:P,children:[e.jsx($,{asChild:!0,children:e.jsxs(O,{variant:"outline",className:_("w-[140px] justify-start text-left font-normal",!c&&"text-muted-foreground"),children:[e.jsx(re,{className:"mr-2 h-4 w-4"}),c?ne(c,"LLL dd, y"):"From"]})}),e.jsx(H,{className:"w-auto p-0",align:"start",children:e.jsx("div",{className:"p-3",children:e.jsx(ae,{mode:"single",selected:c,onSelect:ve,initialFocus:!0,captionLayout:"dropdown-buttons",fromYear:new Date().getFullYear()-10,toYear:new Date().getFullYear()+1,disabled:r=>n?oe(r,n):!1,className:"rounded-md border"})})})]}),e.jsx("div",{className:"text-muted-foreground",children:"to"}),e.jsxs(B,{open:w,onOpenChange:I,children:[e.jsx($,{asChild:!0,children:e.jsxs(O,{variant:"outline",className:_("w-[140px] justify-start text-left font-normal",!n&&"text-muted-foreground"),disabled:!c,children:[e.jsx(re,{className:"mr-2 h-4 w-4"}),n?ne(n,"LLL dd, y"):"To"]})}),e.jsx(H,{className:"w-auto p-0",align:"start",children:e.jsx("div",{className:"p-3",children:e.jsx(ae,{mode:"single",selected:n,onSelect:be,initialFocus:!0,captionLayout:"dropdown-buttons",fromYear:c?c.getFullYear():new Date().getFullYear()-10,toYear:new Date().getFullYear()+1,disabled:r=>c?Ae(r,c):!1,className:"rounded-md border"})})})]}),e.jsx(O,{onClick:ge,disabled:!c||!n,className:"ml-2",children:"Apply"})]})]})]})})})};function X({title:t,value:s,change:a,trend:l="neutral"}){return e.jsxs(M,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(G,{className:"flex flex-row items-center justify-between pb-2",children:e.jsx(U,{className:"text-sm font-medium text-muted-foreground",children:t})}),e.jsxs(F,{children:[e.jsx("div",{className:"text-2xl font-bold",children:s}),a&&e.jsx("p",{className:_("text-xs mt-1",l==="up"&&"text-accent",l==="down"&&"text-destructive",l==="neutral"&&"text-muted-foreground"),children:a})]})]})}const nt=({metrics:t})=>e.jsxs("div",{className:"grid gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 w-full",children:[e.jsx(X,{title:"Total Revenue",value:`£${t.revenue.value.toLocaleString()}`,change:t.revenue.text,trend:t.revenue.trend}),e.jsx(X,{title:"Average Client Pay",value:`£${t.clientPay.value.toFixed(2)}`,change:t.clientPay.text,trend:t.clientPay.trend}),e.jsx(X,{title:"Average Staff Pay",value:`£${t.staffPay.value.toFixed(2)}`,change:t.staffPay.text,trend:t.staffPay.trend})]}),at=({salesData:t})=>{var s;return e.jsxs("div",{className:"grid gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 w-full",children:[e.jsx(M,{children:e.jsx(F,{className:"p-6",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Shifts"}),e.jsx("p",{className:"text-2xl font-bold",children:(t==null?void 0:t.totalShifts)||0})]})})})}),e.jsx(M,{children:e.jsx(F,{className:"p-6",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Clients"}),e.jsx("p",{className:"text-2xl font-bold",children:(t==null?void 0:t.totalClients)||0})]})})})}),e.jsx(M,{children:e.jsx(F,{className:"p-6",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Employees"}),e.jsx("p",{className:"text-2xl font-bold",children:(t==null?void 0:t.uniqueEmployees)||0})]})})})}),e.jsx(M,{children:e.jsx(F,{className:"p-6",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Profit Margin"}),e.jsxs("p",{className:"text-2xl font-bold",children:[((s=t==null?void 0:t.profitMargin)==null?void 0:s.toFixed(1))||0,"%"]})]})})})})]})},Ue=({active:t,payload:s,label:a})=>t&&s&&s.length?e.jsxs("div",{className:"bg-background border border-border p-3 rounded-lg shadow-lg",children:[e.jsx("p",{className:"font-semibold text-foreground",children:a}),s.map((l,x)=>e.jsxs("p",{className:"text-sm",style:{color:l.color},children:[l.name,": £",Number(l.value).toLocaleString()]},x))]}):null,ot=({data:t,aggregationLevel:s})=>{const a={dataKey:"display",interval:0};return!t||t.length===0?e.jsxs(M,{children:[e.jsx(G,{children:e.jsx(U,{children:"Revenue vs Cost Trend"})}),e.jsx(F,{children:e.jsx("div",{className:"h-[400px] flex items-center justify-center",children:e.jsx("p",{className:"text-muted-foreground",children:"No data available for the selected period"})})})]}):e.jsxs(M,{children:[e.jsxs(G,{children:[e.jsx(U,{children:"Revenue vs Cost Trend"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[s==="daily"&&"Daily view",s==="weekly"&&"Weekly view",s==="monthly"&&"Monthly view"]})]}),e.jsx(F,{children:e.jsx("div",{className:"h-[400px]",children:e.jsx(Re,{width:"100%",height:"100%",children:e.jsxs(Ye,{data:t,children:[e.jsx(Be,{strokeDasharray:"3 3"}),e.jsx($e,{dataKey:a.dataKey,tick:{fontSize:12},interval:a.interval}),e.jsx(Le,{}),e.jsx(He,{content:e.jsx(Ue,{})}),e.jsx(qe,{}),e.jsx(ce,{type:"monotone",dataKey:"revenue",name:"Revenue",stroke:"hsl(var(--primary))",fill:"hsl(var(--primary))",fillOpacity:.3,strokeWidth:2}),e.jsx(ce,{type:"monotone",dataKey:"cost",name:"Cost",stroke:"hsl(var(--accent))",fill:"hsl(var(--accent))",fillOpacity:.3,strokeWidth:2})]})})})})]})},it=()=>e.jsx("div",{className:"fixed inset-0 bg-background/80 backdrop-blur-sm z-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Loading Dashboard"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Fetching your data..."})]})]})});export{at as A,rt as D,it as L,nt as M,ot as R,tt as c};
