import{c as I,ar as V,u as W,d as q,r as c,j as e,B as G}from"./index-DCuD3XHh.js";import{D as J}from"./DashboardLayout-Dl7t1uB5.js";import{C as A,d as N,a as K,b as Q}from"./card-BAZ-eILp.js";import{D as U}from"./DashboardHeader-CLjqoNSu.js";import{u as X,O as Y}from"./OperationalTrendChart-K_XPg6AH.js";import{u as Z,L as _,R as w}from"./LoadingOverlay-CEZoQqM1.js";import{T as ee,f as se,a as te,b as h,c as b,d as ae,e as x}from"./table-B0CYNCIx.js";import"./users-ZBRnzPAt.js";import"./locationUtils-BsfjINon.js";import"./popover-DcAis7Kp.js";import"./index-3amNeSfr.js";import"./generateCategoricalChart-DZn2t-K_.js";import"./Line-B95c1t4Y.js";import"./AreaChart-DmQeLqPE.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=I("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),je=()=>{const{metricId:i}=V(),D=W(),{dateRange:r,setDateRange:F}=q(),[R,M]=c.useState(!1),[H,O]=c.useState(r),[o,P]=c.useState([]),[l,k]=c.useState([]),n=["revenue","cost","profit","employees"].includes(i||""),d=["shifts","hours","clients","targetAchievement","missedTargets"].includes(i||""),{operationalData:t,isLoading:B}=X(r,o,l),{financialData:a,isLoading:$}=Z(r,o,l),z=n?$:d?B:!1,p=s=>{switch(s){case"revenue":return"Revenue Analysis";case"cost":return"Cost Analysis";case"profit":return"Profit Analysis";case"shifts":return"Shifts Analysis";case"hours":return"Hours Analysis";case"clients":return"Client Analysis";case"employees":return"Employee Analysis";case"targetAchievement":return"Target Achievement Analysis";case"missedTargets":return"Missed Targets Analysis";default:return"Metric Analysis"}},E=(s,u)=>{var v,f,j,y,L,C,S,T;if(!s)return"-";switch(u){case"revenue":return`£${((v=s.revenue)==null?void 0:v.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}))??0}`;case"cost":return`£${((f=s.cost)==null?void 0:f.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}))??0}`;case"profit":const g=s.profit??s.revenue-s.cost;return`£${(g==null?void 0:g.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}))??0}`;case"shifts":return((j=s.totalShifts)==null?void 0:j.toLocaleString())??0;case"hours":return((y=s.paidHours)==null?void 0:y.toLocaleString(void 0,{maximumFractionDigits:1}))??0;case"clients":return((L=s.clientCount)==null?void 0:L.toLocaleString())??0;case"employees":return((C=s.paidHours)==null?void 0:C.toLocaleString(void 0,{maximumFractionDigits:1}))??0;case"targetAchievement":return`${((S=s.achievementPercentage)==null?void 0:S.toFixed(1))??0}%`;case"missedTargets":return`${((T=s.achievementPercentage)==null?void 0:T.toFixed(1))??0}%`;default:return"-"}},m=n?a==null?void 0:a.timeSeries:t==null?void 0:t.timeSeries;return e.jsx(J,{fullWidth:!0,children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx(U,{dateRange:r,onDateRangeChange:F,calendarOpen:R,onCalendarOpenChange:M,tempDateRange:H,onTempDateRangeChange:O,selectedLocations:o,onLocationsChange:P,selectedSites:l,onSitesChange:k}),e.jsxs("div",{className:"flex-1 overflow-auto p-6 space-y-6 relative",children:[z&&e.jsx(_,{}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(G,{variant:"ghost",size:"sm",onClick:()=>D(-1),className:"gap-2",children:[e.jsx(ie,{className:"h-4 w-4"}),"Back"]}),e.jsx("h1",{className:"text-2xl font-bold",children:p(i)})]}),e.jsxs("div",{className:"grid gap-6",children:[n&&e.jsx(w,{data:(a==null?void 0:a.timeSeries)||[],aggregationLevel:(a==null?void 0:a.aggregationLevel)||"monthly",selectedMetric:i}),d&&e.jsx(Y,{data:(t==null?void 0:t.timeSeries)||[],aggregationLevel:(t==null?void 0:t.aggregationLevel)||"monthly",selectedMetric:i}),!n&&!d&&e.jsx(A,{children:e.jsx(N,{className:"pt-6",children:e.jsx("p",{className:"text-muted-foreground",children:"Metric type not recognized or data unavailable."})})}),e.jsxs(A,{children:[e.jsx(K,{children:e.jsx(Q,{children:"Data Breakdown"})}),e.jsx(N,{children:e.jsxs(ee,{children:[e.jsxs(se,{children:["Detailed historical data for ",p(i)]}),e.jsx(te,{children:e.jsxs(h,{children:[e.jsx(b,{children:"Period"}),e.jsx(b,{className:"text-right",children:"Value"})]})}),e.jsx(ae,{children:m&&m.length>0?[...m].reverse().map((s,u)=>e.jsxs(h,{children:[e.jsx(x,{className:"font-medium",children:s.display}),e.jsx(x,{className:"text-right font-medium",children:E(s,i)})]},u)):e.jsx(h,{children:e.jsx(x,{colSpan:2,className:"text-center",children:"No data available"})})})]})})]})]})]})]})})};export{je as default};
