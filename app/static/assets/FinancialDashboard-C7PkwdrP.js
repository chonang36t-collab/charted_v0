import{r as t,a as p,A as f,u as g,j as e}from"./index-BkF6eZqS.js";import{D as x,L as y}from"./DashboardLayout-DxouEvFY.js";import{f as u}from"./popover-VpNf-b-O.js";import{c as v,D as j,L as D,M as w,A as L,R as N}from"./LoadingOverlay-D7OB3x0Y.js";import{B as h}from"./button-Cedjd8aw.js";import{T as S}from"./users-WJDmUz7O.js";import"./select-Dg33NSRy.js";import"./card-C5tkn_9V.js";import"./AreaChart-CGvpsZA3.js";const M=r=>{const[s,l]=t.useState(null),[d,n]=t.useState(!1),{toast:o}=p(),i=async()=>{n(!0);try{const a=new URLSearchParams({start:u(r.from,"yyyy-MM-dd"),end:u(r.to,"yyyy-MM-dd")}),c=await fetch(`${f.SALES_SUMMARY.replace("sales-summary","financial-summary")}?${a}`,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});if(c.ok){const m=await c.json();l(m)}else o({title:"Error",description:"Could not fetch financial data",variant:"destructive"})}catch{o({title:"Error",description:"Failed to connect to server",variant:"destructive"})}finally{n(!1)}};return t.useEffect(()=>{i()},[r]),{financialData:s,isLoading:d,refetch:i}};function k(){const r=g(),[s,l]=t.useState({from:new Date(2025,0,1),to:new Date(2025,8,30)}),[d,n]=t.useState(!1),[o,i]=t.useState(s),{financialData:a,isLoading:c}=M(s),m=v(a,s);return e.jsx(x,{children:e.jsxs("div",{className:"flex flex-col h-screen",children:[e.jsx(j,{dateRange:s,onDateRangeChange:l,calendarOpen:d,onCalendarOpenChange:n,tempDateRange:o,onTempDateRangeChange:i}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-2 px-1 py-1 bg-muted rounded-lg",children:[e.jsxs(h,{variant:"secondary",size:"sm",className:"gap-2 shadow-sm",children:[e.jsx(S,{className:"h-4 w-4"}),"Financial View"]}),e.jsxs(h,{variant:"ghost",size:"sm",className:"gap-2 text-muted-foreground hover:text-foreground",onClick:()=>r("/dashboard/operational"),children:[e.jsx(y,{className:"h-4 w-4"}),"Operational View"]})]})}),c&&e.jsx(D,{}),e.jsx(w,{metrics:m}),e.jsx(L,{salesData:a}),e.jsx(N,{data:(a==null?void 0:a.timeSeries)||[],aggregationLevel:(a==null?void 0:a.aggregationLevel)||"monthly"})]})})]})})}export{k as default};
