import{c as mt,r,j as e,e as R,t as _n,h as Oe,p as pt,v as Ee,P as Y,q as N,w as me,o as re,x as Pn,B as $,b as ft,L as ae,I as K,y as he,z as In,C as ht,D as Dn,E as En,F as Tn,G as An,H as On,J as kn,K as xt,M as Ln,N as gt,O as Fn,Q as $n,U as Gn,V as Kn,W as Vn,Y as Bn,a as Un,Z as Je,$ as Ze,a0 as Qe,a1 as et,a2 as tt,a3 as nt,a4 as st,a5 as at,X as Hn}from"./index-BfZYg0Ju.js";import{b as zn,C as ke,D as Yn}from"./DashboardLayout-p_xBApmi.js";import{T as qn,a as Wn,b as oe,c as F,d as Xn,e as E}from"./table-BKRdpo58.js";import{B as Jn}from"./badge-DB2pPx5B.js";import{u as Zn,a as Qn,b as es,c as ts,d as ns,e as ss}from"./useRecords--kog_bVt.js";import{C as jt}from"./checkbox-dPoeHkqm.js";import{e as as,D as ot,b as rt,c as it,d as lt}from"./dialog-4FWOn46z.js";import{o as os,s as se,c as H,b as ct,u as rs,t as is,C as Ie,P as ls}from"./types-BtjTWkQg.js";import{L as D}from"./label-DBPBdWET.js";import{S as ge,a as je,b as ve,c as we,d as z}from"./select-zRRHvQsI.js";import{C as cs,a as ds,b as us,f as ms,c as ps,d as fs,e as hs,S as xs}from"./command-RYqqZgHV.js";import{P as vt,a as wt,b as bt,f as W,C as gs,d as js}from"./popover-Bb4GKTnQ.js";import{C as Nt,a as vs}from"./index-ZVyVBBoe.js";import{c as Ct,R as ws,I as bs}from"./index-IFMF49pL.js";import{P as Ns}from"./plus-BFUTgLsO.js";import{T as yt}from"./trash-2-Cr4nklwI.js";import{E as Cs}from"./ellipsis-Cgib5So4.js";import"./users-LsBO_p4p.js";import"./useQuery-BQKFlk_N.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=mt("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ys=mt("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),Mt=({className:t,...n})=>e.jsx("nav",{role:"navigation","aria-label":"pagination",className:R("mx-auto flex w-full justify-center",t),...n});Mt.displayName="Pagination";const St=r.forwardRef(({className:t,...n},s)=>e.jsx("ul",{ref:s,className:R("flex flex-row items-center gap-1",t),...n}));St.displayName="PaginationContent";const be=r.forwardRef(({className:t,...n},s)=>e.jsx("li",{ref:s,className:R("",t),...n}));be.displayName="PaginationItem";const Le=({className:t,isActive:n,size:s="icon",...a})=>e.jsx("a",{"aria-current":n?"page":void 0,className:R(_n({variant:n?"outline":"ghost",size:s}),t),...a});Le.displayName="PaginationLink";const Rt=({className:t,...n})=>e.jsxs(Le,{"aria-label":"Go to previous page",size:"default",className:R("gap-1 pl-2.5",t),...n,children:[e.jsx(zn,{className:"h-4 w-4"}),e.jsx("span",{children:"Previous"})]});Rt.displayName="PaginationPrevious";const _t=({className:t,...n})=>e.jsxs(Le,{"aria-label":"Go to next page",size:"default",className:R("gap-1 pr-2.5",t),...n,children:[e.jsx("span",{children:"Next"}),e.jsx(ke,{className:"h-4 w-4"})]});_t.displayName="PaginationNext";var ye="Collapsible",[Ms,xo]=Oe(ye),[Ss,Fe]=Ms(ye),Pt=r.forwardRef((t,n)=>{const{__scopeCollapsible:s,open:a,defaultOpen:i,disabled:o,onOpenChange:l,...p}=t,[x,h]=pt({prop:a,defaultProp:i??!1,onChange:l,caller:ye});return e.jsx(Ss,{scope:s,disabled:o,contentId:Ee(),open:x,onOpenToggle:r.useCallback(()=>h(f=>!f),[h]),children:e.jsx(Y.div,{"data-state":Ge(x),"data-disabled":o?"":void 0,...p,ref:n})})});Pt.displayName=ye;var It="CollapsibleTrigger",Dt=r.forwardRef((t,n)=>{const{__scopeCollapsible:s,...a}=t,i=Fe(It,s);return e.jsx(Y.button,{type:"button","aria-controls":i.contentId,"aria-expanded":i.open||!1,"data-state":Ge(i.open),"data-disabled":i.disabled?"":void 0,disabled:i.disabled,...a,ref:n,onClick:N(t.onClick,i.onOpenToggle)})});Dt.displayName=It;var $e="CollapsibleContent",Rs=r.forwardRef((t,n)=>{const{forceMount:s,...a}=t,i=Fe($e,t.__scopeCollapsible);return e.jsx(me,{present:s||i.open,children:({present:o})=>e.jsx(_s,{...a,ref:n,present:o})})});Rs.displayName=$e;var _s=r.forwardRef((t,n)=>{const{__scopeCollapsible:s,present:a,children:i,...o}=t,l=Fe($e,s),[p,x]=r.useState(a),h=r.useRef(null),f=re(n,h),c=r.useRef(0),m=c.current,v=r.useRef(0),d=v.current,y=l.open||p,P=r.useRef(y),M=r.useRef(void 0);return r.useEffect(()=>{const C=requestAnimationFrame(()=>P.current=!1);return()=>cancelAnimationFrame(C)},[]),Pn(()=>{const C=h.current;if(C){M.current=M.current||{transitionDuration:C.style.transitionDuration,animationName:C.style.animationName},C.style.transitionDuration="0s",C.style.animationName="none";const b=C.getBoundingClientRect();c.current=b.height,v.current=b.width,P.current||(C.style.transitionDuration=M.current.transitionDuration,C.style.animationName=M.current.animationName),x(a)}},[l.open,a]),e.jsx(Y.div,{"data-state":Ge(l.open),"data-disabled":l.disabled?"":void 0,id:l.contentId,hidden:!y,...o,ref:f,style:{"--radix-collapsible-content-height":m?`${m}px`:void 0,"--radix-collapsible-content-width":d?`${d}px`:void 0,...t.style},children:y&&i})});function Ge(t){return t?"open":"closed"}var Ps=Pt;const Is=Ps,Ds=Dt;function De({options:t,value:n,onChange:s,placeholder:a="Select...",searchPlaceholder:i="Search...",emptyMessage:o="No results found.",className:l,disabled:p=!1}){var f;const[x,h]=r.useState(!1);return e.jsxs(vt,{open:x,onOpenChange:h,children:[e.jsx(wt,{asChild:!0,children:e.jsxs($,{variant:"outline",role:"combobox","aria-expanded":x,className:R("w-full justify-between",l),disabled:p,children:[n?(f=t.find(c=>c.value===n))==null?void 0:f.label:a,e.jsx(cs,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(bt,{className:"w-[--radix-popover-trigger-width] p-0",align:"start",children:e.jsxs(ds,{children:[e.jsx(us,{placeholder:i}),e.jsxs(ms,{children:[e.jsx(ps,{children:o}),e.jsx(fs,{children:t.map(c=>e.jsxs(hs,{value:c.label,onSelect:m=>{s(c.value===n?"":c.value),h(!1)},children:[e.jsx(Nt,{className:R("mr-2 h-4 w-4",n===c.value?"opacity-100":"opacity-0")}),c.label]},c.value))})]})]})})]})}const Es=os({date:se().min(1,"Date is required"),employeeId:H.number().min(1,"Employee is required"),clientId:H.number().min(1,"Client is required"),jobId:H.number().min(1,"Job is required"),shiftId:H.number().min(1,"Shift is required"),startTime:se().min(1,"Start time is required"),endTime:se().min(1,"End time is required"),hours:H.number().min(.1,"Hours must be greater than 0"),hourRate:H.number().optional(),clientHourlyRate:H.number().optional(),job_name:se().optional(),role:se().optional(),jobStatus:se().optional(),additions:H.number().optional(),deductions:H.number().optional(),self_employed:ct().optional(),dns:ct().optional()}),dt=({record:t,onSuccess:n,onCancel:s})=>{const{role:a}=ft(),i=a==="admin",{data:o,isLoading:l}=Zn(),p=Qn(),x=es(),[h,f]=r.useState(""),[c,m]=r.useState(""),v=!!t,d=rs({resolver:is(Es),defaultValues:{date:(t==null?void 0:t.date)||new Date().toISOString().split("T")[0],employeeId:void 0,clientId:void 0,jobId:void 0,shiftId:void 0,startTime:t!=null&&t.shiftStart?t.shiftStart.substring(0,5):"09:00",endTime:t!=null&&t.shiftEnd?t.shiftEnd.substring(0,5):"17:00",hours:(t==null?void 0:t.paidHours)||8,hourRate:(t==null?void 0:t.hourRate)||0,clientHourlyRate:(t==null?void 0:t.clientHourlyRate)||0,job_name:(t==null?void 0:t.jobName)||"",role:"Travel Retail Specialist",jobStatus:(t==null?void 0:t.jobStatus)||"Currently Working - Full Airside Pass",additions:0,deductions:0,self_employed:!1,dns:!1}}),y=d.watch("startTime"),P=d.watch("endTime"),M=d.watch("shiftId"),C=r.useMemo(()=>o!=null&&o.jobs?Array.from(new Set(o.jobs.map(u=>u.location).filter(Boolean))):[],[o]),b=r.useMemo(()=>!(o!=null&&o.jobs)||!h?[]:Array.from(new Set(o.jobs.filter(u=>u.location===h).map(u=>u.site).filter(Boolean))),[o,h]);r.useEffect(()=>{if(t&&o){const u=o.employees.find(S=>S.name===t.fullName);u&&d.setValue("employeeId",u.id);const w=o.clients.find(S=>S.name===t.clientName);w&&d.setValue("clientId",w.id);const _=o.shifts.find(S=>S.name===t.shiftName);_&&d.setValue("shiftId",_.id);let A=o.jobs.find(S=>S.name===t.jobName&&S.site===t.site);A||(A=o.jobs.find(S=>S.site===t.site&&S.location===t.location)),A&&(d.setValue("jobId",A.id),f(A.location),m(A.site))}},[t,o,d]),r.useEffect(()=>{if(y&&P){const[u,w]=y.split(":").map(Number),[_,A]=P.split(":").map(Number);let S=u*60+w,O=_*60+A;O<S&&(O+=24*60);const g=(O-S)/60;d.setValue("hours",parseFloat(g.toFixed(2)))}},[y,P,d]),r.useEffect(()=>{var u;if(!v&&M&&(o!=null&&o.shifts)){const w=(u=o.shifts.find(_=>_.id===M))==null?void 0:u.name;w&&d.setValue("job_name",w)}},[M,v,o,d]),r.useEffect(()=>{if(h&&c&&(o!=null&&o.jobs)){const u=o.jobs.find(w=>w.location===h&&w.site===c);u&&d.setValue("jobId",u.id)}},[h,c,o,d]);const Z=u=>{v&&t?x.mutate({id:t.id,...u},{onSuccess:()=>{he.success("Record updated successfully"),n()},onError:w=>{he.error(`Failed to update record: ${w.message}`)}}):p.mutate(u,{onSuccess:()=>{he.success("Record created successfully"),n()},onError:w=>{he.error(`Failed to create record: ${w.message}`)}})},Q=p.isPending||x.isPending;if(l)return e.jsx("div",{className:"flex justify-center p-4",children:e.jsx(ae,{className:"animate-spin"})});const V=(o==null?void 0:o.employees.map(u=>({value:u.id.toString(),label:u.name})))||[],B=(o==null?void 0:o.clients.map(u=>({value:u.id.toString(),label:u.name})))||[],ie=(o==null?void 0:o.shifts.map(u=>({value:u.id.toString(),label:`${u.name} (${u.start.substring(0,5)}-${u.end.substring(0,5)})`})))||[];return e.jsxs("form",{onSubmit:d.handleSubmit(Z),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"date",children:"Date"}),e.jsx(K,{id:"date",type:"date",...d.register("date")}),d.formState.errors.date&&e.jsx("span",{className:"text-red-500 text-xs",children:d.formState.errors.date.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"startTime",children:"Start Time"}),e.jsx(K,{id:"startTime",type:"time",...d.register("startTime")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"endTime",children:"End Time"}),e.jsx(K,{id:"endTime",type:"time",...d.register("endTime")})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(D,{children:["Calculated Hours: ",d.watch("hours")]}),e.jsx(K,{type:"hidden",...d.register("hours")})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{children:"Employee"}),e.jsx(Ie,{control:d.control,name:"employeeId",render:({field:u})=>{var w;return e.jsx(De,{options:V,value:(w=u.value)==null?void 0:w.toString(),onChange:_=>u.onChange(Number(_)),placeholder:"Select Employee...",searchPlaceholder:"Search employees..."})}}),d.formState.errors.employeeId&&e.jsx("span",{className:"text-red-500 text-xs",children:d.formState.errors.employeeId.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{children:"Client"}),e.jsx(Ie,{control:d.control,name:"clientId",render:({field:u})=>{var w;return e.jsx(De,{options:B,value:(w=u.value)==null?void 0:w.toString(),onChange:_=>u.onChange(Number(_)),placeholder:"Select Client...",searchPlaceholder:"Search clients..."})}}),d.formState.errors.clientId&&e.jsx("span",{className:"text-red-500 text-xs",children:d.formState.errors.clientId.message})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{children:"Location"}),e.jsxs(ge,{value:h,onValueChange:u=>{f(u),m("")},children:[e.jsx(je,{children:e.jsx(ve,{placeholder:"Select Location"})}),e.jsx(we,{children:C.map(u=>e.jsx(z,{value:u,children:u},u))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{children:"Site / Terminal"}),e.jsxs(ge,{value:c,onValueChange:m,disabled:!h,children:[e.jsx(je,{children:e.jsx(ve,{placeholder:"Select Site"})}),e.jsx(we,{children:b.map(u=>e.jsx(z,{value:u,children:u},u))})]}),e.jsx("input",{type:"hidden",...d.register("jobId")}),d.formState.errors.jobId&&e.jsx("span",{className:"text-red-500 text-xs",children:"Job Selection Incomplete"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{children:"Shift"}),e.jsx(Ie,{control:d.control,name:"shiftId",render:({field:u})=>{var w;return e.jsx(De,{options:ie,value:(w=u.value)==null?void 0:w.toString(),onChange:_=>u.onChange(Number(_)),placeholder:"Select Shift config...",searchPlaceholder:"Search shifts..."})}}),d.formState.errors.shiftId&&e.jsx("span",{className:"text-red-500 text-xs",children:d.formState.errors.shiftId.message})]}),(i||v)&&e.jsxs("div",{className:"border-t pt-4 grid grid-cols-2 gap-4 bg-muted/20 p-4 rounded-md",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{children:"Role"}),e.jsx(K,{...d.register("role")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{children:"Status"}),e.jsxs(ge,{onValueChange:u=>d.setValue("jobStatus",u),defaultValue:d.getValues("jobStatus"),children:[e.jsx(je,{children:e.jsx(ve,{placeholder:"Status"})}),e.jsxs(we,{children:[e.jsx(z,{value:"Currently Working - Full Airside Pass",children:"Currently Working - Full Airside Pass"}),e.jsx(z,{value:"Completed",children:"Completed"}),e.jsx(z,{value:"Cancelled",children:"Cancelled"})]})]})]}),i&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"hourRate",children:"Pay Rate (£)"}),e.jsx(K,{id:"hourRate",type:"number",step:"0.01",...d.register("hourRate")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"clientHourlyRate",children:"Client Rate (£)"}),e.jsx(K,{id:"clientHourlyRate",type:"number",step:"0.01",...d.register("clientHourlyRate")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"additions",children:"Additions (£)"}),e.jsx(K,{id:"additions",type:"number",step:"0.01",...d.register("additions")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"deductions",children:"Deductions (£)"}),e.jsx(K,{id:"deductions",type:"number",step:"0.01",...d.register("deductions")})]})]})]}),e.jsxs(as,{className:"mt-6 flex justify-between items-center w-full",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:!v&&"Defaults: Role=Travel Retail, Additions=0, Deductions=0"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx($,{type:"button",variant:"outline",onClick:s,children:"Cancel"}),e.jsxs($,{type:"submit",disabled:Q,children:[Q&&e.jsx(ae,{className:"mr-2 h-4 w-4 animate-spin"}),v?"Update Record":"Create Record"]})]})]})]})};var Te=["Enter"," "],Ts=["ArrowDown","PageUp","Home"],Et=["ArrowUp","PageDown","End"],As=[...Ts,...Et],Os={ltr:[...Te,"ArrowRight"],rtl:[...Te,"ArrowLeft"]},ks={ltr:["ArrowLeft"],rtl:["ArrowRight"]},pe="Menu",[de,Ls,Fs]=In(pe),[X,Tt]=Oe(pe,[Fs,ht,Ct]),Me=ht(),At=Ct(),[$s,J]=X(pe),[Gs,fe]=X(pe),Ot=t=>{const{__scopeMenu:n,open:s=!1,children:a,dir:i,onOpenChange:o,modal:l=!0}=t,p=Me(n),[x,h]=r.useState(null),f=r.useRef(!1),c=xt(o),m=Gn(i);return r.useEffect(()=>{const v=()=>{f.current=!0,document.addEventListener("pointerdown",d,{capture:!0,once:!0}),document.addEventListener("pointermove",d,{capture:!0,once:!0})},d=()=>f.current=!1;return document.addEventListener("keydown",v,{capture:!0}),()=>{document.removeEventListener("keydown",v,{capture:!0}),document.removeEventListener("pointerdown",d,{capture:!0}),document.removeEventListener("pointermove",d,{capture:!0})}},[]),e.jsx(Kn,{...p,children:e.jsx($s,{scope:n,open:s,onOpenChange:c,content:x,onContentChange:h,children:e.jsx(Gs,{scope:n,onClose:r.useCallback(()=>c(!1),[c]),isUsingKeyboardRef:f,dir:m,modal:l,children:a})})})};Ot.displayName=pe;var Ks="MenuAnchor",Ke=r.forwardRef((t,n)=>{const{__scopeMenu:s,...a}=t,i=Me(s);return e.jsx(Dn,{...i,...a,ref:n})});Ke.displayName=Ks;var Ve="MenuPortal",[Vs,kt]=X(Ve,{forceMount:void 0}),Lt=t=>{const{__scopeMenu:n,forceMount:s,children:a,container:i}=t,o=J(Ve,n);return e.jsx(Vs,{scope:n,forceMount:s,children:e.jsx(me,{present:s||o.open,children:e.jsx(Vn,{asChild:!0,container:i,children:a})})})};Lt.displayName=Ve;var L="MenuContent",[Bs,Be]=X(L),Ft=r.forwardRef((t,n)=>{const s=kt(L,t.__scopeMenu),{forceMount:a=s.forceMount,...i}=t,o=J(L,t.__scopeMenu),l=fe(L,t.__scopeMenu);return e.jsx(de.Provider,{scope:t.__scopeMenu,children:e.jsx(me,{present:a||o.open,children:e.jsx(de.Slot,{scope:t.__scopeMenu,children:l.modal?e.jsx(Us,{...i,ref:n}):e.jsx(Hs,{...i,ref:n})})})})}),Us=r.forwardRef((t,n)=>{const s=J(L,t.__scopeMenu),a=r.useRef(null),i=re(n,a);return r.useEffect(()=>{const o=a.current;if(o)return En(o)},[]),e.jsx(Ue,{...t,ref:i,trapFocus:s.open,disableOutsidePointerEvents:s.open,disableOutsideScroll:!0,onFocusOutside:N(t.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>s.onOpenChange(!1)})}),Hs=r.forwardRef((t,n)=>{const s=J(L,t.__scopeMenu);return e.jsx(Ue,{...t,ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>s.onOpenChange(!1)})}),zs=Bn("MenuContent.ScrollLock"),Ue=r.forwardRef((t,n)=>{const{__scopeMenu:s,loop:a=!1,trapFocus:i,onOpenAutoFocus:o,onCloseAutoFocus:l,disableOutsidePointerEvents:p,onEntryFocus:x,onEscapeKeyDown:h,onPointerDownOutside:f,onFocusOutside:c,onInteractOutside:m,onDismiss:v,disableOutsideScroll:d,...y}=t,P=J(L,s),M=fe(L,s),C=Me(s),b=At(s),Z=Ls(s),[Q,V]=r.useState(null),B=r.useRef(null),ie=re(n,B,P.onContentChange),u=r.useRef(0),w=r.useRef(""),_=r.useRef(0),A=r.useRef(null),S=r.useRef("right"),O=r.useRef(0),g=d?Fn:r.Fragment,I=d?{as:zs,allowPinchZoom:!0}:void 0,ee=j=>{var ne,We;const k=w.current+j,G=Z().filter(U=>!U.disabled),q=document.activeElement,_e=(ne=G.find(U=>U.ref.current===q))==null?void 0:ne.textValue,Pe=G.map(U=>U.textValue),qe=aa(Pe,k,_e),le=(We=G.find(U=>U.textValue===qe))==null?void 0:We.ref.current;(function U(Xe){w.current=Xe,window.clearTimeout(u.current),Xe!==""&&(u.current=window.setTimeout(()=>U(""),1e3))})(k),le&&setTimeout(()=>le.focus())};r.useEffect(()=>()=>window.clearTimeout(u.current),[]),Tn();const te=r.useCallback(j=>{var G,q;return S.current===((G=A.current)==null?void 0:G.side)&&ra(j,(q=A.current)==null?void 0:q.area)},[]);return e.jsx(Bs,{scope:s,searchRef:w,onItemEnter:r.useCallback(j=>{te(j)&&j.preventDefault()},[te]),onItemLeave:r.useCallback(j=>{var k;te(j)||((k=B.current)==null||k.focus(),V(null))},[te]),onTriggerLeave:r.useCallback(j=>{te(j)&&j.preventDefault()},[te]),pointerGraceTimerRef:_,onPointerGraceIntentChange:r.useCallback(j=>{A.current=j},[]),children:e.jsx(g,{...I,children:e.jsx(An,{asChild:!0,trapped:i,onMountAutoFocus:N(o,j=>{var k;j.preventDefault(),(k=B.current)==null||k.focus({preventScroll:!0})}),onUnmountAutoFocus:l,children:e.jsx(On,{asChild:!0,disableOutsidePointerEvents:p,onEscapeKeyDown:h,onPointerDownOutside:f,onFocusOutside:c,onInteractOutside:m,onDismiss:v,children:e.jsx(ws,{asChild:!0,...b,dir:M.dir,orientation:"vertical",loop:a,currentTabStopId:Q,onCurrentTabStopIdChange:V,onEntryFocus:N(x,j=>{M.isUsingKeyboardRef.current||j.preventDefault()}),preventScrollOnEntryFocus:!0,children:e.jsx(kn,{role:"menu","aria-orientation":"vertical","data-state":en(P.open),"data-radix-menu-content":"",dir:M.dir,...C,...y,ref:ie,style:{outline:"none",...y.style},onKeyDown:N(y.onKeyDown,j=>{const G=j.target.closest("[data-radix-menu-content]")===j.currentTarget,q=j.ctrlKey||j.altKey||j.metaKey,_e=j.key.length===1;G&&(j.key==="Tab"&&j.preventDefault(),!q&&_e&&ee(j.key));const Pe=B.current;if(j.target!==Pe||!As.includes(j.key))return;j.preventDefault();const le=Z().filter(ne=>!ne.disabled).map(ne=>ne.ref.current);Et.includes(j.key)&&le.reverse(),na(le)}),onBlur:N(t.onBlur,j=>{j.currentTarget.contains(j.target)||(window.clearTimeout(u.current),w.current="")}),onPointerMove:N(t.onPointerMove,ue(j=>{const k=j.target,G=O.current!==j.clientX;if(j.currentTarget.contains(k)&&G){const q=j.clientX>O.current?"right":"left";S.current=q,O.current=j.clientX}}))})})})})})})});Ft.displayName=L;var Ys="MenuGroup",He=r.forwardRef((t,n)=>{const{__scopeMenu:s,...a}=t;return e.jsx(Y.div,{role:"group",...a,ref:n})});He.displayName=Ys;var qs="MenuLabel",$t=r.forwardRef((t,n)=>{const{__scopeMenu:s,...a}=t;return e.jsx(Y.div,{...a,ref:n})});$t.displayName=qs;var Ne="MenuItem",ut="menu.itemSelect",Se=r.forwardRef((t,n)=>{const{disabled:s=!1,onSelect:a,...i}=t,o=r.useRef(null),l=fe(Ne,t.__scopeMenu),p=Be(Ne,t.__scopeMenu),x=re(n,o),h=r.useRef(!1),f=()=>{const c=o.current;if(!s&&c){const m=new CustomEvent(ut,{bubbles:!0,cancelable:!0});c.addEventListener(ut,v=>a==null?void 0:a(v),{once:!0}),$n(c,m),m.defaultPrevented?h.current=!1:l.onClose()}};return e.jsx(Gt,{...i,ref:x,disabled:s,onClick:N(t.onClick,f),onPointerDown:c=>{var m;(m=t.onPointerDown)==null||m.call(t,c),h.current=!0},onPointerUp:N(t.onPointerUp,c=>{var m;h.current||(m=c.currentTarget)==null||m.click()}),onKeyDown:N(t.onKeyDown,c=>{const m=p.searchRef.current!=="";s||m&&c.key===" "||Te.includes(c.key)&&(c.currentTarget.click(),c.preventDefault())})})});Se.displayName=Ne;var Gt=r.forwardRef((t,n)=>{const{__scopeMenu:s,disabled:a=!1,textValue:i,...o}=t,l=Be(Ne,s),p=At(s),x=r.useRef(null),h=re(n,x),[f,c]=r.useState(!1),[m,v]=r.useState("");return r.useEffect(()=>{const d=x.current;d&&v((d.textContent??"").trim())},[o.children]),e.jsx(de.ItemSlot,{scope:s,disabled:a,textValue:i??m,children:e.jsx(bs,{asChild:!0,...p,focusable:!a,children:e.jsx(Y.div,{role:"menuitem","data-highlighted":f?"":void 0,"aria-disabled":a||void 0,"data-disabled":a?"":void 0,...o,ref:h,onPointerMove:N(t.onPointerMove,ue(d=>{a?l.onItemLeave(d):(l.onItemEnter(d),d.defaultPrevented||d.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:N(t.onPointerLeave,ue(d=>l.onItemLeave(d))),onFocus:N(t.onFocus,()=>c(!0)),onBlur:N(t.onBlur,()=>c(!1))})})})}),Ws="MenuCheckboxItem",Kt=r.forwardRef((t,n)=>{const{checked:s=!1,onCheckedChange:a,...i}=t;return e.jsx(zt,{scope:t.__scopeMenu,checked:s,children:e.jsx(Se,{role:"menuitemcheckbox","aria-checked":Ce(s)?"mixed":s,...i,ref:n,"data-state":Ye(s),onSelect:N(i.onSelect,()=>a==null?void 0:a(Ce(s)?!0:!s),{checkForDefaultPrevented:!1})})})});Kt.displayName=Ws;var Vt="MenuRadioGroup",[Xs,Js]=X(Vt,{value:void 0,onValueChange:()=>{}}),Bt=r.forwardRef((t,n)=>{const{value:s,onValueChange:a,...i}=t,o=xt(a);return e.jsx(Xs,{scope:t.__scopeMenu,value:s,onValueChange:o,children:e.jsx(He,{...i,ref:n})})});Bt.displayName=Vt;var Ut="MenuRadioItem",Ht=r.forwardRef((t,n)=>{const{value:s,...a}=t,i=Js(Ut,t.__scopeMenu),o=s===i.value;return e.jsx(zt,{scope:t.__scopeMenu,checked:o,children:e.jsx(Se,{role:"menuitemradio","aria-checked":o,...a,ref:n,"data-state":Ye(o),onSelect:N(a.onSelect,()=>{var l;return(l=i.onValueChange)==null?void 0:l.call(i,s)},{checkForDefaultPrevented:!1})})})});Ht.displayName=Ut;var ze="MenuItemIndicator",[zt,Zs]=X(ze,{checked:!1}),Yt=r.forwardRef((t,n)=>{const{__scopeMenu:s,forceMount:a,...i}=t,o=Zs(ze,s);return e.jsx(me,{present:a||Ce(o.checked)||o.checked===!0,children:e.jsx(Y.span,{...i,ref:n,"data-state":Ye(o.checked)})})});Yt.displayName=ze;var Qs="MenuSeparator",qt=r.forwardRef((t,n)=>{const{__scopeMenu:s,...a}=t;return e.jsx(Y.div,{role:"separator","aria-orientation":"horizontal",...a,ref:n})});qt.displayName=Qs;var ea="MenuArrow",Wt=r.forwardRef((t,n)=>{const{__scopeMenu:s,...a}=t,i=Me(s);return e.jsx(Ln,{...i,...a,ref:n})});Wt.displayName=ea;var ta="MenuSub",[go,Xt]=X(ta),ce="MenuSubTrigger",Jt=r.forwardRef((t,n)=>{const s=J(ce,t.__scopeMenu),a=fe(ce,t.__scopeMenu),i=Xt(ce,t.__scopeMenu),o=Be(ce,t.__scopeMenu),l=r.useRef(null),{pointerGraceTimerRef:p,onPointerGraceIntentChange:x}=o,h={__scopeMenu:t.__scopeMenu},f=r.useCallback(()=>{l.current&&window.clearTimeout(l.current),l.current=null},[]);return r.useEffect(()=>f,[f]),r.useEffect(()=>{const c=p.current;return()=>{window.clearTimeout(c),x(null)}},[p,x]),e.jsx(Ke,{asChild:!0,...h,children:e.jsx(Gt,{id:i.triggerId,"aria-haspopup":"menu","aria-expanded":s.open,"aria-controls":i.contentId,"data-state":en(s.open),...t,ref:gt(n,i.onTriggerChange),onClick:c=>{var m;(m=t.onClick)==null||m.call(t,c),!(t.disabled||c.defaultPrevented)&&(c.currentTarget.focus(),s.open||s.onOpenChange(!0))},onPointerMove:N(t.onPointerMove,ue(c=>{o.onItemEnter(c),!c.defaultPrevented&&!t.disabled&&!s.open&&!l.current&&(o.onPointerGraceIntentChange(null),l.current=window.setTimeout(()=>{s.onOpenChange(!0),f()},100))})),onPointerLeave:N(t.onPointerLeave,ue(c=>{var v,d;f();const m=(v=s.content)==null?void 0:v.getBoundingClientRect();if(m){const y=(d=s.content)==null?void 0:d.dataset.side,P=y==="right",M=P?-5:5,C=m[P?"left":"right"],b=m[P?"right":"left"];o.onPointerGraceIntentChange({area:[{x:c.clientX+M,y:c.clientY},{x:C,y:m.top},{x:b,y:m.top},{x:b,y:m.bottom},{x:C,y:m.bottom}],side:y}),window.clearTimeout(p.current),p.current=window.setTimeout(()=>o.onPointerGraceIntentChange(null),300)}else{if(o.onTriggerLeave(c),c.defaultPrevented)return;o.onPointerGraceIntentChange(null)}})),onKeyDown:N(t.onKeyDown,c=>{var v;const m=o.searchRef.current!=="";t.disabled||m&&c.key===" "||Os[a.dir].includes(c.key)&&(s.onOpenChange(!0),(v=s.content)==null||v.focus(),c.preventDefault())})})})});Jt.displayName=ce;var Zt="MenuSubContent",Qt=r.forwardRef((t,n)=>{const s=kt(L,t.__scopeMenu),{forceMount:a=s.forceMount,...i}=t,o=J(L,t.__scopeMenu),l=fe(L,t.__scopeMenu),p=Xt(Zt,t.__scopeMenu),x=r.useRef(null),h=re(n,x);return e.jsx(de.Provider,{scope:t.__scopeMenu,children:e.jsx(me,{present:a||o.open,children:e.jsx(de.Slot,{scope:t.__scopeMenu,children:e.jsx(Ue,{id:p.contentId,"aria-labelledby":p.triggerId,...i,ref:h,align:"start",side:l.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:f=>{var c;l.isUsingKeyboardRef.current&&((c=x.current)==null||c.focus()),f.preventDefault()},onCloseAutoFocus:f=>f.preventDefault(),onFocusOutside:N(t.onFocusOutside,f=>{f.target!==p.trigger&&o.onOpenChange(!1)}),onEscapeKeyDown:N(t.onEscapeKeyDown,f=>{l.onClose(),f.preventDefault()}),onKeyDown:N(t.onKeyDown,f=>{var v;const c=f.currentTarget.contains(f.target),m=ks[l.dir].includes(f.key);c&&m&&(o.onOpenChange(!1),(v=p.trigger)==null||v.focus(),f.preventDefault())})})})})})});Qt.displayName=Zt;function en(t){return t?"open":"closed"}function Ce(t){return t==="indeterminate"}function Ye(t){return Ce(t)?"indeterminate":t?"checked":"unchecked"}function na(t){const n=document.activeElement;for(const s of t)if(s===n||(s.focus(),document.activeElement!==n))return}function sa(t,n){return t.map((s,a)=>t[(n+a)%t.length])}function aa(t,n,s){const i=n.length>1&&Array.from(n).every(h=>h===n[0])?n[0]:n,o=s?t.indexOf(s):-1;let l=sa(t,Math.max(o,0));i.length===1&&(l=l.filter(h=>h!==s));const x=l.find(h=>h.toLowerCase().startsWith(i.toLowerCase()));return x!==s?x:void 0}function oa(t,n){const{x:s,y:a}=t;let i=!1;for(let o=0,l=n.length-1;o<n.length;l=o++){const p=n[o],x=n[l],h=p.x,f=p.y,c=x.x,m=x.y;f>a!=m>a&&s<(c-h)*(a-f)/(m-f)+h&&(i=!i)}return i}function ra(t,n){if(!n)return!1;const s={x:t.clientX,y:t.clientY};return oa(s,n)}function ue(t){return n=>n.pointerType==="mouse"?t(n):void 0}var ia=Ot,la=Ke,ca=Lt,da=Ft,ua=He,ma=$t,pa=Se,fa=Kt,ha=Bt,xa=Ht,ga=Yt,ja=qt,va=Wt,wa=Jt,ba=Qt,Re="DropdownMenu",[Na,jo]=Oe(Re,[Tt]),T=Tt(),[Ca,tn]=Na(Re),nn=t=>{const{__scopeDropdownMenu:n,children:s,dir:a,open:i,defaultOpen:o,onOpenChange:l,modal:p=!0}=t,x=T(n),h=r.useRef(null),[f,c]=pt({prop:i,defaultProp:o??!1,onChange:l,caller:Re});return e.jsx(Ca,{scope:n,triggerId:Ee(),triggerRef:h,contentId:Ee(),open:f,onOpenChange:c,onOpenToggle:r.useCallback(()=>c(m=>!m),[c]),modal:p,children:e.jsx(ia,{...x,open:f,onOpenChange:c,dir:a,modal:p,children:s})})};nn.displayName=Re;var sn="DropdownMenuTrigger",an=r.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,disabled:a=!1,...i}=t,o=tn(sn,s),l=T(s);return e.jsx(la,{asChild:!0,...l,children:e.jsx(Y.button,{type:"button",id:o.triggerId,"aria-haspopup":"menu","aria-expanded":o.open,"aria-controls":o.open?o.contentId:void 0,"data-state":o.open?"open":"closed","data-disabled":a?"":void 0,disabled:a,...i,ref:gt(n,o.triggerRef),onPointerDown:N(t.onPointerDown,p=>{!a&&p.button===0&&p.ctrlKey===!1&&(o.onOpenToggle(),o.open||p.preventDefault())}),onKeyDown:N(t.onKeyDown,p=>{a||(["Enter"," "].includes(p.key)&&o.onOpenToggle(),p.key==="ArrowDown"&&o.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(p.key)&&p.preventDefault())})})})});an.displayName=sn;var ya="DropdownMenuPortal",on=t=>{const{__scopeDropdownMenu:n,...s}=t,a=T(n);return e.jsx(ca,{...a,...s})};on.displayName=ya;var rn="DropdownMenuContent",ln=r.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,i=tn(rn,s),o=T(s),l=r.useRef(!1);return e.jsx(da,{id:i.contentId,"aria-labelledby":i.triggerId,...o,...a,ref:n,onCloseAutoFocus:N(t.onCloseAutoFocus,p=>{var x;l.current||(x=i.triggerRef.current)==null||x.focus(),l.current=!1,p.preventDefault()}),onInteractOutside:N(t.onInteractOutside,p=>{const x=p.detail.originalEvent,h=x.button===0&&x.ctrlKey===!0,f=x.button===2||h;(!i.modal||f)&&(l.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});ln.displayName=rn;var Ma="DropdownMenuGroup",Sa=r.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,i=T(s);return e.jsx(ua,{...i,...a,ref:n})});Sa.displayName=Ma;var Ra="DropdownMenuLabel",cn=r.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,i=T(s);return e.jsx(ma,{...i,...a,ref:n})});cn.displayName=Ra;var _a="DropdownMenuItem",dn=r.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,i=T(s);return e.jsx(pa,{...i,...a,ref:n})});dn.displayName=_a;var Pa="DropdownMenuCheckboxItem",un=r.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,i=T(s);return e.jsx(fa,{...i,...a,ref:n})});un.displayName=Pa;var Ia="DropdownMenuRadioGroup",Da=r.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,i=T(s);return e.jsx(ha,{...i,...a,ref:n})});Da.displayName=Ia;var Ea="DropdownMenuRadioItem",mn=r.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,i=T(s);return e.jsx(xa,{...i,...a,ref:n})});mn.displayName=Ea;var Ta="DropdownMenuItemIndicator",pn=r.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,i=T(s);return e.jsx(ga,{...i,...a,ref:n})});pn.displayName=Ta;var Aa="DropdownMenuSeparator",fn=r.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,i=T(s);return e.jsx(ja,{...i,...a,ref:n})});fn.displayName=Aa;var Oa="DropdownMenuArrow",ka=r.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,i=T(s);return e.jsx(va,{...i,...a,ref:n})});ka.displayName=Oa;var La="DropdownMenuSubTrigger",hn=r.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,i=T(s);return e.jsx(wa,{...i,...a,ref:n})});hn.displayName=La;var Fa="DropdownMenuSubContent",xn=r.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,i=T(s);return e.jsx(ba,{...i,...a,ref:n,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});xn.displayName=Fa;var $a=nn,Ga=an,Ka=on,gn=ln,jn=cn,vn=dn,wn=un,bn=mn,Nn=pn,Cn=fn,yn=hn,Mn=xn;const Va=$a,Ba=Ga,Ua=r.forwardRef(({className:t,inset:n,children:s,...a},i)=>e.jsxs(yn,{ref:i,className:R("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[state=open]:bg-accent focus:bg-accent",n&&"pl-8",t),...a,children:[s,e.jsx(ke,{className:"ml-auto h-4 w-4"})]}));Ua.displayName=yn.displayName;const Ha=r.forwardRef(({className:t,...n},s)=>e.jsx(Mn,{ref:s,className:R("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n}));Ha.displayName=Mn.displayName;const Sn=r.forwardRef(({className:t,sideOffset:n=4,...s},a)=>e.jsx(Ka,{children:e.jsx(gn,{ref:a,sideOffset:n,className:R("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...s})}));Sn.displayName=gn.displayName;const Ae=r.forwardRef(({className:t,inset:n,...s},a)=>e.jsx(vn,{ref:a,className:R("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",n&&"pl-8",t),...s}));Ae.displayName=vn.displayName;const za=r.forwardRef(({className:t,children:n,checked:s,...a},i)=>e.jsxs(wn,{ref:i,className:R("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t),checked:s,...a,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Nn,{children:e.jsx(Nt,{className:"h-4 w-4"})})}),n]}));za.displayName=wn.displayName;const Ya=r.forwardRef(({className:t,children:n,...s},a)=>e.jsxs(bn,{ref:a,className:R("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t),...s,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Nn,{children:e.jsx(ys,{className:"h-2 w-2 fill-current"})})}),n]}));Ya.displayName=bn.displayName;const Rn=r.forwardRef(({className:t,inset:n,...s},a)=>e.jsx(jn,{ref:a,className:R("px-2 py-1.5 text-sm font-semibold",n&&"pl-8",t),...s}));Rn.displayName=jn.displayName;const qa=r.forwardRef(({className:t,...n},s)=>e.jsx(Cn,{ref:s,className:R("-mx-1 my-1 h-px bg-muted",t),...n}));qa.displayName=Cn.displayName;const vo=()=>{const[t,n]=r.useState({page:1,limit:20,sort_by:"date",sort_order:"desc",search:""}),{role:s}=ft(),a=s==="admin",[i,o]=r.useState(""),[l,p]=r.useState(),[x,h]=r.useState(!1),[f,c]=r.useState(null),[m,v]=r.useState(new Set),[d,y]=r.useState(null),[P,M]=r.useState(!1),{toast:C}=Un(),{data:b,isLoading:Z,isError:Q}=ts(t),V=ns(),B=ss();r.useEffect(()=>{const g=setTimeout(()=>{n(I=>({...I,page:1,search:i}))},500);return()=>clearTimeout(g)},[i]),r.useEffect(()=>{n(g=>({...g,page:1,start:l!=null&&l.from?W(l.from,"yyyy-MM-dd"):void 0,end:l!=null&&l.to?W(l.to,"yyyy-MM-dd"):void 0}))},[l]);const ie=g=>{g.preventDefault(),n(I=>({...I,page:1,search:i}))},u=g=>{n(I=>({...I,sort_by:g,sort_order:I.sort_by===g&&I.sort_order==="desc"?"asc":"desc"}))},w=g=>{g===!0&&(b!=null&&b.data)?v(new Set(b.data.map(I=>I.id))):v(new Set)},_=g=>{v(I=>{const ee=new Set(I);return ee.has(g)?ee.delete(g):ee.add(g),ee})},A=async()=>{try{await V.mutateAsync(Array.from(m)),C({title:"Success",description:`Deleted ${m.size} records`}),v(new Set),M(!1)}catch(g){C({title:"Error",description:g.message||"Failed to delete records",variant:"destructive"}),M(!1)}},S=async()=>{if(d)try{await B.mutateAsync(d),C({title:"Success",description:"Record deleted"}),y(null)}catch(g){C({title:"Error",description:g.message||"Failed to delete record",variant:"destructive"})}},O=(b==null?void 0:b.meta.pages)||1;return e.jsx(Yn,{fullWidth:!0,children:e.jsxs("div",{className:"flex flex-col h-full space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Shift Records"})}),e.jsx(ot,{open:x,onOpenChange:h,children:e.jsxs(rt,{className:"max-w-2xl",children:[e.jsx(it,{children:e.jsx(lt,{children:"Add New Shift Record"})}),e.jsx(dt,{onSuccess:()=>h(!1),onCancel:()=>h(!1)})]})}),e.jsx(ot,{open:!!f,onOpenChange:g=>!g&&c(null),children:e.jsxs(rt,{className:"max-w-2xl",children:[e.jsx(it,{children:e.jsx(lt,{children:"Edit Shift Record"})}),f&&e.jsx(dt,{record:f,onSuccess:()=>c(null),onCancel:()=>c(null)})]})}),e.jsx(Je,{open:P,onOpenChange:M,children:e.jsxs(Ze,{children:[e.jsxs(Qe,{children:[e.jsx(et,{children:"Are you absolutely sure?"}),e.jsxs(tt,{children:["This action cannot be undone. This will permanently delete ",m.size," records."]})]}),e.jsxs(nt,{children:[e.jsx(st,{children:"Cancel"}),e.jsxs(at,{onClick:A,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:[V.isPending?e.jsx(ae,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Delete"]})]})]})}),e.jsx(Je,{open:!!d,onOpenChange:g=>!g&&y(null),children:e.jsxs(Ze,{children:[e.jsxs(Qe,{children:[e.jsx(et,{children:"Are you absolutely sure?"}),e.jsx(tt,{children:"This action cannot be undone. This will permanently delete this record."})]}),e.jsxs(nt,{children:[e.jsx(st,{children:"Cancel"}),e.jsxs(at,{onClick:S,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:[B.isPending?e.jsx(ae,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Delete"]})]})]})}),e.jsxs("div",{className:"flex items-center space-x-2 flex-wrap gap-y-2",children:[e.jsxs("form",{onSubmit:ie,className:"flex-1 min-w-[200px] max-w-sm flex gap-2",children:[e.jsx(K,{placeholder:"Search by name, client, or job...",value:i,onChange:g=>o(g.target.value)}),e.jsx($,{type:"submit",variant:"secondary",children:e.jsx(xs,{className:"h-4 w-4"})})]}),e.jsxs(vt,{children:[e.jsx(wt,{asChild:!0,children:e.jsxs($,{id:"date",variant:"outline",className:R("w-[260px] justify-start text-left font-normal",!l&&"text-muted-foreground"),children:[e.jsx(gs,{className:"mr-2 h-4 w-4"}),l!=null&&l.from?l.to?e.jsxs(e.Fragment,{children:[W(l.from,"LLL dd, y")," -"," ",W(l.to,"LLL dd, y")]}):W(l.from,"LLL dd, y"):e.jsx("span",{children:"Pick a date range"})]})}),e.jsx(bt,{className:"w-auto p-0",align:"end",children:e.jsx(js,{initialFocus:!0,mode:"range",defaultMonth:l==null?void 0:l.from,selected:l,onSelect:p,numberOfMonths:2,captionLayout:"dropdown-buttons",fromYear:2020,toYear:2030})})]}),l&&e.jsx($,{variant:"ghost",size:"icon",onClick:()=>p(void 0),children:e.jsx(Hn,{className:"h-4 w-4"})}),(a||s==="manager")&&e.jsxs($,{onClick:()=>h(!0),className:"ml-auto",children:[e.jsx(Ns,{className:"mr-2 h-4 w-4"})," Add Record"]})]}),e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Rows per page:"}),e.jsxs(ge,{value:t.limit.toString(),onValueChange:g=>n(I=>({...I,page:1,limit:parseInt(g)})),children:[e.jsx(je,{className:"h-8 w-[70px]",children:e.jsx(ve,{placeholder:t.limit.toString()})}),e.jsxs(we,{children:[e.jsx(z,{value:"10",children:"10"}),e.jsx(z,{value:"20",children:"20"}),e.jsx(z,{value:"50",children:"50"}),e.jsx(z,{value:"100",children:"100"})]})]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[(b==null?void 0:b.meta.total)||0," records found"]})]}),m.size>0&&e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-muted rounded-md border",children:[e.jsxs("span",{className:"text-sm font-medium",children:[m.size," record",m.size!==1?"s":""," selected"]}),e.jsxs($,{variant:"destructive",size:"sm",onClick:()=>M(!0),disabled:V.isPending,children:[V.isPending?e.jsx(ae,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(yt,{className:"mr-2 h-4 w-4"}),"Delete Selected"]}),e.jsx($,{variant:"outline",size:"sm",onClick:()=>v(new Set),children:"Clear Selection"})]}),e.jsx("div",{className:"border rounded-md bg-white overflow-x-auto",children:e.jsxs(qn,{children:[e.jsx(Wn,{children:e.jsxs(oe,{children:[e.jsx(F,{className:"w-[40px]",children:e.jsx(jt,{checked:m.size>0&&m.size===(b==null?void 0:b.data.length),onCheckedChange:w})}),e.jsx(F,{className:"w-[30px]"}),e.jsxs(F,{className:"cursor-pointer",onClick:()=>u("date"),children:["Date ",e.jsx(xe,{className:"ml-2 h-4 w-4 inline"})]}),e.jsxs(F,{className:"cursor-pointer",onClick:()=>u("full_name"),children:["Employee ",e.jsx(xe,{className:"ml-2 h-4 w-4 inline"})]}),e.jsxs(F,{className:"cursor-pointer",onClick:()=>u("client_name"),children:["Client ",e.jsx(xe,{className:"ml-2 h-4 w-4 inline"})]}),e.jsxs(F,{className:"hidden md:table-cell cursor-pointer",onClick:()=>u("location"),children:["Location ",e.jsx(xe,{className:"ml-2 h-4 w-4 inline"})]}),e.jsx(F,{children:"Shift"}),e.jsx(F,{className:"text-right",children:"Hours"}),a&&e.jsx(F,{className:"text-right",children:"Staff Pay"}),a&&e.jsx(F,{className:"text-right",children:"Client Pay"}),e.jsx(F,{className:"w-[50px]"})]})}),e.jsx(Xn,{children:Z?e.jsx(oe,{children:e.jsx(E,{colSpan:a?10:8,className:"h-24 text-center",children:e.jsx(ae,{className:"h-6 w-6 animate-spin mx-auto"})})}):Q?e.jsx(oe,{children:e.jsx(E,{colSpan:a?10:8,className:"h-24 text-center text-red-500",children:"Failed to load records"})}):(b==null?void 0:b.data.length)===0?e.jsx(oe,{children:e.jsx(E,{colSpan:a?10:8,className:"h-24 text-center",children:"No records found"})}):b==null?void 0:b.data.map(g=>e.jsx(Wa,{record:g,isAdmin:a,role:s,isSelected:m.has(g.id),onToggleSelect:()=>_(g.id),onEdit:()=>c(g),onDeleteClick:()=>y(g.id)},g.id))})]})}),O>1&&e.jsx(Mt,{children:e.jsxs(St,{children:[e.jsx(be,{children:e.jsx(Rt,{onClick:()=>n(g=>({...g,page:Math.max(1,g.page-1)})),className:t.page===1?"pointer-events-none opacity-50":"cursor-pointer"})}),e.jsx(be,{children:e.jsxs("div",{className:"flex items-center justify-center px-4 text-sm font-medium",children:["Page ",t.page," of ",O]})}),e.jsx(be,{children:e.jsx(_t,{onClick:()=>n(g=>({...g,page:Math.min(O,g.page+1)})),className:t.page===O?"pointer-events-none opacity-50":"cursor-pointer"})})]})})]})})},Wa=({record:t,isAdmin:n,role:s,isSelected:a,onToggleSelect:i,onEdit:o,onDeleteClick:l})=>{var h,f,c,m,v;const[p,x]=r.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs(oe,{className:"group",children:[e.jsx(E,{onClick:d=>d.stopPropagation(),children:e.jsx(jt,{checked:a,onCheckedChange:i})}),e.jsx(E,{children:e.jsx(Is,{open:p,onOpenChange:x,children:e.jsx(Ds,{asChild:!0,children:e.jsxs($,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",children:[p?e.jsx(vs,{className:"h-4 w-4"}):e.jsx(ke,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Toggle"})]})})})}),e.jsx(E,{className:"font-medium",children:t.date?W(new Date(t.date),"dd MMM yyyy"):"-"}),e.jsx(E,{children:t.fullName}),e.jsx(E,{children:t.clientName}),e.jsx(E,{className:"hidden md:table-cell",children:t.location}),e.jsx(E,{children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm",children:t.shiftName}),e.jsx("span",{className:"text-xs text-muted-foreground",children:t.shiftStart&&t.shiftEnd?`${W(new Date(`1970-01-01T${t.shiftStart}`),"HH:mm")} - ${W(new Date(`1970-01-01T${t.shiftEnd}`),"HH:mm")}`:""})]})}),e.jsx(E,{className:"text-right",children:t.paidHours.toFixed(2)}),n&&e.jsxs(E,{className:"text-right",children:["£",((h=t.totalPay)==null?void 0:h.toFixed(2))||"0.00"]}),n&&e.jsxs(E,{className:"text-right font-medium",children:["£",((f=t.clientNet)==null?void 0:f.toFixed(2))||"0.00"]}),e.jsx(E,{children:(n||s==="manager")&&e.jsxs(Va,{children:[e.jsx(Ba,{asChild:!0,children:e.jsxs($,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(Cs,{className:"h-4 w-4"})]})}),e.jsxs(Sn,{align:"end",children:[e.jsx(Rn,{children:"Actions"}),e.jsxs(Ae,{onClick:d=>{d.stopPropagation(),o()},children:[e.jsx(ls,{className:"mr-2 h-4 w-4"})," Edit"]}),e.jsxs(Ae,{onClick:d=>{d.stopPropagation(),l()},className:"text-red-600",children:[e.jsx(yt,{className:"mr-2 h-4 w-4"})," Delete"]})]})]})})]}),e.jsx(oe,{className:p?"":"hidden",children:e.jsx(E,{colSpan:n?10:8,className:"p-0 border-b-0",children:e.jsxs("div",{className:`bg-muted/50 p-4 grid grid-cols-1 ${n?"md:grid-cols-3":"md:grid-cols-2"} gap-4 text-sm shadow-inner`,children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Job Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"Site:"}),e.jsx("span",{children:t.site}),e.jsx("span",{className:"text-muted-foreground",children:"Job Name:"}),e.jsx("span",{children:t.jobName}),e.jsx("span",{className:"text-muted-foreground",children:"Status:"}),e.jsx(Jn,{variant:"outline",className:"w-fit",children:t.jobStatus||"N/A"}),e.jsx("span",{className:"text-muted-foreground",children:"Self Employed:"}),e.jsx("span",{children:t.selfEmployed?"Yes":"No"})]})]}),n&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Financial Breakdown"}),e.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"Pay Rate:"}),e.jsxs("span",{children:["£",((c=t.hourRate)==null?void 0:c.toFixed(2))||"0.00","/hr"]}),e.jsx("span",{className:"text-muted-foreground",children:"Charge Rate:"}),e.jsxs("span",{children:["£",((m=t.clientHourlyRate)==null?void 0:m.toFixed(2))||"0.00","/hr"]}),e.jsx("span",{className:"text-muted-foreground",children:"Total Charge:"}),e.jsxs("span",{children:["£",((v=t.totalCharge)==null?void 0:v.toFixed(2))||"0.00"]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Metadata"}),e.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"System ID:"}),e.jsx("span",{className:"font-mono text-xs",children:t.id})]})]})]})})})]})};export{vo as default};
