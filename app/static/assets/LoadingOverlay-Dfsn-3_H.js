import{e as ke,r as y,f as fe,j as e,P as se,g as ae,h as Pe,i as we,k as Se,l as $,b as Ee,R as w,T as oe,m as ie,n as le,o as ce,X as de,A as ue}from"./index-X6n8QLQ6.js";import{B as A}from"./button-CvIZVJXF.js";import{a as Te,P as X,b as G,g as W,c as K,C as he,f as xe,d as me,i as pe,e as Ie,s as Z,h as D}from"./locationUtils-3wBueozB.js";import{u as Oe,C as _e,a as ee,S as Fe,b as Ae,c as He,d as Me,e as Q}from"./select-D8IUDuCg.js";import{B as V}from"./badge-UXmziVSu.js";import{C as qe,a as Be,b as Ye,d as $e}from"./card-DwLgY9GA.js";function te(t,i){return Te(t,-i)}const We=(t,i)=>{var S,u,f,I,E,O,H,v,q,C,M,R,L,z,U;if(!t)return{revenue:{value:0,change:0,trend:"neutral",text:"No data available"},clientPay:{value:0,change:0,trend:"neutral",text:"No data available"},staffPay:{value:0,change:0,trend:"neutral",text:"No data available"},totalShifts:{value:0,change:0,trend:"neutral",text:"No data available"},paidHours:{value:0,change:0,trend:"neutral",text:"No data available"},uniqueEmployees:{value:0,change:0,trend:"neutral",text:"No data available"},avgShiftDuration:{value:0,change:0,trend:"neutral",text:"No data available"},totalClients:{value:0,change:0,trend:"neutral",text:"No data available"}};const l=t.totalRevenue||0,h=t.avgClientPayPerHour||0,g=t.avgStaffPayPerHour||0,o=((S=t.previousPeriod)==null?void 0:S.totalRevenue)||0,a=((u=t.previousPeriod)==null?void 0:u.avgClientPayPerHour)||0,x=((f=t.previousPeriod)==null?void 0:f.avgStaffPayPerHour)||0,r=(T,F)=>F>0?(T-F)/F*100:0,c=r(l,o),N=r(h,a),m=r(g,x),d=T=>T>0?"up":T<0?"down":"neutral",j=(T,F,B)=>{if(!F)return"No previous data";let s="";return B<=7?s="last week":B<=31?s="last month":B<=93?s="last quarter":s="last period",`${T>0?"+":""}${Math.abs(T).toFixed(1)}% from ${s}`},p=Math.ceil((i.to.getTime()-i.from.getTime())/(1e3*60*60*24)),b=!!t.previousPeriod;return{revenue:{value:l,change:c,trend:d(c),text:j(c,b,p)},clientPay:{value:h,change:N,trend:d(N),text:j(N,b,p)},staffPay:{value:g,change:m,trend:d(m),text:j(m,b,p)},totalShifts:{value:t.totalShifts,change:r(t.totalShifts,((I=t.previousPeriod)==null?void 0:I.totalShifts)||0),trend:d(r(t.totalShifts,((E=t.previousPeriod)==null?void 0:E.totalShifts)||0)),text:j(r(t.totalShifts,((O=t.previousPeriod)==null?void 0:O.totalShifts)||0),b,p)},paidHours:{value:t.totalPaidHours||0,change:r(t.totalPaidHours||0,((H=t.previousPeriod)==null?void 0:H.totalPaidHours)||0)||0,trend:d(r(t.totalPaidHours||0,((v=t.previousPeriod)==null?void 0:v.totalPaidHours)||0)),text:j(r(t.totalPaidHours||0,((q=t.previousPeriod)==null?void 0:q.totalPaidHours)||0),b,p)},uniqueEmployees:{value:t.uniqueEmployees,change:r(t.uniqueEmployees,((C=t.previousPeriod)==null?void 0:C.uniqueEmployees)||0),trend:d(r(t.uniqueEmployees,((M=t.previousPeriod)==null?void 0:M.uniqueEmployees)||0)),text:j(r(t.uniqueEmployees,((R=t.previousPeriod)==null?void 0:R.uniqueEmployees)||0),b,p)},avgShiftDuration:{value:t.totalPaidHours&&t.totalShifts?t.totalPaidHours/t.totalShifts:0,change:0,trend:"neutral",text:"Average hours per shift"},totalClients:{value:t.totalClients,change:r(t.totalClients,((L=t.previousPeriod)==null?void 0:L.totalClients)||0),trend:d(r(t.totalClients,((z=t.previousPeriod)==null?void 0:z.totalClients)||0)),text:j(r(t.totalClients,((U=t.previousPeriod)==null?void 0:U.totalClients)||0),b,p)}}};var J="Checkbox",[Re,Ze]=ke(J),[Le,re]=Re(J);function ze(t){const{__scopeCheckbox:i,checked:l,children:h,defaultChecked:g,disabled:o,form:a,name:x,onCheckedChange:r,required:c,value:N="on",internal_do_not_use_render:m}=t,[d,j]=Se({prop:l,defaultProp:g??!1,onChange:r,caller:J}),[p,b]=y.useState(null),[S,u]=y.useState(null),f=y.useRef(!1),I=p?!!a||!!p.closest("form"):!0,E={checked:d,disabled:o,setChecked:j,control:p,setControl:b,name:x,form:a,value:N,hasConsumerStoppedPropagationRef:f,required:c,defaultChecked:_(g)?!1:g,isFormControl:I,bubbleInput:S,setBubbleInput:u};return e.jsx(Le,{scope:i,...E,children:Ue(m)?m(E):h})}var ve="CheckboxTrigger",ge=y.forwardRef(({__scopeCheckbox:t,onKeyDown:i,onClick:l,...h},g)=>{const{control:o,value:a,disabled:x,checked:r,required:c,setControl:N,setChecked:m,hasConsumerStoppedPropagationRef:d,isFormControl:j,bubbleInput:p}=re(ve,t),b=fe(g,N),S=y.useRef(r);return y.useEffect(()=>{const u=o==null?void 0:o.form;if(u){const f=()=>m(S.current);return u.addEventListener("reset",f),()=>u.removeEventListener("reset",f)}},[o,m]),e.jsx(se.button,{type:"button",role:"checkbox","aria-checked":_(r)?"mixed":r,"aria-required":c,"data-state":ye(r),"data-disabled":x?"":void 0,disabled:x,value:a,...h,ref:b,onKeyDown:ae(i,u=>{u.key==="Enter"&&u.preventDefault()}),onClick:ae(l,u=>{m(f=>_(f)?!0:!f),p&&j&&(d.current=u.isPropagationStopped(),d.current||u.stopPropagation())})})});ge.displayName=ve;var ne=y.forwardRef((t,i)=>{const{__scopeCheckbox:l,name:h,checked:g,defaultChecked:o,required:a,disabled:x,value:r,onCheckedChange:c,form:N,...m}=t;return e.jsx(ze,{__scopeCheckbox:l,checked:g,defaultChecked:o,disabled:x,required:a,onCheckedChange:c,name:h,form:N,value:r,internal_do_not_use_render:({isFormControl:d})=>e.jsxs(e.Fragment,{children:[e.jsx(ge,{...m,ref:i,__scopeCheckbox:l}),d&&e.jsx(Ce,{__scopeCheckbox:l})]})})});ne.displayName=J;var je="CheckboxIndicator",be=y.forwardRef((t,i)=>{const{__scopeCheckbox:l,forceMount:h,...g}=t,o=re(je,l);return e.jsx(Pe,{present:h||_(o.checked)||o.checked===!0,children:e.jsx(se.span,{"data-state":ye(o.checked),"data-disabled":o.disabled?"":void 0,...g,ref:i,style:{pointerEvents:"none",...t.style}})})});be.displayName=je;var Ne="CheckboxBubbleInput",Ce=y.forwardRef(({__scopeCheckbox:t,...i},l)=>{const{control:h,hasConsumerStoppedPropagationRef:g,checked:o,defaultChecked:a,required:x,disabled:r,name:c,value:N,form:m,bubbleInput:d,setBubbleInput:j}=re(Ne,t),p=fe(l,j),b=Oe(o),S=we(h);y.useEffect(()=>{const f=d;if(!f)return;const I=window.HTMLInputElement.prototype,O=Object.getOwnPropertyDescriptor(I,"checked").set,H=!g.current;if(b!==o&&O){const v=new Event("click",{bubbles:H});f.indeterminate=_(o),O.call(f,_(o)?!1:o),f.dispatchEvent(v)}},[d,b,o,g]);const u=y.useRef(_(o)?!1:o);return e.jsx(se.input,{type:"checkbox","aria-hidden":!0,defaultChecked:a??u.current,required:x,disabled:r,name:c,value:N,form:m,...i,tabIndex:-1,ref:p,style:{...i.style,...S,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});Ce.displayName=Ne;function Ue(t){return typeof t=="function"}function _(t){return t==="indeterminate"}function ye(t){return _(t)?"indeterminate":t?"checked":"unchecked"}const Y=y.forwardRef(({className:t,...i},l)=>e.jsx(ne,{ref:l,className:$("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),...i,children:e.jsx(be,{className:$("flex items-center justify-center text-current"),children:e.jsx(_e,{className:"h-4 w-4"})})}));Y.displayName=ne.displayName;const De=({dateRange:t,onDateRangeChange:i,calendarOpen:l,onCalendarOpenChange:h,tempDateRange:g,onTempDateRangeChange:o,selectedLocations:a=[],onLocationsChange:x,selectedSites:r=[],onSitesChange:c})=>{const{role:N,locations:m}=Ee(),[d,j]=w.useState([]),[p,b]=w.useState([]),[S,u]=w.useState(!1),[f,I]=w.useState(!1);w.useEffect(()=>{(async()=>{try{const n=await fetch(`${ue.SALES_SUMMARY.replace("sales-summary","locations")}`,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`},credentials:"include"});if(n.ok){const k=await n.json();j(N==="admin"?k:k.filter(P=>m.includes(P)))}}catch(n){console.error("Failed to fetch locations:",n)}})()},[N,m]),w.useEffect(()=>{c&&(async()=>{try{const n=new URLSearchParams;a.length>0&&a.forEach(P=>n.append("locations",P));const k=await fetch(`${ue.SITES}?${n}`,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`},credentials:"include"});if(k.ok){const P=await k.json();b(P)}}catch(n){console.error("Failed to fetch sites:",n)}})()},[a,c]);const E=s=>{x&&(a.includes(s)?x(a.filter(n=>n!==s)):x([...a,s]))},O=s=>{c&&(r.includes(s)?c(r.filter(n=>n!==s)):c([...r,s]))},H=s=>{const n=new Date;let k,P;switch(s){case"this-month":k=Z(n),P=D(n);break;case"last-month":k=Z(te(n,1)),P=D(te(n,1));break;case"last-3-months":k=Z(te(n,2)),P=D(n);break;case"this-year":k=new Date(n.getFullYear(),0,1),P=new Date(n.getFullYear(),11,31);break;default:return}i({from:k,to:P})},[v,q]=w.useState(t==null?void 0:t.from),[C,M]=w.useState(t==null?void 0:t.to),[R,L]=w.useState(!1),[z,U]=w.useState(!1);w.useEffect(()=>{q(t==null?void 0:t.from),M(t==null?void 0:t.to)},[t]);const T=s=>{s&&(q(s),C&&pe(s,C)&&M(void 0))},F=s=>{s&&M(s)},B=()=>{v&&C&&i({from:v,to:C})};return e.jsx("div",{className:"sticky top-0 z-40 bg-background border-b border-border",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Dashboard"}),e.jsx("p",{className:"text-muted-foreground",children:"Overview of your analytics"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-end",children:[x&&e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Location"}),e.jsxs(X,{open:S,onOpenChange:u,children:[e.jsx(G,{asChild:!0,children:e.jsxs(A,{variant:"outline",className:"w-[180px] justify-between text-left font-normal",children:[e.jsx("div",{className:"flex items-center gap-2 overflow-hidden mr-2",children:e.jsx("span",{className:"truncate",children:a.length===0?"All Locations":a.length===1?W(a[0]):`${a.length} locations`})}),e.jsx(ee,{className:"h-4 w-4 opacity-50 shrink-0"})]})}),e.jsx(K,{className:"w-[200px] p-0",align:"start",children:e.jsxs("div",{className:"p-2 max-h-[300px] overflow-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-2 hover:bg-muted rounded-sm cursor-pointer mb-1",onClick:s=>{s.stopPropagation(),x([])},children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Y,{checked:a.length===0,className:"pointer-events-none"}),e.jsx("span",{className:"text-sm font-medium",children:"All Locations"})]}),a.length>0&&e.jsx(A,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs text-muted-foreground hover:text-foreground",onClick:s=>{s.stopPropagation(),x([])},children:"Clear"})]}),e.jsx("div",{className:"h-px bg-border my-1"}),e.jsx(oe,{children:d.map(s=>e.jsxs("div",{className:"flex items-center space-x-2 p-2 hover:bg-muted rounded-sm cursor-pointer",onClick:n=>{n.stopPropagation(),E(s)},children:[e.jsx(Y,{checked:a.includes(s),className:"pointer-events-none"}),e.jsxs(ie,{children:[e.jsx(le,{asChild:!0,children:e.jsx("span",{className:"text-sm truncate font-medium",children:W(s)})}),e.jsx(ce,{side:"right",children:e.jsx("p",{children:s})})]})]},s))})]})})]}),a.length>0&&e.jsx("div",{className:"hidden lg:flex flex-wrap gap-1 items-center max-w-[180px]",children:e.jsxs(oe,{children:[a.slice(0,2).map(s=>e.jsxs(ie,{children:[e.jsx(le,{asChild:!0,children:e.jsxs(V,{variant:"secondary",className:"text-[10px] px-1 h-5 gap-1 max-w-[85px] truncate",children:[W(s),e.jsx(de,{className:"h-2 w-2 cursor-pointer hover:text-destructive",onClick:n=>{n.stopPropagation(),E(s)}})]})}),e.jsx(ce,{children:e.jsx("p",{children:s})})]},s)),a.length>2&&e.jsxs(V,{variant:"secondary",className:"text-[10px] px-1 h-5",children:["+",a.length-2]})]})})]}),c&&e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Site"}),e.jsxs(X,{open:f,onOpenChange:I,children:[e.jsx(G,{asChild:!0,children:e.jsxs(A,{variant:"outline",className:"w-[180px] justify-between text-left font-normal",children:[e.jsx("div",{className:"flex items-center gap-2 overflow-hidden mr-2",children:e.jsx("span",{className:"truncate",children:r.length===0?"All Sites":`${r.length} sites`})}),e.jsx(ee,{className:"h-4 w-4 opacity-50 shrink-0"})]})}),e.jsx(K,{className:"w-[200px] p-0",align:"start",children:e.jsxs("div",{className:"p-2 max-h-[300px] overflow-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-2 hover:bg-muted rounded-sm cursor-pointer mb-1",onClick:s=>{s.stopPropagation(),c([])},children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Y,{checked:r.length===0,className:"pointer-events-none"}),e.jsx("span",{className:"text-sm font-medium",children:"All Sites"})]}),r.length>0&&e.jsx(A,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs text-muted-foreground hover:text-foreground",onClick:s=>{s.stopPropagation(),c([])},children:"Clear"})]}),e.jsx("div",{className:"h-px bg-border my-1"}),p.map(s=>e.jsxs("div",{className:"flex items-center space-x-2 p-2 hover:bg-muted rounded-sm cursor-pointer",onClick:n=>{n.stopPropagation(),O(s)},children:[e.jsx(Y,{checked:r.includes(s),className:"pointer-events-none"}),e.jsx("span",{className:"text-sm truncate font-medium",children:s})]},s))]})})]}),r.length>0&&e.jsx("div",{className:"hidden lg:flex flex-wrap gap-1 items-center max-w-[180px]",children:r.length<=2?r.map(s=>e.jsxs(V,{variant:"secondary",className:"text-[10px] px-1 h-5 gap-1 max-w-[85px] truncate",children:[s,e.jsx(de,{className:"h-2 w-2 cursor-pointer hover:text-destructive",onClick:n=>{n.stopPropagation(),O(s)}})]},s)):e.jsxs(V,{variant:"secondary",className:"text-[10px] px-1 h-5",children:[r.length," selected"]})})]}),e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Range"}),e.jsxs(Fe,{onValueChange:H,children:[e.jsxs(Ae,{className:"w-[140px]",children:[e.jsx(He,{placeholder:"Quick Select"}),e.jsx(ee,{className:"h-4 w-4 opacity-50"})]}),e.jsxs(Me,{children:[e.jsx(Q,{value:"this-month",children:"This Month"}),e.jsx(Q,{value:"last-month",children:"Last Month"}),e.jsx(Q,{value:"last-3-months",children:"Last 3 Months"}),e.jsx(Q,{value:"this-year",children:"This Year"})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"From Date"}),e.jsxs(X,{open:R,onOpenChange:L,children:[e.jsx(G,{asChild:!0,children:e.jsxs(A,{variant:"outline",className:$("w-[140px] justify-start text-left font-normal",!v&&"text-muted-foreground"),children:[e.jsx(he,{className:"mr-2 h-4 w-4"}),v?xe(v,"LLL dd, y"):"From"]})}),e.jsx(K,{className:"w-auto p-0",align:"start",children:e.jsx("div",{className:"p-3",children:e.jsx(me,{mode:"single",selected:v,onSelect:T,initialFocus:!0,captionLayout:"dropdown-buttons",fromYear:new Date().getFullYear()-10,toYear:new Date().getFullYear()+1,disabled:s=>C?pe(s,C):!1,className:"rounded-md border"})})})]})]}),e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Till Date"}),e.jsxs(X,{open:z,onOpenChange:U,children:[e.jsx(G,{asChild:!0,children:e.jsxs(A,{variant:"outline",className:$("w-[140px] justify-start text-left font-normal",!C&&"text-muted-foreground"),disabled:!v,children:[e.jsx(he,{className:"mr-2 h-4 w-4"}),C?xe(C,"LLL dd, y"):"To"]})}),e.jsx(K,{className:"w-auto p-0",align:"start",children:e.jsx("div",{className:"p-3",children:e.jsx(me,{mode:"single",selected:C,onSelect:F,initialFocus:!0,captionLayout:"dropdown-buttons",fromYear:v?v.getFullYear():new Date().getFullYear()-10,toYear:new Date().getFullYear()+1,disabled:s=>v?Ie(s,v):!1,className:"rounded-md border"})})})]})]}),e.jsxs("div",{className:"flex flex-col gap-1.5 pb-0.5",children:[e.jsx("div",{className:"h-4"})," ",e.jsx(A,{onClick:B,disabled:!v||!C,className:"",children:"Apply"})]})]})]})})})};function et({title:t,value:i,change:l,trend:h="neutral"}){return e.jsxs(qe,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(Be,{className:"flex flex-row items-center justify-between pb-2",children:e.jsx(Ye,{className:"text-sm font-medium text-muted-foreground",children:t})}),e.jsxs($e,{children:[e.jsx("div",{className:"text-2xl font-bold",children:i}),l&&e.jsx("p",{className:$("text-xs mt-1",h==="up"&&"text-accent",h==="down"&&"text-destructive",h==="neutral"&&"text-muted-foreground"),children:l})]})]})}const tt=()=>e.jsx("div",{className:"fixed inset-0 bg-background/80 backdrop-blur-sm z-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Loading Dashboard"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Fetching your data..."})]})]})});export{De as D,tt as L,et as M,We as c};
