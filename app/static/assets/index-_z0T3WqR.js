import{ab as F,r as x,j as e,T as te,e as T,B as D,I as $,k as se,l as re,m as ae,ac as le}from"./index-DdLQU5_r.js";import{D as oe,T as ne}from"./DashboardLayout-BflXQeTW.js";import{L as ie}from"./label-B-RbAI8k.js";import{T as I}from"./trash-2-Bgind0oR.js";import{e as ce,C as de,b as ue}from"./calendar-CbdeFDz3.js";import{f as P,s as fe,P as me,a as be,b as pe}from"./popover-CnjvlIlM.js";import{D as z,a as B,b as J,c as K,d as G,e as V}from"./dialog-BLZ9UZvE.js";import{P as U}from"./plus-LyDG4la4.js";import"./users-DZ5VoTY_.js";function he(t,r){const i=F(t.start),s=F(t.end);let p=+i>+s;const j=p?+i:+s,c=p?s:i;c.setHours(0,0,0,0),c.setDate(1);let u=1;const g=[];for(;+c<=j;)g.push(F(c)),c.setMonth(c.getMonth()+u);return p?g.reverse():g}function xe(t){const r=F(t),i=r.getFullYear();return r.setFullYear(i+1,0,0),r.setHours(23,59,59,999),r}function ye(t,r){return t===null||t===0?"":r.isPercentage?`${t.toFixed(2)}%`:r.isCurrency?`Â£${t.toLocaleString("en-GB",{minimumFractionDigits:2,maximumFractionDigits:2})}`:t.toLocaleString("en-GB",{maximumFractionDigits:2})}function ge({source:t,formula:r,value:i}){return e.jsxs("div",{className:"text-xs space-y-1",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Source:"})," ",t||"Unknown"]}),r&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Formula:"}),e.jsx("code",{className:"bg-muted px-1 rounded ml-1",children:r})]})]})}function Ce({rowId:t,colId:r,value:i,row:s,isActive:p,source:j,onFocus:c,onUpdate:u,onNavigate:g}){const[A,n]=x.useState(!1),[d,y]=x.useState(""),o=x.useRef(null),C=x.useCallback(()=>{n(!0),y(i!==null?String(i):""),setTimeout(()=>{var v;return(v=o.current)==null?void 0:v.focus()},0)},[i]),_=x.useCallback(()=>{n(!1);const v=parseFloat(d);u(d===""?null:isNaN(v)?i:v)},[d,u,i]),N=x.useCallback(v=>{v.key==="Enter"?_():v.key==="Escape"&&n(!1)},[_]);return x.useEffect(()=>{if(p&&!A){const v=l=>{["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(l.key)?(l.preventDefault(),g({ArrowUp:"up",ArrowDown:"down",ArrowLeft:"left",ArrowRight:"right"}[l.key])):!l.ctrlKey&&!l.altKey&&!l.metaKey&&l.key.length===1?(C(),y("")):l.key==="Enter"?(l.preventDefault(),C()):(l.key==="Backspace"||l.key==="Delete")&&u(null)};return window.addEventListener("keydown",v),()=>window.removeEventListener("keydown",v)}},[p,A,g,C,u]),A?e.jsx("input",{ref:o,type:"text",className:"w-full h-full px-2 py-1 outline-none bg-background text-center font-lato",value:d,onChange:v=>y(v.target.value),onBlur:_,onKeyDown:N}):e.jsxs(se,{children:[e.jsx(re,{asChild:!0,children:e.jsx("div",{className:T("w-full h-full px-2 py-1 cursor-cell flex items-center justify-center font-lato",s.isHeader&&"font-bold"),onClick:c,onDoubleClick:C,children:ye(i,s)})}),j&&e.jsx(ae,{children:e.jsx(ge,{source:j,value:i})})]})}function _e(t){let r="",i=t;for(;i>=0;)r=String.fromCharCode(i%26+65)+r,i=Math.floor(i/26)-1;return r}function je({rows:t,columns:r,data:i,activeCell:s,setActiveCell:p,updateCell:j,deleteRow:c,deleteColumn:u,navigateCell:g,updateRowFormula:A,renameColumn:n}){const[d,y]=x.useState(null);return e.jsxs("div",{className:"flex-1 overflow-auto relative border border-border rounded-md bg-background",children:[e.jsx(te,{children:e.jsxs("table",{className:"w-full border-collapse table-fixed text-sm",children:[e.jsxs("thead",{className:"sticky top-0 z-20 bg-muted/90 backdrop-blur-sm shadow-sm",children:[e.jsxs("tr",{children:[e.jsx("th",{className:"w-12 border-b border-border bg-muted p-1 text-center text-xs text-muted-foreground font-normal select-none relative group",children:e.jsx("div",{className:"absolute inset-0 bg-muted/50"})}),e.jsx("th",{className:"w-64 border-b border-r border-border bg-muted p-2 text-left font-medium text-muted-foreground"}),r.map((o,C)=>e.jsx("th",{className:"border-b border-r border-border bg-muted p-1 text-center text-xs font-normal text-muted-foreground select-none relative min-w-[120px]",children:_e(C)},`excel-${C}`))]}),e.jsxs("tr",{children:[e.jsx("th",{className:"w-12 border-b border-border bg-background p-2"}),e.jsx("th",{className:"w-64 border-b border-r border-border bg-background p-2 text-left font-semibold text-foreground",children:"Metric / Account"}),r.map(o=>e.jsx("th",{className:T("relative border-b border-r border-border bg-background p-2 text-right font-semibold min-w-[120px]",o.isYearEnd?"text-primary/80 bg-primary/5":"text-foreground"),children:e.jsxs("div",{className:"flex items-center justify-end gap-2 group",children:[e.jsx("span",{className:"cursor-pointer hover:text-primary transition-colors py-1",onDoubleClick:()=>!o.isProtected&&y({id:o.id,type:"col",value:o.label}),children:o.label}),!o.isProtected&&e.jsx(D,{variant:"ghost",size:"icon",className:"h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity absolute top-1 right-1",onClick:()=>u(o.id),children:e.jsx(I,{className:"h-3 w-3 text-destructive"})})]})},o.id))]})]}),e.jsx("tbody",{children:t.map((o,C)=>e.jsxs("tr",{className:"group/row hover:bg-muted/30 transition-colors",children:[e.jsx("td",{className:"border-r border-b border-border bg-muted/30 p-2 text-center text-xs text-muted-foreground font-mono select-none sticky left-0 z-10 w-12 text-lato",children:C+1}),e.jsx("td",{className:"border-r border-b border-border p-2 font-medium bg-background relative w-64",children:e.jsxs("div",{className:"flex items-center justify-between group",children:[o.isHeader?e.jsx("span",{className:"font-bold text-primary",children:o.label}):e.jsx("span",{className:"cursor-pointer hover:text-primary transition-colors w-full",onDoubleClick:()=>!o.isAutoCalculated&&y({id:o.id,type:"row",value:o.label}),children:o.label}),!o.isAutoCalculated&&e.jsx(D,{variant:"ghost",size:"icon",className:"h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity absolute right-2",onClick:()=>c(o.id),children:e.jsx(I,{className:"h-3 w-3 text-destructive"})})]})}),r.map(_=>{var a;const N=(a=i[o.id])==null?void 0:a[_.id],v=(N==null?void 0:N.value)??null,l=(s==null?void 0:s.row)===o.id&&(s==null?void 0:s.col)===_.id;return e.jsx("td",{className:T("border-r border-b border-border p-0 relative min-w-[120px]",l?"ring-2 ring-primary z-10":"",o.isHeader?"bg-muted/20 font-semibold":"",_.isYearEnd?"bg-primary/5 font-semibold":""),onClick:()=>p({row:o.id,col:_.id}),children:e.jsx(Ce,{rowId:o.id,colId:_.id,value:v,row:o,isActive:l,onFocus:()=>p({row:o.id,col:_.id}),onUpdate:b=>j(o.id,_.id,b),onNavigate:g})},`${o.id}-${_.id}`)})]},o.id))})]})}),d&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-background/80 backdrop-blur-sm",onClick:()=>y(null),children:e.jsxs("div",{className:"bg-card p-4 rounded-lg shadow-lg border w-96",onClick:o=>o.stopPropagation(),children:[e.jsxs(ie,{children:["Edit ",d.type==="row"?"Row":"Column"," Label"]}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx($,{autoFocus:!0,value:d.value,onChange:o=>y({...d,value:o.target.value}),onKeyDown:o=>{o.key==="Enter"&&(d.type==="col"&&n&&n(d.id,d.value),y(null))}}),e.jsx(D,{onClick:()=>y(null),children:"Done"})]})]})})]})}const L=t=>{if(!(t!=null&&t.from)||!(t!=null&&t.to))return new Date().getFullYear(),[{id:"jan",label:"January",isProtected:!0},{id:"feb",label:"February",isProtected:!0},{id:"mar",label:"March",isProtected:!0},{id:"apr",label:"April",isProtected:!0},{id:"may",label:"May",isProtected:!0},{id:"jun",label:"June",isProtected:!0},{id:"jul",label:"July",isProtected:!0},{id:"aug",label:"August",isProtected:!0},{id:"sep",label:"September",isProtected:!0},{id:"oct",label:"October",isProtected:!0},{id:"nov",label:"November",isProtected:!0},{id:"dec",label:"December",isProtected:!0},{id:"year_end",label:"Year End",isProtected:!0,isYearEnd:!0}];const i=he({start:le(t.from),end:ce(t.to)}).map(s=>({id:P(s,"MMM-yyyy").toLowerCase(),label:P(s,"MMM yyyy"),isProtected:!0}));return i.push({id:"year_end",label:"Period Total",isProtected:!0,isYearEnd:!0}),i},R=(t,r,i)=>{var s,p;try{const j=Object.keys(r).sort((g,A)=>A.length-g.length);let c=t;for(const g of j){const A=new RegExp(`\\b${g}\\b`,"g");if(A.test(c)){const n=((p=(s=r[g])==null?void 0:s[i])==null?void 0:p.value)??0;c=c.replace(A,`(${n})`)}}if(!/^[0-9+\-*/().\s]*$/.test(c))return null;const u=new Function(`return ${c}`)();return typeof u=="number"&&!isNaN(u)&&isFinite(u)?u:null}catch{return null}},Y=[{id:"total_sales",label:"Total Sales",isAutoCalculated:!1,isCurrency:!0},{id:"sales_split_pct",label:"% Sales Split for the Year",isAutoCalculated:!1,isPercentage:!0},{id:"cost_sales_se",label:"Cost of Sales SE",isAutoCalculated:!1,isCurrency:!0},{id:"cost_sales_paye",label:"Cost of Sales PAYE Gross",isAutoCalculated:!1,isCurrency:!0},{id:"employee_ni",label:"Employee NI",isAutoCalculated:!1,isCurrency:!0},{id:"employee_pension",label:"Employee Pension",isAutoCalculated:!1,isCurrency:!0},{id:"total_cost_sales",label:"Total Cost of Sales",isAutoCalculated:!0,isCurrency:!0,isHeader:!0,formulaString:"cost_sales_se + cost_sales_paye + employee_ni + employee_pension"},{id:"apprenticeship_levy",label:"Apprenticeship Levy",isAutoCalculated:!1,isCurrency:!0},{id:"annual_leave",label:"Annual Leave Accrual",isAutoCalculated:!1,isCurrency:!0},{id:"other_expenses",label:"Other Expenses",isAutoCalculated:!1,isCurrency:!0},{id:"recruitment_cost",label:"Recruitment & Pass Cost",isAutoCalculated:!1,isCurrency:!0},{id:"overheads_mgmt",label:"Mgmt & Office Cost",isAutoCalculated:!1,isCurrency:!0},{id:"bank_interest",label:"Bank Interest",isAutoCalculated:!1,isCurrency:!0},{id:"cooperation_tax",label:"Cooperation Tax",isAutoCalculated:!1,isCurrency:!0},{id:"total_overheads",label:"Total Overheads",isAutoCalculated:!0,isCurrency:!0,isHeader:!0,formulaString:"apprenticeship_levy + annual_leave + other_expenses + recruitment_cost + overheads_mgmt + bank_interest + cooperation_tax"},{id:"total_cost",label:"Total Cost",isAutoCalculated:!0,isCurrency:!0,isHeader:!0,formulaString:"total_cost_sales + total_overheads"},{id:"avg_hourly_charge",label:"Avg Hourly Charge",isAutoCalculated:!1,isCurrency:!0},{id:"gross_hourly_pay",label:"Gross Hourly Pay",isAutoCalculated:!1,isCurrency:!0},{id:"gross_hourly_margin",label:"Gross Hourly Margin",isAutoCalculated:!0,isCurrency:!0,formulaString:"avg_hourly_charge - gross_hourly_pay"},{id:"net_cost_per_hour",label:"Net Cost per Hour",isAutoCalculated:!1,isCurrency:!0},{id:"gross_pl_value",label:"Gross P&L",isAutoCalculated:!1,isCurrency:!0},{id:"net_pl",label:"Net P&L",isAutoCalculated:!1,isCurrency:!0},{id:"total_net_margin",label:"Total Net Margin",isAutoCalculated:!1,isPercentage:!0},{id:"worked_hours",label:"Worked Hours",isAutoCalculated:!1},{id:"hours_breakeven",label:"Hours for Breakeven",isAutoCalculated:!0,formula:(t,r,i)=>{var j,c,u,g;const s=((c=(j=t.total_cost)==null?void 0:j[i])==null?void 0:c.value)??0,p=((g=(u=t.gross_hourly_margin)==null?void 0:u[i])==null?void 0:g.value)??0;return p!==0?s/p:0}},{id:"value_breakeven",label:"Total Value for Breakeven",isAutoCalculated:!0,isCurrency:!0,formulaString:"hours_breakeven * avg_hourly_charge"},{id:"sales_budget_2026",label:"Projeted Sales Budget 30% Uplift",isAutoCalculated:!0,isCurrency:!0,formulaString:"total_sales * 1.3"},{id:"avg_hourly_charge_2026",label:"Avg Hourly Charge Rate Future",isAutoCalculated:!1,isCurrency:!0},{id:"sales_target_hours",label:"Sales Target in Hours",isAutoCalculated:!1},{id:"variance_2025",label:"Variance",isAutoCalculated:!1,isCurrency:!0}];function W(t,r){const i={};for(const s of t){i[s.id]={};for(const p of r)i[s.id][p.id]={value:null,isEditable:!s.isAutoCalculated&&!p.isYearEnd,source:"manual"}}return i}function S(t,r,i){var g,A;const s=JSON.parse(JSON.stringify(t));for(const n of i.filter(d=>!d.isYearEnd))for(const d of r)d.formulaString?s[d.id][n.id]={...s[d.id][n.id],value:R(d.formulaString,s,n.id),isEditable:!1,source:"calculated"}:d.formula&&(s[d.id][n.id]={...s[d.id][n.id],value:d.formula(s,d.id,n.id),isEditable:!1,source:"calculated"});const p=r.find(n=>n.id==="total_sales"),j=r.find(n=>n.id==="sales_split_pct"),c=i.find(n=>n.isYearEnd);if(p&&j&&c){let n=0;const d=i.filter(y=>!y.isYearEnd);n=d.reduce((y,o)=>{var C,_;return y+(((_=(C=s.total_sales)==null?void 0:C[o.id])==null?void 0:_.value)??0)},0);for(const y of d){const o=((A=(g=s.total_sales)==null?void 0:g[y.id])==null?void 0:A.value)??0,C=n!==0?o/n*100:0;s.sales_split_pct[y.id]={value:C,isEditable:!1,source:"calculated"}}s.sales_split_pct[c.id]={value:n!==0?100:0,isEditable:!1,source:"calculated"}}const u=i.find(n=>n.isYearEnd);if(u)for(const n of r){if(n.id==="sales_split_pct")continue;const d=i.filter(y=>!y.isYearEnd).reduce((y,o)=>{var C,_;return y+(((_=(C=s[n.id])==null?void 0:C[o.id])==null?void 0:_.value)??0)},0);n.formulaString||n.isAutoCalculated?n.formulaString?s[n.id][u.id]={value:R(n.formulaString,s,u.id),isEditable:!1,source:"calculated"}:n.formula?s[n.id][u.id]={value:n.formula(s,n.id,u.id),isEditable:!1,source:"calculated"}:s[n.id][u.id]={value:d,isEditable:!1,source:"calculated"}:s[n.id][u.id]={value:d,isEditable:!1,source:"calculated"}}return s}function ve(t){const[r,i]=x.useState(Y),[s,p]=x.useState(()=>L(t)),[j,c]=x.useState(()=>S(W(Y,L(t)),Y,L(t))),[u,g]=x.useState(null);x.useEffect(()=>{const l=L(t);p(l);let a=W(r,l);t!=null&&t.from&&(t!=null&&t.to)?(async()=>{try{const m=P(t.from,"yyyy-MM-dd"),f=P(t.to,"yyyy-MM-dd"),k=localStorage.getItem("auth_token"),h=await fetch(`/api/financial-summary/metrics?start=${m}&end=${f}`,{headers:{Authorization:`Bearer ${k}`},credentials:"include"});if(h.status===401){console.error("Unauthorized: Redirecting to login"),window.location.href="/auth";return}if(h.ok){const w=h.headers.get("content-type");if(w&&w.indexOf("application/json")!==-1){const M=await h.json(),q={January:"jan",February:"feb",March:"mar",April:"apr",May:"may",June:"jun",July:"jul",August:"aug",September:"sep",October:"oct",November:"nov",December:"dec"};for(const[Q,O]of Object.entries(M)){const[X,Z]=Q.split("-"),H=q[Z];if(!H)continue;const E=`${H}-${X}`;l.find(ee=>ee.id===E)&&(a.total_sales&&a.total_sales[E]&&(a.total_sales[E].value=O.total_sales,a.total_sales[E].source="backend"),a.cost_sales_se&&a.cost_sales_se[E]&&(a.cost_sales_se[E].value=O.cost_sales_se,a.cost_sales_se[E].source="backend"),a.cost_sales_paye&&a.cost_sales_paye[E]&&(a.cost_sales_paye[E].value=O.cost_sales_paye,a.cost_sales_paye[E].source="backend"))}c(S(a,r,l))}else console.error("Received non-JSON response from API"),c(S(a,r,l))}else console.error("API Error",h.status,h.statusText),c(S(a,r,l))}catch(m){console.error("Failed to fetch metrics",m),c(S(a,r,l))}})():c(S(a,r,l))},[t]);const A=x.useCallback((l,a,b)=>{c(m=>{const f={...m};return f[l]={...f[l]},f[l][a]={...f[l][a],value:b,source:"manual"},S(f,r,s)})},[r,s]),n=x.useCallback((l,a)=>{i(b=>{const m=b.map(f=>f.id===l?{...f,formulaString:a}:f);return c(f=>S(f,m,s)),m})},[s]),d=x.useCallback(l=>{const a=`custom_${Date.now()}`,b={id:a,label:l,isAutoCalculated:!1,isCurrency:!0};i(m=>{const f=[...m,b];return c(k=>{const h={...k};h[a]={};for(const w of s)h[a][w.id]={value:null,isEditable:!w.isYearEnd,source:"manual"};return S(h,f,s)}),f})},[s]),y=x.useCallback(l=>{i(a=>a.filter(b=>b.id!==l)),c(a=>{const b={...a};return delete b[l],b})},[]),o=x.useCallback(l=>{const a=`col_${Date.now()}`,b={id:a,label:l};p(m=>{const f=m.findIndex(h=>h.isYearEnd),k=[...m];return k.splice(f,0,b),c(h=>{const w={...h};for(const M of r)w[M.id]={...w[M.id]},w[M.id][a]={value:null,isEditable:!M.isAutoCalculated,source:"manual"};return S(w,r,k)}),k})},[r]),C=x.useCallback(l=>{p(a=>{const b=a.filter(m=>m.id!==l);return c(m=>{const f={...m};for(const k of Object.keys(f)){const{[l]:h,...w}=f[k];f[k]=w}return S(f,r,b)}),b})},[r]),_=x.useCallback((l,a)=>{p(b=>b.map(m=>m.id===l?{...m,label:a}:m))},[]),N=x.useCallback(l=>{if(!u)return;const a=r.filter(w=>!w.isAutoCalculated),b=s.filter(w=>!w.isYearEnd),m=a.findIndex(w=>w.id===u.row),f=b.findIndex(w=>w.id===u.col);if(m===-1||f===-1)return;let k=m,h=f;switch(l){case"up":k=Math.max(0,m-1);break;case"down":k=Math.min(a.length-1,m+1);break;case"left":h=Math.max(0,f-1);break;case"right":h=Math.min(b.length-1,f+1);break}g({row:a[k].id,col:b[h].id})},[u,r,s]),v=x.useCallback(async l=>{if(l)try{const a={year:new Date().getFullYear(),data:j,rows:r,columns:s},b=localStorage.getItem("auth_token");if(!(await fetch("/api/financial-summary/save",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${b}`},body:JSON.stringify(a)})).ok)throw new Error("Failed to save")}catch(a){throw console.error("Save failed",a),a}},[j,r,s]);return{rows:r,columns:s,data:j,activeCell:u,setActiveCell:g,updateCell:A,addRow:d,deleteRow:y,addColumn:o,deleteColumn:C,renameColumn:_,navigateCell:N,saveData:v,updateRowFormula:n}}function Le(){const[t,r]=x.useState({from:fe(new Date),to:xe(new Date)}),{rows:i,columns:s,data:p,activeCell:j,setActiveCell:c,updateCell:u,addRow:g,deleteRow:A,addColumn:n,deleteColumn:d,navigateCell:y,updateRowFormula:o}=ve(t),[C,_]=x.useState(""),[N,v]=x.useState(""),[l,a]=x.useState(!1),[b,m]=x.useState(!1),f=()=>{C.trim()&&(g(C.trim()),_(""),a(!1))},k=()=>{N.trim()&&(n(N.trim()),v(""),m(!1))};return e.jsx(oe,{noPadding:!0,fullWidth:!0,children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-border bg-card/50 shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx(ne,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-foreground",children:"Financial Summary."}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Annual budget and performance spreadsheet"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(me,{children:[e.jsx(be,{asChild:!0,children:e.jsxs(D,{id:"date",variant:"outline",className:T("w-[260px] justify-start text-left font-normal",!t&&"text-muted-foreground"),children:[e.jsx(de,{className:"mr-2 h-4 w-4"}),t!=null&&t.from?t.to?e.jsxs(e.Fragment,{children:[P(t.from,"LLL dd, y")," -"," ",P(t.to,"LLL dd, y")]}):P(t.from,"LLL dd, y"):e.jsx("span",{children:"Pick a date"})]})}),e.jsx(pe,{className:"w-auto p-0",align:"end",children:e.jsx(ue,{initialFocus:!0,mode:"range",defaultMonth:t==null?void 0:t.from,selected:t,onSelect:r,numberOfMonths:2,captionLayout:"dropdown-buttons",fromYear:2020,toYear:2030})})]}),e.jsxs(z,{open:l,onOpenChange:a,children:[e.jsx(B,{asChild:!0,children:e.jsxs(D,{variant:"outline",size:"sm",children:[e.jsx(U,{className:"h-4 w-4 mr-1"})," Add Row"]})}),e.jsxs(J,{children:[e.jsx(K,{children:e.jsx(G,{children:"Add New Row"})}),e.jsx($,{placeholder:"Row label...",value:C,onChange:h=>_(h.target.value),onKeyDown:h=>h.key==="Enter"&&f()}),e.jsx(V,{children:e.jsx(D,{onClick:f,disabled:!C.trim(),children:"Add"})})]})]}),e.jsxs(z,{open:b,onOpenChange:m,children:[e.jsx(B,{asChild:!0,children:e.jsxs(D,{variant:"outline",size:"sm",children:[e.jsx(U,{className:"h-4 w-4 mr-1"})," Add Column"]})}),e.jsxs(J,{children:[e.jsx(K,{children:e.jsx(G,{children:"Add New Column"})}),e.jsx($,{placeholder:"Column label...",value:N,onChange:h=>v(h.target.value),onKeyDown:h=>h.key==="Enter"&&k()}),e.jsx(V,{children:e.jsx(D,{onClick:k,disabled:!N.trim(),children:"Add"})})]})]})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:e.jsx(je,{rows:i,columns:s,data:p,activeCell:j,setActiveCell:c,updateCell:u,deleteRow:A,deleteColumn:d,navigateCell:y,updateRowFormula:o})})]})})}export{Le as default};
