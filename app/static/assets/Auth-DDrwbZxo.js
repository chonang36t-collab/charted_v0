import{r as x,u as j,a as y,b as w,R as v,j as s,A as L}from"./index-BpjfQjoN.js";import{B as N}from"./button-CsFi0B3M.js";import{I as l}from"./input-CDB11ktf.js";import{L as m}from"./label-ClG4VSHv.js";import{C as b,a as C,b as I,c as S,d as D}from"./card-D1aHV2RY.js";function P(){const[t,r]=x.useState(!1),n=j(),{toast:e}=y(),{refreshUser:u,role:o,isLoading:i}=w();v.useEffect(()=>{!i&&o&&n("/dashboard")},[o,i,n]);const p=async c=>{c.preventDefault(),r(!0);const d=new FormData(c.currentTarget),f=d.get("username"),h=d.get("password");try{const a=await fetch(L.LOGIN,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:f,password:h})});if(a.ok){const g=await a.json();localStorage.setItem("auth_token",g.token),await u(),e({title:"Login successful"})}else e({title:"Login failed",description:"Invalid credentials",variant:"destructive"})}catch{e({title:"Error",description:"Could not connect to server",variant:"destructive"})}finally{r(!1)}};return s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background p-4",children:s.jsxs(b,{className:"w-full max-w-md",children:[s.jsxs(C,{children:[s.jsx(I,{className:"text-2xl",children:"Analytics Dashboard"}),s.jsx(S,{children:"Sign in to access your analytics"})]}),s.jsx(D,{children:s.jsxs("form",{onSubmit:p,className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(m,{htmlFor:"login-username",children:"Username"}),s.jsx(l,{id:"login-username",name:"username",type:"text",placeholder:"your_username",required:!0})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(m,{htmlFor:"login-password",children:"Password"}),s.jsx(l,{id:"login-password",name:"password",type:"password",required:!0})]}),s.jsx(N,{type:"submit",className:"w-full",disabled:t,children:t?"Logging in...":"Login"})]})})]})})}export{P as default};
