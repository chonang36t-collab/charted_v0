import{c as nt,r as i,j as e,e as R,t as gn,h as Te,p as st,v as Ie,P as B,q as w,w as ie,o as te,x as jn,B as U,b as at,L as pe,I as $,y as de,z as vn,C as ot,D as bn,E as wn,F as Nn,G as Cn,H as yn,J as Mn,K as rt,M as Sn,N as it,O as Rn,Q as _n,U as Pn,V as In,W as En,Y as Dn,a as Tn}from"./index-Dhp6FQoB.js";import{b as An,C as Ae,D as On}from"./DashboardLayout-D1l5ClYG.js";import{T as kn,a as Fn,b as ee,c as F,d as Ln,e as I}from"./table-BVmx-JdN.js";import{B as $n}from"./badge-eLJJTBeE.js";import{u as Gn,a as Kn,b as Vn,c as Un,d as Bn,e as Hn}from"./useRecords-DeQR0lAp.js";import{C as ct}from"./checkbox-BtoZ0pQ8.js";import{e as zn,D as Ye,b as Xe,c as Je,d as Qe}from"./dialog-DsDWo66o.js";import{o as qn,s as Z,c as V,b as Ze,u as Wn,t as Yn,C as Ce,P as Xn}from"./types-BrRo5TG9.js";import{L as P}from"./label-BWd-PcRk.js";import{S as ye,a as Me,b as Se,c as Re,d as se}from"./select-BXqOJznA.js";import{C as Jn,a as Qn,b as Zn,f as es,c as ts,d as ns,e as ss,S as as}from"./command-BL9BBWIS.js";import{P as os,a as rs,b as is,f as _e}from"./popover-B-CAeHcy.js";import{C as lt,a as cs}from"./index-BtWXcqLn.js";import{c as dt,R as ls,I as ds}from"./index-Gx-JX4uM.js";import{P as us}from"./plus-DVM-c7qY.js";import{T as ut}from"./trash-2-DmrEtUOe.js";import{E as ms}from"./ellipsis-DLNo7F2r.js";import"./users-LB_rL9To.js";import"./useQuery-rhiKOV1j.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=nt("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ps=nt("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),mt=({className:t,...n})=>e.jsx("nav",{role:"navigation","aria-label":"pagination",className:R("mx-auto flex w-full justify-center",t),...n});mt.displayName="Pagination";const pt=i.forwardRef(({className:t,...n},s)=>e.jsx("ul",{ref:s,className:R("flex flex-row items-center gap-1",t),...n}));pt.displayName="PaginationContent";const me=i.forwardRef(({className:t,...n},s)=>e.jsx("li",{ref:s,className:R("",t),...n}));me.displayName="PaginationItem";const Oe=({className:t,isActive:n,size:s="icon",...a})=>e.jsx("a",{"aria-current":n?"page":void 0,className:R(gn({variant:n?"outline":"ghost",size:s}),t),...a});Oe.displayName="PaginationLink";const ft=({className:t,...n})=>e.jsxs(Oe,{"aria-label":"Go to previous page",size:"default",className:R("gap-1 pl-2.5",t),...n,children:[e.jsx(An,{className:"h-4 w-4"}),e.jsx("span",{children:"Previous"})]});ft.displayName="PaginationPrevious";const ht=({className:t,...n})=>e.jsxs(Oe,{"aria-label":"Go to next page",size:"default",className:R("gap-1 pr-2.5",t),...n,children:[e.jsx("span",{children:"Next"}),e.jsx(Ae,{className:"h-4 w-4"})]});ht.displayName="PaginationNext";var xe="Collapsible",[fs,ao]=Te(xe),[hs,ke]=fs(xe),xt=i.forwardRef((t,n)=>{const{__scopeCollapsible:s,open:a,defaultOpen:r,disabled:o,onOpenChange:m,...p}=t,[g,f]=st({prop:a,defaultProp:r??!1,onChange:m,caller:xe});return e.jsx(hs,{scope:s,disabled:o,contentId:Ie(),open:g,onOpenToggle:i.useCallback(()=>f(u=>!u),[f]),children:e.jsx(B.div,{"data-state":Le(g),"data-disabled":o?"":void 0,...p,ref:n})})});xt.displayName=xe;var gt="CollapsibleTrigger",jt=i.forwardRef((t,n)=>{const{__scopeCollapsible:s,...a}=t,r=ke(gt,s);return e.jsx(B.button,{type:"button","aria-controls":r.contentId,"aria-expanded":r.open||!1,"data-state":Le(r.open),"data-disabled":r.disabled?"":void 0,disabled:r.disabled,...a,ref:n,onClick:w(t.onClick,r.onOpenToggle)})});jt.displayName=gt;var Fe="CollapsibleContent",xs=i.forwardRef((t,n)=>{const{forceMount:s,...a}=t,r=ke(Fe,t.__scopeCollapsible);return e.jsx(ie,{present:s||r.open,children:({present:o})=>e.jsx(gs,{...a,ref:n,present:o})})});xs.displayName=Fe;var gs=i.forwardRef((t,n)=>{const{__scopeCollapsible:s,present:a,children:r,...o}=t,m=ke(Fe,s),[p,g]=i.useState(a),f=i.useRef(null),u=te(n,f),c=i.useRef(0),x=c.current,h=i.useRef(0),l=h.current,N=m.open||p,y=i.useRef(N),S=i.useRef(void 0);return i.useEffect(()=>{const C=requestAnimationFrame(()=>y.current=!1);return()=>cancelAnimationFrame(C)},[]),jn(()=>{const C=f.current;if(C){S.current=S.current||{transitionDuration:C.style.transitionDuration,animationName:C.style.animationName},C.style.transitionDuration="0s",C.style.animationName="none";const k=C.getBoundingClientRect();c.current=k.height,h.current=k.width,y.current||(C.style.transitionDuration=S.current.transitionDuration,C.style.animationName=S.current.animationName),g(a)}},[m.open,a]),e.jsx(B.div,{"data-state":Le(m.open),"data-disabled":m.disabled?"":void 0,id:m.contentId,hidden:!N,...o,ref:u,style:{"--radix-collapsible-content-height":x?`${x}px`:void 0,"--radix-collapsible-content-width":l?`${l}px`:void 0,...t.style},children:N&&r})});function Le(t){return t?"open":"closed"}var js=xt;const vs=js,bs=jt;function Pe({options:t,value:n,onChange:s,placeholder:a="Select...",searchPlaceholder:r="Search...",emptyMessage:o="No results found.",className:m,disabled:p=!1}){var u;const[g,f]=i.useState(!1);return e.jsxs(os,{open:g,onOpenChange:f,children:[e.jsx(rs,{asChild:!0,children:e.jsxs(U,{variant:"outline",role:"combobox","aria-expanded":g,className:R("w-full justify-between",m),disabled:p,children:[n?(u=t.find(c=>c.value===n))==null?void 0:u.label:a,e.jsx(Jn,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(is,{className:"w-[--radix-popover-trigger-width] p-0",align:"start",children:e.jsxs(Qn,{children:[e.jsx(Zn,{placeholder:r}),e.jsxs(es,{children:[e.jsx(ts,{children:o}),e.jsx(ns,{children:t.map(c=>e.jsxs(ss,{value:c.label,onSelect:x=>{s(c.value===n?"":c.value),f(!1)},children:[e.jsx(lt,{className:R("mr-2 h-4 w-4",n===c.value?"opacity-100":"opacity-0")}),c.label]},c.value))})]})]})})]})}const ws=qn({date:Z().min(1,"Date is required"),employeeId:V.number().min(1,"Employee is required"),clientId:V.number().min(1,"Client is required"),jobId:V.number().min(1,"Job is required"),shiftId:V.number().min(1,"Shift is required"),startTime:Z().min(1,"Start time is required"),endTime:Z().min(1,"End time is required"),hours:V.number().min(.1,"Hours must be greater than 0"),hourRate:V.number().optional(),clientHourlyRate:V.number().optional(),job_name:Z().optional(),role:Z().optional(),jobStatus:Z().optional(),additions:V.number().optional(),deductions:V.number().optional(),self_employed:Ze().optional(),dns:Ze().optional()}),et=({record:t,onSuccess:n,onCancel:s})=>{const{role:a}=at(),r=a==="admin",{data:o,isLoading:m}=Gn(),p=Kn(),g=Vn(),[f,u]=i.useState(""),[c,x]=i.useState(""),h=!!t,l=Wn({resolver:Yn(ws),defaultValues:{date:(t==null?void 0:t.date)||new Date().toISOString().split("T")[0],employeeId:void 0,clientId:void 0,jobId:void 0,shiftId:void 0,startTime:t!=null&&t.shiftStart?t.shiftStart.substring(0,5):"09:00",endTime:t!=null&&t.shiftEnd?t.shiftEnd.substring(0,5):"17:00",hours:(t==null?void 0:t.paidHours)||8,hourRate:(t==null?void 0:t.hourRate)||0,clientHourlyRate:(t==null?void 0:t.clientHourlyRate)||0,job_name:(t==null?void 0:t.jobName)||"",role:"Travel Retail Specialist",jobStatus:(t==null?void 0:t.jobStatus)||"Currently Working - Full Airside Pass",additions:0,deductions:0,self_employed:!1,dns:!1}}),N=l.watch("startTime"),y=l.watch("endTime"),S=l.watch("shiftId"),C=i.useMemo(()=>o!=null&&o.jobs?Array.from(new Set(o.jobs.map(d=>d.location).filter(Boolean))):[],[o]),k=i.useMemo(()=>!(o!=null&&o.jobs)||!f?[]:Array.from(new Set(o.jobs.filter(d=>d.location===f).map(d=>d.site).filter(Boolean))),[o,f]);i.useEffect(()=>{if(t&&o){const d=o.employees.find(M=>M.name===t.fullName);d&&l.setValue("employeeId",d.id);const b=o.clients.find(M=>M.name===t.clientName);b&&l.setValue("clientId",b.id);const D=o.shifts.find(M=>M.name===t.shiftName);D&&l.setValue("shiftId",D.id);let T=o.jobs.find(M=>M.name===t.jobName&&M.site===t.site);T||(T=o.jobs.find(M=>M.site===t.site&&M.location===t.location)),T&&(l.setValue("jobId",T.id),u(T.location),x(T.site))}},[t,o,l]),i.useEffect(()=>{if(N&&y){const[d,b]=N.split(":").map(Number),[D,T]=y.split(":").map(Number);let M=d*60+b,z=D*60+T;z<M&&(z+=24*60);const be=(z-M)/60;l.setValue("hours",parseFloat(be.toFixed(2)))}},[N,y,l]),i.useEffect(()=>{var d;if(!h&&S&&(o!=null&&o.shifts)){const b=(d=o.shifts.find(D=>D.id===S))==null?void 0:d.name;b&&l.setValue("job_name",b)}},[S,h,o,l]),i.useEffect(()=>{if(f&&c&&(o!=null&&o.jobs)){const d=o.jobs.find(b=>b.location===f&&b.site===c);d&&l.setValue("jobId",d.id)}},[f,c,o,l]);const Y=d=>{h&&t?g.mutate({id:t.id,...d},{onSuccess:()=>{de.success("Record updated successfully"),n()},onError:b=>{de.error(`Failed to update record: ${b.message}`)}}):p.mutate(d,{onSuccess:()=>{de.success("Record created successfully"),n()},onError:b=>{de.error(`Failed to create record: ${b.message}`)}})},X=p.isPending||g.isPending;if(m)return e.jsx("div",{className:"flex justify-center p-4",children:e.jsx(pe,{className:"animate-spin"})});const G=(o==null?void 0:o.employees.map(d=>({value:d.id.toString(),label:d.name})))||[],v=(o==null?void 0:o.clients.map(d=>({value:d.id.toString(),label:d.name})))||[],_=(o==null?void 0:o.shifts.map(d=>({value:d.id.toString(),label:`${d.name} (${d.start.substring(0,5)}-${d.end.substring(0,5)})`})))||[];return e.jsxs("form",{onSubmit:l.handleSubmit(Y),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"date",children:"Date"}),e.jsx($,{id:"date",type:"date",...l.register("date")}),l.formState.errors.date&&e.jsx("span",{className:"text-red-500 text-xs",children:l.formState.errors.date.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"startTime",children:"Start Time"}),e.jsx($,{id:"startTime",type:"time",...l.register("startTime")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"endTime",children:"End Time"}),e.jsx($,{id:"endTime",type:"time",...l.register("endTime")})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(P,{children:["Calculated Hours: ",l.watch("hours")]}),e.jsx($,{type:"hidden",...l.register("hours")})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{children:"Employee"}),e.jsx(Ce,{control:l.control,name:"employeeId",render:({field:d})=>{var b;return e.jsx(Pe,{options:G,value:(b=d.value)==null?void 0:b.toString(),onChange:D=>d.onChange(Number(D)),placeholder:"Select Employee...",searchPlaceholder:"Search employees..."})}}),l.formState.errors.employeeId&&e.jsx("span",{className:"text-red-500 text-xs",children:l.formState.errors.employeeId.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{children:"Client"}),e.jsx(Ce,{control:l.control,name:"clientId",render:({field:d})=>{var b;return e.jsx(Pe,{options:v,value:(b=d.value)==null?void 0:b.toString(),onChange:D=>d.onChange(Number(D)),placeholder:"Select Client...",searchPlaceholder:"Search clients..."})}}),l.formState.errors.clientId&&e.jsx("span",{className:"text-red-500 text-xs",children:l.formState.errors.clientId.message})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{children:"Location"}),e.jsxs(ye,{value:f,onValueChange:d=>{u(d),x("")},children:[e.jsx(Me,{children:e.jsx(Se,{placeholder:"Select Location"})}),e.jsx(Re,{children:C.map(d=>e.jsx(se,{value:d,children:d},d))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{children:"Site / Terminal"}),e.jsxs(ye,{value:c,onValueChange:x,disabled:!f,children:[e.jsx(Me,{children:e.jsx(Se,{placeholder:"Select Site"})}),e.jsx(Re,{children:k.map(d=>e.jsx(se,{value:d,children:d},d))})]}),e.jsx("input",{type:"hidden",...l.register("jobId")}),l.formState.errors.jobId&&e.jsx("span",{className:"text-red-500 text-xs",children:"Job Selection Incomplete"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{children:"Shift"}),e.jsx(Ce,{control:l.control,name:"shiftId",render:({field:d})=>{var b;return e.jsx(Pe,{options:_,value:(b=d.value)==null?void 0:b.toString(),onChange:D=>d.onChange(Number(D)),placeholder:"Select Shift config...",searchPlaceholder:"Search shifts..."})}}),l.formState.errors.shiftId&&e.jsx("span",{className:"text-red-500 text-xs",children:l.formState.errors.shiftId.message})]}),(r||h)&&e.jsxs("div",{className:"border-t pt-4 grid grid-cols-2 gap-4 bg-muted/20 p-4 rounded-md",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{children:"Role"}),e.jsx($,{...l.register("role")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{children:"Status"}),e.jsxs(ye,{onValueChange:d=>l.setValue("jobStatus",d),defaultValue:l.getValues("jobStatus"),children:[e.jsx(Me,{children:e.jsx(Se,{placeholder:"Status"})}),e.jsxs(Re,{children:[e.jsx(se,{value:"Currently Working - Full Airside Pass",children:"Currently Working - Full Airside Pass"}),e.jsx(se,{value:"Completed",children:"Completed"}),e.jsx(se,{value:"Cancelled",children:"Cancelled"})]})]})]}),r&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"hourRate",children:"Pay Rate (£)"}),e.jsx($,{id:"hourRate",type:"number",step:"0.01",...l.register("hourRate")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"clientHourlyRate",children:"Client Rate (£)"}),e.jsx($,{id:"clientHourlyRate",type:"number",step:"0.01",...l.register("clientHourlyRate")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"additions",children:"Additions (£)"}),e.jsx($,{id:"additions",type:"number",step:"0.01",...l.register("additions")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"deductions",children:"Deductions (£)"}),e.jsx($,{id:"deductions",type:"number",step:"0.01",...l.register("deductions")})]})]})]}),e.jsxs(zn,{className:"mt-6 flex justify-between items-center w-full",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:!h&&"Defaults: Role=Travel Retail, Additions=0, Deductions=0"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(U,{type:"button",variant:"outline",onClick:s,children:"Cancel"}),e.jsxs(U,{type:"submit",disabled:X,children:[X&&e.jsx(pe,{className:"mr-2 h-4 w-4 animate-spin"}),h?"Update Record":"Create Record"]})]})]})]})};var Ee=["Enter"," "],Ns=["ArrowDown","PageUp","Home"],vt=["ArrowUp","PageDown","End"],Cs=[...Ns,...vt],ys={ltr:[...Ee,"ArrowRight"],rtl:[...Ee,"ArrowLeft"]},Ms={ltr:["ArrowLeft"],rtl:["ArrowRight"]},ce="Menu",[oe,Ss,Rs]=vn(ce),[q,bt]=Te(ce,[Rs,ot,dt]),ge=ot(),wt=dt(),[_s,W]=q(ce),[Ps,le]=q(ce),Nt=t=>{const{__scopeMenu:n,open:s=!1,children:a,dir:r,onOpenChange:o,modal:m=!0}=t,p=ge(n),[g,f]=i.useState(null),u=i.useRef(!1),c=rt(o),x=Pn(r);return i.useEffect(()=>{const h=()=>{u.current=!0,document.addEventListener("pointerdown",l,{capture:!0,once:!0}),document.addEventListener("pointermove",l,{capture:!0,once:!0})},l=()=>u.current=!1;return document.addEventListener("keydown",h,{capture:!0}),()=>{document.removeEventListener("keydown",h,{capture:!0}),document.removeEventListener("pointerdown",l,{capture:!0}),document.removeEventListener("pointermove",l,{capture:!0})}},[]),e.jsx(In,{...p,children:e.jsx(_s,{scope:n,open:s,onOpenChange:c,content:g,onContentChange:f,children:e.jsx(Ps,{scope:n,onClose:i.useCallback(()=>c(!1),[c]),isUsingKeyboardRef:u,dir:x,modal:m,children:a})})})};Nt.displayName=ce;var Is="MenuAnchor",$e=i.forwardRef((t,n)=>{const{__scopeMenu:s,...a}=t,r=ge(s);return e.jsx(bn,{...r,...a,ref:n})});$e.displayName=Is;var Ge="MenuPortal",[Es,Ct]=q(Ge,{forceMount:void 0}),yt=t=>{const{__scopeMenu:n,forceMount:s,children:a,container:r}=t,o=W(Ge,n);return e.jsx(Es,{scope:n,forceMount:s,children:e.jsx(ie,{present:s||o.open,children:e.jsx(En,{asChild:!0,container:r,children:a})})})};yt.displayName=Ge;var O="MenuContent",[Ds,Ke]=q(O),Mt=i.forwardRef((t,n)=>{const s=Ct(O,t.__scopeMenu),{forceMount:a=s.forceMount,...r}=t,o=W(O,t.__scopeMenu),m=le(O,t.__scopeMenu);return e.jsx(oe.Provider,{scope:t.__scopeMenu,children:e.jsx(ie,{present:a||o.open,children:e.jsx(oe.Slot,{scope:t.__scopeMenu,children:m.modal?e.jsx(Ts,{...r,ref:n}):e.jsx(As,{...r,ref:n})})})})}),Ts=i.forwardRef((t,n)=>{const s=W(O,t.__scopeMenu),a=i.useRef(null),r=te(n,a);return i.useEffect(()=>{const o=a.current;if(o)return wn(o)},[]),e.jsx(Ve,{...t,ref:r,trapFocus:s.open,disableOutsidePointerEvents:s.open,disableOutsideScroll:!0,onFocusOutside:w(t.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>s.onOpenChange(!1)})}),As=i.forwardRef((t,n)=>{const s=W(O,t.__scopeMenu);return e.jsx(Ve,{...t,ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>s.onOpenChange(!1)})}),Os=Dn("MenuContent.ScrollLock"),Ve=i.forwardRef((t,n)=>{const{__scopeMenu:s,loop:a=!1,trapFocus:r,onOpenAutoFocus:o,onCloseAutoFocus:m,disableOutsidePointerEvents:p,onEntryFocus:g,onEscapeKeyDown:f,onPointerDownOutside:u,onFocusOutside:c,onInteractOutside:x,onDismiss:h,disableOutsideScroll:l,...N}=t,y=W(O,s),S=le(O,s),C=ge(s),k=wt(s),Y=Ss(s),[X,G]=i.useState(null),v=i.useRef(null),_=te(n,v,y.onContentChange),d=i.useRef(0),b=i.useRef(""),D=i.useRef(0),T=i.useRef(null),M=i.useRef("right"),z=i.useRef(0),be=l?Rn:i.Fragment,hn=l?{as:Os,allowPinchZoom:!0}:void 0,xn=j=>{var Q,qe;const A=b.current+j,L=Y().filter(K=>!K.disabled),H=document.activeElement,we=(Q=L.find(K=>K.ref.current===H))==null?void 0:Q.textValue,Ne=L.map(K=>K.textValue),ze=qs(Ne,A,we),ne=(qe=L.find(K=>K.textValue===ze))==null?void 0:qe.ref.current;(function K(We){b.current=We,window.clearTimeout(d.current),We!==""&&(d.current=window.setTimeout(()=>K(""),1e3))})(A),ne&&setTimeout(()=>ne.focus())};i.useEffect(()=>()=>window.clearTimeout(d.current),[]),Nn();const J=i.useCallback(j=>{var L,H;return M.current===((L=T.current)==null?void 0:L.side)&&Ys(j,(H=T.current)==null?void 0:H.area)},[]);return e.jsx(Ds,{scope:s,searchRef:b,onItemEnter:i.useCallback(j=>{J(j)&&j.preventDefault()},[J]),onItemLeave:i.useCallback(j=>{var A;J(j)||((A=v.current)==null||A.focus(),G(null))},[J]),onTriggerLeave:i.useCallback(j=>{J(j)&&j.preventDefault()},[J]),pointerGraceTimerRef:D,onPointerGraceIntentChange:i.useCallback(j=>{T.current=j},[]),children:e.jsx(be,{...hn,children:e.jsx(Cn,{asChild:!0,trapped:r,onMountAutoFocus:w(o,j=>{var A;j.preventDefault(),(A=v.current)==null||A.focus({preventScroll:!0})}),onUnmountAutoFocus:m,children:e.jsx(yn,{asChild:!0,disableOutsidePointerEvents:p,onEscapeKeyDown:f,onPointerDownOutside:u,onFocusOutside:c,onInteractOutside:x,onDismiss:h,children:e.jsx(ls,{asChild:!0,...k,dir:S.dir,orientation:"vertical",loop:a,currentTabStopId:X,onCurrentTabStopIdChange:G,onEntryFocus:w(g,j=>{S.isUsingKeyboardRef.current||j.preventDefault()}),preventScrollOnEntryFocus:!0,children:e.jsx(Mn,{role:"menu","aria-orientation":"vertical","data-state":Kt(y.open),"data-radix-menu-content":"",dir:S.dir,...C,...N,ref:_,style:{outline:"none",...N.style},onKeyDown:w(N.onKeyDown,j=>{const L=j.target.closest("[data-radix-menu-content]")===j.currentTarget,H=j.ctrlKey||j.altKey||j.metaKey,we=j.key.length===1;L&&(j.key==="Tab"&&j.preventDefault(),!H&&we&&xn(j.key));const Ne=v.current;if(j.target!==Ne||!Cs.includes(j.key))return;j.preventDefault();const ne=Y().filter(Q=>!Q.disabled).map(Q=>Q.ref.current);vt.includes(j.key)&&ne.reverse(),Hs(ne)}),onBlur:w(t.onBlur,j=>{j.currentTarget.contains(j.target)||(window.clearTimeout(d.current),b.current="")}),onPointerMove:w(t.onPointerMove,re(j=>{const A=j.target,L=z.current!==j.clientX;if(j.currentTarget.contains(A)&&L){const H=j.clientX>z.current?"right":"left";M.current=H,z.current=j.clientX}}))})})})})})})});Mt.displayName=O;var ks="MenuGroup",Ue=i.forwardRef((t,n)=>{const{__scopeMenu:s,...a}=t;return e.jsx(B.div,{role:"group",...a,ref:n})});Ue.displayName=ks;var Fs="MenuLabel",St=i.forwardRef((t,n)=>{const{__scopeMenu:s,...a}=t;return e.jsx(B.div,{...a,ref:n})});St.displayName=Fs;var fe="MenuItem",tt="menu.itemSelect",je=i.forwardRef((t,n)=>{const{disabled:s=!1,onSelect:a,...r}=t,o=i.useRef(null),m=le(fe,t.__scopeMenu),p=Ke(fe,t.__scopeMenu),g=te(n,o),f=i.useRef(!1),u=()=>{const c=o.current;if(!s&&c){const x=new CustomEvent(tt,{bubbles:!0,cancelable:!0});c.addEventListener(tt,h=>a==null?void 0:a(h),{once:!0}),_n(c,x),x.defaultPrevented?f.current=!1:m.onClose()}};return e.jsx(Rt,{...r,ref:g,disabled:s,onClick:w(t.onClick,u),onPointerDown:c=>{var x;(x=t.onPointerDown)==null||x.call(t,c),f.current=!0},onPointerUp:w(t.onPointerUp,c=>{var x;f.current||(x=c.currentTarget)==null||x.click()}),onKeyDown:w(t.onKeyDown,c=>{const x=p.searchRef.current!=="";s||x&&c.key===" "||Ee.includes(c.key)&&(c.currentTarget.click(),c.preventDefault())})})});je.displayName=fe;var Rt=i.forwardRef((t,n)=>{const{__scopeMenu:s,disabled:a=!1,textValue:r,...o}=t,m=Ke(fe,s),p=wt(s),g=i.useRef(null),f=te(n,g),[u,c]=i.useState(!1),[x,h]=i.useState("");return i.useEffect(()=>{const l=g.current;l&&h((l.textContent??"").trim())},[o.children]),e.jsx(oe.ItemSlot,{scope:s,disabled:a,textValue:r??x,children:e.jsx(ds,{asChild:!0,...p,focusable:!a,children:e.jsx(B.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":a||void 0,"data-disabled":a?"":void 0,...o,ref:f,onPointerMove:w(t.onPointerMove,re(l=>{a?m.onItemLeave(l):(m.onItemEnter(l),l.defaultPrevented||l.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:w(t.onPointerLeave,re(l=>m.onItemLeave(l))),onFocus:w(t.onFocus,()=>c(!0)),onBlur:w(t.onBlur,()=>c(!1))})})})}),Ls="MenuCheckboxItem",_t=i.forwardRef((t,n)=>{const{checked:s=!1,onCheckedChange:a,...r}=t;return e.jsx(Tt,{scope:t.__scopeMenu,checked:s,children:e.jsx(je,{role:"menuitemcheckbox","aria-checked":he(s)?"mixed":s,...r,ref:n,"data-state":He(s),onSelect:w(r.onSelect,()=>a==null?void 0:a(he(s)?!0:!s),{checkForDefaultPrevented:!1})})})});_t.displayName=Ls;var Pt="MenuRadioGroup",[$s,Gs]=q(Pt,{value:void 0,onValueChange:()=>{}}),It=i.forwardRef((t,n)=>{const{value:s,onValueChange:a,...r}=t,o=rt(a);return e.jsx($s,{scope:t.__scopeMenu,value:s,onValueChange:o,children:e.jsx(Ue,{...r,ref:n})})});It.displayName=Pt;var Et="MenuRadioItem",Dt=i.forwardRef((t,n)=>{const{value:s,...a}=t,r=Gs(Et,t.__scopeMenu),o=s===r.value;return e.jsx(Tt,{scope:t.__scopeMenu,checked:o,children:e.jsx(je,{role:"menuitemradio","aria-checked":o,...a,ref:n,"data-state":He(o),onSelect:w(a.onSelect,()=>{var m;return(m=r.onValueChange)==null?void 0:m.call(r,s)},{checkForDefaultPrevented:!1})})})});Dt.displayName=Et;var Be="MenuItemIndicator",[Tt,Ks]=q(Be,{checked:!1}),At=i.forwardRef((t,n)=>{const{__scopeMenu:s,forceMount:a,...r}=t,o=Ks(Be,s);return e.jsx(ie,{present:a||he(o.checked)||o.checked===!0,children:e.jsx(B.span,{...r,ref:n,"data-state":He(o.checked)})})});At.displayName=Be;var Vs="MenuSeparator",Ot=i.forwardRef((t,n)=>{const{__scopeMenu:s,...a}=t;return e.jsx(B.div,{role:"separator","aria-orientation":"horizontal",...a,ref:n})});Ot.displayName=Vs;var Us="MenuArrow",kt=i.forwardRef((t,n)=>{const{__scopeMenu:s,...a}=t,r=ge(s);return e.jsx(Sn,{...r,...a,ref:n})});kt.displayName=Us;var Bs="MenuSub",[oo,Ft]=q(Bs),ae="MenuSubTrigger",Lt=i.forwardRef((t,n)=>{const s=W(ae,t.__scopeMenu),a=le(ae,t.__scopeMenu),r=Ft(ae,t.__scopeMenu),o=Ke(ae,t.__scopeMenu),m=i.useRef(null),{pointerGraceTimerRef:p,onPointerGraceIntentChange:g}=o,f={__scopeMenu:t.__scopeMenu},u=i.useCallback(()=>{m.current&&window.clearTimeout(m.current),m.current=null},[]);return i.useEffect(()=>u,[u]),i.useEffect(()=>{const c=p.current;return()=>{window.clearTimeout(c),g(null)}},[p,g]),e.jsx($e,{asChild:!0,...f,children:e.jsx(Rt,{id:r.triggerId,"aria-haspopup":"menu","aria-expanded":s.open,"aria-controls":r.contentId,"data-state":Kt(s.open),...t,ref:it(n,r.onTriggerChange),onClick:c=>{var x;(x=t.onClick)==null||x.call(t,c),!(t.disabled||c.defaultPrevented)&&(c.currentTarget.focus(),s.open||s.onOpenChange(!0))},onPointerMove:w(t.onPointerMove,re(c=>{o.onItemEnter(c),!c.defaultPrevented&&!t.disabled&&!s.open&&!m.current&&(o.onPointerGraceIntentChange(null),m.current=window.setTimeout(()=>{s.onOpenChange(!0),u()},100))})),onPointerLeave:w(t.onPointerLeave,re(c=>{var h,l;u();const x=(h=s.content)==null?void 0:h.getBoundingClientRect();if(x){const N=(l=s.content)==null?void 0:l.dataset.side,y=N==="right",S=y?-5:5,C=x[y?"left":"right"],k=x[y?"right":"left"];o.onPointerGraceIntentChange({area:[{x:c.clientX+S,y:c.clientY},{x:C,y:x.top},{x:k,y:x.top},{x:k,y:x.bottom},{x:C,y:x.bottom}],side:N}),window.clearTimeout(p.current),p.current=window.setTimeout(()=>o.onPointerGraceIntentChange(null),300)}else{if(o.onTriggerLeave(c),c.defaultPrevented)return;o.onPointerGraceIntentChange(null)}})),onKeyDown:w(t.onKeyDown,c=>{var h;const x=o.searchRef.current!=="";t.disabled||x&&c.key===" "||ys[a.dir].includes(c.key)&&(s.onOpenChange(!0),(h=s.content)==null||h.focus(),c.preventDefault())})})})});Lt.displayName=ae;var $t="MenuSubContent",Gt=i.forwardRef((t,n)=>{const s=Ct(O,t.__scopeMenu),{forceMount:a=s.forceMount,...r}=t,o=W(O,t.__scopeMenu),m=le(O,t.__scopeMenu),p=Ft($t,t.__scopeMenu),g=i.useRef(null),f=te(n,g);return e.jsx(oe.Provider,{scope:t.__scopeMenu,children:e.jsx(ie,{present:a||o.open,children:e.jsx(oe.Slot,{scope:t.__scopeMenu,children:e.jsx(Ve,{id:p.contentId,"aria-labelledby":p.triggerId,...r,ref:f,align:"start",side:m.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{var c;m.isUsingKeyboardRef.current&&((c=g.current)==null||c.focus()),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:w(t.onFocusOutside,u=>{u.target!==p.trigger&&o.onOpenChange(!1)}),onEscapeKeyDown:w(t.onEscapeKeyDown,u=>{m.onClose(),u.preventDefault()}),onKeyDown:w(t.onKeyDown,u=>{var h;const c=u.currentTarget.contains(u.target),x=Ms[m.dir].includes(u.key);c&&x&&(o.onOpenChange(!1),(h=p.trigger)==null||h.focus(),u.preventDefault())})})})})})});Gt.displayName=$t;function Kt(t){return t?"open":"closed"}function he(t){return t==="indeterminate"}function He(t){return he(t)?"indeterminate":t?"checked":"unchecked"}function Hs(t){const n=document.activeElement;for(const s of t)if(s===n||(s.focus(),document.activeElement!==n))return}function zs(t,n){return t.map((s,a)=>t[(n+a)%t.length])}function qs(t,n,s){const r=n.length>1&&Array.from(n).every(f=>f===n[0])?n[0]:n,o=s?t.indexOf(s):-1;let m=zs(t,Math.max(o,0));r.length===1&&(m=m.filter(f=>f!==s));const g=m.find(f=>f.toLowerCase().startsWith(r.toLowerCase()));return g!==s?g:void 0}function Ws(t,n){const{x:s,y:a}=t;let r=!1;for(let o=0,m=n.length-1;o<n.length;m=o++){const p=n[o],g=n[m],f=p.x,u=p.y,c=g.x,x=g.y;u>a!=x>a&&s<(c-f)*(a-u)/(x-u)+f&&(r=!r)}return r}function Ys(t,n){if(!n)return!1;const s={x:t.clientX,y:t.clientY};return Ws(s,n)}function re(t){return n=>n.pointerType==="mouse"?t(n):void 0}var Xs=Nt,Js=$e,Qs=yt,Zs=Mt,ea=Ue,ta=St,na=je,sa=_t,aa=It,oa=Dt,ra=At,ia=Ot,ca=kt,la=Lt,da=Gt,ve="DropdownMenu",[ua,ro]=Te(ve,[bt]),E=bt(),[ma,Vt]=ua(ve),Ut=t=>{const{__scopeDropdownMenu:n,children:s,dir:a,open:r,defaultOpen:o,onOpenChange:m,modal:p=!0}=t,g=E(n),f=i.useRef(null),[u,c]=st({prop:r,defaultProp:o??!1,onChange:m,caller:ve});return e.jsx(ma,{scope:n,triggerId:Ie(),triggerRef:f,contentId:Ie(),open:u,onOpenChange:c,onOpenToggle:i.useCallback(()=>c(x=>!x),[c]),modal:p,children:e.jsx(Xs,{...g,open:u,onOpenChange:c,dir:a,modal:p,children:s})})};Ut.displayName=ve;var Bt="DropdownMenuTrigger",Ht=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,disabled:a=!1,...r}=t,o=Vt(Bt,s),m=E(s);return e.jsx(Js,{asChild:!0,...m,children:e.jsx(B.button,{type:"button",id:o.triggerId,"aria-haspopup":"menu","aria-expanded":o.open,"aria-controls":o.open?o.contentId:void 0,"data-state":o.open?"open":"closed","data-disabled":a?"":void 0,disabled:a,...r,ref:it(n,o.triggerRef),onPointerDown:w(t.onPointerDown,p=>{!a&&p.button===0&&p.ctrlKey===!1&&(o.onOpenToggle(),o.open||p.preventDefault())}),onKeyDown:w(t.onKeyDown,p=>{a||(["Enter"," "].includes(p.key)&&o.onOpenToggle(),p.key==="ArrowDown"&&o.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(p.key)&&p.preventDefault())})})})});Ht.displayName=Bt;var pa="DropdownMenuPortal",zt=t=>{const{__scopeDropdownMenu:n,...s}=t,a=E(n);return e.jsx(Qs,{...a,...s})};zt.displayName=pa;var qt="DropdownMenuContent",Wt=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,r=Vt(qt,s),o=E(s),m=i.useRef(!1);return e.jsx(Zs,{id:r.contentId,"aria-labelledby":r.triggerId,...o,...a,ref:n,onCloseAutoFocus:w(t.onCloseAutoFocus,p=>{var g;m.current||(g=r.triggerRef.current)==null||g.focus(),m.current=!1,p.preventDefault()}),onInteractOutside:w(t.onInteractOutside,p=>{const g=p.detail.originalEvent,f=g.button===0&&g.ctrlKey===!0,u=g.button===2||f;(!r.modal||u)&&(m.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Wt.displayName=qt;var fa="DropdownMenuGroup",ha=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,r=E(s);return e.jsx(ea,{...r,...a,ref:n})});ha.displayName=fa;var xa="DropdownMenuLabel",Yt=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,r=E(s);return e.jsx(ta,{...r,...a,ref:n})});Yt.displayName=xa;var ga="DropdownMenuItem",Xt=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,r=E(s);return e.jsx(na,{...r,...a,ref:n})});Xt.displayName=ga;var ja="DropdownMenuCheckboxItem",Jt=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,r=E(s);return e.jsx(sa,{...r,...a,ref:n})});Jt.displayName=ja;var va="DropdownMenuRadioGroup",ba=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,r=E(s);return e.jsx(aa,{...r,...a,ref:n})});ba.displayName=va;var wa="DropdownMenuRadioItem",Qt=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,r=E(s);return e.jsx(oa,{...r,...a,ref:n})});Qt.displayName=wa;var Na="DropdownMenuItemIndicator",Zt=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,r=E(s);return e.jsx(ra,{...r,...a,ref:n})});Zt.displayName=Na;var Ca="DropdownMenuSeparator",en=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,r=E(s);return e.jsx(ia,{...r,...a,ref:n})});en.displayName=Ca;var ya="DropdownMenuArrow",Ma=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,r=E(s);return e.jsx(ca,{...r,...a,ref:n})});Ma.displayName=ya;var Sa="DropdownMenuSubTrigger",tn=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,r=E(s);return e.jsx(la,{...r,...a,ref:n})});tn.displayName=Sa;var Ra="DropdownMenuSubContent",nn=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,r=E(s);return e.jsx(da,{...r,...a,ref:n,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});nn.displayName=Ra;var _a=Ut,Pa=Ht,Ia=zt,sn=Wt,an=Yt,on=Xt,rn=Jt,cn=Qt,ln=Zt,dn=en,un=tn,mn=nn;const Ea=_a,Da=Pa,Ta=i.forwardRef(({className:t,inset:n,children:s,...a},r)=>e.jsxs(un,{ref:r,className:R("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[state=open]:bg-accent focus:bg-accent",n&&"pl-8",t),...a,children:[s,e.jsx(Ae,{className:"ml-auto h-4 w-4"})]}));Ta.displayName=un.displayName;const Aa=i.forwardRef(({className:t,...n},s)=>e.jsx(mn,{ref:s,className:R("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n}));Aa.displayName=mn.displayName;const pn=i.forwardRef(({className:t,sideOffset:n=4,...s},a)=>e.jsx(Ia,{children:e.jsx(sn,{ref:a,sideOffset:n,className:R("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...s})}));pn.displayName=sn.displayName;const De=i.forwardRef(({className:t,inset:n,...s},a)=>e.jsx(on,{ref:a,className:R("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",n&&"pl-8",t),...s}));De.displayName=on.displayName;const Oa=i.forwardRef(({className:t,children:n,checked:s,...a},r)=>e.jsxs(rn,{ref:r,className:R("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t),checked:s,...a,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(ln,{children:e.jsx(lt,{className:"h-4 w-4"})})}),n]}));Oa.displayName=rn.displayName;const ka=i.forwardRef(({className:t,children:n,...s},a)=>e.jsxs(cn,{ref:a,className:R("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t),...s,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(ln,{children:e.jsx(ps,{className:"h-2 w-2 fill-current"})})}),n]}));ka.displayName=cn.displayName;const fn=i.forwardRef(({className:t,inset:n,...s},a)=>e.jsx(an,{ref:a,className:R("px-2 py-1.5 text-sm font-semibold",n&&"pl-8",t),...s}));fn.displayName=an.displayName;const Fa=i.forwardRef(({className:t,...n},s)=>e.jsx(dn,{ref:s,className:R("-mx-1 my-1 h-px bg-muted",t),...n}));Fa.displayName=dn.displayName;const io=()=>{const[t,n]=i.useState({page:1,limit:20,sort_by:"date",sort_order:"desc",search:""}),{role:s}=at(),a=s==="admin",[r,o]=i.useState(""),[m,p]=i.useState(!1),[g,f]=i.useState(null),[u,c]=i.useState(new Set),{toast:x}=Tn(),{data:h,isLoading:l,isError:N}=Un(t),y=Bn();i.useEffect(()=>{const v=setTimeout(()=>{n(_=>({..._,page:1,search:r}))},500);return()=>clearTimeout(v)},[r]);const S=v=>{v.preventDefault(),n(_=>({..._,page:1,search:r}))},C=v=>{n(_=>({..._,sort_by:v,sort_order:_.sort_by===v&&_.sort_order==="desc"?"asc":"desc"}))},k=v=>{v===!0&&(h!=null&&h.data)?c(new Set(h.data.map(_=>_.id))):c(new Set)},Y=v=>{c(_=>{const d=new Set(_);return d.has(v)?d.delete(v):d.add(v),d})},X=async()=>{if(confirm(`Delete ${u.size} record${u.size!==1?"s":""}?`))try{await y.mutateAsync(Array.from(u)),x({title:"Success",description:`Deleted ${u.size} records`}),c(new Set)}catch(v){x({title:"Error",description:v.message||"Failed to delete records",variant:"destructive"})}},G=(h==null?void 0:h.meta.pages)||1;return e.jsx(On,{fullWidth:!0,children:e.jsxs("div",{className:"flex flex-col h-full space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Shift Records"})}),e.jsx(Ye,{open:m,onOpenChange:p,children:e.jsxs(Xe,{className:"max-w-2xl",children:[e.jsx(Je,{children:e.jsx(Qe,{children:"Add New Shift Record"})}),e.jsx(et,{onSuccess:()=>p(!1),onCancel:()=>p(!1)})]})}),e.jsx(Ye,{open:!!g,onOpenChange:v=>!v&&f(null),children:e.jsxs(Xe,{className:"max-w-2xl",children:[e.jsx(Je,{children:e.jsx(Qe,{children:"Edit Shift Record"})}),g&&e.jsx(et,{record:g,onSuccess:()=>f(null),onCancel:()=>f(null)})]})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("form",{onSubmit:S,className:"flex-1 max-w-sm flex gap-2",children:[e.jsx($,{placeholder:"Search by name, client, or job...",value:r,onChange:v=>o(v.target.value)}),e.jsx(U,{type:"submit",variant:"secondary",children:e.jsx(as,{className:"h-4 w-4"})})]}),(a||s==="manager")&&e.jsxs(U,{onClick:()=>p(!0),children:[e.jsx(us,{className:"mr-2 h-4 w-4"})," Add Record"]}),e.jsxs("div",{className:"ml-auto text-sm text-muted-foreground",children:[(h==null?void 0:h.meta.total)||0," records found"]})]}),u.size>0&&e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-muted rounded-md border",children:[e.jsxs("span",{className:"text-sm font-medium",children:[u.size," record",u.size!==1?"s":""," selected"]}),e.jsxs(U,{variant:"destructive",size:"sm",onClick:X,disabled:y.isPending,children:[y.isPending?e.jsx(pe,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(ut,{className:"mr-2 h-4 w-4"}),"Delete Selected"]}),e.jsx(U,{variant:"outline",size:"sm",onClick:()=>c(new Set),children:"Clear Selection"})]}),e.jsx("div",{className:"border rounded-md bg-white overflow-x-auto",children:e.jsxs(kn,{children:[e.jsx(Fn,{children:e.jsxs(ee,{children:[e.jsx(F,{className:"w-[40px]",children:e.jsx(ct,{checked:u.size>0&&u.size===(h==null?void 0:h.data.length),onCheckedChange:k})}),e.jsx(F,{className:"w-[30px]"}),e.jsxs(F,{className:"cursor-pointer",onClick:()=>C("date"),children:["Date ",e.jsx(ue,{className:"ml-2 h-4 w-4 inline"})]}),e.jsxs(F,{className:"cursor-pointer",onClick:()=>C("full_name"),children:["Employee ",e.jsx(ue,{className:"ml-2 h-4 w-4 inline"})]}),e.jsxs(F,{className:"cursor-pointer",onClick:()=>C("client_name"),children:["Client ",e.jsx(ue,{className:"ml-2 h-4 w-4 inline"})]}),e.jsxs(F,{className:"hidden md:table-cell cursor-pointer",onClick:()=>C("location"),children:["Location ",e.jsx(ue,{className:"ml-2 h-4 w-4 inline"})]}),e.jsx(F,{children:"Shift"}),e.jsx(F,{className:"text-right",children:"Hours"}),a&&e.jsx(F,{className:"text-right",children:"Staff Pay"}),a&&e.jsx(F,{className:"text-right",children:"Client Pay"}),e.jsx(F,{className:"w-[50px]"})]})}),e.jsx(Ln,{children:l?e.jsx(ee,{children:e.jsx(I,{colSpan:a?10:8,className:"h-24 text-center",children:e.jsx(pe,{className:"h-6 w-6 animate-spin mx-auto"})})}):N?e.jsx(ee,{children:e.jsx(I,{colSpan:a?10:8,className:"h-24 text-center text-red-500",children:"Failed to load records"})}):(h==null?void 0:h.data.length)===0?e.jsx(ee,{children:e.jsx(I,{colSpan:a?10:8,className:"h-24 text-center",children:"No records found"})}):h==null?void 0:h.data.map(v=>e.jsx(La,{record:v,isAdmin:a,role:s,isSelected:u.has(v.id),onToggleSelect:()=>Y(v.id),onEdit:()=>f(v)},v.id))})]})}),G>1&&e.jsx(mt,{children:e.jsxs(pt,{children:[e.jsx(me,{children:e.jsx(ft,{onClick:()=>n(v=>({...v,page:Math.max(1,v.page-1)})),className:t.page===1?"pointer-events-none opacity-50":"cursor-pointer"})}),e.jsx(me,{children:e.jsxs("div",{className:"flex items-center justify-center px-4 text-sm font-medium",children:["Page ",t.page," of ",G]})}),e.jsx(me,{children:e.jsx(ht,{onClick:()=>n(v=>({...v,page:Math.min(G,v.page+1)})),className:t.page===G?"pointer-events-none opacity-50":"cursor-pointer"})})]})})]})})},La=({record:t,isAdmin:n,role:s,isSelected:a,onToggleSelect:r,onEdit:o})=>{var u,c,x,h,l;const[m,p]=i.useState(!1),g=Hn(),f=()=>{confirm("Are you sure you want to delete this record?")&&g.mutate(t.id)};return e.jsxs(e.Fragment,{children:[e.jsxs(ee,{className:"group",children:[e.jsx(I,{onClick:N=>N.stopPropagation(),children:e.jsx(ct,{checked:a,onCheckedChange:r})}),e.jsx(I,{children:e.jsx(vs,{open:m,onOpenChange:p,children:e.jsx(bs,{asChild:!0,children:e.jsxs(U,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",children:[m?e.jsx(cs,{className:"h-4 w-4"}):e.jsx(Ae,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Toggle"})]})})})}),e.jsx(I,{className:"font-medium",children:t.date?_e(new Date(t.date),"dd MMM yyyy"):"-"}),e.jsx(I,{children:t.fullName}),e.jsx(I,{children:t.clientName}),e.jsx(I,{className:"hidden md:table-cell",children:t.location}),e.jsx(I,{children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm",children:t.shiftName}),e.jsx("span",{className:"text-xs text-muted-foreground",children:t.shiftStart&&t.shiftEnd?`${_e(new Date(`1970-01-01T${t.shiftStart}`),"HH:mm")} - ${_e(new Date(`1970-01-01T${t.shiftEnd}`),"HH:mm")}`:""})]})}),e.jsx(I,{className:"text-right",children:t.paidHours.toFixed(2)}),n&&e.jsxs(I,{className:"text-right",children:["£",((u=t.totalPay)==null?void 0:u.toFixed(2))||"0.00"]}),n&&e.jsxs(I,{className:"text-right font-medium",children:["£",((c=t.clientNet)==null?void 0:c.toFixed(2))||"0.00"]}),e.jsx(I,{children:(n||s==="manager")&&e.jsxs(Ea,{children:[e.jsx(Da,{asChild:!0,children:e.jsxs(U,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(ms,{className:"h-4 w-4"})]})}),e.jsxs(pn,{align:"end",children:[e.jsx(fn,{children:"Actions"}),e.jsxs(De,{onClick:N=>{N.stopPropagation(),o()},children:[e.jsx(Xn,{className:"mr-2 h-4 w-4"})," Edit"]}),e.jsxs(De,{onClick:N=>{N.stopPropagation(),f()},className:"text-red-600",children:[e.jsx(ut,{className:"mr-2 h-4 w-4"})," Delete"]})]})]})})]}),e.jsx(ee,{className:m?"":"hidden",children:e.jsx(I,{colSpan:n?10:8,className:"p-0 border-b-0",children:e.jsxs("div",{className:`bg-muted/50 p-4 grid grid-cols-1 ${n?"md:grid-cols-3":"md:grid-cols-2"} gap-4 text-sm shadow-inner`,children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Job Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"Site:"}),e.jsx("span",{children:t.site}),e.jsx("span",{className:"text-muted-foreground",children:"Job Name:"}),e.jsx("span",{children:t.jobName}),e.jsx("span",{className:"text-muted-foreground",children:"Status:"}),e.jsx($n,{variant:"outline",className:"w-fit",children:t.jobStatus||"N/A"})]})]}),n&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Financial Breakdown"}),e.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"Pay Rate:"}),e.jsxs("span",{children:["£",((x=t.hourRate)==null?void 0:x.toFixed(2))||"0.00","/hr"]}),e.jsx("span",{className:"text-muted-foreground",children:"Charge Rate:"}),e.jsxs("span",{children:["£",((h=t.clientHourlyRate)==null?void 0:h.toFixed(2))||"0.00","/hr"]}),e.jsx("span",{className:"text-muted-foreground",children:"Total Charge:"}),e.jsxs("span",{children:["£",((l=t.totalCharge)==null?void 0:l.toFixed(2))||"0.00"]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Metadata"}),e.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"System ID:"}),e.jsx("span",{className:"font-mono text-xs",children:t.id})]})]})]})})})]})};export{io as default};
