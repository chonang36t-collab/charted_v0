import{j as t,e as E,B as U,r as N,a as O,A as H,S as V}from"./index-DO8IG2PN.js";import{C as B,a as F,b as G,d as K}from"./card-B-M-RSWR.js";import{C as J}from"./DashboardLayout-57TLwtr2.js";import{f as z}from"./popover-Dh_PEMU_.js";import{P as Q}from"./progress-PdGPvrfs.js";import{E as W}from"./ellipsis-CcvjmOMy.js";const ae=(e,i)=>{var C,w,b,r,n,g,R,A,$,I,L,k,q,M,_;if(!e)return{revenue:{value:0,change:0,trend:"neutral",text:"No data available"},clientPay:{value:0,change:0,trend:"neutral",text:"No data available"},staffPay:{value:0,change:0,trend:"neutral",text:"No data available"},totalShifts:{value:0,change:0,trend:"neutral",text:"No data available"},paidHours:{value:0,change:0,trend:"neutral",text:"No data available"},uniqueEmployees:{value:0,change:0,trend:"neutral",text:"No data available"},avgShiftDuration:{value:0,change:0,trend:"neutral",text:"No data available"},totalClients:{value:0,change:0,trend:"neutral",text:"No data available"}};const l=e.totalRevenue||0,h=e.avgClientPayPerHour||0,d=e.avgStaffPayPerHour||0,v=((C=e.previousPeriod)==null?void 0:C.totalRevenue)||0,p=((w=e.previousPeriod)==null?void 0:w.avgClientPayPerHour)||0,u=((b=e.previousPeriod)==null?void 0:b.avgStaffPayPerHour)||0,a=(y,j)=>j>0?(y-j)/j*100:0,s=a(l,v),o=a(h,p),P=a(d,u),m=y=>y>0?"up":y<0?"down":"neutral",x=(y,j,T)=>{if(!j)return"No previous data";let S="";return T<=7?S="last week":T<=31?S="last month":T<=93?S="last quarter":S="last period",`${y>0?"+":""}${Math.abs(y).toFixed(1)}% from ${S}`},f=Math.ceil((i.to.getTime()-i.from.getTime())/(1e3*60*60*24)),c=!!e.previousPeriod;return{revenue:{value:l,change:s,trend:m(s),text:x(s,c,f)},clientPay:{value:h,change:o,trend:m(o),text:x(o,c,f)},staffPay:{value:d,change:P,trend:m(P),text:x(P,c,f)},totalShifts:{value:e.totalShifts,change:a(e.totalShifts,((r=e.previousPeriod)==null?void 0:r.totalShifts)||0),trend:m(a(e.totalShifts,((n=e.previousPeriod)==null?void 0:n.totalShifts)||0)),text:x(a(e.totalShifts,((g=e.previousPeriod)==null?void 0:g.totalShifts)||0),c,f)},paidHours:{value:e.totalPaidHours||0,change:a(e.totalPaidHours||0,((R=e.previousPeriod)==null?void 0:R.totalPaidHours)||0)||0,trend:m(a(e.totalPaidHours||0,((A=e.previousPeriod)==null?void 0:A.totalPaidHours)||0)),text:x(a(e.totalPaidHours||0,(($=e.previousPeriod)==null?void 0:$.totalPaidHours)||0),c,f)},uniqueEmployees:{value:e.uniqueEmployees,change:a(e.uniqueEmployees,((I=e.previousPeriod)==null?void 0:I.uniqueEmployees)||0),trend:m(a(e.uniqueEmployees,((L=e.previousPeriod)==null?void 0:L.uniqueEmployees)||0)),text:x(a(e.uniqueEmployees,((k=e.previousPeriod)==null?void 0:k.uniqueEmployees)||0),c,f)},avgShiftDuration:{value:e.totalPaidHours&&e.totalShifts?e.totalPaidHours/e.totalShifts:0,change:0,trend:"neutral",text:"Average hours per shift"},totalClients:{value:e.totalClients,change:a(e.totalClients,((q=e.previousPeriod)==null?void 0:q.totalClients)||0),trend:m(a(e.totalClients,((M=e.previousPeriod)==null?void 0:M.totalClients)||0)),text:x(a(e.totalClients,((_=e.previousPeriod)==null?void 0:_.totalClients)||0),c,f)}}},se=({title:e,value:i,subtitle:l,icon:h,trend:d,isSelected:v=!1,onClick:p,onViewDetails:u,children:a})=>{const s=!!p;return t.jsxs(B,{className:E("relative transition-all duration-200",s&&"cursor-pointer hover:shadow-md hover:border-primary/50",v&&"border-primary shadow-md ring-2 ring-primary/20"),onClick:p,children:[t.jsxs(F,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(G,{className:"text-sm font-medium",children:e}),h&&t.jsx(h,{className:E("h-4 w-4 text-muted-foreground",v&&"text-primary")})]}),t.jsxs(K,{children:[t.jsx("div",{className:"text-2xl font-bold",children:i}),l&&t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:l}),d&&t.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:d}),u&&t.jsxs(U,{variant:"ghost",size:"sm",className:"mt-2 w-full justify-between text-xs h-8",onClick:o=>{o.stopPropagation(),u()},children:["View Details",t.jsx(J,{className:"h-3 w-3"})]}),a]})]})},oe=(e,i,l)=>{const[h,d]=N.useState([]),[v,p]=N.useState([]),[u,a]=N.useState([]),[s,o]=N.useState(!1),[P,m]=N.useState(!1),[x,f]=N.useState(!1);O();const c=()=>{const r=new URLSearchParams({start:z(e.from,"yyyy-MM-dd"),end:z(e.to,"yyyy-MM-dd")});return i&&i.length>0&&i.forEach(n=>r.append("locations",n)),l&&l.length>0&&l.forEach(n=>r.append("sites",n)),r},C=async()=>{o(!0);try{const r=c();r.append("limit","100");const n=await fetch(`${H.RANKINGS_STAFF}?${r}`,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});if(n.ok){const g=await n.json();d(g)}}catch(r){console.error(r)}finally{o(!1)}},w=async()=>{m(!0);try{const r=c();r.append("limit","100"),r.append("metric","revenue");const n=await fetch(`${H.RANKINGS_CLIENTS}?${r}`,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});if(n.ok){const g=await n.json();p(g)}}catch(r){console.error(r)}finally{m(!1)}},b=async()=>{f(!0);try{const r=c();r.append("limit","100"),r.append("metric","shifts");const n=await fetch(`${H.RANKINGS_CLIENTS}?${r}`,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});if(n.ok){const g=await n.json();a(g)}}catch(r){console.error(r)}finally{f(!1)}};return N.useEffect(()=>{C(),w(),b()},[e,i,l]),{topStaff:h,isLoadingStaff:s,topClientsRevenue:v,isLoadingClientsRev:P,topClientsShifts:u,isLoadingClientsShifts:x}},ne=({title:e,data:i,isLoading:l=!1,valueFormatter:h=u=>u.toLocaleString(),icon:d,className:v,barColor:p="bg-primary"})=>{const u=Math.max(...i.map(s=>s.value),0),a=s=>s.toLowerCase().split(" ").map(o=>o.charAt(0).toUpperCase()+o.slice(1)).join(" ");return t.jsxs(B,{className:E("flex flex-col h-full shadow-sm hover:shadow-md transition-shadow min-w-0",v),children:[t.jsxs(F,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[d&&t.jsx("div",{className:"p-1.5 bg-muted rounded-md",children:d}),t.jsx(G,{className:"text-sm font-medium",children:e})]}),t.jsx(W,{className:"h-4 w-4 text-muted-foreground cursor-pointer hover:text-foreground"})]}),t.jsx(K,{className:"pt-4 flex-1 min-w-0",children:l?t.jsx("div",{className:"space-y-4",children:[...Array(5)].map((s,o)=>t.jsxs("div",{className:"flex flex-col gap-2",children:[t.jsx("div",{className:"h-4 w-1/3 bg-muted animate-pulse rounded"}),t.jsx("div",{className:"h-2 w-full bg-muted animate-pulse rounded"})]},o))}):i.length===0?t.jsx("div",{className:"flex h-full items-center justify-center text-sm text-muted-foreground p-4",children:"No data available"}):t.jsx(V,{className:"h-[240px]",children:t.jsx("div",{className:"space-y-6 pr-4",children:i.map((s,o)=>t.jsxs("div",{className:"flex flex-col gap-2 group min-w-0",children:[t.jsx("div",{className:"flex items-center justify-between text-sm gap-2",children:t.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[t.jsx("span",{className:"flex h-5 w-5 flex-shrink-0 items-center justify-center rounded-full bg-muted text-[10px] font-medium text-muted-foreground group-hover:bg-primary group-hover:text-primary-foreground transition-colors",children:o+1}),t.jsx("span",{className:"font-medium",title:s.name,children:a(s.name)})]})}),t.jsxs("div",{className:"space-y-1.5",children:[t.jsx(Q,{value:u>0?s.value/u*100:0,className:E("h-1.5 w-full",p&&`[&>*]:${p}`)}),t.jsx("div",{className:"flex justify-end",children:t.jsx("span",{className:"text-xs font-semibold text-muted-foreground whitespace-nowrap",children:h(s.value)})})]})]},o))})})})]})};export{se as M,ne as R,ae as c,oe as u};
