import{ab as T,r as p,j as e,T as te,e as F,B as D,I as $,k as re,l as se,m as ae,ac as le}from"./index-Bqtu-zN6.js";import{D as oe,T as ne}from"./DashboardLayout-DT7BCjw-.js";import{L as ie}from"./label-DdPrH6gw.js";import{T as I}from"./trash-2-Cq72jxEv.js";import{e as ue,f as P,s as ce,P as de,a as me,C as fe,b as be,d as he}from"./popover-D_SH7HmH.js";import{D as z,a as B,b as J,c as K,d as G,e as V}from"./dialog-Y9rmCjMF.js";import{P as U}from"./plus-C-fC9XZn.js";import"./users-CSCyi3ZF.js";function pe(t,a){const i=T(t.start),r=T(t.end);let y=+i>+r;const v=y?+i:+r,c=y?r:i;c.setHours(0,0,0,0),c.setDate(1);let f=1;const C=[];for(;+c<=v;)C.push(T(c)),c.setMonth(c.getMonth()+f);return y?C.reverse():C}function xe(t){const a=T(t),i=a.getFullYear();return a.setFullYear(i+1,0,0),a.setHours(23,59,59,999),a}function ye(t,a){return t===null||t===0?"":a.isPercentage?`${t.toFixed(2)}%`:a.isCurrency?`Â£${t.toLocaleString("en-GB",{minimumFractionDigits:2,maximumFractionDigits:2})}`:t.toLocaleString("en-GB",{maximumFractionDigits:2})}function ge({source:t,formula:a,value:i}){return e.jsxs("div",{className:"text-xs space-y-1",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Source:"})," ",t||"Unknown"]}),a&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Formula:"}),e.jsx("code",{className:"bg-muted px-1 rounded ml-1",children:a})]})]})}function _e({rowId:t,colId:a,value:i,row:r,isActive:y,source:v,onFocus:c,onUpdate:f,onNavigate:C}){const[S,n]=p.useState(!1),[u,x]=p.useState(""),o=p.useRef(null),g=p.useCallback(()=>{n(!0),x(i!==null?String(i):""),setTimeout(()=>{var w;return(w=o.current)==null?void 0:w.focus()},0)},[i]),_=p.useCallback(()=>{n(!1);const w=parseFloat(u);f(u===""?null:isNaN(w)?i:w)},[u,f,i]),A=p.useCallback(w=>{w.key==="Enter"?_():w.key==="Escape"&&n(!1)},[_]);return p.useEffect(()=>{if(y&&!S){const w=l=>{["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(l.key)?(l.preventDefault(),C({ArrowUp:"up",ArrowDown:"down",ArrowLeft:"left",ArrowRight:"right"}[l.key])):!l.ctrlKey&&!l.altKey&&!l.metaKey&&l.key.length===1?(g(),x("")):l.key==="Enter"?(l.preventDefault(),g()):(l.key==="Backspace"||l.key==="Delete")&&f(null)};return window.addEventListener("keydown",w),()=>window.removeEventListener("keydown",w)}},[y,S,C,g,f]),S?e.jsx("input",{ref:o,type:"text",className:"w-full h-full px-2 py-1 outline-none bg-background text-center font-lato",value:u,onChange:w=>x(w.target.value),onBlur:_,onKeyDown:A}):e.jsxs(re,{children:[e.jsx(se,{asChild:!0,children:e.jsx("div",{className:F("w-full h-full px-2 py-1 cursor-cell flex items-center justify-center font-lato",r.isHeader&&"font-bold"),onClick:c,onDoubleClick:g,children:ye(i,r)})}),v&&e.jsx(ae,{children:e.jsx(ge,{source:v,value:i})})]})}function Ce(t){let a="",i=t;for(;i>=0;)a=String.fromCharCode(i%26+65)+a,i=Math.floor(i/26)-1;return a}function we({rows:t,columns:a,data:i,activeCell:r,setActiveCell:y,updateCell:v,deleteRow:c,deleteColumn:f,navigateCell:C,updateRowFormula:S,renameColumn:n}){const[u,x]=p.useState(null);return e.jsxs("div",{className:"flex-1 overflow-auto relative border border-border rounded-md bg-background",children:[e.jsx(te,{children:e.jsxs("table",{className:"w-full border-collapse table-fixed text-sm",children:[e.jsxs("thead",{className:"sticky top-0 z-20 bg-muted/90 backdrop-blur-sm shadow-sm",children:[e.jsxs("tr",{children:[e.jsx("th",{className:"w-12 border-b border-border bg-muted p-1 text-center text-xs text-muted-foreground font-normal select-none relative group",children:e.jsx("div",{className:"absolute inset-0 bg-muted/50"})}),e.jsx("th",{className:"w-64 border-b border-r border-border bg-muted p-2 text-left font-medium text-muted-foreground"}),a.map((o,g)=>e.jsx("th",{className:"border-b border-r border-border bg-muted p-1 text-center text-xs font-normal text-muted-foreground select-none relative min-w-[120px]",children:Ce(g)},`excel-${g}`))]}),e.jsxs("tr",{children:[e.jsx("th",{className:"w-12 border-b border-border bg-background p-2"}),e.jsx("th",{className:"w-64 border-b border-r border-border bg-background p-2 text-left font-semibold text-foreground",children:"Metric / Account"}),a.map(o=>e.jsx("th",{className:F("relative border-b border-r border-border bg-background p-2 text-right font-semibold min-w-[120px]",o.isYearEnd?"text-primary/80 bg-primary/5":"text-foreground"),children:e.jsxs("div",{className:"flex items-center justify-end gap-2 group",children:[e.jsx("span",{className:"cursor-pointer hover:text-primary transition-colors py-1",onDoubleClick:()=>!o.isProtected&&x({id:o.id,type:"col",value:o.label}),children:o.label}),!o.isProtected&&e.jsx(D,{variant:"ghost",size:"icon",className:"h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity absolute top-1 right-1",onClick:()=>f(o.id),children:e.jsx(I,{className:"h-3 w-3 text-destructive"})})]})},o.id))]})]}),e.jsx("tbody",{children:t.map((o,g)=>e.jsxs("tr",{className:"group/row hover:bg-muted/30 transition-colors",children:[e.jsx("td",{className:"border-r border-b border-border bg-muted/30 p-2 text-center text-xs text-muted-foreground font-mono select-none sticky left-0 z-10 w-12 text-lato",children:g+1}),e.jsx("td",{className:"border-r border-b border-border p-2 font-medium bg-background relative w-64",children:e.jsxs("div",{className:"flex items-center justify-between group",children:[o.isHeader?e.jsx("span",{className:"font-bold text-primary",children:o.label}):e.jsx("span",{className:"cursor-pointer hover:text-primary transition-colors w-full",onDoubleClick:()=>!o.isAutoCalculated&&x({id:o.id,type:"row",value:o.label}),children:o.label}),!o.isAutoCalculated&&e.jsx(D,{variant:"ghost",size:"icon",className:"h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity absolute right-2",onClick:()=>c(o.id),children:e.jsx(I,{className:"h-3 w-3 text-destructive"})})]})}),a.map(_=>{var s;const A=(s=i[o.id])==null?void 0:s[_.id],w=(A==null?void 0:A.value)??null,l=(r==null?void 0:r.row)===o.id&&(r==null?void 0:r.col)===_.id;return e.jsx("td",{className:F("border-r border-b border-border p-0 relative min-w-[120px]",l?"ring-2 ring-primary z-10":"",o.isHeader?"bg-muted/20 font-semibold":"",_.isYearEnd?"bg-primary/5 font-semibold":""),onClick:()=>y({row:o.id,col:_.id}),children:e.jsx(_e,{rowId:o.id,colId:_.id,value:w,row:o,isActive:l,onFocus:()=>y({row:o.id,col:_.id}),onUpdate:b=>v(o.id,_.id,b),onNavigate:C})},`${o.id}-${_.id}`)})]},o.id))})]})}),u&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-background/80 backdrop-blur-sm",onClick:()=>x(null),children:e.jsxs("div",{className:"bg-card p-4 rounded-lg shadow-lg border w-96",onClick:o=>o.stopPropagation(),children:[e.jsxs(ie,{children:["Edit ",u.type==="row"?"Row":"Column"," Label"]}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx($,{autoFocus:!0,value:u.value,onChange:o=>x({...u,value:o.target.value}),onKeyDown:o=>{o.key==="Enter"&&(u.type==="col"&&n&&n(u.id,u.value),x(null))}}),e.jsx(D,{onClick:()=>x(null),children:"Done"})]})]})})]})}const L=t=>{if(!(t!=null&&t.from)||!(t!=null&&t.to))return new Date().getFullYear(),[{id:"jan",label:"January",isProtected:!0},{id:"feb",label:"February",isProtected:!0},{id:"mar",label:"March",isProtected:!0},{id:"apr",label:"April",isProtected:!0},{id:"may",label:"May",isProtected:!0},{id:"jun",label:"June",isProtected:!0},{id:"jul",label:"July",isProtected:!0},{id:"aug",label:"August",isProtected:!0},{id:"sep",label:"September",isProtected:!0},{id:"oct",label:"October",isProtected:!0},{id:"nov",label:"November",isProtected:!0},{id:"dec",label:"December",isProtected:!0},{id:"year_end",label:"Year End",isProtected:!0,isYearEnd:!0}];const i=pe({start:le(t.from),end:ue(t.to)}).map(r=>({id:P(r,"MMM-yyyy").toLowerCase(),label:P(r,"MMM yyyy"),isProtected:!0}));return i.push({id:"year_end",label:"Period Total",isProtected:!0,isYearEnd:!0}),i},R=(t,a,i)=>{var r,y;try{const v=Object.keys(a).sort((C,S)=>S.length-C.length);let c=t;for(const C of v){const S=new RegExp(`\\b${C}\\b`,"g");if(S.test(c)){const n=((y=(r=a[C])==null?void 0:r[i])==null?void 0:y.value)??0;c=c.replace(S,`(${n})`)}}if(!/^[0-9+\-*/().\s]*$/.test(c))return null;const f=new Function(`return ${c}`)();return typeof f=="number"&&!isNaN(f)&&isFinite(f)?f:null}catch{return null}},Y=[{id:"total_sales",label:"Total Sales",isAutoCalculated:!1,isCurrency:!0},{id:"sales_split_pct",label:"% Sales Split for the Year",isAutoCalculated:!1,isPercentage:!0},{id:"cost_sales_se",label:"Cost of Sales SE",isAutoCalculated:!1,isCurrency:!0},{id:"cost_sales_paye",label:"Cost of Sales PAYE Gross",isAutoCalculated:!1,isCurrency:!0},{id:"employee_ni",label:"Employee NI",isAutoCalculated:!1,isCurrency:!0},{id:"employee_pension",label:"Employee Pension",isAutoCalculated:!1,isCurrency:!0},{id:"total_cost_sales",label:"Total Cost of Sales",isAutoCalculated:!0,isCurrency:!0,isHeader:!0,formulaString:"cost_sales_se + cost_sales_paye + employee_ni + employee_pension"},{id:"apprenticeship_levy",label:"Apprenticeship Levy",isAutoCalculated:!1,isCurrency:!0},{id:"annual_leave",label:"Annual Leave Accrual",isAutoCalculated:!1,isCurrency:!0},{id:"other_expenses",label:"Other Expenses",isAutoCalculated:!1,isCurrency:!0},{id:"recruitment_cost",label:"Recruitment & Pass Cost",isAutoCalculated:!1,isCurrency:!0},{id:"overheads_mgmt",label:"Mgmt & Office Cost",isAutoCalculated:!1,isCurrency:!0},{id:"bank_interest",label:"Bank Interest",isAutoCalculated:!1,isCurrency:!0},{id:"cooperation_tax",label:"Cooperation Tax",isAutoCalculated:!1,isCurrency:!0},{id:"total_overheads",label:"Total Overheads",isAutoCalculated:!0,isCurrency:!0,isHeader:!0,formulaString:"apprenticeship_levy + annual_leave + other_expenses + recruitment_cost + overheads_mgmt + bank_interest + cooperation_tax"},{id:"total_cost",label:"Total Cost",isAutoCalculated:!0,isCurrency:!0,isHeader:!0,formulaString:"total_cost_sales + total_overheads"},{id:"worked_hours",label:"Total Worked Hours",isAutoCalculated:!1,isCurrency:!1},{id:"avg_hourly_charge",label:"Avg Hourly Charge",isAutoCalculated:!0,isCurrency:!0,formulaString:"total_sales / worked_hours"},{id:"gross_hourly_pay",label:"Gross Hourly Pay",isAutoCalculated:!0,isCurrency:!0,formulaString:"total_cost_sales / worked_hours"},{id:"gross_hourly_margin",label:"Gross Hourly Margin",isAutoCalculated:!0,isCurrency:!0,formulaString:"avg_hourly_charge - gross_hourly_pay"},{id:"net_cost_per_hour",label:"Net Cost per Hour",isAutoCalculated:!0,isCurrency:!0,formulaString:"total_cost / worked_hours"},{id:"gross_pl_value",label:"Gross P&L Value",isAutoCalculated:!0,isCurrency:!0,formulaString:"total_sales - cost_sales_se"},{id:"net_pl",label:"Net P&L",isAutoCalculated:!0,isCurrency:!0,formulaString:"total_sales - total_cost"},{id:"total_net_margin",label:"Total Net Margin",isAutoCalculated:!0,isCurrency:!0,formulaString:"net_pl / worked_hours"},{id:"hours_breakeven",label:"Hours for Breakeven",isAutoCalculated:!0,formulaString:"(other_expenses + overheads_mgmt) / gross_hourly_margin"},{id:"value_breakeven",label:"Total Value for Breakeven",isAutoCalculated:!0,isCurrency:!0,formulaString:"hours_breakeven * net_cost_per_hour"},{id:"avg_hourly_charge_2026",label:"Average Hourly Charge Rate Future (6%)",isAutoCalculated:!0,isCurrency:!0,formulaString:"avg_hourly_charge * 1.06"},{id:"sales_budget_2026",label:"Projected Sales Budget (30% Uplift)",isAutoCalculated:!0,isCurrency:!0,formulaString:"total_sales * 1.3"},{id:"sales_target_hours",label:"Sales Target in Hours",isAutoCalculated:!0,formulaString:"sales_budget_2026 / avg_hourly_charge_2026"},{id:"variance_2025",label:"Variance",isAutoCalculated:!0,formulaString:"sales_target_hours - worked_hours"}];function W(t,a){const i={};for(const r of t){i[r.id]={};for(const y of a)i[r.id][y.id]={value:null,isEditable:!r.isAutoCalculated&&!y.isYearEnd,source:"manual"}}return i}function N(t,a,i){var C,S;const r=JSON.parse(JSON.stringify(t));for(const n of i.filter(u=>!u.isYearEnd))for(const u of a)u.formulaString?r[u.id][n.id]={...r[u.id][n.id],value:R(u.formulaString,r,n.id),isEditable:!1,source:"calculated"}:u.formula&&(r[u.id][n.id]={...r[u.id][n.id],value:u.formula(r,u.id,n.id),isEditable:!1,source:"calculated"});const y=a.find(n=>n.id==="total_sales"),v=a.find(n=>n.id==="sales_split_pct"),c=i.find(n=>n.isYearEnd);if(y&&v&&c){let n=0;const u=i.filter(x=>!x.isYearEnd);n=u.reduce((x,o)=>{var g,_;return x+(((_=(g=r.total_sales)==null?void 0:g[o.id])==null?void 0:_.value)??0)},0);for(const x of u){const o=((S=(C=r.total_sales)==null?void 0:C[x.id])==null?void 0:S.value)??0,g=n!==0?o/n*100:0;r.sales_split_pct[x.id]={value:g,isEditable:!1,source:"calculated"}}r.sales_split_pct[c.id]={value:n!==0?100:0,isEditable:!1,source:"calculated"}}const f=i.find(n=>n.isYearEnd);if(f)for(const n of a){if(n.id==="sales_split_pct")continue;const u=i.filter(x=>!x.isYearEnd).reduce((x,o)=>{var g,_;return x+(((_=(g=r[n.id])==null?void 0:g[o.id])==null?void 0:_.value)??0)},0);n.formulaString||n.isAutoCalculated?n.formulaString?r[n.id][f.id]={value:R(n.formulaString,r,f.id),isEditable:!1,source:"calculated"}:n.formula?r[n.id][f.id]={value:n.formula(r,n.id,f.id),isEditable:!1,source:"calculated"}:r[n.id][f.id]={value:u,isEditable:!1,source:"calculated"}:r[n.id][f.id]={value:u,isEditable:!1,source:"calculated"}}return r}function je(t){const[a,i]=p.useState(Y),[r,y]=p.useState(()=>L(t)),[v,c]=p.useState(()=>N(W(Y,L(t)),Y,L(t))),[f,C]=p.useState(null);p.useEffect(()=>{const l=L(t);y(l);let s=W(a,l);t!=null&&t.from&&(t!=null&&t.to)?(async()=>{try{const m=P(t.from,"yyyy-MM-dd"),d=P(t.to,"yyyy-MM-dd"),k=localStorage.getItem("auth_token"),h=await fetch(`/api/financial-summary/metrics?start=${m}&end=${d}`,{headers:{Authorization:`Bearer ${k}`},credentials:"include"});if(h.status===401){console.error("Unauthorized: Redirecting to login"),window.location.href="/auth";return}if(h.ok){const j=h.headers.get("content-type");if(j&&j.indexOf("application/json")!==-1){const M=await h.json(),q={January:"jan",February:"feb",March:"mar",April:"apr",May:"may",June:"jun",July:"jul",August:"aug",September:"sep",October:"oct",November:"nov",December:"dec"};for(const[Q,O]of Object.entries(M)){const[X,Z]=Q.split("-"),H=q[Z];if(!H)continue;const E=`${H}-${X}`;l.find(ee=>ee.id===E)&&(s.total_sales&&s.total_sales[E]&&(s.total_sales[E].value=O.total_sales,s.total_sales[E].source="backend"),s.cost_sales_se&&s.cost_sales_se[E]&&(s.cost_sales_se[E].value=O.cost_sales_se,s.cost_sales_se[E].source="backend"),s.cost_sales_paye&&s.cost_sales_paye[E]&&(s.cost_sales_paye[E].value=O.cost_sales_paye,s.cost_sales_paye[E].source="backend"))}c(N(s,a,l))}else console.error("Received non-JSON response from API"),c(N(s,a,l))}else console.error("API Error",h.status,h.statusText),c(N(s,a,l))}catch(m){console.error("Failed to fetch metrics",m),c(N(s,a,l))}})():c(N(s,a,l))},[t]);const S=p.useCallback((l,s,b)=>{c(m=>{const d={...m};return d[l]={...d[l]},d[l][s]={...d[l][s],value:b,source:"manual"},N(d,a,r)})},[a,r]),n=p.useCallback((l,s)=>{i(b=>{const m=b.map(d=>d.id===l?{...d,formulaString:s}:d);return c(d=>N(d,m,r)),m})},[r]),u=p.useCallback(l=>{const s=`custom_${Date.now()}`,b={id:s,label:l,isAutoCalculated:!1,isCurrency:!0};i(m=>{const d=[...m,b];return c(k=>{const h={...k};h[s]={};for(const j of r)h[s][j.id]={value:null,isEditable:!j.isYearEnd,source:"manual"};return N(h,d,r)}),d})},[r]),x=p.useCallback(l=>{i(s=>s.filter(b=>b.id!==l)),c(s=>{const b={...s};return delete b[l],b})},[]),o=p.useCallback(l=>{const s=`col_${Date.now()}`,b={id:s,label:l};y(m=>{const d=m.findIndex(h=>h.isYearEnd),k=[...m];return k.splice(d,0,b),c(h=>{const j={...h};for(const M of a)j[M.id]={...j[M.id]},j[M.id][s]={value:null,isEditable:!M.isAutoCalculated,source:"manual"};return N(j,a,k)}),k})},[a]),g=p.useCallback(l=>{y(s=>{const b=s.filter(m=>m.id!==l);return c(m=>{const d={...m};for(const k of Object.keys(d)){const{[l]:h,...j}=d[k];d[k]=j}return N(d,a,b)}),b})},[a]),_=p.useCallback((l,s)=>{y(b=>b.map(m=>m.id===l?{...m,label:s}:m))},[]),A=p.useCallback(l=>{if(!f)return;const s=a.filter(j=>!j.isAutoCalculated),b=r.filter(j=>!j.isYearEnd),m=s.findIndex(j=>j.id===f.row),d=b.findIndex(j=>j.id===f.col);if(m===-1||d===-1)return;let k=m,h=d;switch(l){case"up":k=Math.max(0,m-1);break;case"down":k=Math.min(s.length-1,m+1);break;case"left":h=Math.max(0,d-1);break;case"right":h=Math.min(b.length-1,d+1);break}C({row:s[k].id,col:b[h].id})},[f,a,r]),w=p.useCallback(async l=>{if(l)try{const s={year:new Date().getFullYear(),data:v,rows:a,columns:r},b=localStorage.getItem("auth_token");if(!(await fetch("/api/financial-summary/save",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${b}`},body:JSON.stringify(s)})).ok)throw new Error("Failed to save")}catch(s){throw console.error("Save failed",s),s}},[v,a,r]);return{rows:a,columns:r,data:v,activeCell:f,setActiveCell:C,updateCell:S,addRow:u,deleteRow:x,addColumn:o,deleteColumn:g,renameColumn:_,navigateCell:A,saveData:w,updateRowFormula:n}}function Me(){const[t,a]=p.useState({from:ce(new Date),to:xe(new Date)}),{rows:i,columns:r,data:y,activeCell:v,setActiveCell:c,updateCell:f,addRow:C,deleteRow:S,addColumn:n,deleteColumn:u,navigateCell:x,updateRowFormula:o}=je(t),[g,_]=p.useState(""),[A,w]=p.useState(""),[l,s]=p.useState(!1),[b,m]=p.useState(!1),d=()=>{g.trim()&&(C(g.trim()),_(""),s(!1))},k=()=>{A.trim()&&(n(A.trim()),w(""),m(!1))};return e.jsx(oe,{noPadding:!0,fullWidth:!0,children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-border bg-card/50 shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx(ne,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-foreground",children:"Financial Summary."}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Annual budget and performance spreadsheet"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(de,{children:[e.jsx(me,{asChild:!0,children:e.jsxs(D,{id:"date",variant:"outline",className:F("w-[260px] justify-start text-left font-normal",!t&&"text-muted-foreground"),children:[e.jsx(fe,{className:"mr-2 h-4 w-4"}),t!=null&&t.from?t.to?e.jsxs(e.Fragment,{children:[P(t.from,"LLL dd, y")," -"," ",P(t.to,"LLL dd, y")]}):P(t.from,"LLL dd, y"):e.jsx("span",{children:"Pick a date"})]})}),e.jsx(be,{className:"w-auto p-0",align:"end",children:e.jsx(he,{initialFocus:!0,mode:"range",defaultMonth:t==null?void 0:t.from,selected:t,onSelect:a,numberOfMonths:2,captionLayout:"dropdown-buttons",fromYear:2020,toYear:2030})})]}),e.jsxs(z,{open:l,onOpenChange:s,children:[e.jsx(B,{asChild:!0,children:e.jsxs(D,{variant:"outline",size:"sm",children:[e.jsx(U,{className:"h-4 w-4 mr-1"})," Add Row"]})}),e.jsxs(J,{children:[e.jsx(K,{children:e.jsx(G,{children:"Add New Row"})}),e.jsx($,{placeholder:"Row label...",value:g,onChange:h=>_(h.target.value),onKeyDown:h=>h.key==="Enter"&&d()}),e.jsx(V,{children:e.jsx(D,{onClick:d,disabled:!g.trim(),children:"Add"})})]})]}),e.jsxs(z,{open:b,onOpenChange:m,children:[e.jsx(B,{asChild:!0,children:e.jsxs(D,{variant:"outline",size:"sm",children:[e.jsx(U,{className:"h-4 w-4 mr-1"})," Add Column"]})}),e.jsxs(J,{children:[e.jsx(K,{children:e.jsx(G,{children:"Add New Column"})}),e.jsx($,{placeholder:"Column label...",value:A,onChange:h=>w(h.target.value),onKeyDown:h=>h.key==="Enter"&&k()}),e.jsx(V,{children:e.jsx(D,{onClick:k,disabled:!A.trim(),children:"Add"})})]})]})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:e.jsx(we,{rows:i,columns:r,data:y,activeCell:v,setActiveCell:c,updateCell:f,deleteRow:S,deleteColumn:u,navigateCell:x,updateRowFormula:o})})]})})}export{Me as default};
