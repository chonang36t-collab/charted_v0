import{c as S,j as e,u as O,b as $,d as w,r as c,B as N}from"./index-rPM3s_Y2.js";import{U as A,D as H,L}from"./DashboardLayout-DI3MN083.js";import{u as U,L as z,R as E}from"./LoadingOverlay-DmT362cA.js";import{M as n,u as B,c as q,R as I}from"./RankingList-DNM5q4aa.js";import{D as W}from"./DashboardHeader-Daf9YT-N.js";import{P as f}from"./pound-sterling-CGpm4NgT.js";import{C as G,a as J,b as K,d as Q}from"./card-BV2z4ACO.js";import{T as h}from"./users-D2UsnzQI.js";import"./popover-D4Hisapw.js";import"./generateCategoricalChart-D43NcCUH.js";import"./AreaChart-oP1Geq80.js";import"./progress-BO7VeKbe.js";import"./ellipsis-Bzsd7hr8.js";import"./calendar-wPgt8F6O.js";import"./checkbox-B-efyCOC.js";import"./index-CkQOtv6u.js";import"./locationUtils-uPLdQhTS.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=S("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]),Y=({salesData:t,selectedMetric:a,onMetricSelect:o,onViewDetails:r})=>{var m,g,u;return e.jsxs("div",{className:"grid gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 w-full",children:[e.jsx(n,{title:"Avg Client Rate",value:`£${((m=t==null?void 0:t.avgClientPayPerHour)==null?void 0:m.toFixed(2))||"0.00"}`,icon:f,isSelected:a==="clientRate",onClick:()=>o==null?void 0:o("clientRate"),onViewDetails:()=>r==null?void 0:r("clientRate"),subtitle:"Per hour charged"}),e.jsx(n,{title:"Avg Staff Rate",value:`£${((g=t==null?void 0:t.avgStaffPayPerHour)==null?void 0:g.toFixed(2))||"0.00"}`,icon:A,isSelected:a==="staffRate",onClick:()=>o==null?void 0:o("staffRate"),onViewDetails:()=>r==null?void 0:r("staffRate"),subtitle:"Per hour paid"}),e.jsx(n,{title:"Profit Margin",value:`${((u=t==null?void 0:t.profitMargin)==null?void 0:u.toFixed(1))||0}%`,icon:X,isSelected:a==="profit",onClick:()=>o==null?void 0:o("profit"),onViewDetails:()=>r==null?void 0:r("profit"),subtitle:"Net margin (after overheads)"})]})},ge=()=>{var j,R,b;const t=O();$();const{dateRange:a,setDateRange:o}=w(),[r,m]=c.useState(!1),[g,u]=c.useState(a),[v,y]=c.useState([]),[x,F]=c.useState([]),[i,l]=c.useState("revenue"),d=p=>{t(`/dashboard/metrics/${p}`)},{financialData:s,isLoading:P}=U(a,v,x),{topClientsRevenue:T,isLoadingClientsRev:k}=B(a,v,x),C=q(s,a);return e.jsx(H,{fullWidth:!0,children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx(W,{dateRange:a,onDateRangeChange:o,calendarOpen:r,onCalendarOpenChange:m,tempDateRange:g,onTempDateRangeChange:u,selectedLocations:v,onLocationsChange:y,selectedSites:x,onSitesChange:F}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsxs("div",{className:"px-4 pt-6 pb-6 space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-2 px-1 py-1 bg-muted rounded-lg",children:[e.jsxs(N,{variant:"secondary",size:"sm",className:"gap-2 shadow-sm",children:[e.jsx(h,{className:"h-4 w-4"}),"Financial View"]}),e.jsxs(N,{variant:"ghost",size:"sm",className:"gap-2 text-muted-foreground hover:text-foreground",onClick:()=>t("/dashboard/operational"),children:[e.jsx(L,{className:"h-4 w-4"}),"Operational View"]})]})}),P&&e.jsx(z,{}),e.jsxs("div",{className:"grid gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 w-full",children:[e.jsx(n,{title:"Total Revenue",value:`£${((j=s==null?void 0:s.totalRevenue)==null?void 0:j.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}))??"0.00"}`,subtitle:C.revenue.text,trend:C.revenue.trend,icon:f,isSelected:i==="revenue",onClick:()=>l("revenue"),onViewDetails:()=>d("revenue")}),e.jsx(n,{title:"Total Cost",value:`£${((R=s==null?void 0:s.totalCost)==null?void 0:R.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}))??"0.00"}`,subtitle:"Total expenses",icon:h,isSelected:i==="cost",onClick:()=>l("cost"),onViewDetails:()=>d("cost")}),e.jsx(n,{title:"Total Overheads",value:`£${((b=s==null?void 0:s.totalOverheads)==null?void 0:b.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}))??"0.00"}`,subtitle:"Fixed & Variable expenses",icon:L,isSelected:i==="overheads",onClick:()=>l("overheads"),onViewDetails:()=>d("overheads")}),e.jsx(n,{title:"Total Profit",value:`£${(((s==null?void 0:s.totalRevenue)??0)-((s==null?void 0:s.totalCost)??0)-((s==null?void 0:s.totalOverheads)??0)).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`,subtitle:"Net Profit",icon:h,isSelected:i==="profit",onClick:()=>l("profit"),onViewDetails:()=>d("profit")})]}),e.jsx(Y,{salesData:s,selectedMetric:i,onMetricSelect:l,onViewDetails:d}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-7",children:[e.jsxs(G,{className:"col-span-5",children:[e.jsx(J,{children:e.jsxs(K,{children:[i==="revenue"&&"Revenue Overview",i==="cost"&&"Cost Overview",i==="profit"&&"Profit Trend",i==="shifts"&&"Shifts Trend",i==="clients"&&"New vs Returning Clients",i==="employees"&&"Active Employees Trend"]})}),e.jsx(Q,{className:"pl-2",children:e.jsx(E,{data:(s==null?void 0:s.timeSeries)||[],aggregationLevel:(s==null?void 0:s.aggregationLevel)||"monthly",selectedMetric:i})})]}),e.jsx("div",{className:"col-span-2 flex flex-col gap-4 h-full",children:e.jsx(I,{title:"Top Clients (Revenue)",data:T,isLoading:k,valueFormatter:p=>`£${p.toLocaleString()}`,icon:e.jsx(f,{className:"h-4 w-4"}),className:"h-full",barColor:"bg-green-500"})})]})]})})]})})};export{ge as FinancialDashboard,ge as default};
