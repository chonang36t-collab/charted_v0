import{c as le,ab as O,r as p,j as e,e as P,B as E,T as Q,k as X,l as Z,m as R,I,ac as oe}from"./index-CoblmJZV.js";import{D as ne,T as ie}from"./DashboardLayout-CNCKgcT1.js";import{D as $,b as H,c as z,d as B,e as J,a as K}from"./dialog-DjtW9QfA.js";import{L as ue}from"./label-Bxo8TLHd.js";import{T as U}from"./trash-2-yO4ik7ec.js";import{e as ce,C as de,b as me}from"./calendar-BpriYni-.js";import{f as M,s as fe,P as he,a as pe,b as be}from"./popover-daMAULH5.js";import{P as W}from"./plus-Dls6KUX2.js";import"./users-Cnybme16.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=le("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);function ye(s,l){const o=O(s.start),r=O(s.end);let h=+o>+r;const d=h?+o:+r,a=h?r:o;a.setHours(0,0,0,0),a.setDate(1);let x=1;const y=[];for(;+a<=d;)y.push(O(a)),a.setMonth(a.getMonth()+x);return h?y.reverse():y}function ge(s){const l=O(s),o=l.getFullYear();return l.setFullYear(o+1,0,0),l.setHours(23,59,59,999),l}function ee(s,l){return s===null||s===0?"":l.isPercentage?`${s.toFixed(2)}%`:l.isCurrency?`Â£${s.toLocaleString("en-GB",{minimumFractionDigits:2,maximumFractionDigits:2})}`:s.toLocaleString("en-GB",{maximumFractionDigits:2})}function te({source:s,formula:l,value:o}){return e.jsxs("div",{className:"text-xs space-y-1",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Source:"})," ",s||"Unknown"]}),l&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Formula:"}),e.jsx("code",{className:"bg-muted px-1 rounded ml-1",children:l})]})]})}function Ce({rowId:s,colId:l,value:o,row:r,isActive:h,source:d,onFocus:a,onUpdate:x,onNavigate:y}){const[C,j]=p.useState(!1),[_,w]=p.useState(""),A=p.useRef(null),k=p.useCallback(()=>{j(!0),w(o!==null?String(o):""),setTimeout(()=>{var i;return(i=A.current)==null?void 0:i.focus()},0)},[o]),S=p.useCallback(()=>{j(!1);const i=parseFloat(_);x(_===""?null:isNaN(i)?o:i)},[_,x,o]),v=i=>{C?i.key==="Enter"||i.key==="Tab"?(i.preventDefault(),S(),y(i.shiftKey?"up":"down")):i.key==="Escape"&&j(!1):i.key==="Enter"||i.key==="F2"?(i.preventDefault(),k()):i.key==="ArrowUp"?(i.preventDefault(),y("up")):i.key==="ArrowDown"?(i.preventDefault(),y("down")):i.key==="ArrowLeft"?(i.preventDefault(),y("left")):i.key==="ArrowRight"?(i.preventDefault(),y("right")):i.key==="Delete"||i.key==="Backspace"?(i.preventDefault(),x(null)):/^[0-9.\-]$/.test(i.key)&&(i.preventDefault(),w(i.key),j(!0),setTimeout(()=>{var c;return(c=A.current)==null?void 0:c.focus()},0))};return e.jsx(Q,{children:e.jsxs(X,{delayDuration:500,children:[e.jsx(Z,{asChild:!0,children:e.jsxs("td",{className:P("border border-border px-2 py-1 text-right text-sm min-w-[110px] cursor-cell transition-colors relative",h&&"ring-2 ring-primary ring-inset bg-primary/5",!h&&"hover:bg-muted/50",d==="backend"&&"bg-blue-50/30 dark:bg-blue-900/10",d==="formula"&&"bg-purple-50/30 dark:bg-purple-900/10"),onClick:a,onDoubleClick:k,onKeyDown:v,tabIndex:0,onFocus:a,children:[d==="backend"&&e.jsx("div",{className:"absolute top-0 right-0 w-1.5 h-1.5 bg-blue-400 rounded-bl-sm opacity-50"}),C?e.jsx("input",{ref:A,type:"text",value:_,onChange:i=>w(i.target.value),onBlur:S,className:"w-full bg-transparent text-right outline-none text-sm font-mono"}):e.jsx("span",{className:"font-mono text-sm",children:ee(o,r)})]})}),e.jsx(R,{children:e.jsx(te,{source:d,value:o})})]})})}function je({value:s,row:l,source:o,formula:r}){return e.jsx(Q,{children:e.jsxs(X,{delayDuration:500,children:[e.jsx(Z,{asChild:!0,children:e.jsxs("td",{className:P("border border-border px-2 py-1 text-right text-sm min-w-[110px] relative",l.isHeader?"bg-primary/10 font-semibold":"bg-muted/30",o==="calculated"&&"bg-orange-50/30 dark:bg-orange-900/10"),children:[r&&e.jsx("div",{className:"absolute top-0 right-0 w-1.5 h-1.5 bg-orange-400 rounded-bl-sm opacity-50"}),e.jsx("span",{className:"font-mono text-sm",children:ee(s,l)})]})}),e.jsx(R,{children:e.jsx(te,{source:o,formula:r,value:s})})]})})}function ve({isOpen:s,onClose:l,row:o,onSave:r}){const[h,d]=p.useState((o==null?void 0:o.formulaString)||"");return p.useEffect(()=>{o&&d(o.formulaString||"")},[o]),o?e.jsx($,{open:s,onOpenChange:a=>!a&&l(),children:e.jsxs(H,{children:[e.jsx(z,{children:e.jsxs(B,{children:["Edit Formula: ",o.label]})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(ue,{htmlFor:"formula",className:"text-right",children:"Formula"}),e.jsx(I,{id:"formula",value:h,onChange:a=>d(a.target.value),className:"col-span-3 font-mono"})]}),e.jsx("div",{className:"text-xs text-muted-foreground ml-[25%]",children:"Supported: +, -, *, /, (, ), row_ids (e.g. total_sales)"})]}),e.jsx(J,{children:e.jsx(E,{type:"submit",onClick:()=>r(h),children:"Save changes"})})]})}):null}function _e({rows:s,columns:l,data:o,activeCell:r,setActiveCell:h,updateCell:d,deleteRow:a,deleteColumn:x,navigateCell:y,onRenameColumn:C,updateRowFormula:j}){const[_,w]=p.useState(null),[A,k]=p.useState(""),S=p.useRef(null),[v,i]=p.useState(null),c=t=>{w(t.id),k(t.label),setTimeout(()=>{var m;return(m=S.current)==null?void 0:m.focus()},0)},n=()=>{_&&C&&C(_,A),w(null)},b=t=>{i(t)},f=t=>{v&&j&&j(v.id,t),i(null)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto border border-border rounded-lg bg-card max-w-full",children:e.jsxs("table",{className:"border-collapse w-full text-xs",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-card border border-border px-2 py-2 text-left font-semibold text-muted-foreground uppercase tracking-wider w-[240px] min-w-[240px]",children:"Description"}),l.map(t=>e.jsx("th",{className:P("sticky top-0 z-10 border border-border px-1 py-1 text-center font-semibold uppercase tracking-wider min-w-[80px]",t.isYearEnd?"bg-primary/10 text-primary":"bg-muted/50 text-muted-foreground"),onDoubleClick:()=>!t.isProtected&&c(t),children:e.jsx("div",{className:"flex items-center justify-center gap-1 h-8 group relative px-2",children:_===t.id?e.jsx("input",{ref:S,value:A,onChange:m=>k(m.target.value),onBlur:n,onKeyDown:m=>m.key==="Enter"&&n(),className:"w-full bg-background border rounded px-1 text-center"}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"truncate",children:t.label}),!t.isProtected&&e.jsx(E,{variant:"ghost",size:"icon",className:"h-5 w-5 opacity-0 group-hover:opacity-100 absolute -right-1 hover:text-destructive hover:bg-destructive/10",onClick:m=>{m.stopPropagation(),x(t.id)},children:e.jsx(U,{className:"h-3 w-3"})})]})})},t.id)),e.jsx("th",{className:"sticky top-0 z-10 bg-card border border-border w-16"})]})}),e.jsx("tbody",{children:s.map(t=>e.jsxs("tr",{className:P("group hover:bg-muted/20",t.isHeader&&"bg-primary/5"),children:[e.jsxs("td",{className:P("sticky left-0 z-10 border border-border px-2 py-1 whitespace-nowrap bg-card text-xs truncate max-w-[240px] flex items-center justify-between gap-2",t.isHeader&&"font-bold text-primary bg-primary/5",t.isAutoCalculated&&!t.isHeader&&"text-muted-foreground italic"),title:`ID: ${t.id}`,children:[e.jsx("span",{className:"truncate",children:t.label}),(t.formulaString||t.isAutoCalculated)&&e.jsx(E,{variant:"ghost",size:"icon",className:"h-5 w-5 opacity-0 group-hover:opacity-100 hover:text-primary shrink-0",title:"Edit Formula",onClick:()=>b(t),children:e.jsx(xe,{className:"h-3 w-3"})})]}),l.map(m=>{var D;const u=(D=o[t.id])==null?void 0:D[m.id];return(u==null?void 0:u.isEditable)&&!t.isAutoCalculated&&!m.isYearEnd?e.jsx(Ce,{rowId:t.id,colId:m.id,value:(u==null?void 0:u.value)??null,row:t,isActive:(r==null?void 0:r.row)===t.id&&(r==null?void 0:r.col)===m.id,source:u==null?void 0:u.source,onFocus:()=>h({row:t.id,col:m.id}),onUpdate:L=>d(t.id,m.id,L),onNavigate:y},m.id):e.jsx(je,{value:(u==null?void 0:u.value)??null,row:t,source:u==null?void 0:u.source,formula:t.formulaString},m.id)}),e.jsx("td",{className:"border border-border bg-card w-16 text-center p-0",children:!t.isAutoCalculated&&e.jsx(E,{variant:"ghost",size:"icon",className:"h-5 w-5 opacity-0 group-hover:opacity-100 hover:text-destructive",onClick:()=>a(t.id),children:e.jsx(U,{className:"h-3 w-3"})})})]},t.id))})]})}),v&&e.jsx(ve,{isOpen:!0,onClose:()=>i(null),row:v,onSave:f})]})}const T=s=>{if(!(s!=null&&s.from)||!(s!=null&&s.to))return new Date().getFullYear(),[{id:"jan",label:"January",isProtected:!0},{id:"feb",label:"February",isProtected:!0},{id:"mar",label:"March",isProtected:!0},{id:"apr",label:"April",isProtected:!0},{id:"may",label:"May",isProtected:!0},{id:"jun",label:"June",isProtected:!0},{id:"jul",label:"July",isProtected:!0},{id:"aug",label:"August",isProtected:!0},{id:"sep",label:"September",isProtected:!0},{id:"oct",label:"October",isProtected:!0},{id:"nov",label:"November",isProtected:!0},{id:"dec",label:"December",isProtected:!0},{id:"year_end",label:"Year End",isProtected:!0,isYearEnd:!0}];const o=ye({start:oe(s.from),end:ce(s.to)}).map(r=>({id:M(r,"MMM-yyyy").toLowerCase(),label:M(r,"MMM yyyy"),isProtected:!0}));return o.push({id:"year_end",label:"Period Total",isProtected:!0,isYearEnd:!0}),o},ke=(s,l,o)=>{var r,h;try{const d=Object.keys(l).sort((y,C)=>C.length-y.length);let a=s;for(const y of d){const C=new RegExp(`\\b${y}\\b`,"g");if(C.test(a)){const j=((h=(r=l[y])==null?void 0:r[o])==null?void 0:h.value)??0;a=a.replace(C,`(${j})`)}}if(!/^[0-9+\-*/().\s]*$/.test(a))return null;const x=new Function(`return ${a}`)();return typeof x=="number"&&!isNaN(x)&&isFinite(x)?x:null}catch{return null}},Y=[{id:"total_sales",label:"Total Sales",isAutoCalculated:!1,isCurrency:!0},{id:"sales_split_pct",label:"% Sales Split for the Year",isAutoCalculated:!1,isPercentage:!0},{id:"cost_sales_se",label:"Cost of Sales SE",isAutoCalculated:!1,isCurrency:!0},{id:"cost_sales_paye",label:"Cost of Sales PAYE Gross",isAutoCalculated:!1,isCurrency:!0},{id:"employee_ni",label:"Employee NI",isAutoCalculated:!1,isCurrency:!0},{id:"employee_pension",label:"Employee Pension",isAutoCalculated:!1,isCurrency:!0},{id:"total_cost_sales",label:"Total Cost of Sales",isAutoCalculated:!0,isCurrency:!0,isHeader:!0,formulaString:"cost_sales_se + cost_sales_paye + employee_ni + employee_pension"},{id:"apprenticeship_levy",label:"Apprenticeship Levy",isAutoCalculated:!1,isCurrency:!0},{id:"annual_leave",label:"Annual Leave Accrual",isAutoCalculated:!1,isCurrency:!0},{id:"other_expenses",label:"Other Expenses",isAutoCalculated:!1,isCurrency:!0},{id:"recruitment_cost",label:"Recruitment & Pass Cost",isAutoCalculated:!1,isCurrency:!0},{id:"overheads_mgmt",label:"Mgmt & Office Cost",isAutoCalculated:!1,isCurrency:!0},{id:"bank_interest",label:"Bank Interest",isAutoCalculated:!1,isCurrency:!0},{id:"cooperation_tax",label:"Cooperation Tax",isAutoCalculated:!1,isCurrency:!0},{id:"total_overheads",label:"Total Overheads",isAutoCalculated:!0,isCurrency:!0,isHeader:!0,formulaString:"apprenticeship_levy + annual_leave + other_expenses + recruitment_cost + overheads_mgmt + bank_interest + cooperation_tax"},{id:"total_cost",label:"Total Cost",isAutoCalculated:!0,isCurrency:!0,isHeader:!0,formulaString:"total_cost_sales + total_overheads"},{id:"avg_hourly_charge",label:"Avg Hourly Charge",isAutoCalculated:!1,isCurrency:!0},{id:"gross_hourly_pay",label:"Gross Hourly Pay",isAutoCalculated:!1,isCurrency:!0},{id:"gross_hourly_margin",label:"Gross Hourly Margin",isAutoCalculated:!0,isCurrency:!0,formulaString:"avg_hourly_charge - gross_hourly_pay"},{id:"net_cost_per_hour",label:"Net Cost per Hour",isAutoCalculated:!1,isCurrency:!0},{id:"gross_pl_value",label:"Gross P&L",isAutoCalculated:!1,isCurrency:!0},{id:"net_pl",label:"Net P&L",isAutoCalculated:!1,isCurrency:!0},{id:"total_net_margin",label:"Total Net Margin",isAutoCalculated:!1,isPercentage:!0},{id:"worked_hours",label:"Worked Hours",isAutoCalculated:!1},{id:"hours_breakeven",label:"Hours for Breakeven",isAutoCalculated:!0,formula:(s,l,o)=>{var d,a,x,y;const r=((a=(d=s.total_cost)==null?void 0:d[o])==null?void 0:a.value)??0,h=((y=(x=s.gross_hourly_margin)==null?void 0:x[o])==null?void 0:y.value)??0;return h!==0?r/h:0}},{id:"value_breakeven",label:"Total Value for Breakeven",isAutoCalculated:!0,isCurrency:!0,formulaString:"hours_breakeven * avg_hourly_charge"},{id:"sales_budget_2026",label:"Projeted Sales Budget 30% Uplift",isAutoCalculated:!0,isCurrency:!0,formulaString:"total_sales * 1.3"},{id:"avg_hourly_charge_2026",label:"Average Hourly Charge Rate Future",isAutoCalculated:!1,isCurrency:!0},{id:"sales_target_hours",label:"Sales Target in Hours",isAutoCalculated:!1},{id:"variance_2025",label:"Variance",isAutoCalculated:!1,isCurrency:!0}];function q(s,l){const o={};for(const r of s){o[r.id]={};for(const h of l)o[r.id][h.id]={value:null,isEditable:!r.isAutoCalculated&&!h.isYearEnd,source:"manual"}}return o}function N(s,l,o){const r=JSON.parse(JSON.stringify(s));for(const d of o.filter(a=>!a.isYearEnd))for(const a of l)a.formulaString?r[a.id][d.id]={...r[a.id][d.id],value:ke(a.formulaString,r,d.id),isEditable:!1,source:"calculated"}:a.formula&&(r[a.id][d.id]={...r[a.id][d.id],value:a.formula(r,a.id,d.id),isEditable:!1,source:"calculated"});const h=o.find(d=>d.isYearEnd);if(h)for(const d of l){const a=o.filter(x=>!x.isYearEnd).reduce((x,y)=>{var C,j;return x+(((j=(C=r[d.id])==null?void 0:C[y.id])==null?void 0:j.value)??0)},0);r[d.id][h.id]={value:a,isEditable:!1,source:"calculated"}}return r}function we(s){const[l,o]=p.useState(Y),[r,h]=p.useState(()=>T(s)),[d,a]=p.useState(()=>N(q(Y,T(s)),Y,T(s))),[x,y]=p.useState(null);p.useEffect(()=>{const c=T(s);h(c);let n=q(l,c);s!=null&&s.from&&(s!=null&&s.to)?(async()=>{try{const f=M(s.from,"yyyy-MM-dd"),t=M(s.to,"yyyy-MM-dd"),m=localStorage.getItem("auth_token"),u=await fetch(`undefined/api/financial-summary/metrics?start=${f}&end=${t}`,{headers:{Authorization:`Bearer ${m}`}});if(u.ok){const g=await u.json(),D={January:"jan",February:"feb",March:"mar",April:"apr",May:"may",June:"jun",July:"jul",August:"aug",September:"sep",October:"oct",November:"nov",December:"dec"};for(const[L,V]of Object.entries(g)){const[se,re]=L.split("-"),G=D[re];if(!G)continue;const F=`${G}-${se}`;c.find(ae=>ae.id===F)&&(n.total_sales&&n.total_sales[F]&&(n.total_sales[F].value=V.total_sales,n.total_sales[F].source="backend"),n.cost_sales_paye&&n.cost_sales_paye[F]&&(n.cost_sales_paye[F].value=V.cost_sales_paye,n.cost_sales_paye[F].source="backend"))}a(N(n,l,c))}else a(N(n,l,c))}catch(f){console.error("Failed to fetch metrics",f),a(N(n,l,c))}})():a(N(n,l,c))},[s]);const C=p.useCallback((c,n,b)=>{a(f=>{const t={...f};return t[c]={...t[c]},t[c][n]={...t[c][n],value:b,source:"manual"},N(t,l,r)})},[l,r]),j=p.useCallback((c,n)=>{o(b=>{const f=b.map(t=>t.id===c?{...t,formulaString:n}:t);return a(t=>N(t,f,r)),f})},[r]),_=p.useCallback(c=>{const n=`custom_${Date.now()}`,b={id:n,label:c,isAutoCalculated:!1,isCurrency:!0};o(f=>{const t=[...f,b];return a(m=>{const u={...m};u[n]={};for(const g of r)u[n][g.id]={value:null,isEditable:!g.isYearEnd,source:"manual"};return N(u,t,r)}),t})},[r]),w=p.useCallback(c=>{o(n=>n.filter(b=>b.id!==c)),a(n=>{const b={...n};return delete b[c],b})},[]),A=p.useCallback(c=>{const n=`col_${Date.now()}`,b={id:n,label:c};h(f=>{const t=f.findIndex(u=>u.isYearEnd),m=[...f];return m.splice(t,0,b),a(u=>{const g={...u};for(const D of l)g[D.id]={...g[D.id]},g[D.id][n]={value:null,isEditable:!D.isAutoCalculated,source:"manual"};return N(g,l,m)}),m})},[l]),k=p.useCallback(c=>{h(n=>{const b=n.filter(f=>f.id!==c);return a(f=>{const t={...f};for(const m of Object.keys(t)){const{[c]:u,...g}=t[m];t[m]=g}return N(t,l,b)}),b})},[l]),S=p.useCallback((c,n)=>{h(b=>b.map(f=>f.id===c?{...f,label:n}:f))},[]),v=p.useCallback(c=>{if(!x)return;const n=l.filter(g=>!g.isAutoCalculated),b=r.filter(g=>!g.isYearEnd),f=n.findIndex(g=>g.id===x.row),t=b.findIndex(g=>g.id===x.col);if(f===-1||t===-1)return;let m=f,u=t;switch(c){case"up":m=Math.max(0,f-1);break;case"down":m=Math.min(n.length-1,f+1);break;case"left":u=Math.max(0,t-1);break;case"right":u=Math.min(b.length-1,t+1);break}y({row:n[m].id,col:b[u].id})},[x,l,r]),i=p.useCallback(async c=>{if(c)try{const n={year:new Date().getFullYear(),data:d,rows:l,columns:r},b=localStorage.getItem("auth_token");if(!(await fetch("undefined/api/financial-summary/save",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${b}`},body:JSON.stringify(n)})).ok)throw new Error("Failed to save")}catch(n){throw console.error("Save failed",n),n}},[d,l,r]);return{rows:l,columns:r,data:d,activeCell:x,setActiveCell:y,updateCell:C,addRow:_,deleteRow:w,addColumn:A,deleteColumn:k,renameColumn:S,navigateCell:v,saveData:i,updateRowFormula:j}}function Oe(){const[s,l]=p.useState({from:fe(new Date),to:ge(new Date)}),{rows:o,columns:r,data:h,activeCell:d,setActiveCell:a,updateCell:x,addRow:y,deleteRow:C,addColumn:j,deleteColumn:_,navigateCell:w,updateRowFormula:A}=we(s),[k,S]=p.useState(""),[v,i]=p.useState(""),[c,n]=p.useState(!1),[b,f]=p.useState(!1),t=()=>{k.trim()&&(y(k.trim()),S(""),n(!1))},m=()=>{v.trim()&&(j(v.trim()),i(""),f(!1))};return e.jsx(ne,{noPadding:!0,fullWidth:!0,children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-border bg-card/50 shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx(ie,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-foreground",children:"Financial Summary"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Annual budget and performance spreadsheet"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(he,{children:[e.jsx(pe,{asChild:!0,children:e.jsxs(E,{id:"date",variant:"outline",className:P("w-[260px] justify-start text-left font-normal",!s&&"text-muted-foreground"),children:[e.jsx(de,{className:"mr-2 h-4 w-4"}),s!=null&&s.from?s.to?e.jsxs(e.Fragment,{children:[M(s.from,"LLL dd, y")," -"," ",M(s.to,"LLL dd, y")]}):M(s.from,"LLL dd, y"):e.jsx("span",{children:"Pick a date"})]})}),e.jsx(be,{className:"w-auto p-0",align:"end",children:e.jsx(me,{initialFocus:!0,mode:"range",defaultMonth:s==null?void 0:s.from,selected:s,onSelect:l,numberOfMonths:2})})]}),e.jsxs($,{open:c,onOpenChange:n,children:[e.jsx(K,{asChild:!0,children:e.jsxs(E,{variant:"outline",size:"sm",children:[e.jsx(W,{className:"h-4 w-4 mr-1"})," Add Row"]})}),e.jsxs(H,{children:[e.jsx(z,{children:e.jsx(B,{children:"Add New Row"})}),e.jsx(I,{placeholder:"Row label...",value:k,onChange:u=>S(u.target.value),onKeyDown:u=>u.key==="Enter"&&t()}),e.jsx(J,{children:e.jsx(E,{onClick:t,disabled:!k.trim(),children:"Add"})})]})]}),e.jsxs($,{open:b,onOpenChange:f,children:[e.jsx(K,{asChild:!0,children:e.jsxs(E,{variant:"outline",size:"sm",children:[e.jsx(W,{className:"h-4 w-4 mr-1"})," Add Column"]})}),e.jsxs(H,{children:[e.jsx(z,{children:e.jsx(B,{children:"Add New Column"})}),e.jsx(I,{placeholder:"Column label...",value:v,onChange:u=>i(u.target.value),onKeyDown:u=>u.key==="Enter"&&m()}),e.jsx(J,{children:e.jsx(E,{onClick:m,disabled:!v.trim(),children:"Add"})})]})]})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:e.jsx(_e,{rows:o,columns:r,data:h,activeCell:d,setActiveCell:a,updateCell:x,deleteRow:C,deleteColumn:_,navigateCell:w,updateRowFormula:A})})]})})}export{Oe as default};
