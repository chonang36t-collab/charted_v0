import{d as pe,r as N,e as ae,j as e,P as W,f as J,g as ve,h as je,i as be,k as _,b as ge,R as T,X as ye,A as Ne}from"./index-DOJfk6yY.js";import{B as O}from"./button-C9T-8Bfs.js";import{a as Ce,P as B,b as L,c as $,C as Z,f as D,d as ee,i as te,e as ke,s as H,g as q}from"./popover-DNqNyveK.js";import{u as we,C as Pe,a as se,S as Se,b as Te,c as Ee,d as Ae,e as R}from"./select-BJoH3pJ0.js";import{B as re}from"./badge-BH_9jPuK.js";import{C as M,a as X,b as G,d as F}from"./card-YQ9ZWLYX.js";import{R as Me,A as Fe,C as Oe,X as _e,Y as Ie,T as Re,L as Ye,a as ne}from"./AreaChart-Aqdz0Eyd.js";function z(t,s){return Ce(t,-s)}const Ve=(t,s)=>{var c,d,n;if(!t)return{revenue:{value:0,change:0,trend:"neutral",text:"No data available"},clientPay:{value:0,change:0,trend:"neutral",text:"No data available"},staffPay:{value:0,change:0,trend:"neutral",text:"No data available"}};const a=t.totalRevenue||0,i=t.avgClientPayPerHour||0,x=t.avgStaffPayPerHour||0,o=((c=t.previousPeriod)==null?void 0:c.totalRevenue)||0,l=((d=t.previousPeriod)==null?void 0:d.avgClientPayPerHour)||0,h=((n=t.previousPeriod)==null?void 0:n.avgStaffPayPerHour)||0,m=(v,k)=>k>0?(v-k)/k*100:0,j=m(a,o),g=m(i,l),f=m(x,h),p=v=>v>0?"up":v<0?"down":"neutral",C=(v,k,P)=>{if(!k)return"No previous data";let w="";return P<=7?w="last week":P<=31?w="last month":P<=93?w="last quarter":w="last period",`${v>0?"+":""}${Math.abs(v).toFixed(1)}% from ${w}`},b=Math.ceil((s.to.getTime()-s.from.getTime())/(1e3*60*60*24)),y=!!t.previousPeriod;return{revenue:{value:a,change:j,trend:p(j),text:C(j,y,b)},clientPay:{value:i,change:g,trend:p(g),text:C(g,y,b)},staffPay:{value:x,change:f,trend:p(f),text:C(f,y,b)}}};var Y="Checkbox",[Be,Je]=pe(Y),[Le,Q]=Be(Y);function $e(t){const{__scopeCheckbox:s,checked:a,children:i,defaultChecked:x,disabled:o,form:l,name:h,onCheckedChange:m,required:j,value:g="on",internal_do_not_use_render:f}=t,[p,C]=be({prop:a,defaultProp:x??!1,onChange:m,caller:Y}),[b,y]=N.useState(null),[c,d]=N.useState(null),n=N.useRef(!1),v=b?!!l||!!b.closest("form"):!0,k={checked:p,disabled:o,setChecked:C,control:b,setControl:y,name:h,form:l,value:g,hasConsumerStoppedPropagationRef:n,required:j,defaultChecked:E(x)?!1:x,isFormControl:v,bubbleInput:c,setBubbleInput:d};return e.jsx(Le,{scope:s,...k,children:He(f)?f(k):i})}var oe="CheckboxTrigger",le=N.forwardRef(({__scopeCheckbox:t,onKeyDown:s,onClick:a,...i},x)=>{const{control:o,value:l,disabled:h,checked:m,required:j,setControl:g,setChecked:f,hasConsumerStoppedPropagationRef:p,isFormControl:C,bubbleInput:b}=Q(oe,t),y=ae(x,g),c=N.useRef(m);return N.useEffect(()=>{const d=o==null?void 0:o.form;if(d){const n=()=>f(c.current);return d.addEventListener("reset",n),()=>d.removeEventListener("reset",n)}},[o,f]),e.jsx(W.button,{type:"button",role:"checkbox","aria-checked":E(m)?"mixed":m,"aria-required":j,"data-state":xe(m),"data-disabled":h?"":void 0,disabled:h,value:l,...i,ref:y,onKeyDown:J(s,d=>{d.key==="Enter"&&d.preventDefault()}),onClick:J(a,d=>{f(n=>E(n)?!0:!n),b&&C&&(p.current=d.isPropagationStopped(),p.current||d.stopPropagation())})})});le.displayName=oe;var V=N.forwardRef((t,s)=>{const{__scopeCheckbox:a,name:i,checked:x,defaultChecked:o,required:l,disabled:h,value:m,onCheckedChange:j,form:g,...f}=t;return e.jsx($e,{__scopeCheckbox:a,checked:x,defaultChecked:o,disabled:h,required:l,onCheckedChange:j,name:i,form:g,value:m,internal_do_not_use_render:({isFormControl:p})=>e.jsxs(e.Fragment,{children:[e.jsx(le,{...f,ref:s,__scopeCheckbox:a}),p&&e.jsx(ue,{__scopeCheckbox:a})]})})});V.displayName=Y;var ie="CheckboxIndicator",ce=N.forwardRef((t,s)=>{const{__scopeCheckbox:a,forceMount:i,...x}=t,o=Q(ie,a);return e.jsx(ve,{present:i||E(o.checked)||o.checked===!0,children:e.jsx(W.span,{"data-state":xe(o.checked),"data-disabled":o.disabled?"":void 0,...x,ref:s,style:{pointerEvents:"none",...t.style}})})});ce.displayName=ie;var de="CheckboxBubbleInput",ue=N.forwardRef(({__scopeCheckbox:t,...s},a)=>{const{control:i,hasConsumerStoppedPropagationRef:x,checked:o,defaultChecked:l,required:h,disabled:m,name:j,value:g,form:f,bubbleInput:p,setBubbleInput:C}=Q(de,t),b=ae(a,C),y=we(o),c=je(i);N.useEffect(()=>{const n=p;if(!n)return;const v=window.HTMLInputElement.prototype,P=Object.getOwnPropertyDescriptor(v,"checked").set,w=!x.current;if(y!==o&&P){const I=new Event("click",{bubbles:w});n.indeterminate=E(o),P.call(n,E(o)?!1:o),n.dispatchEvent(I)}},[p,y,o,x]);const d=N.useRef(E(o)?!1:o);return e.jsx(W.input,{type:"checkbox","aria-hidden":!0,defaultChecked:l??d.current,required:h,disabled:m,name:j,value:g,form:f,...s,tabIndex:-1,ref:b,style:{...s.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});ue.displayName=de;function He(t){return typeof t=="function"}function E(t){return t==="indeterminate"}function xe(t){return E(t)?"indeterminate":t?"checked":"unchecked"}const U=N.forwardRef(({className:t,...s},a)=>e.jsx(V,{ref:a,className:_("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),...s,children:e.jsx(ce,{className:_("flex items-center justify-center text-current"),children:e.jsx(Pe,{className:"h-4 w-4"})})}));U.displayName=V.displayName;const Ze=({dateRange:t,onDateRangeChange:s,calendarOpen:a,onCalendarOpenChange:i,tempDateRange:x,onTempDateRangeChange:o,selectedLocations:l=[],onLocationsChange:h})=>{const{role:m,locations:j}=ge(),[g,f]=T.useState([]),[p,C]=T.useState(!1);T.useEffect(()=>{(async()=>{try{const u=await fetch(`${Ne.SALES_SUMMARY.replace("sales-summary","locations")}`,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});if(u.ok){const S=await u.json();f(m==="admin"?S:S.filter(A=>j.includes(A)))}}catch(u){console.error("Failed to fetch locations:",u)}})()},[m,j]);const b=r=>{h&&(l.includes(r)?h(l.filter(u=>u!==r)):h([...l,r]))},y=r=>{const u=new Date;let S,A;switch(r){case"this-month":S=H(u),A=q(u);break;case"last-month":S=H(z(u,1)),A=q(z(u,1));break;case"last-3-months":S=H(z(u,2)),A=q(u);break;case"this-year":S=new Date(u.getFullYear(),0,1),A=new Date(u.getFullYear(),11,31);break;default:return}s({from:S,to:A})},[c,d]=T.useState(t==null?void 0:t.from),[n,v]=T.useState(t==null?void 0:t.to),[k,P]=T.useState(!1),[w,I]=T.useState(!1);T.useEffect(()=>{d(t==null?void 0:t.from),v(t==null?void 0:t.to)},[t]);const he=r=>{r&&(d(r),n&&te(r,n)&&v(void 0))},me=r=>{r&&v(r)},fe=()=>{c&&n&&s({from:c,to:n})};return e.jsx("div",{className:"sticky top-0 z-40 bg-background border-b border-border",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Dashboard"}),e.jsx("p",{className:"text-muted-foreground",children:"Overview of your analytics"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[h&&e.jsxs(B,{open:p,onOpenChange:C,children:[e.jsx(L,{asChild:!0,children:e.jsxs(O,{variant:"outline",className:"w-auto min-w-[180px] justify-between text-left font-normal",children:[e.jsx("div",{className:"flex items-center gap-2 overflow-hidden mr-2",children:e.jsx("span",{className:"truncate",children:l.length===0?"All Locations":`${l.length} selected`})}),e.jsx(se,{className:"h-4 w-4 opacity-50 shrink-0"})]})}),e.jsx($,{className:"w-[200px] p-0",align:"start",children:e.jsxs("div",{className:"p-2 max-h-[300px] overflow-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-2 hover:bg-muted rounded-sm cursor-pointer mb-1",onClick:r=>{r.stopPropagation(),h([])},children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(U,{checked:l.length===0,className:"pointer-events-none"}),e.jsx("span",{className:"text-sm font-medium",children:"All Locations"})]}),l.length>0&&e.jsx(O,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs text-muted-foreground hover:text-foreground",onClick:r=>{r.stopPropagation(),h([])},children:"Clear"})]}),e.jsx("div",{className:"h-px bg-border my-1"}),g.map(r=>e.jsxs("div",{className:"flex items-center space-x-2 p-2 hover:bg-muted rounded-sm cursor-pointer",onClick:u=>{u.stopPropagation(),b(r)},children:[e.jsx(U,{checked:l.includes(r),className:"pointer-events-none"}),e.jsx("span",{className:"text-sm truncate",children:r})]},r))]})})]}),l.length>0&&h&&e.jsxs("div",{className:"hidden lg:flex flex-wrap gap-1 items-center max-w-[300px]",children:[l.slice(0,3).map(r=>e.jsxs(re,{variant:"secondary",className:"text-[10px] px-1 h-5 gap-1 max-w-[100px] truncate",children:[r,e.jsx(ye,{className:"h-2 w-2 cursor-pointer hover:text-destructive",onClick:u=>{u.stopPropagation(),b(r)}})]},r)),l.length>3&&e.jsxs(re,{variant:"secondary",className:"text-[10px] px-1 h-5",children:["+",l.length-3," more"]})]}),e.jsxs(Se,{onValueChange:y,children:[e.jsxs(Te,{className:"w-[140px]",children:[e.jsx(Ee,{placeholder:"Quick Select"}),e.jsx(se,{className:"h-4 w-4 opacity-50"})]}),e.jsxs(Ae,{children:[e.jsx(R,{value:"this-month",children:"This Month"}),e.jsx(R,{value:"last-month",children:"Last Month"}),e.jsx(R,{value:"last-3-months",children:"Last 3 Months"}),e.jsx(R,{value:"this-year",children:"This Year"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(B,{open:k,onOpenChange:P,children:[e.jsx(L,{asChild:!0,children:e.jsxs(O,{variant:"outline",className:_("w-[140px] justify-start text-left font-normal",!c&&"text-muted-foreground"),children:[e.jsx(Z,{className:"mr-2 h-4 w-4"}),c?D(c,"LLL dd, y"):"From"]})}),e.jsx($,{className:"w-auto p-0",align:"start",children:e.jsx("div",{className:"p-3",children:e.jsx(ee,{mode:"single",selected:c,onSelect:he,initialFocus:!0,captionLayout:"dropdown-buttons",fromYear:new Date().getFullYear()-10,toYear:new Date().getFullYear()+1,disabled:r=>n?te(r,n):!1,className:"rounded-md border"})})})]}),e.jsx("div",{className:"text-muted-foreground",children:"to"}),e.jsxs(B,{open:w,onOpenChange:I,children:[e.jsx(L,{asChild:!0,children:e.jsxs(O,{variant:"outline",className:_("w-[140px] justify-start text-left font-normal",!n&&"text-muted-foreground"),disabled:!c,children:[e.jsx(Z,{className:"mr-2 h-4 w-4"}),n?D(n,"LLL dd, y"):"To"]})}),e.jsx($,{className:"w-auto p-0",align:"start",children:e.jsx("div",{className:"p-3",children:e.jsx(ee,{mode:"single",selected:n,onSelect:me,initialFocus:!0,captionLayout:"dropdown-buttons",fromYear:c?c.getFullYear():new Date().getFullYear()-10,toYear:new Date().getFullYear()+1,disabled:r=>c?ke(r,c):!1,className:"rounded-md border"})})})]}),e.jsx(O,{onClick:fe,disabled:!c||!n,className:"ml-2",children:"Apply"})]})]})]})})})};function K({title:t,value:s,change:a,trend:i="neutral"}){return e.jsxs(M,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(X,{className:"flex flex-row items-center justify-between pb-2",children:e.jsx(G,{className:"text-sm font-medium text-muted-foreground",children:t})}),e.jsxs(F,{children:[e.jsx("div",{className:"text-2xl font-bold",children:s}),a&&e.jsx("p",{className:_("text-xs mt-1",i==="up"&&"text-accent",i==="down"&&"text-destructive",i==="neutral"&&"text-muted-foreground"),children:a})]})]})}const De=({metrics:t})=>e.jsxs("div",{className:"grid gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 w-full",children:[e.jsx(K,{title:"Total Revenue",value:`£${t.revenue.value.toLocaleString()}`,change:t.revenue.text,trend:t.revenue.trend}),e.jsx(K,{title:"Average Client Pay",value:`£${t.clientPay.value.toFixed(2)}`,change:t.clientPay.text,trend:t.clientPay.trend}),e.jsx(K,{title:"Average Staff Pay",value:`£${t.staffPay.value.toFixed(2)}`,change:t.staffPay.text,trend:t.staffPay.trend})]}),et=({salesData:t})=>{var s;return e.jsxs("div",{className:"grid gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 w-full",children:[e.jsx(M,{children:e.jsx(F,{className:"p-6",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Shifts"}),e.jsx("p",{className:"text-2xl font-bold",children:(t==null?void 0:t.totalShifts)||0})]})})})}),e.jsx(M,{children:e.jsx(F,{className:"p-6",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Clients"}),e.jsx("p",{className:"text-2xl font-bold",children:(t==null?void 0:t.totalClients)||0})]})})})}),e.jsx(M,{children:e.jsx(F,{className:"p-6",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Employees"}),e.jsx("p",{className:"text-2xl font-bold",children:(t==null?void 0:t.uniqueEmployees)||0})]})})})}),e.jsx(M,{children:e.jsx(F,{className:"p-6",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Profit Margin"}),e.jsxs("p",{className:"text-2xl font-bold",children:[((s=t==null?void 0:t.profitMargin)==null?void 0:s.toFixed(1))||0,"%"]})]})})})})]})},qe=({active:t,payload:s,label:a})=>t&&s&&s.length?e.jsxs("div",{className:"bg-background border border-border p-3 rounded-lg shadow-lg",children:[e.jsx("p",{className:"font-semibold text-foreground",children:a}),s.map((i,x)=>e.jsxs("p",{className:"text-sm",style:{color:i.color},children:[i.name,": £",Number(i.value).toLocaleString()]},x))]}):null,tt=({data:t,aggregationLevel:s})=>{const a={dataKey:"display",interval:0};return!t||t.length===0?e.jsxs(M,{children:[e.jsx(X,{children:e.jsx(G,{children:"Revenue vs Cost Trend"})}),e.jsx(F,{children:e.jsx("div",{className:"h-[400px] flex items-center justify-center",children:e.jsx("p",{className:"text-muted-foreground",children:"No data available for the selected period"})})})]}):e.jsxs(M,{children:[e.jsxs(X,{children:[e.jsx(G,{children:"Revenue vs Cost Trend"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[s==="daily"&&"Daily view",s==="weekly"&&"Weekly view",s==="monthly"&&"Monthly view"]})]}),e.jsx(F,{children:e.jsx("div",{className:"h-[400px]",children:e.jsx(Me,{width:"100%",height:"100%",children:e.jsxs(Fe,{data:t,children:[e.jsx(Oe,{strokeDasharray:"3 3"}),e.jsx(_e,{dataKey:a.dataKey,tick:{fontSize:12},interval:a.interval}),e.jsx(Ie,{}),e.jsx(Re,{content:e.jsx(qe,{})}),e.jsx(Ye,{}),e.jsx(ne,{type:"monotone",dataKey:"revenue",name:"Revenue",stroke:"hsl(var(--primary))",fill:"hsl(var(--primary))",fillOpacity:.3,strokeWidth:2}),e.jsx(ne,{type:"monotone",dataKey:"cost",name:"Cost",stroke:"hsl(var(--accent))",fill:"hsl(var(--accent))",fillOpacity:.3,strokeWidth:2})]})})})})]})},st=()=>e.jsx("div",{className:"fixed inset-0 bg-background/80 backdrop-blur-sm z-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Loading Dashboard"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Fetching your data..."})]})]})});export{et as A,Ze as D,st as L,De as M,tt as R,Ve as c};
