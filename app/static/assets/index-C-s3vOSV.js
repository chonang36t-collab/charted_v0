import{c as le,ab as O,r as h,j as e,e as P,B as D,T as Q,k as X,l as Z,m as R,I as $,ac as oe}from"./index-C5-1ptRh.js";import{D as ne,T as ie}from"./DashboardLayout-8l4kgvIg.js";import{D as I,b as H,c as z,d as B,e as J,a as K}from"./dialog-Cb--uEF5.js";import{L as ue}from"./label-C3FcUiwD.js";import{T as U}from"./trash-2-BWt3pV54.js";import{c as ce,e as de,C as me,b as fe}from"./calendar-DcY2blU7.js";import{f as M,s as he,P as pe,a as be,b as ye}from"./popover-B6ysh9UK.js";import{P as W}from"./plus-425WCZhY.js";import"./users-MTDTp6lb.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=le("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);function ge(t,a){const o=O(t.start),r=O(t.end);let p=+o>+r;const c=p?+o:+r,l=p?r:o;l.setHours(0,0,0,0),l.setDate(1);let y=1;const x=[];for(;+l<=c;)x.push(O(l)),l.setMonth(l.getMonth()+y);return p?x.reverse():x}function Ce(t){const a=O(t),o=a.getFullYear();return a.setFullYear(o+1,0,0),a.setHours(23,59,59,999),a}function je(t,a){return ce(t,-a)}function ee(t,a){return t===null||t===0?"":a.isPercentage?`${t.toFixed(2)}%`:a.isCurrency?`Â£${t.toLocaleString("en-GB",{minimumFractionDigits:2,maximumFractionDigits:2})}`:t.toLocaleString("en-GB",{maximumFractionDigits:2})}function te({source:t,formula:a,value:o}){return e.jsxs("div",{className:"text-xs space-y-1",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Source:"})," ",t||"Unknown"]}),a&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Formula:"}),e.jsx("code",{className:"bg-muted px-1 rounded ml-1",children:a})]})]})}function ve({rowId:t,colId:a,value:o,row:r,isActive:p,source:c,onFocus:l,onUpdate:y,onNavigate:x}){const[C,v]=h.useState(!1),[_,A]=h.useState(""),S=h.useRef(null),E=h.useCallback(()=>{v(!0),A(o!==null?String(o):""),setTimeout(()=>{var i;return(i=S.current)==null?void 0:i.focus()},0)},[o]),k=h.useCallback(()=>{v(!1);const i=parseFloat(_);y(_===""?null:isNaN(i)?o:i)},[_,y,o]),w=i=>{C?i.key==="Enter"||i.key==="Tab"?(i.preventDefault(),k(),x(i.shiftKey?"up":"down")):i.key==="Escape"&&v(!1):i.key==="Enter"||i.key==="F2"?(i.preventDefault(),E()):i.key==="ArrowUp"?(i.preventDefault(),x("up")):i.key==="ArrowDown"?(i.preventDefault(),x("down")):i.key==="ArrowLeft"?(i.preventDefault(),x("left")):i.key==="ArrowRight"?(i.preventDefault(),x("right")):i.key==="Delete"||i.key==="Backspace"?(i.preventDefault(),y(null)):/^[0-9.\-]$/.test(i.key)&&(i.preventDefault(),A(i.key),v(!0),setTimeout(()=>{var u;return(u=S.current)==null?void 0:u.focus()},0))};return e.jsx(Q,{children:e.jsxs(X,{delayDuration:500,children:[e.jsx(Z,{asChild:!0,children:e.jsxs("td",{className:P("border border-border px-2 py-1 text-right text-sm min-w-[110px] cursor-cell transition-colors relative",p&&"ring-2 ring-primary ring-inset bg-primary/5",!p&&"hover:bg-muted/50",c==="backend"&&"bg-blue-50/30 dark:bg-blue-900/10",c==="formula"&&"bg-purple-50/30 dark:bg-purple-900/10"),onClick:l,onDoubleClick:E,onKeyDown:w,tabIndex:0,onFocus:l,children:[c==="backend"&&e.jsx("div",{className:"absolute top-0 right-0 w-1.5 h-1.5 bg-blue-400 rounded-bl-sm opacity-50"}),C?e.jsx("input",{ref:S,type:"text",value:_,onChange:i=>A(i.target.value),onBlur:k,className:"w-full bg-transparent text-right outline-none text-sm font-mono"}):e.jsx("span",{className:"font-mono text-sm",children:ee(o,r)})]})}),e.jsx(R,{children:e.jsx(te,{source:c,value:o})})]})})}function _e({value:t,row:a,source:o,formula:r}){return e.jsx(Q,{children:e.jsxs(X,{delayDuration:500,children:[e.jsx(Z,{asChild:!0,children:e.jsxs("td",{className:P("border border-border px-2 py-1 text-right text-sm min-w-[110px] relative",a.isHeader?"bg-primary/10 font-semibold":"bg-muted/30",o==="calculated"&&"bg-orange-50/30 dark:bg-orange-900/10"),children:[r&&e.jsx("div",{className:"absolute top-0 right-0 w-1.5 h-1.5 bg-orange-400 rounded-bl-sm opacity-50"}),e.jsx("span",{className:"font-mono text-sm",children:ee(t,a)})]})}),e.jsx(R,{children:e.jsx(te,{source:o,formula:r,value:t})})]})})}function ke({isOpen:t,onClose:a,row:o,onSave:r}){const[p,c]=h.useState((o==null?void 0:o.formulaString)||"");return h.useEffect(()=>{o&&c(o.formulaString||"")},[o]),o?e.jsx(I,{open:t,onOpenChange:l=>!l&&a(),children:e.jsxs(H,{children:[e.jsx(z,{children:e.jsxs(B,{children:["Edit Formula: ",o.label]})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(ue,{htmlFor:"formula",className:"text-right",children:"Formula"}),e.jsx($,{id:"formula",value:p,onChange:l=>c(l.target.value),className:"col-span-3 font-mono"})]}),e.jsx("div",{className:"text-xs text-muted-foreground ml-[25%]",children:"Supported: +, -, *, /, (, ), row_ids (e.g. total_sales)"})]}),e.jsx(J,{children:e.jsx(D,{type:"submit",onClick:()=>r(p),children:"Save changes"})})]})}):null}function we({rows:t,columns:a,data:o,activeCell:r,setActiveCell:p,updateCell:c,deleteRow:l,deleteColumn:y,navigateCell:x,onRenameColumn:C,updateRowFormula:v}){const[_,A]=h.useState(null),[S,E]=h.useState(""),k=h.useRef(null),[w,i]=h.useState(null),u=s=>{A(s.id),E(s.label),setTimeout(()=>{var d;return(d=k.current)==null?void 0:d.focus()},0)},n=()=>{_&&C&&C(_,S),A(null)},b=s=>{i(s)},f=s=>{w&&v&&v(w.id,s),i(null)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto border border-border rounded-lg bg-card max-w-full",children:e.jsxs("table",{className:"border-collapse w-full text-xs",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-card border border-border px-2 py-2 text-left font-semibold text-muted-foreground uppercase tracking-wider w-[240px] min-w-[240px]",children:"Description"}),a.map(s=>e.jsx("th",{className:P("sticky top-0 z-10 border border-border px-1 py-1 text-center font-semibold uppercase tracking-wider min-w-[80px]",s.isYearEnd?"bg-primary/10 text-primary":"bg-muted/50 text-muted-foreground"),onDoubleClick:()=>!s.isProtected&&u(s),children:e.jsx("div",{className:"flex items-center justify-center gap-1 h-8 group relative px-2",children:_===s.id?e.jsx("input",{ref:k,value:S,onChange:d=>E(d.target.value),onBlur:n,onKeyDown:d=>d.key==="Enter"&&n(),className:"w-full bg-background border rounded px-1 text-center"}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"truncate",children:s.label}),!s.isProtected&&e.jsx(D,{variant:"ghost",size:"icon",className:"h-5 w-5 opacity-0 group-hover:opacity-100 absolute -right-1 hover:text-destructive hover:bg-destructive/10",onClick:d=>{d.stopPropagation(),y(s.id)},children:e.jsx(U,{className:"h-3 w-3"})})]})})},s.id)),e.jsx("th",{className:"sticky top-0 z-10 bg-card border border-border w-16"})]})}),e.jsx("tbody",{children:t.map(s=>e.jsxs("tr",{className:P("group hover:bg-muted/20",s.isHeader&&"bg-primary/5"),children:[e.jsxs("td",{className:P("sticky left-0 z-10 border border-border px-2 py-1 whitespace-nowrap bg-card text-xs truncate max-w-[240px] flex items-center justify-between gap-2",s.isHeader&&"font-bold text-primary bg-primary/5",s.isAutoCalculated&&!s.isHeader&&"text-muted-foreground italic"),title:`ID: ${s.id}`,children:[e.jsx("span",{className:"truncate",children:s.label}),(s.formulaString||s.isAutoCalculated)&&e.jsx(D,{variant:"ghost",size:"icon",className:"h-5 w-5 opacity-0 group-hover:opacity-100 hover:text-primary shrink-0",title:"Edit Formula",onClick:()=>b(s),children:e.jsx(xe,{className:"h-3 w-3"})})]}),a.map(d=>{var j;const m=(j=o[s.id])==null?void 0:j[d.id];return(m==null?void 0:m.isEditable)&&!s.isAutoCalculated&&!d.isYearEnd?e.jsx(ve,{rowId:s.id,colId:d.id,value:(m==null?void 0:m.value)??null,row:s,isActive:(r==null?void 0:r.row)===s.id&&(r==null?void 0:r.col)===d.id,source:m==null?void 0:m.source,onFocus:()=>p({row:s.id,col:d.id}),onUpdate:L=>c(s.id,d.id,L),onNavigate:x},d.id):e.jsx(_e,{value:(m==null?void 0:m.value)??null,row:s,source:m==null?void 0:m.source,formula:s.formulaString},d.id)}),e.jsx("td",{className:"border border-border bg-card w-16 text-center p-0",children:!s.isAutoCalculated&&e.jsx(D,{variant:"ghost",size:"icon",className:"h-5 w-5 opacity-0 group-hover:opacity-100 hover:text-destructive",onClick:()=>l(s.id),children:e.jsx(U,{className:"h-3 w-3"})})})]},s.id))})]})}),w&&e.jsx(ke,{isOpen:!0,onClose:()=>i(null),row:w,onSave:f})]})}const T=t=>{if(!(t!=null&&t.from)||!(t!=null&&t.to))return new Date().getFullYear(),[{id:"jan",label:"January",isProtected:!0},{id:"feb",label:"February",isProtected:!0},{id:"mar",label:"March",isProtected:!0},{id:"apr",label:"April",isProtected:!0},{id:"may",label:"May",isProtected:!0},{id:"jun",label:"June",isProtected:!0},{id:"jul",label:"July",isProtected:!0},{id:"aug",label:"August",isProtected:!0},{id:"sep",label:"September",isProtected:!0},{id:"oct",label:"October",isProtected:!0},{id:"nov",label:"November",isProtected:!0},{id:"dec",label:"December",isProtected:!0},{id:"year_end",label:"Year End",isProtected:!0,isYearEnd:!0}];const o=ge({start:oe(t.from),end:de(t.to)}).map(r=>({id:M(r,"MMM-yyyy").toLowerCase(),label:M(r,"MMM yyyy"),isProtected:!0}));return o.push({id:"year_end",label:"Period Total",isProtected:!0,isYearEnd:!0}),o},Ae=(t,a,o)=>{var r,p;try{const c=Object.keys(a).sort((x,C)=>C.length-x.length);let l=t;for(const x of c){const C=new RegExp(`\\b${x}\\b`,"g");if(C.test(l)){const v=((p=(r=a[x])==null?void 0:r[o])==null?void 0:p.value)??0;l=l.replace(C,`(${v})`)}}if(!/^[0-9+\-*/().\s]*$/.test(l))return null;const y=new Function(`return ${l}`)();return typeof y=="number"&&!isNaN(y)&&isFinite(y)?y:null}catch{return null}},Y=[{id:"total_sales",label:"Total Sales",isAutoCalculated:!1,isCurrency:!0},{id:"sales_split_pct",label:"% Sales Split for the Year",isAutoCalculated:!1,isPercentage:!0},{id:"cost_sales_se",label:"Cost of Sales SE",isAutoCalculated:!1,isCurrency:!0},{id:"cost_sales_paye",label:"Cost of Sales PAYE Gross",isAutoCalculated:!1,isCurrency:!0},{id:"employee_ni",label:"Employee NI",isAutoCalculated:!1,isCurrency:!0},{id:"employee_pension",label:"Employee Pension",isAutoCalculated:!1,isCurrency:!0},{id:"total_cost_sales",label:"Total Cost of Sales",isAutoCalculated:!0,isCurrency:!0,isHeader:!0,formulaString:"cost_sales_se + cost_sales_paye + employee_ni + employee_pension"},{id:"apprenticeship_levy",label:"Apprenticeship Levy",isAutoCalculated:!1,isCurrency:!0},{id:"annual_leave",label:"Annual Leave Accrual",isAutoCalculated:!1,isCurrency:!0},{id:"other_expenses",label:"Other Expenses",isAutoCalculated:!1,isCurrency:!0},{id:"recruitment_cost",label:"Recruitment & Pass Cost",isAutoCalculated:!1,isCurrency:!0},{id:"overheads_mgmt",label:"Mgmt & Office Cost",isAutoCalculated:!1,isCurrency:!0},{id:"bank_interest",label:"Bank Interest",isAutoCalculated:!1,isCurrency:!0},{id:"cooperation_tax",label:"Cooperation Tax",isAutoCalculated:!1,isCurrency:!0},{id:"total_overheads",label:"Total Overheads",isAutoCalculated:!0,isCurrency:!0,isHeader:!0,formulaString:"apprenticeship_levy + annual_leave + other_expenses + recruitment_cost + overheads_mgmt + bank_interest + cooperation_tax"},{id:"total_cost",label:"Total Cost",isAutoCalculated:!0,isCurrency:!0,isHeader:!0,formulaString:"total_cost_sales + total_overheads"},{id:"avg_hourly_charge",label:"Avg Hourly Charge",isAutoCalculated:!1,isCurrency:!0},{id:"gross_hourly_pay",label:"Gross Hourly Pay",isAutoCalculated:!1,isCurrency:!0},{id:"gross_hourly_margin",label:"Gross Hourly Margin",isAutoCalculated:!0,isCurrency:!0,formulaString:"avg_hourly_charge - gross_hourly_pay"},{id:"net_cost_per_hour",label:"Net Cost per Hour",isAutoCalculated:!1,isCurrency:!0},{id:"gross_pl_value",label:"Gross P&L",isAutoCalculated:!1,isCurrency:!0},{id:"net_pl",label:"Net P&L",isAutoCalculated:!1,isCurrency:!0},{id:"total_net_margin",label:"Total Net Margin",isAutoCalculated:!1,isPercentage:!0},{id:"worked_hours",label:"Worked Hours",isAutoCalculated:!1},{id:"hours_breakeven",label:"Hours for Breakeven",isAutoCalculated:!0,formula:(t,a,o)=>{var c,l,y,x;const r=((l=(c=t.total_cost)==null?void 0:c[o])==null?void 0:l.value)??0,p=((x=(y=t.gross_hourly_margin)==null?void 0:y[o])==null?void 0:x.value)??0;return p!==0?r/p:0}},{id:"value_breakeven",label:"Total Value for Breakeven",isAutoCalculated:!0,isCurrency:!0,formulaString:"hours_breakeven * avg_hourly_charge"},{id:"sales_budget_2026",label:"Projeted Sales Budget 30% Uplift",isAutoCalculated:!0,isCurrency:!0,formulaString:"total_sales * 1.3"},{id:"avg_hourly_charge_2026",label:"Average Hourly Charge Rate Future",isAutoCalculated:!1,isCurrency:!0},{id:"sales_target_hours",label:"Sales Target in Hours",isAutoCalculated:!1},{id:"variance_2025",label:"Variance",isAutoCalculated:!1,isCurrency:!0}];function q(t,a){const o={};for(const r of t){o[r.id]={};for(const p of a)o[r.id][p.id]={value:null,isEditable:!r.isAutoCalculated&&!p.isYearEnd,source:"manual"}}return o}function N(t,a,o){const r=JSON.parse(JSON.stringify(t));for(const c of o.filter(l=>!l.isYearEnd))for(const l of a)l.formulaString?r[l.id][c.id]={...r[l.id][c.id],value:Ae(l.formulaString,r,c.id),isEditable:!1,source:"calculated"}:l.formula&&(r[l.id][c.id]={...r[l.id][c.id],value:l.formula(r,l.id,c.id),isEditable:!1,source:"calculated"});const p=o.find(c=>c.isYearEnd);if(p)for(const c of a){const l=o.filter(y=>!y.isYearEnd).reduce((y,x)=>{var C,v;return y+(((v=(C=r[c.id])==null?void 0:C[x.id])==null?void 0:v.value)??0)},0);r[c.id][p.id]={value:l,isEditable:!1,source:"calculated"}}return r}function Se(t){const[a,o]=h.useState(Y),[r,p]=h.useState(()=>T(t)),[c,l]=h.useState(()=>N(q(Y,T(t)),Y,T(t))),[y,x]=h.useState(null);h.useEffect(()=>{const u=T(t);p(u);let n=q(a,u);t!=null&&t.from&&(t!=null&&t.to)?(async()=>{try{const f=M(t.from,"yyyy-MM-dd"),s=M(t.to,"yyyy-MM-dd"),d=localStorage.getItem("auth_token"),m=await fetch(`http://localhost:5000/api/financial-summary/metrics?start=${f}&end=${s}`,{headers:{Authorization:`Bearer ${d}`}});if(m.ok){const g=await m.json(),j={January:"jan",February:"feb",March:"mar",April:"apr",May:"may",June:"jun",July:"jul",August:"aug",September:"sep",October:"oct",November:"nov",December:"dec"};for(const[L,V]of Object.entries(g)){const[se,re]=L.split("-"),G=j[re];if(!G)continue;const F=`${G}-${se}`;u.find(ae=>ae.id===F)&&(n.total_sales&&n.total_sales[F]&&(n.total_sales[F].value=V.total_sales,n.total_sales[F].source="backend"),n.cost_sales_paye&&n.cost_sales_paye[F]&&(n.cost_sales_paye[F].value=V.cost_sales_paye,n.cost_sales_paye[F].source="backend"))}l(N(n,a,u))}else l(N(n,a,u))}catch(f){console.error("Failed to fetch metrics",f),l(N(n,a,u))}})():l(N(n,a,u))},[t]);const C=h.useCallback((u,n,b)=>{l(f=>{const s={...f};return s[u]={...s[u]},s[u][n]={...s[u][n],value:b,source:"manual"},N(s,a,r)})},[a,r]),v=h.useCallback((u,n)=>{o(b=>{const f=b.map(s=>s.id===u?{...s,formulaString:n}:s);return l(s=>N(s,f,r)),f})},[r]),_=h.useCallback(u=>{const n=`custom_${Date.now()}`,b={id:n,label:u,isAutoCalculated:!1,isCurrency:!0};o(f=>{const s=[...f,b];return l(d=>{const m={...d};m[n]={};for(const g of r)m[n][g.id]={value:null,isEditable:!g.isYearEnd,source:"manual"};return N(m,s,r)}),s})},[r]),A=h.useCallback(u=>{o(n=>n.filter(b=>b.id!==u)),l(n=>{const b={...n};return delete b[u],b})},[]),S=h.useCallback(u=>{const n=`col_${Date.now()}`,b={id:n,label:u};p(f=>{const s=f.findIndex(m=>m.isYearEnd),d=[...f];return d.splice(s,0,b),l(m=>{const g={...m};for(const j of a)g[j.id]={...g[j.id]},g[j.id][n]={value:null,isEditable:!j.isAutoCalculated,source:"manual"};return N(g,a,d)}),d})},[a]),E=h.useCallback(u=>{p(n=>{const b=n.filter(f=>f.id!==u);return l(f=>{const s={...f};for(const d of Object.keys(s)){const{[u]:m,...g}=s[d];s[d]=g}return N(s,a,b)}),b})},[a]),k=h.useCallback((u,n)=>{p(b=>b.map(f=>f.id===u?{...f,label:n}:f))},[]),w=h.useCallback(u=>{if(!y)return;const n=a.filter(g=>!g.isAutoCalculated),b=r.filter(g=>!g.isYearEnd),f=n.findIndex(g=>g.id===y.row),s=b.findIndex(g=>g.id===y.col);if(f===-1||s===-1)return;let d=f,m=s;switch(u){case"up":d=Math.max(0,f-1);break;case"down":d=Math.min(n.length-1,f+1);break;case"left":m=Math.max(0,s-1);break;case"right":m=Math.min(b.length-1,s+1);break}x({row:n[d].id,col:b[m].id})},[y,a,r]),i=h.useCallback(async u=>{if(u)try{const n={year:new Date().getFullYear(),data:c,rows:a,columns:r},b=localStorage.getItem("auth_token");if(!(await fetch("http://localhost:5000/api/financial-summary/save",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${b}`},body:JSON.stringify(n)})).ok)throw new Error("Failed to save")}catch(n){throw console.error("Save failed",n),n}},[c,a,r]);return{rows:a,columns:r,data:c,activeCell:y,setActiveCell:x,updateCell:C,addRow:_,deleteRow:A,addColumn:S,deleteColumn:E,renameColumn:k,navigateCell:w,saveData:i,updateRowFormula:v}}function Ye(){const[t,a]=h.useState({from:he(je(new Date,1)),to:Ce(new Date)}),{rows:o,columns:r,data:p,activeCell:c,setActiveCell:l,updateCell:y,addRow:x,deleteRow:C,addColumn:v,deleteColumn:_,navigateCell:A,renameColumn:S,saveData:E}=Se(t),[k,w]=h.useState(""),[i,u]=h.useState(""),[n,b]=h.useState(!1),[f,s]=h.useState(!1);h.useState(!1);const d=()=>{k.trim()&&(x(k.trim()),w(""),b(!1))},m=()=>{i.trim()&&(v(i.trim()),u(""),s(!1))},g=t!=null&&t.from&&(t!=null&&t.to)?`Financial Summary for ${M(t.from,"MMM yyyy")} - ${M(t.to,"MMM yyyy")}`:"Financial Summary";return e.jsx(ne,{noPadding:!0,fullWidth:!0,children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-border bg-card/50 shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx(ie,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-foreground",children:g}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Annual budget and performance spreadsheet"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(pe,{children:[e.jsx(be,{asChild:!0,children:e.jsxs(D,{variant:"outline",className:P("w-[240px] justify-start text-left font-normal",!t&&"text-muted-foreground"),children:[e.jsx(me,{className:"mr-2 h-4 w-4"}),t!=null&&t.from?t.to?e.jsxs(e.Fragment,{children:[M(t.from,"LLL dd, y")," -"," ",M(t.to,"LLL dd, y")]}):M(t.from,"LLL dd, y"):e.jsx("span",{children:"Pick a date"})]})}),e.jsx(ye,{className:"w-auto p-0",align:"end",children:e.jsx(fe,{initialFocus:!0,mode:"range",defaultMonth:t==null?void 0:t.from,selected:t,onSelect:a,numberOfMonths:2,captionLayout:"dropdown-buttons",fromYear:2020,toYear:2030})})]}),e.jsxs(I,{open:n,onOpenChange:b,children:[e.jsx(K,{asChild:!0,children:e.jsxs(D,{variant:"outline",size:"sm",children:[e.jsx(W,{className:"h-4 w-4 mr-1"})," Add Row"]})}),e.jsxs(H,{children:[e.jsx(z,{children:e.jsx(B,{children:"Add New Row"})}),e.jsx($,{placeholder:"Row label...",value:k,onChange:j=>w(j.target.value),onKeyDown:j=>j.key==="Enter"&&d()}),e.jsx(J,{children:e.jsx(D,{onClick:d,disabled:!k.trim(),children:"Add"})})]})]}),e.jsxs(I,{open:f,onOpenChange:s,children:[e.jsx(K,{asChild:!0,children:e.jsxs(D,{variant:"outline",size:"sm",children:[e.jsx(W,{className:"h-4 w-4 mr-1"})," Add Column"]})}),e.jsxs(H,{children:[e.jsx(z,{children:e.jsx(B,{children:"Add New Column"})}),e.jsx($,{placeholder:"Column label...",value:i,onChange:j=>u(j.target.value),onKeyDown:j=>j.key==="Enter"&&m()}),e.jsx(J,{children:e.jsx(D,{onClick:m,disabled:!i.trim(),children:"Add"})})]})]}),e.jsx(D,{variant:"default",size:"sm",onClick:()=>E(!0),children:"Save Changes"})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:e.jsx(we,{rows:o,columns:r,data:p,activeCell:c,setActiveCell:l,updateCell:y,deleteRow:C,deleteColumn:_,navigateCell:A,onRenameColumn:S})})]})})}export{Ye as default};
