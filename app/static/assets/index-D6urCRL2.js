import{c as nt,r,j as e,e as M,t as wn,h as Te,p as st,v as Ie,P as V,q as b,w as le,o as ne,x as bn,B as k,b as at,L as fe,I as F,y as ue,z as Nn,C as ot,D as Cn,E as yn,F as Mn,G as Sn,H as Rn,J as _n,K as rt,M as Pn,N as it,O as In,Q as En,U as Dn,V as Tn,W as An,Y as On,a as kn,X as Ln}from"./index-5h4fyC5o.js";import{b as Fn,C as Ae,D as $n}from"./DashboardLayout-CYWblJpM.js";import{T as Gn,a as Kn,b as te,c as O,d as Vn,e as P}from"./table-fuh9ib3s.js";import{B as Un}from"./badge-D45OPiav.js";import{u as Bn,a as Hn,b as zn,c as qn,d as Wn,e as Yn}from"./useRecords-BEXBPuKS.js";import{C as lt}from"./checkbox-CAEsV9yU.js";import{e as Xn,D as Ye,b as Xe,c as Je,d as Qe}from"./dialog-smSnTwQb.js";import{o as Jn,s as ee,c as K,b as Ze,u as Qn,t as Zn,C as ye,P as es}from"./types-DJhIH_GO.js";import{L as _}from"./label-DFOmj1kT.js";import{S as Me,a as Se,b as Re,c as _e,d as ae}from"./select-DHBbaoyE.js";import{C as ts,a as ns,b as ss,f as as,c as os,d as rs,e as is,S as ls}from"./command-Kye7CpQV.js";import{P as ct,a as dt,b as ut,f as z,C as cs,d as ds}from"./popover-CtwuidQE.js";import{C as mt,a as us}from"./index-C0CKl0Wy.js";import{c as pt,R as ms,I as ps}from"./index-CPO4dr6J.js";import{P as fs}from"./plus-t6F7-hPY.js";import{T as ft}from"./trash-2-DBHdjib2.js";import{E as hs}from"./ellipsis-Azl_UyhE.js";import"./users-Chyp5r20.js";import"./useQuery-CwlKf-ES.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=nt("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=nt("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),ht=({className:t,...n})=>e.jsx("nav",{role:"navigation","aria-label":"pagination",className:M("mx-auto flex w-full justify-center",t),...n});ht.displayName="Pagination";const xt=r.forwardRef(({className:t,...n},s)=>e.jsx("ul",{ref:s,className:M("flex flex-row items-center gap-1",t),...n}));xt.displayName="PaginationContent";const pe=r.forwardRef(({className:t,...n},s)=>e.jsx("li",{ref:s,className:M("",t),...n}));pe.displayName="PaginationItem";const Oe=({className:t,isActive:n,size:s="icon",...a})=>e.jsx("a",{"aria-current":n?"page":void 0,className:M(wn({variant:n?"outline":"ghost",size:s}),t),...a});Oe.displayName="PaginationLink";const gt=({className:t,...n})=>e.jsxs(Oe,{"aria-label":"Go to previous page",size:"default",className:M("gap-1 pl-2.5",t),...n,children:[e.jsx(Fn,{className:"h-4 w-4"}),e.jsx("span",{children:"Previous"})]});gt.displayName="PaginationPrevious";const jt=({className:t,...n})=>e.jsxs(Oe,{"aria-label":"Go to next page",size:"default",className:M("gap-1 pr-2.5",t),...n,children:[e.jsx("span",{children:"Next"}),e.jsx(Ae,{className:"h-4 w-4"})]});jt.displayName="PaginationNext";var ge="Collapsible",[gs,io]=Te(ge),[js,ke]=gs(ge),vt=r.forwardRef((t,n)=>{const{__scopeCollapsible:s,open:a,defaultOpen:i,disabled:o,onOpenChange:c,...f}=t,[x,h]=st({prop:a,defaultProp:i??!1,onChange:c,caller:ge});return e.jsx(js,{scope:s,disabled:o,contentId:Ie(),open:x,onOpenToggle:r.useCallback(()=>h(p=>!p),[h]),children:e.jsx(V.div,{"data-state":Fe(x),"data-disabled":o?"":void 0,...f,ref:n})})});vt.displayName=ge;var wt="CollapsibleTrigger",bt=r.forwardRef((t,n)=>{const{__scopeCollapsible:s,...a}=t,i=ke(wt,s);return e.jsx(V.button,{type:"button","aria-controls":i.contentId,"aria-expanded":i.open||!1,"data-state":Fe(i.open),"data-disabled":i.disabled?"":void 0,disabled:i.disabled,...a,ref:n,onClick:b(t.onClick,i.onOpenToggle)})});bt.displayName=wt;var Le="CollapsibleContent",vs=r.forwardRef((t,n)=>{const{forceMount:s,...a}=t,i=ke(Le,t.__scopeCollapsible);return e.jsx(le,{present:s||i.open,children:({present:o})=>e.jsx(ws,{...a,ref:n,present:o})})});vs.displayName=Le;var ws=r.forwardRef((t,n)=>{const{__scopeCollapsible:s,present:a,children:i,...o}=t,c=ke(Le,s),[f,x]=r.useState(a),h=r.useRef(null),p=ne(n,h),d=r.useRef(0),m=d.current,w=r.useRef(0),u=w.current,g=c.open||f,R=r.useRef(g),S=r.useRef(void 0);return r.useEffect(()=>{const N=requestAnimationFrame(()=>R.current=!1);return()=>cancelAnimationFrame(N)},[]),bn(()=>{const N=h.current;if(N){S.current=S.current||{transitionDuration:N.style.transitionDuration,animationName:N.style.animationName},N.style.transitionDuration="0s",N.style.animationName="none";const A=N.getBoundingClientRect();d.current=A.height,w.current=A.width,R.current||(N.style.transitionDuration=S.current.transitionDuration,N.style.animationName=S.current.animationName),x(a)}},[c.open,a]),e.jsx(V.div,{"data-state":Fe(c.open),"data-disabled":c.disabled?"":void 0,id:c.contentId,hidden:!g,...o,ref:p,style:{"--radix-collapsible-content-height":m?`${m}px`:void 0,"--radix-collapsible-content-width":u?`${u}px`:void 0,...t.style},children:g&&i})});function Fe(t){return t?"open":"closed"}var bs=vt;const Ns=bs,Cs=bt;function Pe({options:t,value:n,onChange:s,placeholder:a="Select...",searchPlaceholder:i="Search...",emptyMessage:o="No results found.",className:c,disabled:f=!1}){var p;const[x,h]=r.useState(!1);return e.jsxs(ct,{open:x,onOpenChange:h,children:[e.jsx(dt,{asChild:!0,children:e.jsxs(k,{variant:"outline",role:"combobox","aria-expanded":x,className:M("w-full justify-between",c),disabled:f,children:[n?(p=t.find(d=>d.value===n))==null?void 0:p.label:a,e.jsx(ts,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(ut,{className:"w-[--radix-popover-trigger-width] p-0",align:"start",children:e.jsxs(ns,{children:[e.jsx(ss,{placeholder:i}),e.jsxs(as,{children:[e.jsx(os,{children:o}),e.jsx(rs,{children:t.map(d=>e.jsxs(is,{value:d.label,onSelect:m=>{s(d.value===n?"":d.value),h(!1)},children:[e.jsx(mt,{className:M("mr-2 h-4 w-4",n===d.value?"opacity-100":"opacity-0")}),d.label]},d.value))})]})]})})]})}const ys=Jn({date:ee().min(1,"Date is required"),employeeId:K.number().min(1,"Employee is required"),clientId:K.number().min(1,"Client is required"),jobId:K.number().min(1,"Job is required"),shiftId:K.number().min(1,"Shift is required"),startTime:ee().min(1,"Start time is required"),endTime:ee().min(1,"End time is required"),hours:K.number().min(.1,"Hours must be greater than 0"),hourRate:K.number().optional(),clientHourlyRate:K.number().optional(),job_name:ee().optional(),role:ee().optional(),jobStatus:ee().optional(),additions:K.number().optional(),deductions:K.number().optional(),self_employed:Ze().optional(),dns:Ze().optional()}),et=({record:t,onSuccess:n,onCancel:s})=>{const{role:a}=at(),i=a==="admin",{data:o,isLoading:c}=Bn(),f=Hn(),x=zn(),[h,p]=r.useState(""),[d,m]=r.useState(""),w=!!t,u=Qn({resolver:Zn(ys),defaultValues:{date:(t==null?void 0:t.date)||new Date().toISOString().split("T")[0],employeeId:void 0,clientId:void 0,jobId:void 0,shiftId:void 0,startTime:t!=null&&t.shiftStart?t.shiftStart.substring(0,5):"09:00",endTime:t!=null&&t.shiftEnd?t.shiftEnd.substring(0,5):"17:00",hours:(t==null?void 0:t.paidHours)||8,hourRate:(t==null?void 0:t.hourRate)||0,clientHourlyRate:(t==null?void 0:t.clientHourlyRate)||0,job_name:(t==null?void 0:t.jobName)||"",role:"Travel Retail Specialist",jobStatus:(t==null?void 0:t.jobStatus)||"Currently Working - Full Airside Pass",additions:0,deductions:0,self_employed:!1,dns:!1}}),g=u.watch("startTime"),R=u.watch("endTime"),S=u.watch("shiftId"),N=r.useMemo(()=>o!=null&&o.jobs?Array.from(new Set(o.jobs.map(l=>l.location).filter(Boolean))):[],[o]),A=r.useMemo(()=>!(o!=null&&o.jobs)||!h?[]:Array.from(new Set(o.jobs.filter(l=>l.location===h).map(l=>l.site).filter(Boolean))),[o,h]);r.useEffect(()=>{if(t&&o){const l=o.employees.find(y=>y.name===t.fullName);l&&u.setValue("employeeId",l.id);const j=o.clients.find(y=>y.name===t.clientName);j&&u.setValue("clientId",j.id);const C=o.shifts.find(y=>y.name===t.shiftName);C&&u.setValue("shiftId",C.id);let E=o.jobs.find(y=>y.name===t.jobName&&y.site===t.site);E||(E=o.jobs.find(y=>y.site===t.site&&y.location===t.location)),E&&(u.setValue("jobId",E.id),p(E.location),m(E.site))}},[t,o,u]),r.useEffect(()=>{if(g&&R){const[l,j]=g.split(":").map(Number),[C,E]=R.split(":").map(Number);let y=l*60+j,q=C*60+E;q<y&&(q+=24*60);const be=(q-y)/60;u.setValue("hours",parseFloat(be.toFixed(2)))}},[g,R,u]),r.useEffect(()=>{var l;if(!w&&S&&(o!=null&&o.shifts)){const j=(l=o.shifts.find(C=>C.id===S))==null?void 0:l.name;j&&u.setValue("job_name",j)}},[S,w,o,u]),r.useEffect(()=>{if(h&&d&&(o!=null&&o.jobs)){const l=o.jobs.find(j=>j.location===h&&j.site===d);l&&u.setValue("jobId",l.id)}},[h,d,o,u]);const $=l=>{w&&t?x.mutate({id:t.id,...l},{onSuccess:()=>{ue.success("Record updated successfully"),n()},onError:j=>{ue.error(`Failed to update record: ${j.message}`)}}):f.mutate(l,{onSuccess:()=>{ue.success("Record created successfully"),n()},onError:j=>{ue.error(`Failed to create record: ${j.message}`)}})},X=f.isPending||x.isPending;if(c)return e.jsx("div",{className:"flex justify-center p-4",children:e.jsx(fe,{className:"animate-spin"})});const J=(o==null?void 0:o.employees.map(l=>({value:l.id.toString(),label:l.name})))||[],U=(o==null?void 0:o.clients.map(l=>({value:l.id.toString(),label:l.name})))||[],B=(o==null?void 0:o.shifts.map(l=>({value:l.id.toString(),label:`${l.name} (${l.start.substring(0,5)}-${l.end.substring(0,5)})`})))||[];return e.jsxs("form",{onSubmit:u.handleSubmit($),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"date",children:"Date"}),e.jsx(F,{id:"date",type:"date",...u.register("date")}),u.formState.errors.date&&e.jsx("span",{className:"text-red-500 text-xs",children:u.formState.errors.date.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"startTime",children:"Start Time"}),e.jsx(F,{id:"startTime",type:"time",...u.register("startTime")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"endTime",children:"End Time"}),e.jsx(F,{id:"endTime",type:"time",...u.register("endTime")})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(_,{children:["Calculated Hours: ",u.watch("hours")]}),e.jsx(F,{type:"hidden",...u.register("hours")})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{children:"Employee"}),e.jsx(ye,{control:u.control,name:"employeeId",render:({field:l})=>{var j;return e.jsx(Pe,{options:J,value:(j=l.value)==null?void 0:j.toString(),onChange:C=>l.onChange(Number(C)),placeholder:"Select Employee...",searchPlaceholder:"Search employees..."})}}),u.formState.errors.employeeId&&e.jsx("span",{className:"text-red-500 text-xs",children:u.formState.errors.employeeId.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{children:"Client"}),e.jsx(ye,{control:u.control,name:"clientId",render:({field:l})=>{var j;return e.jsx(Pe,{options:U,value:(j=l.value)==null?void 0:j.toString(),onChange:C=>l.onChange(Number(C)),placeholder:"Select Client...",searchPlaceholder:"Search clients..."})}}),u.formState.errors.clientId&&e.jsx("span",{className:"text-red-500 text-xs",children:u.formState.errors.clientId.message})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{children:"Location"}),e.jsxs(Me,{value:h,onValueChange:l=>{p(l),m("")},children:[e.jsx(Se,{children:e.jsx(Re,{placeholder:"Select Location"})}),e.jsx(_e,{children:N.map(l=>e.jsx(ae,{value:l,children:l},l))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{children:"Site / Terminal"}),e.jsxs(Me,{value:d,onValueChange:m,disabled:!h,children:[e.jsx(Se,{children:e.jsx(Re,{placeholder:"Select Site"})}),e.jsx(_e,{children:A.map(l=>e.jsx(ae,{value:l,children:l},l))})]}),e.jsx("input",{type:"hidden",...u.register("jobId")}),u.formState.errors.jobId&&e.jsx("span",{className:"text-red-500 text-xs",children:"Job Selection Incomplete"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{children:"Shift"}),e.jsx(ye,{control:u.control,name:"shiftId",render:({field:l})=>{var j;return e.jsx(Pe,{options:B,value:(j=l.value)==null?void 0:j.toString(),onChange:C=>l.onChange(Number(C)),placeholder:"Select Shift config...",searchPlaceholder:"Search shifts..."})}}),u.formState.errors.shiftId&&e.jsx("span",{className:"text-red-500 text-xs",children:u.formState.errors.shiftId.message})]}),(i||w)&&e.jsxs("div",{className:"border-t pt-4 grid grid-cols-2 gap-4 bg-muted/20 p-4 rounded-md",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{children:"Role"}),e.jsx(F,{...u.register("role")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{children:"Status"}),e.jsxs(Me,{onValueChange:l=>u.setValue("jobStatus",l),defaultValue:u.getValues("jobStatus"),children:[e.jsx(Se,{children:e.jsx(Re,{placeholder:"Status"})}),e.jsxs(_e,{children:[e.jsx(ae,{value:"Currently Working - Full Airside Pass",children:"Currently Working - Full Airside Pass"}),e.jsx(ae,{value:"Completed",children:"Completed"}),e.jsx(ae,{value:"Cancelled",children:"Cancelled"})]})]})]}),i&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"hourRate",children:"Pay Rate (£)"}),e.jsx(F,{id:"hourRate",type:"number",step:"0.01",...u.register("hourRate")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"clientHourlyRate",children:"Client Rate (£)"}),e.jsx(F,{id:"clientHourlyRate",type:"number",step:"0.01",...u.register("clientHourlyRate")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"additions",children:"Additions (£)"}),e.jsx(F,{id:"additions",type:"number",step:"0.01",...u.register("additions")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{htmlFor:"deductions",children:"Deductions (£)"}),e.jsx(F,{id:"deductions",type:"number",step:"0.01",...u.register("deductions")})]})]})]}),e.jsxs(Xn,{className:"mt-6 flex justify-between items-center w-full",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:!w&&"Defaults: Role=Travel Retail, Additions=0, Deductions=0"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(k,{type:"button",variant:"outline",onClick:s,children:"Cancel"}),e.jsxs(k,{type:"submit",disabled:X,children:[X&&e.jsx(fe,{className:"mr-2 h-4 w-4 animate-spin"}),w?"Update Record":"Create Record"]})]})]})]})};var Ee=["Enter"," "],Ms=["ArrowDown","PageUp","Home"],Nt=["ArrowUp","PageDown","End"],Ss=[...Ms,...Nt],Rs={ltr:[...Ee,"ArrowRight"],rtl:[...Ee,"ArrowLeft"]},_s={ltr:["ArrowLeft"],rtl:["ArrowRight"]},ce="Menu",[re,Ps,Is]=Nn(ce),[W,Ct]=Te(ce,[Is,ot,pt]),je=ot(),yt=pt(),[Es,Y]=W(ce),[Ds,de]=W(ce),Mt=t=>{const{__scopeMenu:n,open:s=!1,children:a,dir:i,onOpenChange:o,modal:c=!0}=t,f=je(n),[x,h]=r.useState(null),p=r.useRef(!1),d=rt(o),m=Dn(i);return r.useEffect(()=>{const w=()=>{p.current=!0,document.addEventListener("pointerdown",u,{capture:!0,once:!0}),document.addEventListener("pointermove",u,{capture:!0,once:!0})},u=()=>p.current=!1;return document.addEventListener("keydown",w,{capture:!0}),()=>{document.removeEventListener("keydown",w,{capture:!0}),document.removeEventListener("pointerdown",u,{capture:!0}),document.removeEventListener("pointermove",u,{capture:!0})}},[]),e.jsx(Tn,{...f,children:e.jsx(Es,{scope:n,open:s,onOpenChange:d,content:x,onContentChange:h,children:e.jsx(Ds,{scope:n,onClose:r.useCallback(()=>d(!1),[d]),isUsingKeyboardRef:p,dir:m,modal:c,children:a})})})};Mt.displayName=ce;var Ts="MenuAnchor",$e=r.forwardRef((t,n)=>{const{__scopeMenu:s,...a}=t,i=je(s);return e.jsx(Cn,{...i,...a,ref:n})});$e.displayName=Ts;var Ge="MenuPortal",[As,St]=W(Ge,{forceMount:void 0}),Rt=t=>{const{__scopeMenu:n,forceMount:s,children:a,container:i}=t,o=Y(Ge,n);return e.jsx(As,{scope:n,forceMount:s,children:e.jsx(le,{present:s||o.open,children:e.jsx(An,{asChild:!0,container:i,children:a})})})};Rt.displayName=Ge;var T="MenuContent",[Os,Ke]=W(T),_t=r.forwardRef((t,n)=>{const s=St(T,t.__scopeMenu),{forceMount:a=s.forceMount,...i}=t,o=Y(T,t.__scopeMenu),c=de(T,t.__scopeMenu);return e.jsx(re.Provider,{scope:t.__scopeMenu,children:e.jsx(le,{present:a||o.open,children:e.jsx(re.Slot,{scope:t.__scopeMenu,children:c.modal?e.jsx(ks,{...i,ref:n}):e.jsx(Ls,{...i,ref:n})})})})}),ks=r.forwardRef((t,n)=>{const s=Y(T,t.__scopeMenu),a=r.useRef(null),i=ne(n,a);return r.useEffect(()=>{const o=a.current;if(o)return yn(o)},[]),e.jsx(Ve,{...t,ref:i,trapFocus:s.open,disableOutsidePointerEvents:s.open,disableOutsideScroll:!0,onFocusOutside:b(t.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>s.onOpenChange(!1)})}),Ls=r.forwardRef((t,n)=>{const s=Y(T,t.__scopeMenu);return e.jsx(Ve,{...t,ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>s.onOpenChange(!1)})}),Fs=On("MenuContent.ScrollLock"),Ve=r.forwardRef((t,n)=>{const{__scopeMenu:s,loop:a=!1,trapFocus:i,onOpenAutoFocus:o,onCloseAutoFocus:c,disableOutsidePointerEvents:f,onEntryFocus:x,onEscapeKeyDown:h,onPointerDownOutside:p,onFocusOutside:d,onInteractOutside:m,onDismiss:w,disableOutsideScroll:u,...g}=t,R=Y(T,s),S=de(T,s),N=je(s),A=yt(s),$=Ps(s),[X,J]=r.useState(null),U=r.useRef(null),B=ne(n,U,R.onContentChange),l=r.useRef(0),j=r.useRef(""),C=r.useRef(0),E=r.useRef(null),y=r.useRef("right"),q=r.useRef(0),be=u?In:r.Fragment,jn=u?{as:Fs,allowPinchZoom:!0}:void 0,vn=v=>{var Z,qe;const D=j.current+v,L=$().filter(G=>!G.disabled),H=document.activeElement,Ne=(Z=L.find(G=>G.ref.current===H))==null?void 0:Z.textValue,Ce=L.map(G=>G.textValue),ze=Xs(Ce,D,Ne),se=(qe=L.find(G=>G.textValue===ze))==null?void 0:qe.ref.current;(function G(We){j.current=We,window.clearTimeout(l.current),We!==""&&(l.current=window.setTimeout(()=>G(""),1e3))})(D),se&&setTimeout(()=>se.focus())};r.useEffect(()=>()=>window.clearTimeout(l.current),[]),Mn();const Q=r.useCallback(v=>{var L,H;return y.current===((L=E.current)==null?void 0:L.side)&&Qs(v,(H=E.current)==null?void 0:H.area)},[]);return e.jsx(Os,{scope:s,searchRef:j,onItemEnter:r.useCallback(v=>{Q(v)&&v.preventDefault()},[Q]),onItemLeave:r.useCallback(v=>{var D;Q(v)||((D=U.current)==null||D.focus(),J(null))},[Q]),onTriggerLeave:r.useCallback(v=>{Q(v)&&v.preventDefault()},[Q]),pointerGraceTimerRef:C,onPointerGraceIntentChange:r.useCallback(v=>{E.current=v},[]),children:e.jsx(be,{...jn,children:e.jsx(Sn,{asChild:!0,trapped:i,onMountAutoFocus:b(o,v=>{var D;v.preventDefault(),(D=U.current)==null||D.focus({preventScroll:!0})}),onUnmountAutoFocus:c,children:e.jsx(Rn,{asChild:!0,disableOutsidePointerEvents:f,onEscapeKeyDown:h,onPointerDownOutside:p,onFocusOutside:d,onInteractOutside:m,onDismiss:w,children:e.jsx(ms,{asChild:!0,...A,dir:S.dir,orientation:"vertical",loop:a,currentTabStopId:X,onCurrentTabStopIdChange:J,onEntryFocus:b(x,v=>{S.isUsingKeyboardRef.current||v.preventDefault()}),preventScrollOnEntryFocus:!0,children:e.jsx(_n,{role:"menu","aria-orientation":"vertical","data-state":Bt(R.open),"data-radix-menu-content":"",dir:S.dir,...N,...g,ref:B,style:{outline:"none",...g.style},onKeyDown:b(g.onKeyDown,v=>{const L=v.target.closest("[data-radix-menu-content]")===v.currentTarget,H=v.ctrlKey||v.altKey||v.metaKey,Ne=v.key.length===1;L&&(v.key==="Tab"&&v.preventDefault(),!H&&Ne&&vn(v.key));const Ce=U.current;if(v.target!==Ce||!Ss.includes(v.key))return;v.preventDefault();const se=$().filter(Z=>!Z.disabled).map(Z=>Z.ref.current);Nt.includes(v.key)&&se.reverse(),Ws(se)}),onBlur:b(t.onBlur,v=>{v.currentTarget.contains(v.target)||(window.clearTimeout(l.current),j.current="")}),onPointerMove:b(t.onPointerMove,ie(v=>{const D=v.target,L=q.current!==v.clientX;if(v.currentTarget.contains(D)&&L){const H=v.clientX>q.current?"right":"left";y.current=H,q.current=v.clientX}}))})})})})})})});_t.displayName=T;var $s="MenuGroup",Ue=r.forwardRef((t,n)=>{const{__scopeMenu:s,...a}=t;return e.jsx(V.div,{role:"group",...a,ref:n})});Ue.displayName=$s;var Gs="MenuLabel",Pt=r.forwardRef((t,n)=>{const{__scopeMenu:s,...a}=t;return e.jsx(V.div,{...a,ref:n})});Pt.displayName=Gs;var he="MenuItem",tt="menu.itemSelect",ve=r.forwardRef((t,n)=>{const{disabled:s=!1,onSelect:a,...i}=t,o=r.useRef(null),c=de(he,t.__scopeMenu),f=Ke(he,t.__scopeMenu),x=ne(n,o),h=r.useRef(!1),p=()=>{const d=o.current;if(!s&&d){const m=new CustomEvent(tt,{bubbles:!0,cancelable:!0});d.addEventListener(tt,w=>a==null?void 0:a(w),{once:!0}),En(d,m),m.defaultPrevented?h.current=!1:c.onClose()}};return e.jsx(It,{...i,ref:x,disabled:s,onClick:b(t.onClick,p),onPointerDown:d=>{var m;(m=t.onPointerDown)==null||m.call(t,d),h.current=!0},onPointerUp:b(t.onPointerUp,d=>{var m;h.current||(m=d.currentTarget)==null||m.click()}),onKeyDown:b(t.onKeyDown,d=>{const m=f.searchRef.current!=="";s||m&&d.key===" "||Ee.includes(d.key)&&(d.currentTarget.click(),d.preventDefault())})})});ve.displayName=he;var It=r.forwardRef((t,n)=>{const{__scopeMenu:s,disabled:a=!1,textValue:i,...o}=t,c=Ke(he,s),f=yt(s),x=r.useRef(null),h=ne(n,x),[p,d]=r.useState(!1),[m,w]=r.useState("");return r.useEffect(()=>{const u=x.current;u&&w((u.textContent??"").trim())},[o.children]),e.jsx(re.ItemSlot,{scope:s,disabled:a,textValue:i??m,children:e.jsx(ps,{asChild:!0,...f,focusable:!a,children:e.jsx(V.div,{role:"menuitem","data-highlighted":p?"":void 0,"aria-disabled":a||void 0,"data-disabled":a?"":void 0,...o,ref:h,onPointerMove:b(t.onPointerMove,ie(u=>{a?c.onItemLeave(u):(c.onItemEnter(u),u.defaultPrevented||u.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:b(t.onPointerLeave,ie(u=>c.onItemLeave(u))),onFocus:b(t.onFocus,()=>d(!0)),onBlur:b(t.onBlur,()=>d(!1))})})})}),Ks="MenuCheckboxItem",Et=r.forwardRef((t,n)=>{const{checked:s=!1,onCheckedChange:a,...i}=t;return e.jsx(kt,{scope:t.__scopeMenu,checked:s,children:e.jsx(ve,{role:"menuitemcheckbox","aria-checked":xe(s)?"mixed":s,...i,ref:n,"data-state":He(s),onSelect:b(i.onSelect,()=>a==null?void 0:a(xe(s)?!0:!s),{checkForDefaultPrevented:!1})})})});Et.displayName=Ks;var Dt="MenuRadioGroup",[Vs,Us]=W(Dt,{value:void 0,onValueChange:()=>{}}),Tt=r.forwardRef((t,n)=>{const{value:s,onValueChange:a,...i}=t,o=rt(a);return e.jsx(Vs,{scope:t.__scopeMenu,value:s,onValueChange:o,children:e.jsx(Ue,{...i,ref:n})})});Tt.displayName=Dt;var At="MenuRadioItem",Ot=r.forwardRef((t,n)=>{const{value:s,...a}=t,i=Us(At,t.__scopeMenu),o=s===i.value;return e.jsx(kt,{scope:t.__scopeMenu,checked:o,children:e.jsx(ve,{role:"menuitemradio","aria-checked":o,...a,ref:n,"data-state":He(o),onSelect:b(a.onSelect,()=>{var c;return(c=i.onValueChange)==null?void 0:c.call(i,s)},{checkForDefaultPrevented:!1})})})});Ot.displayName=At;var Be="MenuItemIndicator",[kt,Bs]=W(Be,{checked:!1}),Lt=r.forwardRef((t,n)=>{const{__scopeMenu:s,forceMount:a,...i}=t,o=Bs(Be,s);return e.jsx(le,{present:a||xe(o.checked)||o.checked===!0,children:e.jsx(V.span,{...i,ref:n,"data-state":He(o.checked)})})});Lt.displayName=Be;var Hs="MenuSeparator",Ft=r.forwardRef((t,n)=>{const{__scopeMenu:s,...a}=t;return e.jsx(V.div,{role:"separator","aria-orientation":"horizontal",...a,ref:n})});Ft.displayName=Hs;var zs="MenuArrow",$t=r.forwardRef((t,n)=>{const{__scopeMenu:s,...a}=t,i=je(s);return e.jsx(Pn,{...i,...a,ref:n})});$t.displayName=zs;var qs="MenuSub",[lo,Gt]=W(qs),oe="MenuSubTrigger",Kt=r.forwardRef((t,n)=>{const s=Y(oe,t.__scopeMenu),a=de(oe,t.__scopeMenu),i=Gt(oe,t.__scopeMenu),o=Ke(oe,t.__scopeMenu),c=r.useRef(null),{pointerGraceTimerRef:f,onPointerGraceIntentChange:x}=o,h={__scopeMenu:t.__scopeMenu},p=r.useCallback(()=>{c.current&&window.clearTimeout(c.current),c.current=null},[]);return r.useEffect(()=>p,[p]),r.useEffect(()=>{const d=f.current;return()=>{window.clearTimeout(d),x(null)}},[f,x]),e.jsx($e,{asChild:!0,...h,children:e.jsx(It,{id:i.triggerId,"aria-haspopup":"menu","aria-expanded":s.open,"aria-controls":i.contentId,"data-state":Bt(s.open),...t,ref:it(n,i.onTriggerChange),onClick:d=>{var m;(m=t.onClick)==null||m.call(t,d),!(t.disabled||d.defaultPrevented)&&(d.currentTarget.focus(),s.open||s.onOpenChange(!0))},onPointerMove:b(t.onPointerMove,ie(d=>{o.onItemEnter(d),!d.defaultPrevented&&!t.disabled&&!s.open&&!c.current&&(o.onPointerGraceIntentChange(null),c.current=window.setTimeout(()=>{s.onOpenChange(!0),p()},100))})),onPointerLeave:b(t.onPointerLeave,ie(d=>{var w,u;p();const m=(w=s.content)==null?void 0:w.getBoundingClientRect();if(m){const g=(u=s.content)==null?void 0:u.dataset.side,R=g==="right",S=R?-5:5,N=m[R?"left":"right"],A=m[R?"right":"left"];o.onPointerGraceIntentChange({area:[{x:d.clientX+S,y:d.clientY},{x:N,y:m.top},{x:A,y:m.top},{x:A,y:m.bottom},{x:N,y:m.bottom}],side:g}),window.clearTimeout(f.current),f.current=window.setTimeout(()=>o.onPointerGraceIntentChange(null),300)}else{if(o.onTriggerLeave(d),d.defaultPrevented)return;o.onPointerGraceIntentChange(null)}})),onKeyDown:b(t.onKeyDown,d=>{var w;const m=o.searchRef.current!=="";t.disabled||m&&d.key===" "||Rs[a.dir].includes(d.key)&&(s.onOpenChange(!0),(w=s.content)==null||w.focus(),d.preventDefault())})})})});Kt.displayName=oe;var Vt="MenuSubContent",Ut=r.forwardRef((t,n)=>{const s=St(T,t.__scopeMenu),{forceMount:a=s.forceMount,...i}=t,o=Y(T,t.__scopeMenu),c=de(T,t.__scopeMenu),f=Gt(Vt,t.__scopeMenu),x=r.useRef(null),h=ne(n,x);return e.jsx(re.Provider,{scope:t.__scopeMenu,children:e.jsx(le,{present:a||o.open,children:e.jsx(re.Slot,{scope:t.__scopeMenu,children:e.jsx(Ve,{id:f.contentId,"aria-labelledby":f.triggerId,...i,ref:h,align:"start",side:c.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:p=>{var d;c.isUsingKeyboardRef.current&&((d=x.current)==null||d.focus()),p.preventDefault()},onCloseAutoFocus:p=>p.preventDefault(),onFocusOutside:b(t.onFocusOutside,p=>{p.target!==f.trigger&&o.onOpenChange(!1)}),onEscapeKeyDown:b(t.onEscapeKeyDown,p=>{c.onClose(),p.preventDefault()}),onKeyDown:b(t.onKeyDown,p=>{var w;const d=p.currentTarget.contains(p.target),m=_s[c.dir].includes(p.key);d&&m&&(o.onOpenChange(!1),(w=f.trigger)==null||w.focus(),p.preventDefault())})})})})})});Ut.displayName=Vt;function Bt(t){return t?"open":"closed"}function xe(t){return t==="indeterminate"}function He(t){return xe(t)?"indeterminate":t?"checked":"unchecked"}function Ws(t){const n=document.activeElement;for(const s of t)if(s===n||(s.focus(),document.activeElement!==n))return}function Ys(t,n){return t.map((s,a)=>t[(n+a)%t.length])}function Xs(t,n,s){const i=n.length>1&&Array.from(n).every(h=>h===n[0])?n[0]:n,o=s?t.indexOf(s):-1;let c=Ys(t,Math.max(o,0));i.length===1&&(c=c.filter(h=>h!==s));const x=c.find(h=>h.toLowerCase().startsWith(i.toLowerCase()));return x!==s?x:void 0}function Js(t,n){const{x:s,y:a}=t;let i=!1;for(let o=0,c=n.length-1;o<n.length;c=o++){const f=n[o],x=n[c],h=f.x,p=f.y,d=x.x,m=x.y;p>a!=m>a&&s<(d-h)*(a-p)/(m-p)+h&&(i=!i)}return i}function Qs(t,n){if(!n)return!1;const s={x:t.clientX,y:t.clientY};return Js(s,n)}function ie(t){return n=>n.pointerType==="mouse"?t(n):void 0}var Zs=Mt,ea=$e,ta=Rt,na=_t,sa=Ue,aa=Pt,oa=ve,ra=Et,ia=Tt,la=Ot,ca=Lt,da=Ft,ua=$t,ma=Kt,pa=Ut,we="DropdownMenu",[fa,co]=Te(we,[Ct]),I=Ct(),[ha,Ht]=fa(we),zt=t=>{const{__scopeDropdownMenu:n,children:s,dir:a,open:i,defaultOpen:o,onOpenChange:c,modal:f=!0}=t,x=I(n),h=r.useRef(null),[p,d]=st({prop:i,defaultProp:o??!1,onChange:c,caller:we});return e.jsx(ha,{scope:n,triggerId:Ie(),triggerRef:h,contentId:Ie(),open:p,onOpenChange:d,onOpenToggle:r.useCallback(()=>d(m=>!m),[d]),modal:f,children:e.jsx(Zs,{...x,open:p,onOpenChange:d,dir:a,modal:f,children:s})})};zt.displayName=we;var qt="DropdownMenuTrigger",Wt=r.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,disabled:a=!1,...i}=t,o=Ht(qt,s),c=I(s);return e.jsx(ea,{asChild:!0,...c,children:e.jsx(V.button,{type:"button",id:o.triggerId,"aria-haspopup":"menu","aria-expanded":o.open,"aria-controls":o.open?o.contentId:void 0,"data-state":o.open?"open":"closed","data-disabled":a?"":void 0,disabled:a,...i,ref:it(n,o.triggerRef),onPointerDown:b(t.onPointerDown,f=>{!a&&f.button===0&&f.ctrlKey===!1&&(o.onOpenToggle(),o.open||f.preventDefault())}),onKeyDown:b(t.onKeyDown,f=>{a||(["Enter"," "].includes(f.key)&&o.onOpenToggle(),f.key==="ArrowDown"&&o.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(f.key)&&f.preventDefault())})})})});Wt.displayName=qt;var xa="DropdownMenuPortal",Yt=t=>{const{__scopeDropdownMenu:n,...s}=t,a=I(n);return e.jsx(ta,{...a,...s})};Yt.displayName=xa;var Xt="DropdownMenuContent",Jt=r.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,i=Ht(Xt,s),o=I(s),c=r.useRef(!1);return e.jsx(na,{id:i.contentId,"aria-labelledby":i.triggerId,...o,...a,ref:n,onCloseAutoFocus:b(t.onCloseAutoFocus,f=>{var x;c.current||(x=i.triggerRef.current)==null||x.focus(),c.current=!1,f.preventDefault()}),onInteractOutside:b(t.onInteractOutside,f=>{const x=f.detail.originalEvent,h=x.button===0&&x.ctrlKey===!0,p=x.button===2||h;(!i.modal||p)&&(c.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Jt.displayName=Xt;var ga="DropdownMenuGroup",ja=r.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,i=I(s);return e.jsx(sa,{...i,...a,ref:n})});ja.displayName=ga;var va="DropdownMenuLabel",Qt=r.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,i=I(s);return e.jsx(aa,{...i,...a,ref:n})});Qt.displayName=va;var wa="DropdownMenuItem",Zt=r.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,i=I(s);return e.jsx(oa,{...i,...a,ref:n})});Zt.displayName=wa;var ba="DropdownMenuCheckboxItem",en=r.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,i=I(s);return e.jsx(ra,{...i,...a,ref:n})});en.displayName=ba;var Na="DropdownMenuRadioGroup",Ca=r.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,i=I(s);return e.jsx(ia,{...i,...a,ref:n})});Ca.displayName=Na;var ya="DropdownMenuRadioItem",tn=r.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,i=I(s);return e.jsx(la,{...i,...a,ref:n})});tn.displayName=ya;var Ma="DropdownMenuItemIndicator",nn=r.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,i=I(s);return e.jsx(ca,{...i,...a,ref:n})});nn.displayName=Ma;var Sa="DropdownMenuSeparator",sn=r.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,i=I(s);return e.jsx(da,{...i,...a,ref:n})});sn.displayName=Sa;var Ra="DropdownMenuArrow",_a=r.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,i=I(s);return e.jsx(ua,{...i,...a,ref:n})});_a.displayName=Ra;var Pa="DropdownMenuSubTrigger",an=r.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,i=I(s);return e.jsx(ma,{...i,...a,ref:n})});an.displayName=Pa;var Ia="DropdownMenuSubContent",on=r.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,i=I(s);return e.jsx(pa,{...i,...a,ref:n,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});on.displayName=Ia;var Ea=zt,Da=Wt,Ta=Yt,rn=Jt,ln=Qt,cn=Zt,dn=en,un=tn,mn=nn,pn=sn,fn=an,hn=on;const Aa=Ea,Oa=Da,ka=r.forwardRef(({className:t,inset:n,children:s,...a},i)=>e.jsxs(fn,{ref:i,className:M("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[state=open]:bg-accent focus:bg-accent",n&&"pl-8",t),...a,children:[s,e.jsx(Ae,{className:"ml-auto h-4 w-4"})]}));ka.displayName=fn.displayName;const La=r.forwardRef(({className:t,...n},s)=>e.jsx(hn,{ref:s,className:M("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n}));La.displayName=hn.displayName;const xn=r.forwardRef(({className:t,sideOffset:n=4,...s},a)=>e.jsx(Ta,{children:e.jsx(rn,{ref:a,sideOffset:n,className:M("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...s})}));xn.displayName=rn.displayName;const De=r.forwardRef(({className:t,inset:n,...s},a)=>e.jsx(cn,{ref:a,className:M("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",n&&"pl-8",t),...s}));De.displayName=cn.displayName;const Fa=r.forwardRef(({className:t,children:n,checked:s,...a},i)=>e.jsxs(dn,{ref:i,className:M("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t),checked:s,...a,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(mn,{children:e.jsx(mt,{className:"h-4 w-4"})})}),n]}));Fa.displayName=dn.displayName;const $a=r.forwardRef(({className:t,children:n,...s},a)=>e.jsxs(un,{ref:a,className:M("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t),...s,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(mn,{children:e.jsx(xs,{className:"h-2 w-2 fill-current"})})}),n]}));$a.displayName=un.displayName;const gn=r.forwardRef(({className:t,inset:n,...s},a)=>e.jsx(ln,{ref:a,className:M("px-2 py-1.5 text-sm font-semibold",n&&"pl-8",t),...s}));gn.displayName=ln.displayName;const Ga=r.forwardRef(({className:t,...n},s)=>e.jsx(pn,{ref:s,className:M("-mx-1 my-1 h-px bg-muted",t),...n}));Ga.displayName=pn.displayName;const uo=()=>{const[t,n]=r.useState({page:1,limit:20,sort_by:"date",sort_order:"desc",search:""}),{role:s}=at(),a=s==="admin",[i,o]=r.useState(""),[c,f]=r.useState(),[x,h]=r.useState(!1),[p,d]=r.useState(null),[m,w]=r.useState(new Set),{toast:u}=kn(),{data:g,isLoading:R,isError:S}=qn(t),N=Wn();r.useEffect(()=>{const l=setTimeout(()=>{n(j=>({...j,page:1,search:i}))},500);return()=>clearTimeout(l)},[i]),r.useEffect(()=>{n(l=>({...l,page:1,start:c!=null&&c.from?z(c.from,"yyyy-MM-dd"):void 0,end:c!=null&&c.to?z(c.to,"yyyy-MM-dd"):void 0}))},[c]);const A=l=>{l.preventDefault(),n(j=>({...j,page:1,search:i}))},$=l=>{n(j=>({...j,sort_by:l,sort_order:j.sort_by===l&&j.sort_order==="desc"?"asc":"desc"}))},X=l=>{l===!0&&(g!=null&&g.data)?w(new Set(g.data.map(j=>j.id))):w(new Set)},J=l=>{w(j=>{const C=new Set(j);return C.has(l)?C.delete(l):C.add(l),C})},U=async()=>{if(confirm(`Delete ${m.size} record${m.size!==1?"s":""}?`))try{await N.mutateAsync(Array.from(m)),u({title:"Success",description:`Deleted ${m.size} records`}),w(new Set)}catch(l){u({title:"Error",description:l.message||"Failed to delete records",variant:"destructive"})}},B=(g==null?void 0:g.meta.pages)||1;return e.jsx($n,{fullWidth:!0,children:e.jsxs("div",{className:"flex flex-col h-full space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Shift Records"})}),e.jsx(Ye,{open:x,onOpenChange:h,children:e.jsxs(Xe,{className:"max-w-2xl",children:[e.jsx(Je,{children:e.jsx(Qe,{children:"Add New Shift Record"})}),e.jsx(et,{onSuccess:()=>h(!1),onCancel:()=>h(!1)})]})}),e.jsx(Ye,{open:!!p,onOpenChange:l=>!l&&d(null),children:e.jsxs(Xe,{className:"max-w-2xl",children:[e.jsx(Je,{children:e.jsx(Qe,{children:"Edit Shift Record"})}),p&&e.jsx(et,{record:p,onSuccess:()=>d(null),onCancel:()=>d(null)})]})}),e.jsxs("div",{className:"flex items-center space-x-2 flex-wrap gap-y-2",children:[e.jsxs("form",{onSubmit:A,className:"flex-1 min-w-[200px] max-w-sm flex gap-2",children:[e.jsx(F,{placeholder:"Search by name, client, or job...",value:i,onChange:l=>o(l.target.value)}),e.jsx(k,{type:"submit",variant:"secondary",children:e.jsx(ls,{className:"h-4 w-4"})})]}),e.jsxs(ct,{children:[e.jsx(dt,{asChild:!0,children:e.jsxs(k,{id:"date",variant:"outline",className:M("w-[260px] justify-start text-left font-normal",!c&&"text-muted-foreground"),children:[e.jsx(cs,{className:"mr-2 h-4 w-4"}),c!=null&&c.from?c.to?e.jsxs(e.Fragment,{children:[z(c.from,"LLL dd, y")," -"," ",z(c.to,"LLL dd, y")]}):z(c.from,"LLL dd, y"):e.jsx("span",{children:"Pick a date range"})]})}),e.jsx(ut,{className:"w-auto p-0",align:"end",children:e.jsx(ds,{initialFocus:!0,mode:"range",defaultMonth:c==null?void 0:c.from,selected:c,onSelect:f,numberOfMonths:2})})]}),c&&e.jsx(k,{variant:"ghost",size:"icon",onClick:()=>f(void 0),children:e.jsx(Ln,{className:"h-4 w-4"})}),(a||s==="manager")&&e.jsxs(k,{onClick:()=>h(!0),className:"ml-auto",children:[e.jsx(fs,{className:"mr-2 h-4 w-4"})," Add Record"]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground text-right w-full",children:[(g==null?void 0:g.meta.total)||0," records found"]}),m.size>0&&e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-muted rounded-md border",children:[e.jsxs("span",{className:"text-sm font-medium",children:[m.size," record",m.size!==1?"s":""," selected"]}),e.jsxs(k,{variant:"destructive",size:"sm",onClick:U,disabled:N.isPending,children:[N.isPending?e.jsx(fe,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(ft,{className:"mr-2 h-4 w-4"}),"Delete Selected"]}),e.jsx(k,{variant:"outline",size:"sm",onClick:()=>w(new Set),children:"Clear Selection"})]}),e.jsx("div",{className:"border rounded-md bg-white overflow-x-auto",children:e.jsxs(Gn,{children:[e.jsx(Kn,{children:e.jsxs(te,{children:[e.jsx(O,{className:"w-[40px]",children:e.jsx(lt,{checked:m.size>0&&m.size===(g==null?void 0:g.data.length),onCheckedChange:X})}),e.jsx(O,{className:"w-[30px]"}),e.jsxs(O,{className:"cursor-pointer",onClick:()=>$("date"),children:["Date ",e.jsx(me,{className:"ml-2 h-4 w-4 inline"})]}),e.jsxs(O,{className:"cursor-pointer",onClick:()=>$("full_name"),children:["Employee ",e.jsx(me,{className:"ml-2 h-4 w-4 inline"})]}),e.jsxs(O,{className:"cursor-pointer",onClick:()=>$("client_name"),children:["Client ",e.jsx(me,{className:"ml-2 h-4 w-4 inline"})]}),e.jsxs(O,{className:"hidden md:table-cell cursor-pointer",onClick:()=>$("location"),children:["Location ",e.jsx(me,{className:"ml-2 h-4 w-4 inline"})]}),e.jsx(O,{children:"Shift"}),e.jsx(O,{className:"text-right",children:"Hours"}),a&&e.jsx(O,{className:"text-right",children:"Staff Pay"}),a&&e.jsx(O,{className:"text-right",children:"Client Pay"}),e.jsx(O,{className:"w-[50px]"})]})}),e.jsx(Vn,{children:R?e.jsx(te,{children:e.jsx(P,{colSpan:a?10:8,className:"h-24 text-center",children:e.jsx(fe,{className:"h-6 w-6 animate-spin mx-auto"})})}):S?e.jsx(te,{children:e.jsx(P,{colSpan:a?10:8,className:"h-24 text-center text-red-500",children:"Failed to load records"})}):(g==null?void 0:g.data.length)===0?e.jsx(te,{children:e.jsx(P,{colSpan:a?10:8,className:"h-24 text-center",children:"No records found"})}):g==null?void 0:g.data.map(l=>e.jsx(Ka,{record:l,isAdmin:a,role:s,isSelected:m.has(l.id),onToggleSelect:()=>J(l.id),onEdit:()=>d(l)},l.id))})]})}),B>1&&e.jsx(ht,{children:e.jsxs(xt,{children:[e.jsx(pe,{children:e.jsx(gt,{onClick:()=>n(l=>({...l,page:Math.max(1,l.page-1)})),className:t.page===1?"pointer-events-none opacity-50":"cursor-pointer"})}),e.jsx(pe,{children:e.jsxs("div",{className:"flex items-center justify-center px-4 text-sm font-medium",children:["Page ",t.page," of ",B]})}),e.jsx(pe,{children:e.jsx(jt,{onClick:()=>n(l=>({...l,page:Math.min(B,l.page+1)})),className:t.page===B?"pointer-events-none opacity-50":"cursor-pointer"})})]})})]})})},Ka=({record:t,isAdmin:n,role:s,isSelected:a,onToggleSelect:i,onEdit:o})=>{var p,d,m,w,u;const[c,f]=r.useState(!1),x=Yn(),h=()=>{confirm("Are you sure you want to delete this record?")&&x.mutate(t.id)};return e.jsxs(e.Fragment,{children:[e.jsxs(te,{className:"group",children:[e.jsx(P,{onClick:g=>g.stopPropagation(),children:e.jsx(lt,{checked:a,onCheckedChange:i})}),e.jsx(P,{children:e.jsx(Ns,{open:c,onOpenChange:f,children:e.jsx(Cs,{asChild:!0,children:e.jsxs(k,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",children:[c?e.jsx(us,{className:"h-4 w-4"}):e.jsx(Ae,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Toggle"})]})})})}),e.jsx(P,{className:"font-medium",children:t.date?z(new Date(t.date),"dd MMM yyyy"):"-"}),e.jsx(P,{children:t.fullName}),e.jsx(P,{children:t.clientName}),e.jsx(P,{className:"hidden md:table-cell",children:t.location}),e.jsx(P,{children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm",children:t.shiftName}),e.jsx("span",{className:"text-xs text-muted-foreground",children:t.shiftStart&&t.shiftEnd?`${z(new Date(`1970-01-01T${t.shiftStart}`),"HH:mm")} - ${z(new Date(`1970-01-01T${t.shiftEnd}`),"HH:mm")}`:""})]})}),e.jsx(P,{className:"text-right",children:t.paidHours.toFixed(2)}),n&&e.jsxs(P,{className:"text-right",children:["£",((p=t.totalPay)==null?void 0:p.toFixed(2))||"0.00"]}),n&&e.jsxs(P,{className:"text-right font-medium",children:["£",((d=t.clientNet)==null?void 0:d.toFixed(2))||"0.00"]}),e.jsx(P,{children:(n||s==="manager")&&e.jsxs(Aa,{children:[e.jsx(Oa,{asChild:!0,children:e.jsxs(k,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(hs,{className:"h-4 w-4"})]})}),e.jsxs(xn,{align:"end",children:[e.jsx(gn,{children:"Actions"}),e.jsxs(De,{onClick:g=>{g.stopPropagation(),o()},children:[e.jsx(es,{className:"mr-2 h-4 w-4"})," Edit"]}),e.jsxs(De,{onClick:g=>{g.stopPropagation(),h()},className:"text-red-600",children:[e.jsx(ft,{className:"mr-2 h-4 w-4"})," Delete"]})]})]})})]}),e.jsx(te,{className:c?"":"hidden",children:e.jsx(P,{colSpan:n?10:8,className:"p-0 border-b-0",children:e.jsxs("div",{className:`bg-muted/50 p-4 grid grid-cols-1 ${n?"md:grid-cols-3":"md:grid-cols-2"} gap-4 text-sm shadow-inner`,children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Job Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"Site:"}),e.jsx("span",{children:t.site}),e.jsx("span",{className:"text-muted-foreground",children:"Job Name:"}),e.jsx("span",{children:t.jobName}),e.jsx("span",{className:"text-muted-foreground",children:"Status:"}),e.jsx(Un,{variant:"outline",className:"w-fit",children:t.jobStatus||"N/A"}),e.jsx("span",{className:"text-muted-foreground",children:"Self Employed:"}),e.jsx("span",{children:t.selfEmployed?"Yes":"No"})]})]}),n&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Financial Breakdown"}),e.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"Pay Rate:"}),e.jsxs("span",{children:["£",((m=t.hourRate)==null?void 0:m.toFixed(2))||"0.00","/hr"]}),e.jsx("span",{className:"text-muted-foreground",children:"Charge Rate:"}),e.jsxs("span",{children:["£",((w=t.clientHourlyRate)==null?void 0:w.toFixed(2))||"0.00","/hr"]}),e.jsx("span",{className:"text-muted-foreground",children:"Total Charge:"}),e.jsxs("span",{children:["£",((u=t.totalCharge)==null?void 0:u.toFixed(2))||"0.00"]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Metadata"}),e.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"System ID:"}),e.jsx("span",{className:"font-mono text-xs",children:t.id})]})]})]})})})]})};export{uo as default};
