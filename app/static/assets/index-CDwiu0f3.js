import{ab as F,r as x,j as e,T as te,e as T,B as E,I as Y,k as re,l as se,m as ae,ac as le}from"./index-DbfFdmLM.js";import{D as oe,T as ie}from"./DashboardLayout-BAFyr5zr.js";import{L as ne}from"./label-KOE339St.js";import{T as I}from"./trash-2-Dy5dTjP0.js";import{e as de,C as ce,b as ue}from"./calendar-C6RcvnVO.js";import{f as P,s as fe,P as me,a as be,b as pe}from"./popover-CZNB3bEH.js";import{D as z,a as B,b as J,c as K,d as G,e as V}from"./dialog-CyDagInZ.js";import{P as U}from"./plus-_zHGu6J4.js";import"./users-DjCyNXQz.js";function he(t,s){const n=F(t.start),r=F(t.end);let p=+n>+r;const j=p?+n:+r,d=p?r:n;d.setHours(0,0,0,0),d.setDate(1);let u=1;const g=[];for(;+d<=j;)g.push(F(d)),d.setMonth(d.getMonth()+u);return p?g.reverse():g}function xe(t){const s=F(t),n=s.getFullYear();return s.setFullYear(n+1,0,0),s.setHours(23,59,59,999),s}function ye(t,s){return t===null||t===0?"":s.isPercentage?`${t.toFixed(2)}%`:s.isCurrency?`Â£${t.toLocaleString("en-GB",{minimumFractionDigits:2,maximumFractionDigits:2})}`:t.toLocaleString("en-GB",{maximumFractionDigits:2})}function ge({source:t,formula:s,value:n}){return e.jsxs("div",{className:"text-xs space-y-1",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Source:"})," ",t||"Unknown"]}),s&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Formula:"}),e.jsx("code",{className:"bg-muted px-1 rounded ml-1",children:s})]})]})}function Ce({rowId:t,colId:s,value:n,row:r,isActive:p,source:j,onFocus:d,onUpdate:u,onNavigate:g}){const[A,i]=x.useState(!1),[c,y]=x.useState(""),o=x.useRef(null),C=x.useCallback(()=>{i(!0),y(n!==null?String(n):""),setTimeout(()=>{var w;return(w=o.current)==null?void 0:w.focus()},0)},[n]),_=x.useCallback(()=>{i(!1);const w=parseFloat(c);u(c===""?null:isNaN(w)?n:w)},[c,u,n]),N=x.useCallback(w=>{w.key==="Enter"?_():w.key==="Escape"&&i(!1)},[_]);return x.useEffect(()=>{if(p&&!A){const w=l=>{["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(l.key)?(l.preventDefault(),g({ArrowUp:"up",ArrowDown:"down",ArrowLeft:"left",ArrowRight:"right"}[l.key])):!l.ctrlKey&&!l.altKey&&!l.metaKey&&l.key.length===1?(C(),y("")):l.key==="Enter"?(l.preventDefault(),C()):(l.key==="Backspace"||l.key==="Delete")&&u(null)};return window.addEventListener("keydown",w),()=>window.removeEventListener("keydown",w)}},[p,A,g,C,u]),A?e.jsx("input",{ref:o,type:"text",className:"w-full h-full px-2 py-1 outline-none bg-background text-right font-lato",value:c,onChange:w=>y(w.target.value),onBlur:_,onKeyDown:N}):e.jsxs(re,{children:[e.jsx(se,{asChild:!0,children:e.jsx("div",{className:T("w-full h-full px-2 py-1 cursor-cell flex items-center justify-end font-lato",r.isHeader&&"font-bold"),onClick:d,onDoubleClick:C,children:ye(n,r)})}),j&&e.jsx(ae,{children:e.jsx(ge,{source:j,value:n})})]})}function _e(t){let s="",n=t;for(;n>=0;)s=String.fromCharCode(n%26+65)+s,n=Math.floor(n/26)-1;return s}function je({rows:t,columns:s,data:n,activeCell:r,setActiveCell:p,updateCell:j,deleteRow:d,deleteColumn:u,navigateCell:g,updateRowFormula:A,renameColumn:i}){const[c,y]=x.useState(null);return e.jsxs("div",{className:"flex-1 overflow-auto relative border border-border rounded-md bg-background",children:[e.jsx(te,{children:e.jsxs("table",{className:"w-full border-collapse table-fixed text-sm",children:[e.jsxs("thead",{className:"sticky top-0 z-20 bg-muted/90 backdrop-blur-sm shadow-sm",children:[e.jsxs("tr",{children:[e.jsx("th",{className:"w-12 border-b border-border bg-muted p-1 text-center text-xs text-muted-foreground font-normal select-none relative group",children:e.jsx("div",{className:"absolute inset-0 bg-muted/50"})}),e.jsx("th",{className:"w-64 border-b border-r border-border bg-muted p-2 text-left font-medium text-muted-foreground"}),s.map((o,C)=>e.jsx("th",{className:"border-b border-r border-border bg-muted p-1 text-center text-xs font-normal text-muted-foreground select-none relative min-w-[120px]",children:_e(C)},`excel-${C}`))]}),e.jsxs("tr",{children:[e.jsx("th",{className:"w-12 border-b border-border bg-background p-2"}),e.jsx("th",{className:"w-64 border-b border-r border-border bg-background p-2 text-left font-semibold text-foreground",children:"Metric / Account"}),s.map(o=>e.jsx("th",{className:T("relative border-b border-r border-border bg-background p-2 text-right font-semibold min-w-[120px]",o.isYearEnd?"text-primary/80 bg-primary/5":"text-foreground"),children:e.jsxs("div",{className:"flex items-center justify-end gap-2 group",children:[e.jsx("span",{className:"cursor-pointer hover:text-primary transition-colors py-1",onDoubleClick:()=>!o.isProtected&&y({id:o.id,type:"col",value:o.label}),children:o.label}),!o.isProtected&&e.jsx(E,{variant:"ghost",size:"icon",className:"h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity absolute top-1 right-1",onClick:()=>u(o.id),children:e.jsx(I,{className:"h-3 w-3 text-destructive"})})]})},o.id))]})]}),e.jsx("tbody",{children:t.map((o,C)=>e.jsxs("tr",{className:"group/row hover:bg-muted/30 transition-colors",children:[e.jsx("td",{className:"border-r border-b border-border bg-muted/30 p-2 text-center text-xs text-muted-foreground font-mono select-none sticky left-0 z-10 w-12 text-lato",children:C+1}),e.jsx("td",{className:"border-r border-b border-border p-2 font-medium bg-background relative w-64",children:e.jsxs("div",{className:"flex items-center justify-between group",children:[o.isHeader?e.jsx("span",{className:"font-bold text-primary",children:o.label}):e.jsx("span",{className:"cursor-pointer hover:text-primary transition-colors w-full",onDoubleClick:()=>!o.isAutoCalculated&&y({id:o.id,type:"row",value:o.label}),children:o.label}),!o.isAutoCalculated&&e.jsx(E,{variant:"ghost",size:"icon",className:"h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity absolute right-2",onClick:()=>d(o.id),children:e.jsx(I,{className:"h-3 w-3 text-destructive"})})]})}),s.map(_=>{var a;const N=(a=n[o.id])==null?void 0:a[_.id],w=(N==null?void 0:N.value)??null,l=(r==null?void 0:r.row)===o.id&&(r==null?void 0:r.col)===_.id;return e.jsx("td",{className:T("border-r border-b border-border p-0 relative min-w-[120px]",l?"ring-2 ring-primary z-10":"",o.isHeader?"bg-muted/20 font-semibold":"",_.isYearEnd?"bg-primary/5 font-semibold":""),onClick:()=>p({row:o.id,col:_.id}),children:e.jsx(Ce,{rowId:o.id,colId:_.id,value:w,row:o,isActive:l,onFocus:()=>p({row:o.id,col:_.id}),onUpdate:b=>j(o.id,_.id,b),onNavigate:g})},`${o.id}-${_.id}`)})]},o.id))})]})}),c&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-background/80 backdrop-blur-sm",onClick:()=>y(null),children:e.jsxs("div",{className:"bg-card p-4 rounded-lg shadow-lg border w-96",onClick:o=>o.stopPropagation(),children:[e.jsxs(ne,{children:["Edit ",c.type==="row"?"Row":"Column"," Label"]}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx(Y,{autoFocus:!0,value:c.value,onChange:o=>y({...c,value:o.target.value}),onKeyDown:o=>{o.key==="Enter"&&(c.type==="col"&&i&&i(c.id,c.value),y(null))}}),e.jsx(E,{onClick:()=>y(null),children:"Done"})]})]})})]})}const L=t=>{if(!(t!=null&&t.from)||!(t!=null&&t.to))return new Date().getFullYear(),[{id:"jan",label:"January",isProtected:!0},{id:"feb",label:"February",isProtected:!0},{id:"mar",label:"March",isProtected:!0},{id:"apr",label:"April",isProtected:!0},{id:"may",label:"May",isProtected:!0},{id:"jun",label:"June",isProtected:!0},{id:"jul",label:"July",isProtected:!0},{id:"aug",label:"August",isProtected:!0},{id:"sep",label:"September",isProtected:!0},{id:"oct",label:"October",isProtected:!0},{id:"nov",label:"November",isProtected:!0},{id:"dec",label:"December",isProtected:!0},{id:"year_end",label:"Year End",isProtected:!0,isYearEnd:!0}];const n=he({start:le(t.from),end:de(t.to)}).map(r=>({id:P(r,"MMM-yyyy").toLowerCase(),label:P(r,"MMM yyyy"),isProtected:!0}));return n.push({id:"year_end",label:"Period Total",isProtected:!0,isYearEnd:!0}),n},R=(t,s,n)=>{var r,p;try{const j=Object.keys(s).sort((g,A)=>A.length-g.length);let d=t;for(const g of j){const A=new RegExp(`\\b${g}\\b`,"g");if(A.test(d)){const i=((p=(r=s[g])==null?void 0:r[n])==null?void 0:p.value)??0;d=d.replace(A,`(${i})`)}}if(!/^[0-9+\-*/().\s]*$/.test(d))return null;const u=new Function(`return ${d}`)();return typeof u=="number"&&!isNaN(u)&&isFinite(u)?u:null}catch{return null}},O=[{id:"total_sales",label:"Total Sales",isAutoCalculated:!1,isCurrency:!0},{id:"sales_split_pct",label:"% Sales Split for the Year",isAutoCalculated:!1,isPercentage:!0},{id:"cost_sales_se",label:"Cost of Sales SE",isAutoCalculated:!1,isCurrency:!0},{id:"cost_sales_paye",label:"Cost of Sales PAYE Gross",isAutoCalculated:!1,isCurrency:!0},{id:"employee_ni",label:"Employee NI",isAutoCalculated:!1,isCurrency:!0},{id:"employee_pension",label:"Employee Pension",isAutoCalculated:!1,isCurrency:!0},{id:"total_cost_sales",label:"Total Cost of Sales",isAutoCalculated:!0,isCurrency:!0,isHeader:!0,formulaString:"cost_sales_se + cost_sales_paye + employee_ni + employee_pension"},{id:"apprenticeship_levy",label:"Apprenticeship Levy",isAutoCalculated:!1,isCurrency:!0},{id:"annual_leave",label:"Annual Leave Accrual",isAutoCalculated:!1,isCurrency:!0},{id:"other_expenses",label:"Other Expenses",isAutoCalculated:!1,isCurrency:!0},{id:"recruitment_cost",label:"Recruitment & Pass Cost",isAutoCalculated:!1,isCurrency:!0},{id:"overheads_mgmt",label:"Mgmt & Office Cost",isAutoCalculated:!1,isCurrency:!0},{id:"bank_interest",label:"Bank Interest",isAutoCalculated:!1,isCurrency:!0},{id:"cooperation_tax",label:"Cooperation Tax",isAutoCalculated:!1,isCurrency:!0},{id:"total_overheads",label:"Total Overheads",isAutoCalculated:!0,isCurrency:!0,isHeader:!0,formulaString:"apprenticeship_levy + annual_leave + other_expenses + recruitment_cost + overheads_mgmt + bank_interest + cooperation_tax"},{id:"total_cost",label:"Total Cost",isAutoCalculated:!0,isCurrency:!0,isHeader:!0,formulaString:"total_cost_sales + total_overheads"},{id:"avg_hourly_charge",label:"Avg Hourly Charge",isAutoCalculated:!1,isCurrency:!0},{id:"gross_hourly_pay",label:"Gross Hourly Pay",isAutoCalculated:!1,isCurrency:!0},{id:"gross_hourly_margin",label:"Gross Hourly Margin",isAutoCalculated:!0,isCurrency:!0,formulaString:"avg_hourly_charge - gross_hourly_pay"},{id:"net_cost_per_hour",label:"Net Cost per Hour",isAutoCalculated:!1,isCurrency:!0},{id:"gross_pl_value",label:"Gross P&L",isAutoCalculated:!1,isCurrency:!0},{id:"net_pl",label:"Net P&L",isAutoCalculated:!1,isCurrency:!0},{id:"total_net_margin",label:"Total Net Margin",isAutoCalculated:!1,isPercentage:!0},{id:"worked_hours",label:"Worked Hours",isAutoCalculated:!1},{id:"hours_breakeven",label:"Hours for Breakeven",isAutoCalculated:!0,formula:(t,s,n)=>{var j,d,u,g;const r=((d=(j=t.total_cost)==null?void 0:j[n])==null?void 0:d.value)??0,p=((g=(u=t.gross_hourly_margin)==null?void 0:u[n])==null?void 0:g.value)??0;return p!==0?r/p:0}},{id:"value_breakeven",label:"Total Value for Breakeven",isAutoCalculated:!0,isCurrency:!0,formulaString:"hours_breakeven * avg_hourly_charge"},{id:"sales_budget_2026",label:"Projeted Sales Budget 30% Uplift",isAutoCalculated:!0,isCurrency:!0,formulaString:"total_sales * 1.3"},{id:"avg_hourly_charge_2026",label:"Average Hourly Charge Rate Future",isAutoCalculated:!1,isCurrency:!0},{id:"sales_target_hours",label:"Sales Target in Hours",isAutoCalculated:!1},{id:"variance_2025",label:"Variance",isAutoCalculated:!1,isCurrency:!0}];function W(t,s){const n={};for(const r of t){n[r.id]={};for(const p of s)n[r.id][p.id]={value:null,isEditable:!r.isAutoCalculated&&!p.isYearEnd,source:"manual"}}return n}function S(t,s,n){var g,A;const r=JSON.parse(JSON.stringify(t));for(const i of n.filter(c=>!c.isYearEnd))for(const c of s)c.formulaString?r[c.id][i.id]={...r[c.id][i.id],value:R(c.formulaString,r,i.id),isEditable:!1,source:"calculated"}:c.formula&&(r[c.id][i.id]={...r[c.id][i.id],value:c.formula(r,c.id,i.id),isEditable:!1,source:"calculated"});const p=s.find(i=>i.id==="total_sales"),j=s.find(i=>i.id==="sales_split_pct"),d=n.find(i=>i.isYearEnd);if(p&&j&&d){let i=0;const c=n.filter(y=>!y.isYearEnd);i=c.reduce((y,o)=>{var C,_;return y+(((_=(C=r.total_sales)==null?void 0:C[o.id])==null?void 0:_.value)??0)},0);for(const y of c){const o=((A=(g=r.total_sales)==null?void 0:g[y.id])==null?void 0:A.value)??0,C=i!==0?o/i*100:0;r.sales_split_pct[y.id]={value:C,isEditable:!1,source:"calculated"}}r.sales_split_pct[d.id]={value:i!==0?100:0,isEditable:!1,source:"calculated"}}const u=n.find(i=>i.isYearEnd);if(u)for(const i of s){if(i.id==="sales_split_pct")continue;const c=n.filter(y=>!y.isYearEnd).reduce((y,o)=>{var C,_;return y+(((_=(C=r[i.id])==null?void 0:C[o.id])==null?void 0:_.value)??0)},0);i.formulaString||i.isAutoCalculated?i.formulaString?r[i.id][u.id]={value:R(i.formulaString,r,u.id),isEditable:!1,source:"calculated"}:i.formula?r[i.id][u.id]={value:i.formula(r,i.id,u.id),isEditable:!1,source:"calculated"}:r[i.id][u.id]={value:c,isEditable:!1,source:"calculated"}:r[i.id][u.id]={value:c,isEditable:!1,source:"calculated"}}return r}function we(t){const[s,n]=x.useState(O),[r,p]=x.useState(()=>L(t)),[j,d]=x.useState(()=>S(W(O,L(t)),O,L(t))),[u,g]=x.useState(null);x.useEffect(()=>{const l=L(t);p(l);let a=W(s,l);t!=null&&t.from&&(t!=null&&t.to)?(async()=>{try{const m=P(t.from,"yyyy-MM-dd"),f=P(t.to,"yyyy-MM-dd"),k=localStorage.getItem("auth_token"),h=await fetch(`/api/financial-summary/metrics?start=${m}&end=${f}`,{headers:{Authorization:`Bearer ${k}`},credentials:"include"});if(h.status===401){console.error("Unauthorized: Redirecting to login"),window.location.href="/auth";return}if(h.ok){const v=h.headers.get("content-type");if(v&&v.indexOf("application/json")!==-1){const M=await h.json(),q={January:"jan",February:"feb",March:"mar",April:"apr",May:"may",June:"jun",July:"jul",August:"aug",September:"sep",October:"oct",November:"nov",December:"dec"};for(const[Q,$]of Object.entries(M)){const[X,Z]=Q.split("-"),H=q[Z];if(!H)continue;const D=`${H}-${X}`;l.find(ee=>ee.id===D)&&(a.total_sales&&a.total_sales[D]&&(a.total_sales[D].value=$.total_sales,a.total_sales[D].source="backend"),a.cost_sales_paye&&a.cost_sales_paye[D]&&(a.cost_sales_paye[D].value=$.cost_sales_paye,a.cost_sales_paye[D].source="backend"))}d(S(a,s,l))}else console.error("Received non-JSON response from API"),d(S(a,s,l))}else console.error("API Error",h.status,h.statusText),d(S(a,s,l))}catch(m){console.error("Failed to fetch metrics",m),d(S(a,s,l))}})():d(S(a,s,l))},[t]);const A=x.useCallback((l,a,b)=>{d(m=>{const f={...m};return f[l]={...f[l]},f[l][a]={...f[l][a],value:b,source:"manual"},S(f,s,r)})},[s,r]),i=x.useCallback((l,a)=>{n(b=>{const m=b.map(f=>f.id===l?{...f,formulaString:a}:f);return d(f=>S(f,m,r)),m})},[r]),c=x.useCallback(l=>{const a=`custom_${Date.now()}`,b={id:a,label:l,isAutoCalculated:!1,isCurrency:!0};n(m=>{const f=[...m,b];return d(k=>{const h={...k};h[a]={};for(const v of r)h[a][v.id]={value:null,isEditable:!v.isYearEnd,source:"manual"};return S(h,f,r)}),f})},[r]),y=x.useCallback(l=>{n(a=>a.filter(b=>b.id!==l)),d(a=>{const b={...a};return delete b[l],b})},[]),o=x.useCallback(l=>{const a=`col_${Date.now()}`,b={id:a,label:l};p(m=>{const f=m.findIndex(h=>h.isYearEnd),k=[...m];return k.splice(f,0,b),d(h=>{const v={...h};for(const M of s)v[M.id]={...v[M.id]},v[M.id][a]={value:null,isEditable:!M.isAutoCalculated,source:"manual"};return S(v,s,k)}),k})},[s]),C=x.useCallback(l=>{p(a=>{const b=a.filter(m=>m.id!==l);return d(m=>{const f={...m};for(const k of Object.keys(f)){const{[l]:h,...v}=f[k];f[k]=v}return S(f,s,b)}),b})},[s]),_=x.useCallback((l,a)=>{p(b=>b.map(m=>m.id===l?{...m,label:a}:m))},[]),N=x.useCallback(l=>{if(!u)return;const a=s.filter(v=>!v.isAutoCalculated),b=r.filter(v=>!v.isYearEnd),m=a.findIndex(v=>v.id===u.row),f=b.findIndex(v=>v.id===u.col);if(m===-1||f===-1)return;let k=m,h=f;switch(l){case"up":k=Math.max(0,m-1);break;case"down":k=Math.min(a.length-1,m+1);break;case"left":h=Math.max(0,f-1);break;case"right":h=Math.min(b.length-1,f+1);break}g({row:a[k].id,col:b[h].id})},[u,s,r]),w=x.useCallback(async l=>{if(l)try{const a={year:new Date().getFullYear(),data:j,rows:s,columns:r},b=localStorage.getItem("auth_token");if(!(await fetch("/api/financial-summary/save",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${b}`},body:JSON.stringify(a)})).ok)throw new Error("Failed to save")}catch(a){throw console.error("Save failed",a),a}},[j,s,r]);return{rows:s,columns:r,data:j,activeCell:u,setActiveCell:g,updateCell:A,addRow:c,deleteRow:y,addColumn:o,deleteColumn:C,renameColumn:_,navigateCell:N,saveData:w,updateRowFormula:i}}function Le(){const[t,s]=x.useState({from:fe(new Date),to:xe(new Date)}),{rows:n,columns:r,data:p,activeCell:j,setActiveCell:d,updateCell:u,addRow:g,deleteRow:A,addColumn:i,deleteColumn:c,navigateCell:y,updateRowFormula:o}=we(t),[C,_]=x.useState(""),[N,w]=x.useState(""),[l,a]=x.useState(!1),[b,m]=x.useState(!1),f=()=>{C.trim()&&(g(C.trim()),_(""),a(!1))},k=()=>{N.trim()&&(i(N.trim()),w(""),m(!1))};return e.jsx(oe,{noPadding:!0,fullWidth:!0,children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-border bg-card/50 shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx(ie,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-foreground",children:"Financial Summary."}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Annual budget and performance spreadsheet"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(me,{children:[e.jsx(be,{asChild:!0,children:e.jsxs(E,{id:"date",variant:"outline",className:T("w-[260px] justify-start text-left font-normal",!t&&"text-muted-foreground"),children:[e.jsx(ce,{className:"mr-2 h-4 w-4"}),t!=null&&t.from?t.to?e.jsxs(e.Fragment,{children:[P(t.from,"LLL dd, y")," -"," ",P(t.to,"LLL dd, y")]}):P(t.from,"LLL dd, y"):e.jsx("span",{children:"Pick a date"})]})}),e.jsx(pe,{className:"w-auto p-0",align:"end",children:e.jsx(ue,{initialFocus:!0,mode:"range",defaultMonth:t==null?void 0:t.from,selected:t,onSelect:s,numberOfMonths:2,captionLayout:"dropdown-buttons",fromYear:2020,toYear:2030})})]}),e.jsxs(z,{open:l,onOpenChange:a,children:[e.jsx(B,{asChild:!0,children:e.jsxs(E,{variant:"outline",size:"sm",children:[e.jsx(U,{className:"h-4 w-4 mr-1"})," Add Row"]})}),e.jsxs(J,{children:[e.jsx(K,{children:e.jsx(G,{children:"Add New Row"})}),e.jsx(Y,{placeholder:"Row label...",value:C,onChange:h=>_(h.target.value),onKeyDown:h=>h.key==="Enter"&&f()}),e.jsx(V,{children:e.jsx(E,{onClick:f,disabled:!C.trim(),children:"Add"})})]})]}),e.jsxs(z,{open:b,onOpenChange:m,children:[e.jsx(B,{asChild:!0,children:e.jsxs(E,{variant:"outline",size:"sm",children:[e.jsx(U,{className:"h-4 w-4 mr-1"})," Add Column"]})}),e.jsxs(J,{children:[e.jsx(K,{children:e.jsx(G,{children:"Add New Column"})}),e.jsx(Y,{placeholder:"Column label...",value:N,onChange:h=>w(h.target.value),onKeyDown:h=>h.key==="Enter"&&k()}),e.jsx(V,{children:e.jsx(E,{onClick:k,disabled:!N.trim(),children:"Add"})})]})]})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:e.jsx(je,{rows:n,columns:r,data:p,activeCell:j,setActiveCell:d,updateCell:u,deleteRow:A,deleteColumn:c,navigateCell:y,updateRowFormula:o})})]})})}export{Le as default};
