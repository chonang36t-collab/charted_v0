import{c as Te,r as i,j as e,d as S,y as hn,g as Ae,m as st,z as Ie,P as $,i as w,k as se,h as J,C as xn,B as U,b as at,L as Pe,I as k,D as le,E as gn,F as ot,G as jn,H as vn,J as bn,K as wn,M as Nn,N as Cn,O as rt,Q as yn,U as it,V as Mn,W as Sn,Y as Rn,Z as _n,$ as In,a0 as Pn}from"./index-B2wxE_Dd.js";import{a as En,b as Oe,D as Dn}from"./DashboardLayout-BkHDIkQ9.js";import{T as Tn,a as An,b as X,c as O,d as On,e as P}from"./table-DrLqigzo.js";import{B as kn}from"./badge-qm2RVjzI.js";import{u as Fn,a as Ln,b as Gn,c as ct,R as $n,I as Kn,d as Vn,e as Un}from"./index-Dh76PAe9.js";import{d as Hn,D as Xe,a as Je,b as Ze,c as Qe}from"./dialog-Dh4N6b0I.js";import{o as Bn,s as Y,c as G,b as et,u as zn,t as qn,C as we,P as Wn,T as Yn}from"./types-BXAkA8PV.js";import{L as R}from"./label-DS_sKOtC.js";import{S as Ne,a as Ce,b as ye,c as Me,d as Q}from"./select-DSIXMPLM.js";import{C as Xn,a as Jn,b as Zn,f as Qn,c as es,d as ts,e as ns,S as ss}from"./command-DMb1SibL.js";import{P as as,a as os,b as rs,f as Se}from"./popover-Cbhn3GHF.js";import{C as lt,a as is}from"./index-ZIh-836K.js";import{E as cs}from"./ellipsis-Dw6AlHGd.js";import"./users-C1K4zxjf.js";import"./useQuery-DD9OD5YM.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=Te("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ls=Te("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ds=Te("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),dt=({className:t,...n})=>e.jsx("nav",{role:"navigation","aria-label":"pagination",className:S("mx-auto flex w-full justify-center",t),...n});dt.displayName="Pagination";const ut=i.forwardRef(({className:t,...n},s)=>e.jsx("ul",{ref:s,className:S("flex flex-row items-center gap-1",t),...n}));ut.displayName="PaginationContent";const de=i.forwardRef(({className:t,...n},s)=>e.jsx("li",{ref:s,className:S("",t),...n}));de.displayName="PaginationItem";const ke=({className:t,isActive:n,size:s="icon",...a})=>e.jsx("a",{"aria-current":n?"page":void 0,className:S(hn({variant:n?"outline":"ghost",size:s}),t),...a});ke.displayName="PaginationLink";const mt=({className:t,...n})=>e.jsxs(ke,{"aria-label":"Go to previous page",size:"default",className:S("gap-1 pl-2.5",t),...n,children:[e.jsx(En,{className:"h-4 w-4"}),e.jsx("span",{children:"Previous"})]});mt.displayName="PaginationPrevious";const pt=({className:t,...n})=>e.jsxs(ke,{"aria-label":"Go to next page",size:"default",className:S("gap-1 pr-2.5",t),...n,children:[e.jsx("span",{children:"Next"}),e.jsx(Oe,{className:"h-4 w-4"})]});pt.displayName="PaginationNext";var pe="Collapsible",[us,Ja]=Ae(pe),[ms,Fe]=us(pe),ft=i.forwardRef((t,n)=>{const{__scopeCollapsible:s,open:a,defaultOpen:r,disabled:o,onOpenChange:u,...p}=t,[x,f]=st({prop:a,defaultProp:r??!1,onChange:u,caller:pe});return e.jsx(ms,{scope:s,disabled:o,contentId:Ie(),open:x,onOpenToggle:i.useCallback(()=>f(d=>!d),[f]),children:e.jsx($.div,{"data-state":Ge(x),"data-disabled":o?"":void 0,...p,ref:n})})});ft.displayName=pe;var ht="CollapsibleTrigger",xt=i.forwardRef((t,n)=>{const{__scopeCollapsible:s,...a}=t,r=Fe(ht,s);return e.jsx($.button,{type:"button","aria-controls":r.contentId,"aria-expanded":r.open||!1,"data-state":Ge(r.open),"data-disabled":r.disabled?"":void 0,disabled:r.disabled,...a,ref:n,onClick:w(t.onClick,r.onOpenToggle)})});xt.displayName=ht;var Le="CollapsibleContent",ps=i.forwardRef((t,n)=>{const{forceMount:s,...a}=t,r=Fe(Le,t.__scopeCollapsible);return e.jsx(se,{present:s||r.open,children:({present:o})=>e.jsx(fs,{...a,ref:n,present:o})})});ps.displayName=Le;var fs=i.forwardRef((t,n)=>{const{__scopeCollapsible:s,present:a,children:r,...o}=t,u=Fe(Le,s),[p,x]=i.useState(a),f=i.useRef(null),d=J(n,f),c=i.useRef(0),h=c.current,j=i.useRef(0),l=j.current,C=u.open||p,v=i.useRef(C),N=i.useRef(void 0);return i.useEffect(()=>{const y=requestAnimationFrame(()=>v.current=!1);return()=>cancelAnimationFrame(y)},[]),xn(()=>{const y=f.current;if(y){N.current=N.current||{transitionDuration:y.style.transitionDuration,animationName:y.style.animationName},y.style.transitionDuration="0s",y.style.animationName="none";const F=y.getBoundingClientRect();c.current=F.height,j.current=F.width,v.current||(y.style.transitionDuration=N.current.transitionDuration,y.style.animationName=N.current.animationName),x(a)}},[u.open,a]),e.jsx($.div,{"data-state":Ge(u.open),"data-disabled":u.disabled?"":void 0,id:u.contentId,hidden:!C,...o,ref:d,style:{"--radix-collapsible-content-height":h?`${h}px`:void 0,"--radix-collapsible-content-width":l?`${l}px`:void 0,...t.style},children:C&&r})});function Ge(t){return t?"open":"closed"}var hs=ft;const xs=hs,gs=xt;function _e({options:t,value:n,onChange:s,placeholder:a="Select...",searchPlaceholder:r="Search...",emptyMessage:o="No results found.",className:u,disabled:p=!1}){var d;const[x,f]=i.useState(!1);return e.jsxs(as,{open:x,onOpenChange:f,children:[e.jsx(os,{asChild:!0,children:e.jsxs(U,{variant:"outline",role:"combobox","aria-expanded":x,className:S("w-full justify-between",u),disabled:p,children:[n?(d=t.find(c=>c.value===n))==null?void 0:d.label:a,e.jsx(Xn,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(rs,{className:"w-[--radix-popover-trigger-width] p-0",align:"start",children:e.jsxs(Jn,{children:[e.jsx(Zn,{placeholder:r}),e.jsxs(Qn,{children:[e.jsx(es,{children:o}),e.jsx(ts,{children:t.map(c=>e.jsxs(ns,{value:c.label,onSelect:h=>{s(c.value===n?"":c.value),f(!1)},children:[e.jsx(lt,{className:S("mr-2 h-4 w-4",n===c.value?"opacity-100":"opacity-0")}),c.label]},c.value))})]})]})})]})}const js=Bn({date:Y().min(1,"Date is required"),employeeId:G.number().min(1,"Employee is required"),clientId:G.number().min(1,"Client is required"),jobId:G.number().min(1,"Job is required"),shiftId:G.number().min(1,"Shift is required"),startTime:Y().min(1,"Start time is required"),endTime:Y().min(1,"End time is required"),hours:G.number().min(.1,"Hours must be greater than 0"),hourRate:G.number().optional(),clientHourlyRate:G.number().optional(),job_name:Y().optional(),role:Y().optional(),jobStatus:Y().optional(),additions:G.number().optional(),deductions:G.number().optional(),self_employed:et().optional(),dns:et().optional()}),tt=({record:t,onSuccess:n,onCancel:s})=>{const{role:a}=at(),r=a==="admin",{data:o,isLoading:u}=Fn(),p=Ln(),x=Gn(),[f,d]=i.useState(""),[c,h]=i.useState(""),j=!!t,l=zn({resolver:qn(js),defaultValues:{date:(t==null?void 0:t.date)||new Date().toISOString().split("T")[0],employeeId:void 0,clientId:void 0,jobId:void 0,shiftId:void 0,startTime:t!=null&&t.shiftStart?t.shiftStart.substring(0,5):"09:00",endTime:t!=null&&t.shiftEnd?t.shiftEnd.substring(0,5):"17:00",hours:(t==null?void 0:t.paidHours)||8,hourRate:(t==null?void 0:t.hourRate)||0,clientHourlyRate:(t==null?void 0:t.clientHourlyRate)||0,job_name:(t==null?void 0:t.jobName)||"",role:"Travel Retail Specialist",jobStatus:(t==null?void 0:t.jobStatus)||"Currently Working - Full Airside Pass",additions:0,deductions:0,self_employed:!1,dns:!1}}),C=l.watch("startTime"),v=l.watch("endTime"),N=l.watch("shiftId"),y=i.useMemo(()=>o!=null&&o.jobs?Array.from(new Set(o.jobs.map(m=>m.location).filter(Boolean))):[],[o]),F=i.useMemo(()=>!(o!=null&&o.jobs)||!f?[]:Array.from(new Set(o.jobs.filter(m=>m.location===f).map(m=>m.site).filter(Boolean))),[o,f]);i.useEffect(()=>{if(t&&o){const m=o.employees.find(M=>M.name===t.fullName);m&&l.setValue("employeeId",m.id);const b=o.clients.find(M=>M.name===t.clientName);b&&l.setValue("clientId",b.id);const I=o.shifts.find(M=>M.name===t.shiftName);I&&l.setValue("shiftId",I.id);let E=o.jobs.find(M=>M.name===t.jobName&&M.site===t.site);E||(E=o.jobs.find(M=>M.site===t.site&&M.location===t.location)),E&&(l.setValue("jobId",E.id),d(E.location),h(E.site))}},[t,o,l]),i.useEffect(()=>{if(C&&v){const[m,b]=C.split(":").map(Number),[I,E]=v.split(":").map(Number);let M=m*60+b,V=I*60+E;V<M&&(V+=24*60);const je=(V-M)/60;l.setValue("hours",parseFloat(je.toFixed(2)))}},[C,v,l]),i.useEffect(()=>{var m;if(!j&&N&&(o!=null&&o.shifts)){const b=(m=o.shifts.find(I=>I.id===N))==null?void 0:m.name;b&&l.setValue("job_name",b)}},[N,j,o,l]),i.useEffect(()=>{if(f&&c&&(o!=null&&o.jobs)){const m=o.jobs.find(b=>b.location===f&&b.site===c);m&&l.setValue("jobId",m.id)}},[f,c,o,l]);const re=m=>{j&&t?x.mutate({id:t.id,...m},{onSuccess:()=>{le.success("Record updated successfully"),n()},onError:b=>{le.error(`Failed to update record: ${b.message}`)}}):p.mutate(m,{onSuccess:()=>{le.success("Record created successfully"),n()},onError:b=>{le.error(`Failed to create record: ${b.message}`)}})},ie=p.isPending||x.isPending;if(u)return e.jsx("div",{className:"flex justify-center p-4",children:e.jsx(Pe,{className:"animate-spin"})});const ce=(o==null?void 0:o.employees.map(m=>({value:m.id.toString(),label:m.name})))||[],z=(o==null?void 0:o.clients.map(m=>({value:m.id.toString(),label:m.name})))||[],ge=(o==null?void 0:o.shifts.map(m=>({value:m.id.toString(),label:`${m.name} (${m.start.substring(0,5)}-${m.end.substring(0,5)})`})))||[];return e.jsxs("form",{onSubmit:l.handleSubmit(re),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"date",children:"Date"}),e.jsx(k,{id:"date",type:"date",...l.register("date")}),l.formState.errors.date&&e.jsx("span",{className:"text-red-500 text-xs",children:l.formState.errors.date.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"startTime",children:"Start Time"}),e.jsx(k,{id:"startTime",type:"time",...l.register("startTime")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"endTime",children:"End Time"}),e.jsx(k,{id:"endTime",type:"time",...l.register("endTime")})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(R,{children:["Calculated Hours: ",l.watch("hours")]}),e.jsx(k,{type:"hidden",...l.register("hours")})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:"Employee"}),e.jsx(we,{control:l.control,name:"employeeId",render:({field:m})=>{var b;return e.jsx(_e,{options:ce,value:(b=m.value)==null?void 0:b.toString(),onChange:I=>m.onChange(Number(I)),placeholder:"Select Employee...",searchPlaceholder:"Search employees..."})}}),l.formState.errors.employeeId&&e.jsx("span",{className:"text-red-500 text-xs",children:l.formState.errors.employeeId.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:"Client"}),e.jsx(we,{control:l.control,name:"clientId",render:({field:m})=>{var b;return e.jsx(_e,{options:z,value:(b=m.value)==null?void 0:b.toString(),onChange:I=>m.onChange(Number(I)),placeholder:"Select Client...",searchPlaceholder:"Search clients..."})}}),l.formState.errors.clientId&&e.jsx("span",{className:"text-red-500 text-xs",children:l.formState.errors.clientId.message})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:"Location"}),e.jsxs(Ne,{value:f,onValueChange:m=>{d(m),h("")},children:[e.jsx(Ce,{children:e.jsx(ye,{placeholder:"Select Location"})}),e.jsx(Me,{children:y.map(m=>e.jsx(Q,{value:m,children:m},m))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:"Site / Terminal"}),e.jsxs(Ne,{value:c,onValueChange:h,disabled:!f,children:[e.jsx(Ce,{children:e.jsx(ye,{placeholder:"Select Site"})}),e.jsx(Me,{children:F.map(m=>e.jsx(Q,{value:m,children:m},m))})]}),e.jsx("input",{type:"hidden",...l.register("jobId")}),l.formState.errors.jobId&&e.jsx("span",{className:"text-red-500 text-xs",children:"Job Selection Incomplete"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:"Shift"}),e.jsx(we,{control:l.control,name:"shiftId",render:({field:m})=>{var b;return e.jsx(_e,{options:ge,value:(b=m.value)==null?void 0:b.toString(),onChange:I=>m.onChange(Number(I)),placeholder:"Select Shift config...",searchPlaceholder:"Search shifts..."})}}),l.formState.errors.shiftId&&e.jsx("span",{className:"text-red-500 text-xs",children:l.formState.errors.shiftId.message})]}),(r||j)&&e.jsxs("div",{className:"border-t pt-4 grid grid-cols-2 gap-4 bg-muted/20 p-4 rounded-md",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:"Role"}),e.jsx(k,{...l.register("role")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:"Status"}),e.jsxs(Ne,{onValueChange:m=>l.setValue("jobStatus",m),defaultValue:l.getValues("jobStatus"),children:[e.jsx(Ce,{children:e.jsx(ye,{placeholder:"Status"})}),e.jsxs(Me,{children:[e.jsx(Q,{value:"Currently Working - Full Airside Pass",children:"Currently Working - Full Airside Pass"}),e.jsx(Q,{value:"Completed",children:"Completed"}),e.jsx(Q,{value:"Cancelled",children:"Cancelled"})]})]})]}),r&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"hourRate",children:"Pay Rate (£)"}),e.jsx(k,{id:"hourRate",type:"number",step:"0.01",...l.register("hourRate")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"clientHourlyRate",children:"Client Rate (£)"}),e.jsx(k,{id:"clientHourlyRate",type:"number",step:"0.01",...l.register("clientHourlyRate")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"additions",children:"Additions (£)"}),e.jsx(k,{id:"additions",type:"number",step:"0.01",...l.register("additions")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"deductions",children:"Deductions (£)"}),e.jsx(k,{id:"deductions",type:"number",step:"0.01",...l.register("deductions")})]})]})]}),e.jsxs(Hn,{className:"mt-6 flex justify-between items-center w-full",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:!j&&"Defaults: Role=Travel Retail, Additions=0, Deductions=0"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(U,{type:"button",variant:"outline",onClick:s,children:"Cancel"}),e.jsxs(U,{type:"submit",disabled:ie,children:[ie&&e.jsx(Pe,{className:"mr-2 h-4 w-4 animate-spin"}),j?"Update Record":"Create Record"]})]})]})]})};var Ee=["Enter"," "],vs=["ArrowDown","PageUp","Home"],gt=["ArrowUp","PageDown","End"],bs=[...vs,...gt],ws={ltr:[...Ee,"ArrowRight"],rtl:[...Ee,"ArrowLeft"]},Ns={ltr:["ArrowLeft"],rtl:["ArrowRight"]},ae="Menu",[te,Cs,ys]=gn(ae),[H,jt]=Ae(ae,[ys,ot,ct]),fe=ot(),vt=ct(),[Ms,B]=H(ae),[Ss,oe]=H(ae),bt=t=>{const{__scopeMenu:n,open:s=!1,children:a,dir:r,onOpenChange:o,modal:u=!0}=t,p=fe(n),[x,f]=i.useState(null),d=i.useRef(!1),c=rt(o),h=Rn(r);return i.useEffect(()=>{const j=()=>{d.current=!0,document.addEventListener("pointerdown",l,{capture:!0,once:!0}),document.addEventListener("pointermove",l,{capture:!0,once:!0})},l=()=>d.current=!1;return document.addEventListener("keydown",j,{capture:!0}),()=>{document.removeEventListener("keydown",j,{capture:!0}),document.removeEventListener("pointerdown",l,{capture:!0}),document.removeEventListener("pointermove",l,{capture:!0})}},[]),e.jsx(_n,{...p,children:e.jsx(Ms,{scope:n,open:s,onOpenChange:c,content:x,onContentChange:f,children:e.jsx(Ss,{scope:n,onClose:i.useCallback(()=>c(!1),[c]),isUsingKeyboardRef:d,dir:h,modal:u,children:a})})})};bt.displayName=ae;var Rs="MenuAnchor",$e=i.forwardRef((t,n)=>{const{__scopeMenu:s,...a}=t,r=fe(s);return e.jsx(jn,{...r,...a,ref:n})});$e.displayName=Rs;var Ke="MenuPortal",[_s,wt]=H(Ke,{forceMount:void 0}),Nt=t=>{const{__scopeMenu:n,forceMount:s,children:a,container:r}=t,o=B(Ke,n);return e.jsx(_s,{scope:n,forceMount:s,children:e.jsx(se,{present:s||o.open,children:e.jsx(In,{asChild:!0,container:r,children:a})})})};Nt.displayName=Ke;var T="MenuContent",[Is,Ve]=H(T),Ct=i.forwardRef((t,n)=>{const s=wt(T,t.__scopeMenu),{forceMount:a=s.forceMount,...r}=t,o=B(T,t.__scopeMenu),u=oe(T,t.__scopeMenu);return e.jsx(te.Provider,{scope:t.__scopeMenu,children:e.jsx(se,{present:a||o.open,children:e.jsx(te.Slot,{scope:t.__scopeMenu,children:u.modal?e.jsx(Ps,{...r,ref:n}):e.jsx(Es,{...r,ref:n})})})})}),Ps=i.forwardRef((t,n)=>{const s=B(T,t.__scopeMenu),a=i.useRef(null),r=J(n,a);return i.useEffect(()=>{const o=a.current;if(o)return vn(o)},[]),e.jsx(Ue,{...t,ref:r,trapFocus:s.open,disableOutsidePointerEvents:s.open,disableOutsideScroll:!0,onFocusOutside:w(t.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>s.onOpenChange(!1)})}),Es=i.forwardRef((t,n)=>{const s=B(T,t.__scopeMenu);return e.jsx(Ue,{...t,ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>s.onOpenChange(!1)})}),Ds=Pn("MenuContent.ScrollLock"),Ue=i.forwardRef((t,n)=>{const{__scopeMenu:s,loop:a=!1,trapFocus:r,onOpenAutoFocus:o,onCloseAutoFocus:u,disableOutsidePointerEvents:p,onEntryFocus:x,onEscapeKeyDown:f,onPointerDownOutside:d,onFocusOutside:c,onInteractOutside:h,onDismiss:j,disableOutsideScroll:l,...C}=t,v=B(T,s),N=oe(T,s),y=fe(s),F=vt(s),re=Cs(s),[ie,ce]=i.useState(null),z=i.useRef(null),ge=J(n,z,v.onContentChange),m=i.useRef(0),b=i.useRef(""),I=i.useRef(0),E=i.useRef(null),M=i.useRef("right"),V=i.useRef(0),je=l?Mn:i.Fragment,pn=l?{as:Ds,allowPinchZoom:!0}:void 0,fn=g=>{var W,We;const D=b.current+g,A=re().filter(L=>!L.disabled),K=document.activeElement,ve=(W=A.find(L=>L.ref.current===K))==null?void 0:W.textValue,be=A.map(L=>L.textValue),qe=Hs(be,D,ve),Z=(We=A.find(L=>L.textValue===qe))==null?void 0:We.ref.current;(function L(Ye){b.current=Ye,window.clearTimeout(m.current),Ye!==""&&(m.current=window.setTimeout(()=>L(""),1e3))})(D),Z&&setTimeout(()=>Z.focus())};i.useEffect(()=>()=>window.clearTimeout(m.current),[]),bn();const q=i.useCallback(g=>{var A,K;return M.current===((A=E.current)==null?void 0:A.side)&&zs(g,(K=E.current)==null?void 0:K.area)},[]);return e.jsx(Is,{scope:s,searchRef:b,onItemEnter:i.useCallback(g=>{q(g)&&g.preventDefault()},[q]),onItemLeave:i.useCallback(g=>{var D;q(g)||((D=z.current)==null||D.focus(),ce(null))},[q]),onTriggerLeave:i.useCallback(g=>{q(g)&&g.preventDefault()},[q]),pointerGraceTimerRef:I,onPointerGraceIntentChange:i.useCallback(g=>{E.current=g},[]),children:e.jsx(je,{...pn,children:e.jsx(wn,{asChild:!0,trapped:r,onMountAutoFocus:w(o,g=>{var D;g.preventDefault(),(D=z.current)==null||D.focus({preventScroll:!0})}),onUnmountAutoFocus:u,children:e.jsx(Nn,{asChild:!0,disableOutsidePointerEvents:p,onEscapeKeyDown:f,onPointerDownOutside:d,onFocusOutside:c,onInteractOutside:h,onDismiss:j,children:e.jsx($n,{asChild:!0,...F,dir:N.dir,orientation:"vertical",loop:a,currentTabStopId:ie,onCurrentTabStopIdChange:ce,onEntryFocus:w(x,g=>{N.isUsingKeyboardRef.current||g.preventDefault()}),preventScrollOnEntryFocus:!0,children:e.jsx(Cn,{role:"menu","aria-orientation":"vertical","data-state":Gt(v.open),"data-radix-menu-content":"",dir:N.dir,...y,...C,ref:ge,style:{outline:"none",...C.style},onKeyDown:w(C.onKeyDown,g=>{const A=g.target.closest("[data-radix-menu-content]")===g.currentTarget,K=g.ctrlKey||g.altKey||g.metaKey,ve=g.key.length===1;A&&(g.key==="Tab"&&g.preventDefault(),!K&&ve&&fn(g.key));const be=z.current;if(g.target!==be||!bs.includes(g.key))return;g.preventDefault();const Z=re().filter(W=>!W.disabled).map(W=>W.ref.current);gt.includes(g.key)&&Z.reverse(),Vs(Z)}),onBlur:w(t.onBlur,g=>{g.currentTarget.contains(g.target)||(window.clearTimeout(m.current),b.current="")}),onPointerMove:w(t.onPointerMove,ne(g=>{const D=g.target,A=V.current!==g.clientX;if(g.currentTarget.contains(D)&&A){const K=g.clientX>V.current?"right":"left";M.current=K,V.current=g.clientX}}))})})})})})})});Ct.displayName=T;var Ts="MenuGroup",He=i.forwardRef((t,n)=>{const{__scopeMenu:s,...a}=t;return e.jsx($.div,{role:"group",...a,ref:n})});He.displayName=Ts;var As="MenuLabel",yt=i.forwardRef((t,n)=>{const{__scopeMenu:s,...a}=t;return e.jsx($.div,{...a,ref:n})});yt.displayName=As;var ue="MenuItem",nt="menu.itemSelect",he=i.forwardRef((t,n)=>{const{disabled:s=!1,onSelect:a,...r}=t,o=i.useRef(null),u=oe(ue,t.__scopeMenu),p=Ve(ue,t.__scopeMenu),x=J(n,o),f=i.useRef(!1),d=()=>{const c=o.current;if(!s&&c){const h=new CustomEvent(nt,{bubbles:!0,cancelable:!0});c.addEventListener(nt,j=>a==null?void 0:a(j),{once:!0}),Sn(c,h),h.defaultPrevented?f.current=!1:u.onClose()}};return e.jsx(Mt,{...r,ref:x,disabled:s,onClick:w(t.onClick,d),onPointerDown:c=>{var h;(h=t.onPointerDown)==null||h.call(t,c),f.current=!0},onPointerUp:w(t.onPointerUp,c=>{var h;f.current||(h=c.currentTarget)==null||h.click()}),onKeyDown:w(t.onKeyDown,c=>{const h=p.searchRef.current!=="";s||h&&c.key===" "||Ee.includes(c.key)&&(c.currentTarget.click(),c.preventDefault())})})});he.displayName=ue;var Mt=i.forwardRef((t,n)=>{const{__scopeMenu:s,disabled:a=!1,textValue:r,...o}=t,u=Ve(ue,s),p=vt(s),x=i.useRef(null),f=J(n,x),[d,c]=i.useState(!1),[h,j]=i.useState("");return i.useEffect(()=>{const l=x.current;l&&j((l.textContent??"").trim())},[o.children]),e.jsx(te.ItemSlot,{scope:s,disabled:a,textValue:r??h,children:e.jsx(Kn,{asChild:!0,...p,focusable:!a,children:e.jsx($.div,{role:"menuitem","data-highlighted":d?"":void 0,"aria-disabled":a||void 0,"data-disabled":a?"":void 0,...o,ref:f,onPointerMove:w(t.onPointerMove,ne(l=>{a?u.onItemLeave(l):(u.onItemEnter(l),l.defaultPrevented||l.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:w(t.onPointerLeave,ne(l=>u.onItemLeave(l))),onFocus:w(t.onFocus,()=>c(!0)),onBlur:w(t.onBlur,()=>c(!1))})})})}),Os="MenuCheckboxItem",St=i.forwardRef((t,n)=>{const{checked:s=!1,onCheckedChange:a,...r}=t;return e.jsx(Et,{scope:t.__scopeMenu,checked:s,children:e.jsx(he,{role:"menuitemcheckbox","aria-checked":me(s)?"mixed":s,...r,ref:n,"data-state":ze(s),onSelect:w(r.onSelect,()=>a==null?void 0:a(me(s)?!0:!s),{checkForDefaultPrevented:!1})})})});St.displayName=Os;var Rt="MenuRadioGroup",[ks,Fs]=H(Rt,{value:void 0,onValueChange:()=>{}}),_t=i.forwardRef((t,n)=>{const{value:s,onValueChange:a,...r}=t,o=rt(a);return e.jsx(ks,{scope:t.__scopeMenu,value:s,onValueChange:o,children:e.jsx(He,{...r,ref:n})})});_t.displayName=Rt;var It="MenuRadioItem",Pt=i.forwardRef((t,n)=>{const{value:s,...a}=t,r=Fs(It,t.__scopeMenu),o=s===r.value;return e.jsx(Et,{scope:t.__scopeMenu,checked:o,children:e.jsx(he,{role:"menuitemradio","aria-checked":o,...a,ref:n,"data-state":ze(o),onSelect:w(a.onSelect,()=>{var u;return(u=r.onValueChange)==null?void 0:u.call(r,s)},{checkForDefaultPrevented:!1})})})});Pt.displayName=It;var Be="MenuItemIndicator",[Et,Ls]=H(Be,{checked:!1}),Dt=i.forwardRef((t,n)=>{const{__scopeMenu:s,forceMount:a,...r}=t,o=Ls(Be,s);return e.jsx(se,{present:a||me(o.checked)||o.checked===!0,children:e.jsx($.span,{...r,ref:n,"data-state":ze(o.checked)})})});Dt.displayName=Be;var Gs="MenuSeparator",Tt=i.forwardRef((t,n)=>{const{__scopeMenu:s,...a}=t;return e.jsx($.div,{role:"separator","aria-orientation":"horizontal",...a,ref:n})});Tt.displayName=Gs;var $s="MenuArrow",At=i.forwardRef((t,n)=>{const{__scopeMenu:s,...a}=t,r=fe(s);return e.jsx(yn,{...r,...a,ref:n})});At.displayName=$s;var Ks="MenuSub",[Za,Ot]=H(Ks),ee="MenuSubTrigger",kt=i.forwardRef((t,n)=>{const s=B(ee,t.__scopeMenu),a=oe(ee,t.__scopeMenu),r=Ot(ee,t.__scopeMenu),o=Ve(ee,t.__scopeMenu),u=i.useRef(null),{pointerGraceTimerRef:p,onPointerGraceIntentChange:x}=o,f={__scopeMenu:t.__scopeMenu},d=i.useCallback(()=>{u.current&&window.clearTimeout(u.current),u.current=null},[]);return i.useEffect(()=>d,[d]),i.useEffect(()=>{const c=p.current;return()=>{window.clearTimeout(c),x(null)}},[p,x]),e.jsx($e,{asChild:!0,...f,children:e.jsx(Mt,{id:r.triggerId,"aria-haspopup":"menu","aria-expanded":s.open,"aria-controls":r.contentId,"data-state":Gt(s.open),...t,ref:it(n,r.onTriggerChange),onClick:c=>{var h;(h=t.onClick)==null||h.call(t,c),!(t.disabled||c.defaultPrevented)&&(c.currentTarget.focus(),s.open||s.onOpenChange(!0))},onPointerMove:w(t.onPointerMove,ne(c=>{o.onItemEnter(c),!c.defaultPrevented&&!t.disabled&&!s.open&&!u.current&&(o.onPointerGraceIntentChange(null),u.current=window.setTimeout(()=>{s.onOpenChange(!0),d()},100))})),onPointerLeave:w(t.onPointerLeave,ne(c=>{var j,l;d();const h=(j=s.content)==null?void 0:j.getBoundingClientRect();if(h){const C=(l=s.content)==null?void 0:l.dataset.side,v=C==="right",N=v?-5:5,y=h[v?"left":"right"],F=h[v?"right":"left"];o.onPointerGraceIntentChange({area:[{x:c.clientX+N,y:c.clientY},{x:y,y:h.top},{x:F,y:h.top},{x:F,y:h.bottom},{x:y,y:h.bottom}],side:C}),window.clearTimeout(p.current),p.current=window.setTimeout(()=>o.onPointerGraceIntentChange(null),300)}else{if(o.onTriggerLeave(c),c.defaultPrevented)return;o.onPointerGraceIntentChange(null)}})),onKeyDown:w(t.onKeyDown,c=>{var j;const h=o.searchRef.current!=="";t.disabled||h&&c.key===" "||ws[a.dir].includes(c.key)&&(s.onOpenChange(!0),(j=s.content)==null||j.focus(),c.preventDefault())})})})});kt.displayName=ee;var Ft="MenuSubContent",Lt=i.forwardRef((t,n)=>{const s=wt(T,t.__scopeMenu),{forceMount:a=s.forceMount,...r}=t,o=B(T,t.__scopeMenu),u=oe(T,t.__scopeMenu),p=Ot(Ft,t.__scopeMenu),x=i.useRef(null),f=J(n,x);return e.jsx(te.Provider,{scope:t.__scopeMenu,children:e.jsx(se,{present:a||o.open,children:e.jsx(te.Slot,{scope:t.__scopeMenu,children:e.jsx(Ue,{id:p.contentId,"aria-labelledby":p.triggerId,...r,ref:f,align:"start",side:u.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:d=>{var c;u.isUsingKeyboardRef.current&&((c=x.current)==null||c.focus()),d.preventDefault()},onCloseAutoFocus:d=>d.preventDefault(),onFocusOutside:w(t.onFocusOutside,d=>{d.target!==p.trigger&&o.onOpenChange(!1)}),onEscapeKeyDown:w(t.onEscapeKeyDown,d=>{u.onClose(),d.preventDefault()}),onKeyDown:w(t.onKeyDown,d=>{var j;const c=d.currentTarget.contains(d.target),h=Ns[u.dir].includes(d.key);c&&h&&(o.onOpenChange(!1),(j=p.trigger)==null||j.focus(),d.preventDefault())})})})})})});Lt.displayName=Ft;function Gt(t){return t?"open":"closed"}function me(t){return t==="indeterminate"}function ze(t){return me(t)?"indeterminate":t?"checked":"unchecked"}function Vs(t){const n=document.activeElement;for(const s of t)if(s===n||(s.focus(),document.activeElement!==n))return}function Us(t,n){return t.map((s,a)=>t[(n+a)%t.length])}function Hs(t,n,s){const r=n.length>1&&Array.from(n).every(f=>f===n[0])?n[0]:n,o=s?t.indexOf(s):-1;let u=Us(t,Math.max(o,0));r.length===1&&(u=u.filter(f=>f!==s));const x=u.find(f=>f.toLowerCase().startsWith(r.toLowerCase()));return x!==s?x:void 0}function Bs(t,n){const{x:s,y:a}=t;let r=!1;for(let o=0,u=n.length-1;o<n.length;u=o++){const p=n[o],x=n[u],f=p.x,d=p.y,c=x.x,h=x.y;d>a!=h>a&&s<(c-f)*(a-d)/(h-d)+f&&(r=!r)}return r}function zs(t,n){if(!n)return!1;const s={x:t.clientX,y:t.clientY};return Bs(s,n)}function ne(t){return n=>n.pointerType==="mouse"?t(n):void 0}var qs=bt,Ws=$e,Ys=Nt,Xs=Ct,Js=He,Zs=yt,Qs=he,ea=St,ta=_t,na=Pt,sa=Dt,aa=Tt,oa=At,ra=kt,ia=Lt,xe="DropdownMenu",[ca,Qa]=Ae(xe,[jt]),_=jt(),[la,$t]=ca(xe),Kt=t=>{const{__scopeDropdownMenu:n,children:s,dir:a,open:r,defaultOpen:o,onOpenChange:u,modal:p=!0}=t,x=_(n),f=i.useRef(null),[d,c]=st({prop:r,defaultProp:o??!1,onChange:u,caller:xe});return e.jsx(la,{scope:n,triggerId:Ie(),triggerRef:f,contentId:Ie(),open:d,onOpenChange:c,onOpenToggle:i.useCallback(()=>c(h=>!h),[c]),modal:p,children:e.jsx(qs,{...x,open:d,onOpenChange:c,dir:a,modal:p,children:s})})};Kt.displayName=xe;var Vt="DropdownMenuTrigger",Ut=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,disabled:a=!1,...r}=t,o=$t(Vt,s),u=_(s);return e.jsx(Ws,{asChild:!0,...u,children:e.jsx($.button,{type:"button",id:o.triggerId,"aria-haspopup":"menu","aria-expanded":o.open,"aria-controls":o.open?o.contentId:void 0,"data-state":o.open?"open":"closed","data-disabled":a?"":void 0,disabled:a,...r,ref:it(n,o.triggerRef),onPointerDown:w(t.onPointerDown,p=>{!a&&p.button===0&&p.ctrlKey===!1&&(o.onOpenToggle(),o.open||p.preventDefault())}),onKeyDown:w(t.onKeyDown,p=>{a||(["Enter"," "].includes(p.key)&&o.onOpenToggle(),p.key==="ArrowDown"&&o.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(p.key)&&p.preventDefault())})})})});Ut.displayName=Vt;var da="DropdownMenuPortal",Ht=t=>{const{__scopeDropdownMenu:n,...s}=t,a=_(n);return e.jsx(Ys,{...a,...s})};Ht.displayName=da;var Bt="DropdownMenuContent",zt=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,r=$t(Bt,s),o=_(s),u=i.useRef(!1);return e.jsx(Xs,{id:r.contentId,"aria-labelledby":r.triggerId,...o,...a,ref:n,onCloseAutoFocus:w(t.onCloseAutoFocus,p=>{var x;u.current||(x=r.triggerRef.current)==null||x.focus(),u.current=!1,p.preventDefault()}),onInteractOutside:w(t.onInteractOutside,p=>{const x=p.detail.originalEvent,f=x.button===0&&x.ctrlKey===!0,d=x.button===2||f;(!r.modal||d)&&(u.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});zt.displayName=Bt;var ua="DropdownMenuGroup",ma=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,r=_(s);return e.jsx(Js,{...r,...a,ref:n})});ma.displayName=ua;var pa="DropdownMenuLabel",qt=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,r=_(s);return e.jsx(Zs,{...r,...a,ref:n})});qt.displayName=pa;var fa="DropdownMenuItem",Wt=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,r=_(s);return e.jsx(Qs,{...r,...a,ref:n})});Wt.displayName=fa;var ha="DropdownMenuCheckboxItem",Yt=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,r=_(s);return e.jsx(ea,{...r,...a,ref:n})});Yt.displayName=ha;var xa="DropdownMenuRadioGroup",ga=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,r=_(s);return e.jsx(ta,{...r,...a,ref:n})});ga.displayName=xa;var ja="DropdownMenuRadioItem",Xt=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,r=_(s);return e.jsx(na,{...r,...a,ref:n})});Xt.displayName=ja;var va="DropdownMenuItemIndicator",Jt=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,r=_(s);return e.jsx(sa,{...r,...a,ref:n})});Jt.displayName=va;var ba="DropdownMenuSeparator",Zt=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,r=_(s);return e.jsx(aa,{...r,...a,ref:n})});Zt.displayName=ba;var wa="DropdownMenuArrow",Na=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,r=_(s);return e.jsx(oa,{...r,...a,ref:n})});Na.displayName=wa;var Ca="DropdownMenuSubTrigger",Qt=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,r=_(s);return e.jsx(ra,{...r,...a,ref:n})});Qt.displayName=Ca;var ya="DropdownMenuSubContent",en=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...a}=t,r=_(s);return e.jsx(ia,{...r,...a,ref:n,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});en.displayName=ya;var Ma=Kt,Sa=Ut,Ra=Ht,tn=zt,nn=qt,sn=Wt,an=Yt,on=Xt,rn=Jt,cn=Zt,ln=Qt,dn=en;const _a=Ma,Ia=Sa,Pa=i.forwardRef(({className:t,inset:n,children:s,...a},r)=>e.jsxs(ln,{ref:r,className:S("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[state=open]:bg-accent focus:bg-accent",n&&"pl-8",t),...a,children:[s,e.jsx(Oe,{className:"ml-auto h-4 w-4"})]}));Pa.displayName=ln.displayName;const Ea=i.forwardRef(({className:t,...n},s)=>e.jsx(dn,{ref:s,className:S("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n}));Ea.displayName=dn.displayName;const un=i.forwardRef(({className:t,sideOffset:n=4,...s},a)=>e.jsx(Ra,{children:e.jsx(tn,{ref:a,sideOffset:n,className:S("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...s})}));un.displayName=tn.displayName;const De=i.forwardRef(({className:t,inset:n,...s},a)=>e.jsx(sn,{ref:a,className:S("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",n&&"pl-8",t),...s}));De.displayName=sn.displayName;const Da=i.forwardRef(({className:t,children:n,checked:s,...a},r)=>e.jsxs(an,{ref:r,className:S("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t),checked:s,...a,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(rn,{children:e.jsx(lt,{className:"h-4 w-4"})})}),n]}));Da.displayName=an.displayName;const Ta=i.forwardRef(({className:t,children:n,...s},a)=>e.jsxs(on,{ref:a,className:S("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t),...s,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(rn,{children:e.jsx(ls,{className:"h-2 w-2 fill-current"})})}),n]}));Ta.displayName=on.displayName;const mn=i.forwardRef(({className:t,inset:n,...s},a)=>e.jsx(nn,{ref:a,className:S("px-2 py-1.5 text-sm font-semibold",n&&"pl-8",t),...s}));mn.displayName=nn.displayName;const Aa=i.forwardRef(({className:t,...n},s)=>e.jsx(cn,{ref:s,className:S("-mx-1 my-1 h-px bg-muted",t),...n}));Aa.displayName=cn.displayName;const eo=()=>{const[t,n]=i.useState({page:1,limit:20,sort_by:"date",sort_order:"desc",search:""}),{role:s}=at(),a=s==="admin",[r,o]=i.useState(""),[u,p]=i.useState(!1),[x,f]=i.useState(null),{data:d,isLoading:c,isError:h}=Vn(t);i.useEffect(()=>{const v=setTimeout(()=>{n(N=>({...N,page:1,search:r}))},500);return()=>clearTimeout(v)},[r]);const j=v=>{v.preventDefault(),n(N=>({...N,page:1,search:r}))},l=v=>{n(N=>({...N,sort_by:v,sort_order:N.sort_by===v&&N.sort_order==="desc"?"asc":"desc"}))},C=(d==null?void 0:d.meta.pages)||1;return e.jsx(Dn,{fullWidth:!0,children:e.jsxs("div",{className:"flex flex-col h-full space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Shift Records"})}),e.jsx(Xe,{open:u,onOpenChange:p,children:e.jsxs(Je,{className:"max-w-2xl",children:[e.jsx(Ze,{children:e.jsx(Qe,{children:"Add New Shift Record"})}),e.jsx(tt,{onSuccess:()=>p(!1),onCancel:()=>p(!1)})]})}),e.jsx(Xe,{open:!!x,onOpenChange:v=>!v&&f(null),children:e.jsxs(Je,{className:"max-w-2xl",children:[e.jsx(Ze,{children:e.jsx(Qe,{children:"Edit Shift Record"})}),x&&e.jsx(tt,{record:x,onSuccess:()=>f(null),onCancel:()=>f(null)})]})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("form",{onSubmit:j,className:"flex-1 max-w-sm flex gap-2",children:[e.jsx(k,{placeholder:"Search by name, client, or job...",value:r,onChange:v=>o(v.target.value)}),e.jsx(U,{type:"submit",variant:"secondary",children:e.jsx(ss,{className:"h-4 w-4"})})]}),(a||s==="manager")&&e.jsxs(U,{onClick:()=>p(!0),children:[e.jsx(ds,{className:"mr-2 h-4 w-4"})," Add Record"]}),e.jsxs("div",{className:"ml-auto text-sm text-muted-foreground",children:[(d==null?void 0:d.meta.total)||0," records found"]})]}),e.jsx("div",{className:"border rounded-md bg-white overflow-x-auto",children:e.jsxs(Tn,{children:[e.jsx(An,{children:e.jsxs(X,{children:[e.jsx(O,{className:"w-[30px]"}),e.jsxs(O,{className:"cursor-pointer",onClick:()=>l("date"),children:["Date ",e.jsx(Re,{className:"ml-2 h-4 w-4 inline"})]}),e.jsxs(O,{className:"cursor-pointer",onClick:()=>l("full_name"),children:["Employee ",e.jsx(Re,{className:"ml-2 h-4 w-4 inline"})]}),e.jsxs(O,{className:"cursor-pointer",onClick:()=>l("client_name"),children:["Client ",e.jsx(Re,{className:"ml-2 h-4 w-4 inline"})]}),e.jsx(O,{className:"hidden md:table-cell cursor-pointer",onClick:()=>l("location"),children:"Location"}),e.jsx(O,{children:"Shift"}),e.jsx(O,{className:"text-right",children:"Hours"}),a&&e.jsx(O,{className:"text-right",children:"Staff Pay"}),a&&e.jsx(O,{className:"text-right",children:"Client Pay"}),e.jsx(O,{className:"w-[50px]"})]})}),e.jsx(On,{children:c?e.jsx(X,{children:e.jsx(P,{colSpan:a?10:8,className:"h-24 text-center",children:e.jsx(Pe,{className:"h-6 w-6 animate-spin mx-auto"})})}):h?e.jsx(X,{children:e.jsx(P,{colSpan:a?10:8,className:"h-24 text-center text-red-500",children:"Failed to load records"})}):(d==null?void 0:d.data.length)===0?e.jsx(X,{children:e.jsx(P,{colSpan:a?10:8,className:"h-24 text-center",children:"No records found"})}):d==null?void 0:d.data.map(v=>e.jsx(Oa,{record:v,isAdmin:a,role:s,onEdit:()=>f(v)},v.id))})]})}),C>1&&e.jsx(dt,{children:e.jsxs(ut,{children:[e.jsx(de,{children:e.jsx(mt,{onClick:()=>n(v=>({...v,page:Math.max(1,v.page-1)})),className:t.page===1?"pointer-events-none opacity-50":"cursor-pointer"})}),e.jsx(de,{children:e.jsxs("div",{className:"flex items-center justify-center px-4 text-sm font-medium",children:["Page ",t.page," of ",C]})}),e.jsx(de,{children:e.jsx(pt,{onClick:()=>n(v=>({...v,page:Math.min(C,v.page+1)})),className:t.page===C?"pointer-events-none opacity-50":"cursor-pointer"})})]})})]})})},Oa=({record:t,isAdmin:n,role:s,onEdit:a})=>{var x,f,d,c,h;const[r,o]=i.useState(!1),u=Un(),p=()=>{confirm("Are you sure you want to delete this record?")&&u.mutate(t.id)};return e.jsxs(e.Fragment,{children:[e.jsxs(X,{className:"group",children:[e.jsx(P,{children:e.jsx(xs,{open:r,onOpenChange:o,children:e.jsx(gs,{asChild:!0,children:e.jsxs(U,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",children:[r?e.jsx(is,{className:"h-4 w-4"}):e.jsx(Oe,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Toggle"})]})})})}),e.jsx(P,{className:"font-medium",children:t.date?Se(new Date(t.date),"dd MMM yyyy"):"-"}),e.jsx(P,{children:t.fullName}),e.jsx(P,{children:t.clientName}),e.jsx(P,{className:"hidden md:table-cell",children:t.location}),e.jsx(P,{children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm",children:t.shiftName}),e.jsx("span",{className:"text-xs text-muted-foreground",children:t.shiftStart&&t.shiftEnd?`${Se(new Date(`1970-01-01T${t.shiftStart}`),"HH:mm")} - ${Se(new Date(`1970-01-01T${t.shiftEnd}`),"HH:mm")}`:""})]})}),e.jsx(P,{className:"text-right",children:t.paidHours.toFixed(2)}),n&&e.jsxs(P,{className:"text-right",children:["£",((x=t.totalPay)==null?void 0:x.toFixed(2))||"0.00"]}),n&&e.jsxs(P,{className:"text-right font-medium",children:["£",((f=t.clientNet)==null?void 0:f.toFixed(2))||"0.00"]}),e.jsx(P,{children:(n||s==="manager")&&e.jsxs(_a,{children:[e.jsx(Ia,{asChild:!0,children:e.jsxs(U,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(cs,{className:"h-4 w-4"})]})}),e.jsxs(un,{align:"end",children:[e.jsx(mn,{children:"Actions"}),e.jsxs(De,{onClick:j=>{j.stopPropagation(),a()},children:[e.jsx(Wn,{className:"mr-2 h-4 w-4"})," Edit"]}),e.jsxs(De,{onClick:j=>{j.stopPropagation(),p()},className:"text-red-600",children:[e.jsx(Yn,{className:"mr-2 h-4 w-4"})," Delete"]})]})]})})]}),e.jsx(X,{className:r?"":"hidden",children:e.jsx(P,{colSpan:n?10:8,className:"p-0 border-b-0",children:e.jsxs("div",{className:`bg-muted/50 p-4 grid grid-cols-1 ${n?"md:grid-cols-3":"md:grid-cols-2"} gap-4 text-sm shadow-inner`,children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Job Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"Site:"}),e.jsx("span",{children:t.site}),e.jsx("span",{className:"text-muted-foreground",children:"Job Name:"}),e.jsx("span",{children:t.jobName}),e.jsx("span",{className:"text-muted-foreground",children:"Status:"}),e.jsx(kn,{variant:"outline",className:"w-fit",children:t.jobStatus||"N/A"})]})]}),n&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Financial Breakdown"}),e.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"Pay Rate:"}),e.jsxs("span",{children:["£",((d=t.hourRate)==null?void 0:d.toFixed(2))||"0.00","/hr"]}),e.jsx("span",{className:"text-muted-foreground",children:"Charge Rate:"}),e.jsxs("span",{children:["£",((c=t.clientHourlyRate)==null?void 0:c.toFixed(2))||"0.00","/hr"]}),e.jsx("span",{className:"text-muted-foreground",children:"Total Charge:"}),e.jsxs("span",{children:["£",((h=t.totalCharge)==null?void 0:h.toFixed(2))||"0.00"]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Metadata"}),e.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"System ID:"}),e.jsx("span",{className:"font-mono text-xs",children:t.id})]})]})]})})})]})};export{eo as default};
