import{c as nt,r as i,j as e,e as S,t as hn,h as Te,p as st,v as Ie,P as $,q as w,w as se,o as J,x as xn,B as U,b as ot,L as Pe,I as k,y as le,z as gn,C as at,D as jn,E as vn,F as bn,G as wn,H as Nn,J as Cn,K as rt,M as yn,N as it,O as Mn,Q as Sn,U as Rn,V as _n,W as In,Y as Pn}from"./index-Cwa0VGn5.js";import{b as En,C as Ae,D as Dn}from"./DashboardLayout-Blb4jY-C.js";import{T as Tn,a as An,b as X,c as O,d as On,e as P}from"./table-BwrTp2Bi.js";import{B as kn}from"./badge-RrlKDuub.js";import{u as Fn,a as Ln,b as Gn,c as $n,d as Kn}from"./useRecords-FoBgCd03.js";import{e as Vn,D as Ye,b as Xe,c as Je,d as Qe}from"./dialog-jMZg7LyU.js";import{o as Un,s as Y,c as G,b as Ze,u as Hn,t as Bn,C as we,P as qn}from"./types-CinCvijy.js";import{L as R}from"./label-BJtP0uMy.js";import{S as Ne,a as Ce,b as ye,c as Me,d as Z}from"./select-BrmXPpgU.js";import{C as zn,a as Wn,b as Yn,f as Xn,c as Jn,d as Qn,e as Zn,S as es}from"./command-DX7W0Pfg.js";import{P as ts,a as ns,b as ss,f as Se}from"./popover-NxQMHS6k.js";import{C as ct,a as os}from"./index-Bb3Hx0GX.js";import{c as lt,R as as,I as rs,P as is}from"./index-CQifGSqN.js";import{E as cs}from"./ellipsis-B0XMlEsc.js";import{T as ls}from"./trash-2-BOp9v2gF.js";import"./users-V4lVAK-5.js";import"./useQuery-CddlU5wy.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=nt("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ds=nt("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),dt=({className:t,...n})=>e.jsx("nav",{role:"navigation","aria-label":"pagination",className:S("mx-auto flex w-full justify-center",t),...n});dt.displayName="Pagination";const ut=i.forwardRef(({className:t,...n},s)=>e.jsx("ul",{ref:s,className:S("flex flex-row items-center gap-1",t),...n}));ut.displayName="PaginationContent";const de=i.forwardRef(({className:t,...n},s)=>e.jsx("li",{ref:s,className:S("",t),...n}));de.displayName="PaginationItem";const Oe=({className:t,isActive:n,size:s="icon",...o})=>e.jsx("a",{"aria-current":n?"page":void 0,className:S(hn({variant:n?"outline":"ghost",size:s}),t),...o});Oe.displayName="PaginationLink";const mt=({className:t,...n})=>e.jsxs(Oe,{"aria-label":"Go to previous page",size:"default",className:S("gap-1 pl-2.5",t),...n,children:[e.jsx(En,{className:"h-4 w-4"}),e.jsx("span",{children:"Previous"})]});mt.displayName="PaginationPrevious";const pt=({className:t,...n})=>e.jsxs(Oe,{"aria-label":"Go to next page",size:"default",className:S("gap-1 pr-2.5",t),...n,children:[e.jsx("span",{children:"Next"}),e.jsx(Ae,{className:"h-4 w-4"})]});pt.displayName="PaginationNext";var pe="Collapsible",[us,ea]=Te(pe),[ms,ke]=us(pe),ft=i.forwardRef((t,n)=>{const{__scopeCollapsible:s,open:o,defaultOpen:r,disabled:a,onOpenChange:u,...p}=t,[x,f]=st({prop:o,defaultProp:r??!1,onChange:u,caller:pe});return e.jsx(ms,{scope:s,disabled:a,contentId:Ie(),open:x,onOpenToggle:i.useCallback(()=>f(d=>!d),[f]),children:e.jsx($.div,{"data-state":Le(x),"data-disabled":a?"":void 0,...p,ref:n})})});ft.displayName=pe;var ht="CollapsibleTrigger",xt=i.forwardRef((t,n)=>{const{__scopeCollapsible:s,...o}=t,r=ke(ht,s);return e.jsx($.button,{type:"button","aria-controls":r.contentId,"aria-expanded":r.open||!1,"data-state":Le(r.open),"data-disabled":r.disabled?"":void 0,disabled:r.disabled,...o,ref:n,onClick:w(t.onClick,r.onOpenToggle)})});xt.displayName=ht;var Fe="CollapsibleContent",ps=i.forwardRef((t,n)=>{const{forceMount:s,...o}=t,r=ke(Fe,t.__scopeCollapsible);return e.jsx(se,{present:s||r.open,children:({present:a})=>e.jsx(fs,{...o,ref:n,present:a})})});ps.displayName=Fe;var fs=i.forwardRef((t,n)=>{const{__scopeCollapsible:s,present:o,children:r,...a}=t,u=ke(Fe,s),[p,x]=i.useState(o),f=i.useRef(null),d=J(n,f),c=i.useRef(0),h=c.current,j=i.useRef(0),l=j.current,C=u.open||p,v=i.useRef(C),N=i.useRef(void 0);return i.useEffect(()=>{const y=requestAnimationFrame(()=>v.current=!1);return()=>cancelAnimationFrame(y)},[]),xn(()=>{const y=f.current;if(y){N.current=N.current||{transitionDuration:y.style.transitionDuration,animationName:y.style.animationName},y.style.transitionDuration="0s",y.style.animationName="none";const F=y.getBoundingClientRect();c.current=F.height,j.current=F.width,v.current||(y.style.transitionDuration=N.current.transitionDuration,y.style.animationName=N.current.animationName),x(o)}},[u.open,o]),e.jsx($.div,{"data-state":Le(u.open),"data-disabled":u.disabled?"":void 0,id:u.contentId,hidden:!C,...a,ref:d,style:{"--radix-collapsible-content-height":h?`${h}px`:void 0,"--radix-collapsible-content-width":l?`${l}px`:void 0,...t.style},children:C&&r})});function Le(t){return t?"open":"closed"}var hs=ft;const xs=hs,gs=xt;function _e({options:t,value:n,onChange:s,placeholder:o="Select...",searchPlaceholder:r="Search...",emptyMessage:a="No results found.",className:u,disabled:p=!1}){var d;const[x,f]=i.useState(!1);return e.jsxs(ts,{open:x,onOpenChange:f,children:[e.jsx(ns,{asChild:!0,children:e.jsxs(U,{variant:"outline",role:"combobox","aria-expanded":x,className:S("w-full justify-between",u),disabled:p,children:[n?(d=t.find(c=>c.value===n))==null?void 0:d.label:o,e.jsx(zn,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(ss,{className:"w-[--radix-popover-trigger-width] p-0",align:"start",children:e.jsxs(Wn,{children:[e.jsx(Yn,{placeholder:r}),e.jsxs(Xn,{children:[e.jsx(Jn,{children:a}),e.jsx(Qn,{children:t.map(c=>e.jsxs(Zn,{value:c.label,onSelect:h=>{s(c.value===n?"":c.value),f(!1)},children:[e.jsx(ct,{className:S("mr-2 h-4 w-4",n===c.value?"opacity-100":"opacity-0")}),c.label]},c.value))})]})]})})]})}const js=Un({date:Y().min(1,"Date is required"),employeeId:G.number().min(1,"Employee is required"),clientId:G.number().min(1,"Client is required"),jobId:G.number().min(1,"Job is required"),shiftId:G.number().min(1,"Shift is required"),startTime:Y().min(1,"Start time is required"),endTime:Y().min(1,"End time is required"),hours:G.number().min(.1,"Hours must be greater than 0"),hourRate:G.number().optional(),clientHourlyRate:G.number().optional(),job_name:Y().optional(),role:Y().optional(),jobStatus:Y().optional(),additions:G.number().optional(),deductions:G.number().optional(),self_employed:Ze().optional(),dns:Ze().optional()}),et=({record:t,onSuccess:n,onCancel:s})=>{const{role:o}=ot(),r=o==="admin",{data:a,isLoading:u}=Fn(),p=Ln(),x=Gn(),[f,d]=i.useState(""),[c,h]=i.useState(""),j=!!t,l=Hn({resolver:Bn(js),defaultValues:{date:(t==null?void 0:t.date)||new Date().toISOString().split("T")[0],employeeId:void 0,clientId:void 0,jobId:void 0,shiftId:void 0,startTime:t!=null&&t.shiftStart?t.shiftStart.substring(0,5):"09:00",endTime:t!=null&&t.shiftEnd?t.shiftEnd.substring(0,5):"17:00",hours:(t==null?void 0:t.paidHours)||8,hourRate:(t==null?void 0:t.hourRate)||0,clientHourlyRate:(t==null?void 0:t.clientHourlyRate)||0,job_name:(t==null?void 0:t.jobName)||"",role:"Travel Retail Specialist",jobStatus:(t==null?void 0:t.jobStatus)||"Currently Working - Full Airside Pass",additions:0,deductions:0,self_employed:!1,dns:!1}}),C=l.watch("startTime"),v=l.watch("endTime"),N=l.watch("shiftId"),y=i.useMemo(()=>a!=null&&a.jobs?Array.from(new Set(a.jobs.map(m=>m.location).filter(Boolean))):[],[a]),F=i.useMemo(()=>!(a!=null&&a.jobs)||!f?[]:Array.from(new Set(a.jobs.filter(m=>m.location===f).map(m=>m.site).filter(Boolean))),[a,f]);i.useEffect(()=>{if(t&&a){const m=a.employees.find(M=>M.name===t.fullName);m&&l.setValue("employeeId",m.id);const b=a.clients.find(M=>M.name===t.clientName);b&&l.setValue("clientId",b.id);const I=a.shifts.find(M=>M.name===t.shiftName);I&&l.setValue("shiftId",I.id);let E=a.jobs.find(M=>M.name===t.jobName&&M.site===t.site);E||(E=a.jobs.find(M=>M.site===t.site&&M.location===t.location)),E&&(l.setValue("jobId",E.id),d(E.location),h(E.site))}},[t,a,l]),i.useEffect(()=>{if(C&&v){const[m,b]=C.split(":").map(Number),[I,E]=v.split(":").map(Number);let M=m*60+b,V=I*60+E;V<M&&(V+=24*60);const je=(V-M)/60;l.setValue("hours",parseFloat(je.toFixed(2)))}},[C,v,l]),i.useEffect(()=>{var m;if(!j&&N&&(a!=null&&a.shifts)){const b=(m=a.shifts.find(I=>I.id===N))==null?void 0:m.name;b&&l.setValue("job_name",b)}},[N,j,a,l]),i.useEffect(()=>{if(f&&c&&(a!=null&&a.jobs)){const m=a.jobs.find(b=>b.location===f&&b.site===c);m&&l.setValue("jobId",m.id)}},[f,c,a,l]);const re=m=>{j&&t?x.mutate({id:t.id,...m},{onSuccess:()=>{le.success("Record updated successfully"),n()},onError:b=>{le.error(`Failed to update record: ${b.message}`)}}):p.mutate(m,{onSuccess:()=>{le.success("Record created successfully"),n()},onError:b=>{le.error(`Failed to create record: ${b.message}`)}})},ie=p.isPending||x.isPending;if(u)return e.jsx("div",{className:"flex justify-center p-4",children:e.jsx(Pe,{className:"animate-spin"})});const ce=(a==null?void 0:a.employees.map(m=>({value:m.id.toString(),label:m.name})))||[],q=(a==null?void 0:a.clients.map(m=>({value:m.id.toString(),label:m.name})))||[],ge=(a==null?void 0:a.shifts.map(m=>({value:m.id.toString(),label:`${m.name} (${m.start.substring(0,5)}-${m.end.substring(0,5)})`})))||[];return e.jsxs("form",{onSubmit:l.handleSubmit(re),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"date",children:"Date"}),e.jsx(k,{id:"date",type:"date",...l.register("date")}),l.formState.errors.date&&e.jsx("span",{className:"text-red-500 text-xs",children:l.formState.errors.date.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"startTime",children:"Start Time"}),e.jsx(k,{id:"startTime",type:"time",...l.register("startTime")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"endTime",children:"End Time"}),e.jsx(k,{id:"endTime",type:"time",...l.register("endTime")})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(R,{children:["Calculated Hours: ",l.watch("hours")]}),e.jsx(k,{type:"hidden",...l.register("hours")})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:"Employee"}),e.jsx(we,{control:l.control,name:"employeeId",render:({field:m})=>{var b;return e.jsx(_e,{options:ce,value:(b=m.value)==null?void 0:b.toString(),onChange:I=>m.onChange(Number(I)),placeholder:"Select Employee...",searchPlaceholder:"Search employees..."})}}),l.formState.errors.employeeId&&e.jsx("span",{className:"text-red-500 text-xs",children:l.formState.errors.employeeId.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:"Client"}),e.jsx(we,{control:l.control,name:"clientId",render:({field:m})=>{var b;return e.jsx(_e,{options:q,value:(b=m.value)==null?void 0:b.toString(),onChange:I=>m.onChange(Number(I)),placeholder:"Select Client...",searchPlaceholder:"Search clients..."})}}),l.formState.errors.clientId&&e.jsx("span",{className:"text-red-500 text-xs",children:l.formState.errors.clientId.message})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:"Location"}),e.jsxs(Ne,{value:f,onValueChange:m=>{d(m),h("")},children:[e.jsx(Ce,{children:e.jsx(ye,{placeholder:"Select Location"})}),e.jsx(Me,{children:y.map(m=>e.jsx(Z,{value:m,children:m},m))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:"Site / Terminal"}),e.jsxs(Ne,{value:c,onValueChange:h,disabled:!f,children:[e.jsx(Ce,{children:e.jsx(ye,{placeholder:"Select Site"})}),e.jsx(Me,{children:F.map(m=>e.jsx(Z,{value:m,children:m},m))})]}),e.jsx("input",{type:"hidden",...l.register("jobId")}),l.formState.errors.jobId&&e.jsx("span",{className:"text-red-500 text-xs",children:"Job Selection Incomplete"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:"Shift"}),e.jsx(we,{control:l.control,name:"shiftId",render:({field:m})=>{var b;return e.jsx(_e,{options:ge,value:(b=m.value)==null?void 0:b.toString(),onChange:I=>m.onChange(Number(I)),placeholder:"Select Shift config...",searchPlaceholder:"Search shifts..."})}}),l.formState.errors.shiftId&&e.jsx("span",{className:"text-red-500 text-xs",children:l.formState.errors.shiftId.message})]}),(r||j)&&e.jsxs("div",{className:"border-t pt-4 grid grid-cols-2 gap-4 bg-muted/20 p-4 rounded-md",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:"Role"}),e.jsx(k,{...l.register("role")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:"Status"}),e.jsxs(Ne,{onValueChange:m=>l.setValue("jobStatus",m),defaultValue:l.getValues("jobStatus"),children:[e.jsx(Ce,{children:e.jsx(ye,{placeholder:"Status"})}),e.jsxs(Me,{children:[e.jsx(Z,{value:"Currently Working - Full Airside Pass",children:"Currently Working - Full Airside Pass"}),e.jsx(Z,{value:"Completed",children:"Completed"}),e.jsx(Z,{value:"Cancelled",children:"Cancelled"})]})]})]}),r&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"hourRate",children:"Pay Rate (£)"}),e.jsx(k,{id:"hourRate",type:"number",step:"0.01",...l.register("hourRate")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"clientHourlyRate",children:"Client Rate (£)"}),e.jsx(k,{id:"clientHourlyRate",type:"number",step:"0.01",...l.register("clientHourlyRate")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"additions",children:"Additions (£)"}),e.jsx(k,{id:"additions",type:"number",step:"0.01",...l.register("additions")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"deductions",children:"Deductions (£)"}),e.jsx(k,{id:"deductions",type:"number",step:"0.01",...l.register("deductions")})]})]})]}),e.jsxs(Vn,{className:"mt-6 flex justify-between items-center w-full",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:!j&&"Defaults: Role=Travel Retail, Additions=0, Deductions=0"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(U,{type:"button",variant:"outline",onClick:s,children:"Cancel"}),e.jsxs(U,{type:"submit",disabled:ie,children:[ie&&e.jsx(Pe,{className:"mr-2 h-4 w-4 animate-spin"}),j?"Update Record":"Create Record"]})]})]})]})};var Ee=["Enter"," "],vs=["ArrowDown","PageUp","Home"],gt=["ArrowUp","PageDown","End"],bs=[...vs,...gt],ws={ltr:[...Ee,"ArrowRight"],rtl:[...Ee,"ArrowLeft"]},Ns={ltr:["ArrowLeft"],rtl:["ArrowRight"]},oe="Menu",[te,Cs,ys]=gn(oe),[H,jt]=Te(oe,[ys,at,lt]),fe=at(),vt=lt(),[Ms,B]=H(oe),[Ss,ae]=H(oe),bt=t=>{const{__scopeMenu:n,open:s=!1,children:o,dir:r,onOpenChange:a,modal:u=!0}=t,p=fe(n),[x,f]=i.useState(null),d=i.useRef(!1),c=rt(a),h=Rn(r);return i.useEffect(()=>{const j=()=>{d.current=!0,document.addEventListener("pointerdown",l,{capture:!0,once:!0}),document.addEventListener("pointermove",l,{capture:!0,once:!0})},l=()=>d.current=!1;return document.addEventListener("keydown",j,{capture:!0}),()=>{document.removeEventListener("keydown",j,{capture:!0}),document.removeEventListener("pointerdown",l,{capture:!0}),document.removeEventListener("pointermove",l,{capture:!0})}},[]),e.jsx(_n,{...p,children:e.jsx(Ms,{scope:n,open:s,onOpenChange:c,content:x,onContentChange:f,children:e.jsx(Ss,{scope:n,onClose:i.useCallback(()=>c(!1),[c]),isUsingKeyboardRef:d,dir:h,modal:u,children:o})})})};bt.displayName=oe;var Rs="MenuAnchor",Ge=i.forwardRef((t,n)=>{const{__scopeMenu:s,...o}=t,r=fe(s);return e.jsx(jn,{...r,...o,ref:n})});Ge.displayName=Rs;var $e="MenuPortal",[_s,wt]=H($e,{forceMount:void 0}),Nt=t=>{const{__scopeMenu:n,forceMount:s,children:o,container:r}=t,a=B($e,n);return e.jsx(_s,{scope:n,forceMount:s,children:e.jsx(se,{present:s||a.open,children:e.jsx(In,{asChild:!0,container:r,children:o})})})};Nt.displayName=$e;var T="MenuContent",[Is,Ke]=H(T),Ct=i.forwardRef((t,n)=>{const s=wt(T,t.__scopeMenu),{forceMount:o=s.forceMount,...r}=t,a=B(T,t.__scopeMenu),u=ae(T,t.__scopeMenu);return e.jsx(te.Provider,{scope:t.__scopeMenu,children:e.jsx(se,{present:o||a.open,children:e.jsx(te.Slot,{scope:t.__scopeMenu,children:u.modal?e.jsx(Ps,{...r,ref:n}):e.jsx(Es,{...r,ref:n})})})})}),Ps=i.forwardRef((t,n)=>{const s=B(T,t.__scopeMenu),o=i.useRef(null),r=J(n,o);return i.useEffect(()=>{const a=o.current;if(a)return vn(a)},[]),e.jsx(Ve,{...t,ref:r,trapFocus:s.open,disableOutsidePointerEvents:s.open,disableOutsideScroll:!0,onFocusOutside:w(t.onFocusOutside,a=>a.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>s.onOpenChange(!1)})}),Es=i.forwardRef((t,n)=>{const s=B(T,t.__scopeMenu);return e.jsx(Ve,{...t,ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>s.onOpenChange(!1)})}),Ds=Pn("MenuContent.ScrollLock"),Ve=i.forwardRef((t,n)=>{const{__scopeMenu:s,loop:o=!1,trapFocus:r,onOpenAutoFocus:a,onCloseAutoFocus:u,disableOutsidePointerEvents:p,onEntryFocus:x,onEscapeKeyDown:f,onPointerDownOutside:d,onFocusOutside:c,onInteractOutside:h,onDismiss:j,disableOutsideScroll:l,...C}=t,v=B(T,s),N=ae(T,s),y=fe(s),F=vt(s),re=Cs(s),[ie,ce]=i.useState(null),q=i.useRef(null),ge=J(n,q,v.onContentChange),m=i.useRef(0),b=i.useRef(""),I=i.useRef(0),E=i.useRef(null),M=i.useRef("right"),V=i.useRef(0),je=l?Mn:i.Fragment,pn=l?{as:Ds,allowPinchZoom:!0}:void 0,fn=g=>{var W,ze;const D=b.current+g,A=re().filter(L=>!L.disabled),K=document.activeElement,ve=(W=A.find(L=>L.ref.current===K))==null?void 0:W.textValue,be=A.map(L=>L.textValue),qe=Hs(be,D,ve),Q=(ze=A.find(L=>L.textValue===qe))==null?void 0:ze.ref.current;(function L(We){b.current=We,window.clearTimeout(m.current),We!==""&&(m.current=window.setTimeout(()=>L(""),1e3))})(D),Q&&setTimeout(()=>Q.focus())};i.useEffect(()=>()=>window.clearTimeout(m.current),[]),bn();const z=i.useCallback(g=>{var A,K;return M.current===((A=E.current)==null?void 0:A.side)&&qs(g,(K=E.current)==null?void 0:K.area)},[]);return e.jsx(Is,{scope:s,searchRef:b,onItemEnter:i.useCallback(g=>{z(g)&&g.preventDefault()},[z]),onItemLeave:i.useCallback(g=>{var D;z(g)||((D=q.current)==null||D.focus(),ce(null))},[z]),onTriggerLeave:i.useCallback(g=>{z(g)&&g.preventDefault()},[z]),pointerGraceTimerRef:I,onPointerGraceIntentChange:i.useCallback(g=>{E.current=g},[]),children:e.jsx(je,{...pn,children:e.jsx(wn,{asChild:!0,trapped:r,onMountAutoFocus:w(a,g=>{var D;g.preventDefault(),(D=q.current)==null||D.focus({preventScroll:!0})}),onUnmountAutoFocus:u,children:e.jsx(Nn,{asChild:!0,disableOutsidePointerEvents:p,onEscapeKeyDown:f,onPointerDownOutside:d,onFocusOutside:c,onInteractOutside:h,onDismiss:j,children:e.jsx(as,{asChild:!0,...F,dir:N.dir,orientation:"vertical",loop:o,currentTabStopId:ie,onCurrentTabStopIdChange:ce,onEntryFocus:w(x,g=>{N.isUsingKeyboardRef.current||g.preventDefault()}),preventScrollOnEntryFocus:!0,children:e.jsx(Cn,{role:"menu","aria-orientation":"vertical","data-state":Gt(v.open),"data-radix-menu-content":"",dir:N.dir,...y,...C,ref:ge,style:{outline:"none",...C.style},onKeyDown:w(C.onKeyDown,g=>{const A=g.target.closest("[data-radix-menu-content]")===g.currentTarget,K=g.ctrlKey||g.altKey||g.metaKey,ve=g.key.length===1;A&&(g.key==="Tab"&&g.preventDefault(),!K&&ve&&fn(g.key));const be=q.current;if(g.target!==be||!bs.includes(g.key))return;g.preventDefault();const Q=re().filter(W=>!W.disabled).map(W=>W.ref.current);gt.includes(g.key)&&Q.reverse(),Vs(Q)}),onBlur:w(t.onBlur,g=>{g.currentTarget.contains(g.target)||(window.clearTimeout(m.current),b.current="")}),onPointerMove:w(t.onPointerMove,ne(g=>{const D=g.target,A=V.current!==g.clientX;if(g.currentTarget.contains(D)&&A){const K=g.clientX>V.current?"right":"left";M.current=K,V.current=g.clientX}}))})})})})})})});Ct.displayName=T;var Ts="MenuGroup",Ue=i.forwardRef((t,n)=>{const{__scopeMenu:s,...o}=t;return e.jsx($.div,{role:"group",...o,ref:n})});Ue.displayName=Ts;var As="MenuLabel",yt=i.forwardRef((t,n)=>{const{__scopeMenu:s,...o}=t;return e.jsx($.div,{...o,ref:n})});yt.displayName=As;var ue="MenuItem",tt="menu.itemSelect",he=i.forwardRef((t,n)=>{const{disabled:s=!1,onSelect:o,...r}=t,a=i.useRef(null),u=ae(ue,t.__scopeMenu),p=Ke(ue,t.__scopeMenu),x=J(n,a),f=i.useRef(!1),d=()=>{const c=a.current;if(!s&&c){const h=new CustomEvent(tt,{bubbles:!0,cancelable:!0});c.addEventListener(tt,j=>o==null?void 0:o(j),{once:!0}),Sn(c,h),h.defaultPrevented?f.current=!1:u.onClose()}};return e.jsx(Mt,{...r,ref:x,disabled:s,onClick:w(t.onClick,d),onPointerDown:c=>{var h;(h=t.onPointerDown)==null||h.call(t,c),f.current=!0},onPointerUp:w(t.onPointerUp,c=>{var h;f.current||(h=c.currentTarget)==null||h.click()}),onKeyDown:w(t.onKeyDown,c=>{const h=p.searchRef.current!=="";s||h&&c.key===" "||Ee.includes(c.key)&&(c.currentTarget.click(),c.preventDefault())})})});he.displayName=ue;var Mt=i.forwardRef((t,n)=>{const{__scopeMenu:s,disabled:o=!1,textValue:r,...a}=t,u=Ke(ue,s),p=vt(s),x=i.useRef(null),f=J(n,x),[d,c]=i.useState(!1),[h,j]=i.useState("");return i.useEffect(()=>{const l=x.current;l&&j((l.textContent??"").trim())},[a.children]),e.jsx(te.ItemSlot,{scope:s,disabled:o,textValue:r??h,children:e.jsx(rs,{asChild:!0,...p,focusable:!o,children:e.jsx($.div,{role:"menuitem","data-highlighted":d?"":void 0,"aria-disabled":o||void 0,"data-disabled":o?"":void 0,...a,ref:f,onPointerMove:w(t.onPointerMove,ne(l=>{o?u.onItemLeave(l):(u.onItemEnter(l),l.defaultPrevented||l.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:w(t.onPointerLeave,ne(l=>u.onItemLeave(l))),onFocus:w(t.onFocus,()=>c(!0)),onBlur:w(t.onBlur,()=>c(!1))})})})}),Os="MenuCheckboxItem",St=i.forwardRef((t,n)=>{const{checked:s=!1,onCheckedChange:o,...r}=t;return e.jsx(Et,{scope:t.__scopeMenu,checked:s,children:e.jsx(he,{role:"menuitemcheckbox","aria-checked":me(s)?"mixed":s,...r,ref:n,"data-state":Be(s),onSelect:w(r.onSelect,()=>o==null?void 0:o(me(s)?!0:!s),{checkForDefaultPrevented:!1})})})});St.displayName=Os;var Rt="MenuRadioGroup",[ks,Fs]=H(Rt,{value:void 0,onValueChange:()=>{}}),_t=i.forwardRef((t,n)=>{const{value:s,onValueChange:o,...r}=t,a=rt(o);return e.jsx(ks,{scope:t.__scopeMenu,value:s,onValueChange:a,children:e.jsx(Ue,{...r,ref:n})})});_t.displayName=Rt;var It="MenuRadioItem",Pt=i.forwardRef((t,n)=>{const{value:s,...o}=t,r=Fs(It,t.__scopeMenu),a=s===r.value;return e.jsx(Et,{scope:t.__scopeMenu,checked:a,children:e.jsx(he,{role:"menuitemradio","aria-checked":a,...o,ref:n,"data-state":Be(a),onSelect:w(o.onSelect,()=>{var u;return(u=r.onValueChange)==null?void 0:u.call(r,s)},{checkForDefaultPrevented:!1})})})});Pt.displayName=It;var He="MenuItemIndicator",[Et,Ls]=H(He,{checked:!1}),Dt=i.forwardRef((t,n)=>{const{__scopeMenu:s,forceMount:o,...r}=t,a=Ls(He,s);return e.jsx(se,{present:o||me(a.checked)||a.checked===!0,children:e.jsx($.span,{...r,ref:n,"data-state":Be(a.checked)})})});Dt.displayName=He;var Gs="MenuSeparator",Tt=i.forwardRef((t,n)=>{const{__scopeMenu:s,...o}=t;return e.jsx($.div,{role:"separator","aria-orientation":"horizontal",...o,ref:n})});Tt.displayName=Gs;var $s="MenuArrow",At=i.forwardRef((t,n)=>{const{__scopeMenu:s,...o}=t,r=fe(s);return e.jsx(yn,{...r,...o,ref:n})});At.displayName=$s;var Ks="MenuSub",[ta,Ot]=H(Ks),ee="MenuSubTrigger",kt=i.forwardRef((t,n)=>{const s=B(ee,t.__scopeMenu),o=ae(ee,t.__scopeMenu),r=Ot(ee,t.__scopeMenu),a=Ke(ee,t.__scopeMenu),u=i.useRef(null),{pointerGraceTimerRef:p,onPointerGraceIntentChange:x}=a,f={__scopeMenu:t.__scopeMenu},d=i.useCallback(()=>{u.current&&window.clearTimeout(u.current),u.current=null},[]);return i.useEffect(()=>d,[d]),i.useEffect(()=>{const c=p.current;return()=>{window.clearTimeout(c),x(null)}},[p,x]),e.jsx(Ge,{asChild:!0,...f,children:e.jsx(Mt,{id:r.triggerId,"aria-haspopup":"menu","aria-expanded":s.open,"aria-controls":r.contentId,"data-state":Gt(s.open),...t,ref:it(n,r.onTriggerChange),onClick:c=>{var h;(h=t.onClick)==null||h.call(t,c),!(t.disabled||c.defaultPrevented)&&(c.currentTarget.focus(),s.open||s.onOpenChange(!0))},onPointerMove:w(t.onPointerMove,ne(c=>{a.onItemEnter(c),!c.defaultPrevented&&!t.disabled&&!s.open&&!u.current&&(a.onPointerGraceIntentChange(null),u.current=window.setTimeout(()=>{s.onOpenChange(!0),d()},100))})),onPointerLeave:w(t.onPointerLeave,ne(c=>{var j,l;d();const h=(j=s.content)==null?void 0:j.getBoundingClientRect();if(h){const C=(l=s.content)==null?void 0:l.dataset.side,v=C==="right",N=v?-5:5,y=h[v?"left":"right"],F=h[v?"right":"left"];a.onPointerGraceIntentChange({area:[{x:c.clientX+N,y:c.clientY},{x:y,y:h.top},{x:F,y:h.top},{x:F,y:h.bottom},{x:y,y:h.bottom}],side:C}),window.clearTimeout(p.current),p.current=window.setTimeout(()=>a.onPointerGraceIntentChange(null),300)}else{if(a.onTriggerLeave(c),c.defaultPrevented)return;a.onPointerGraceIntentChange(null)}})),onKeyDown:w(t.onKeyDown,c=>{var j;const h=a.searchRef.current!=="";t.disabled||h&&c.key===" "||ws[o.dir].includes(c.key)&&(s.onOpenChange(!0),(j=s.content)==null||j.focus(),c.preventDefault())})})})});kt.displayName=ee;var Ft="MenuSubContent",Lt=i.forwardRef((t,n)=>{const s=wt(T,t.__scopeMenu),{forceMount:o=s.forceMount,...r}=t,a=B(T,t.__scopeMenu),u=ae(T,t.__scopeMenu),p=Ot(Ft,t.__scopeMenu),x=i.useRef(null),f=J(n,x);return e.jsx(te.Provider,{scope:t.__scopeMenu,children:e.jsx(se,{present:o||a.open,children:e.jsx(te.Slot,{scope:t.__scopeMenu,children:e.jsx(Ve,{id:p.contentId,"aria-labelledby":p.triggerId,...r,ref:f,align:"start",side:u.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:d=>{var c;u.isUsingKeyboardRef.current&&((c=x.current)==null||c.focus()),d.preventDefault()},onCloseAutoFocus:d=>d.preventDefault(),onFocusOutside:w(t.onFocusOutside,d=>{d.target!==p.trigger&&a.onOpenChange(!1)}),onEscapeKeyDown:w(t.onEscapeKeyDown,d=>{u.onClose(),d.preventDefault()}),onKeyDown:w(t.onKeyDown,d=>{var j;const c=d.currentTarget.contains(d.target),h=Ns[u.dir].includes(d.key);c&&h&&(a.onOpenChange(!1),(j=p.trigger)==null||j.focus(),d.preventDefault())})})})})})});Lt.displayName=Ft;function Gt(t){return t?"open":"closed"}function me(t){return t==="indeterminate"}function Be(t){return me(t)?"indeterminate":t?"checked":"unchecked"}function Vs(t){const n=document.activeElement;for(const s of t)if(s===n||(s.focus(),document.activeElement!==n))return}function Us(t,n){return t.map((s,o)=>t[(n+o)%t.length])}function Hs(t,n,s){const r=n.length>1&&Array.from(n).every(f=>f===n[0])?n[0]:n,a=s?t.indexOf(s):-1;let u=Us(t,Math.max(a,0));r.length===1&&(u=u.filter(f=>f!==s));const x=u.find(f=>f.toLowerCase().startsWith(r.toLowerCase()));return x!==s?x:void 0}function Bs(t,n){const{x:s,y:o}=t;let r=!1;for(let a=0,u=n.length-1;a<n.length;u=a++){const p=n[a],x=n[u],f=p.x,d=p.y,c=x.x,h=x.y;d>o!=h>o&&s<(c-f)*(o-d)/(h-d)+f&&(r=!r)}return r}function qs(t,n){if(!n)return!1;const s={x:t.clientX,y:t.clientY};return Bs(s,n)}function ne(t){return n=>n.pointerType==="mouse"?t(n):void 0}var zs=bt,Ws=Ge,Ys=Nt,Xs=Ct,Js=Ue,Qs=yt,Zs=he,eo=St,to=_t,no=Pt,so=Dt,oo=Tt,ao=At,ro=kt,io=Lt,xe="DropdownMenu",[co,na]=Te(xe,[jt]),_=jt(),[lo,$t]=co(xe),Kt=t=>{const{__scopeDropdownMenu:n,children:s,dir:o,open:r,defaultOpen:a,onOpenChange:u,modal:p=!0}=t,x=_(n),f=i.useRef(null),[d,c]=st({prop:r,defaultProp:a??!1,onChange:u,caller:xe});return e.jsx(lo,{scope:n,triggerId:Ie(),triggerRef:f,contentId:Ie(),open:d,onOpenChange:c,onOpenToggle:i.useCallback(()=>c(h=>!h),[c]),modal:p,children:e.jsx(zs,{...x,open:d,onOpenChange:c,dir:o,modal:p,children:s})})};Kt.displayName=xe;var Vt="DropdownMenuTrigger",Ut=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,disabled:o=!1,...r}=t,a=$t(Vt,s),u=_(s);return e.jsx(Ws,{asChild:!0,...u,children:e.jsx($.button,{type:"button",id:a.triggerId,"aria-haspopup":"menu","aria-expanded":a.open,"aria-controls":a.open?a.contentId:void 0,"data-state":a.open?"open":"closed","data-disabled":o?"":void 0,disabled:o,...r,ref:it(n,a.triggerRef),onPointerDown:w(t.onPointerDown,p=>{!o&&p.button===0&&p.ctrlKey===!1&&(a.onOpenToggle(),a.open||p.preventDefault())}),onKeyDown:w(t.onKeyDown,p=>{o||(["Enter"," "].includes(p.key)&&a.onOpenToggle(),p.key==="ArrowDown"&&a.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(p.key)&&p.preventDefault())})})})});Ut.displayName=Vt;var uo="DropdownMenuPortal",Ht=t=>{const{__scopeDropdownMenu:n,...s}=t,o=_(n);return e.jsx(Ys,{...o,...s})};Ht.displayName=uo;var Bt="DropdownMenuContent",qt=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...o}=t,r=$t(Bt,s),a=_(s),u=i.useRef(!1);return e.jsx(Xs,{id:r.contentId,"aria-labelledby":r.triggerId,...a,...o,ref:n,onCloseAutoFocus:w(t.onCloseAutoFocus,p=>{var x;u.current||(x=r.triggerRef.current)==null||x.focus(),u.current=!1,p.preventDefault()}),onInteractOutside:w(t.onInteractOutside,p=>{const x=p.detail.originalEvent,f=x.button===0&&x.ctrlKey===!0,d=x.button===2||f;(!r.modal||d)&&(u.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});qt.displayName=Bt;var mo="DropdownMenuGroup",po=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...o}=t,r=_(s);return e.jsx(Js,{...r,...o,ref:n})});po.displayName=mo;var fo="DropdownMenuLabel",zt=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...o}=t,r=_(s);return e.jsx(Qs,{...r,...o,ref:n})});zt.displayName=fo;var ho="DropdownMenuItem",Wt=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...o}=t,r=_(s);return e.jsx(Zs,{...r,...o,ref:n})});Wt.displayName=ho;var xo="DropdownMenuCheckboxItem",Yt=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...o}=t,r=_(s);return e.jsx(eo,{...r,...o,ref:n})});Yt.displayName=xo;var go="DropdownMenuRadioGroup",jo=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...o}=t,r=_(s);return e.jsx(to,{...r,...o,ref:n})});jo.displayName=go;var vo="DropdownMenuRadioItem",Xt=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...o}=t,r=_(s);return e.jsx(no,{...r,...o,ref:n})});Xt.displayName=vo;var bo="DropdownMenuItemIndicator",Jt=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...o}=t,r=_(s);return e.jsx(so,{...r,...o,ref:n})});Jt.displayName=bo;var wo="DropdownMenuSeparator",Qt=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...o}=t,r=_(s);return e.jsx(oo,{...r,...o,ref:n})});Qt.displayName=wo;var No="DropdownMenuArrow",Co=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...o}=t,r=_(s);return e.jsx(ao,{...r,...o,ref:n})});Co.displayName=No;var yo="DropdownMenuSubTrigger",Zt=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...o}=t,r=_(s);return e.jsx(ro,{...r,...o,ref:n})});Zt.displayName=yo;var Mo="DropdownMenuSubContent",en=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:s,...o}=t,r=_(s);return e.jsx(io,{...r,...o,ref:n,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});en.displayName=Mo;var So=Kt,Ro=Ut,_o=Ht,tn=qt,nn=zt,sn=Wt,on=Yt,an=Xt,rn=Jt,cn=Qt,ln=Zt,dn=en;const Io=So,Po=Ro,Eo=i.forwardRef(({className:t,inset:n,children:s,...o},r)=>e.jsxs(ln,{ref:r,className:S("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[state=open]:bg-accent focus:bg-accent",n&&"pl-8",t),...o,children:[s,e.jsx(Ae,{className:"ml-auto h-4 w-4"})]}));Eo.displayName=ln.displayName;const Do=i.forwardRef(({className:t,...n},s)=>e.jsx(dn,{ref:s,className:S("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n}));Do.displayName=dn.displayName;const un=i.forwardRef(({className:t,sideOffset:n=4,...s},o)=>e.jsx(_o,{children:e.jsx(tn,{ref:o,sideOffset:n,className:S("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...s})}));un.displayName=tn.displayName;const De=i.forwardRef(({className:t,inset:n,...s},o)=>e.jsx(sn,{ref:o,className:S("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",n&&"pl-8",t),...s}));De.displayName=sn.displayName;const To=i.forwardRef(({className:t,children:n,checked:s,...o},r)=>e.jsxs(on,{ref:r,className:S("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t),checked:s,...o,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(rn,{children:e.jsx(ct,{className:"h-4 w-4"})})}),n]}));To.displayName=on.displayName;const Ao=i.forwardRef(({className:t,children:n,...s},o)=>e.jsxs(an,{ref:o,className:S("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t),...s,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(rn,{children:e.jsx(ds,{className:"h-2 w-2 fill-current"})})}),n]}));Ao.displayName=an.displayName;const mn=i.forwardRef(({className:t,inset:n,...s},o)=>e.jsx(nn,{ref:o,className:S("px-2 py-1.5 text-sm font-semibold",n&&"pl-8",t),...s}));mn.displayName=nn.displayName;const Oo=i.forwardRef(({className:t,...n},s)=>e.jsx(cn,{ref:s,className:S("-mx-1 my-1 h-px bg-muted",t),...n}));Oo.displayName=cn.displayName;const sa=()=>{const[t,n]=i.useState({page:1,limit:20,sort_by:"date",sort_order:"desc",search:""}),{role:s}=ot(),o=s==="admin",[r,a]=i.useState(""),[u,p]=i.useState(!1),[x,f]=i.useState(null),{data:d,isLoading:c,isError:h}=$n(t);i.useEffect(()=>{const v=setTimeout(()=>{n(N=>({...N,page:1,search:r}))},500);return()=>clearTimeout(v)},[r]);const j=v=>{v.preventDefault(),n(N=>({...N,page:1,search:r}))},l=v=>{n(N=>({...N,sort_by:v,sort_order:N.sort_by===v&&N.sort_order==="desc"?"asc":"desc"}))},C=(d==null?void 0:d.meta.pages)||1;return e.jsx(Dn,{fullWidth:!0,children:e.jsxs("div",{className:"flex flex-col h-full space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Shift Records"})}),e.jsx(Ye,{open:u,onOpenChange:p,children:e.jsxs(Xe,{className:"max-w-2xl",children:[e.jsx(Je,{children:e.jsx(Qe,{children:"Add New Shift Record"})}),e.jsx(et,{onSuccess:()=>p(!1),onCancel:()=>p(!1)})]})}),e.jsx(Ye,{open:!!x,onOpenChange:v=>!v&&f(null),children:e.jsxs(Xe,{className:"max-w-2xl",children:[e.jsx(Je,{children:e.jsx(Qe,{children:"Edit Shift Record"})}),x&&e.jsx(et,{record:x,onSuccess:()=>f(null),onCancel:()=>f(null)})]})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("form",{onSubmit:j,className:"flex-1 max-w-sm flex gap-2",children:[e.jsx(k,{placeholder:"Search by name, client, or job...",value:r,onChange:v=>a(v.target.value)}),e.jsx(U,{type:"submit",variant:"secondary",children:e.jsx(es,{className:"h-4 w-4"})})]}),(o||s==="manager")&&e.jsxs(U,{onClick:()=>p(!0),children:[e.jsx(is,{className:"mr-2 h-4 w-4"})," Add Record"]}),e.jsxs("div",{className:"ml-auto text-sm text-muted-foreground",children:[(d==null?void 0:d.meta.total)||0," records found"]})]}),e.jsx("div",{className:"border rounded-md bg-white overflow-x-auto",children:e.jsxs(Tn,{children:[e.jsx(An,{children:e.jsxs(X,{children:[e.jsx(O,{className:"w-[30px]"}),e.jsxs(O,{className:"cursor-pointer",onClick:()=>l("date"),children:["Date ",e.jsx(Re,{className:"ml-2 h-4 w-4 inline"})]}),e.jsxs(O,{className:"cursor-pointer",onClick:()=>l("full_name"),children:["Employee ",e.jsx(Re,{className:"ml-2 h-4 w-4 inline"})]}),e.jsxs(O,{className:"cursor-pointer",onClick:()=>l("client_name"),children:["Client ",e.jsx(Re,{className:"ml-2 h-4 w-4 inline"})]}),e.jsx(O,{className:"hidden md:table-cell cursor-pointer",onClick:()=>l("location"),children:"Location"}),e.jsx(O,{children:"Shift"}),e.jsx(O,{className:"text-right",children:"Hours"}),o&&e.jsx(O,{className:"text-right",children:"Staff Pay"}),o&&e.jsx(O,{className:"text-right",children:"Client Pay"}),e.jsx(O,{className:"w-[50px]"})]})}),e.jsx(On,{children:c?e.jsx(X,{children:e.jsx(P,{colSpan:o?10:8,className:"h-24 text-center",children:e.jsx(Pe,{className:"h-6 w-6 animate-spin mx-auto"})})}):h?e.jsx(X,{children:e.jsx(P,{colSpan:o?10:8,className:"h-24 text-center text-red-500",children:"Failed to load records"})}):(d==null?void 0:d.data.length)===0?e.jsx(X,{children:e.jsx(P,{colSpan:o?10:8,className:"h-24 text-center",children:"No records found"})}):d==null?void 0:d.data.map(v=>e.jsx(ko,{record:v,isAdmin:o,role:s,onEdit:()=>f(v)},v.id))})]})}),C>1&&e.jsx(dt,{children:e.jsxs(ut,{children:[e.jsx(de,{children:e.jsx(mt,{onClick:()=>n(v=>({...v,page:Math.max(1,v.page-1)})),className:t.page===1?"pointer-events-none opacity-50":"cursor-pointer"})}),e.jsx(de,{children:e.jsxs("div",{className:"flex items-center justify-center px-4 text-sm font-medium",children:["Page ",t.page," of ",C]})}),e.jsx(de,{children:e.jsx(pt,{onClick:()=>n(v=>({...v,page:Math.min(C,v.page+1)})),className:t.page===C?"pointer-events-none opacity-50":"cursor-pointer"})})]})})]})})},ko=({record:t,isAdmin:n,role:s,onEdit:o})=>{var x,f,d,c,h;const[r,a]=i.useState(!1),u=Kn(),p=()=>{confirm("Are you sure you want to delete this record?")&&u.mutate(t.id)};return e.jsxs(e.Fragment,{children:[e.jsxs(X,{className:"group",children:[e.jsx(P,{children:e.jsx(xs,{open:r,onOpenChange:a,children:e.jsx(gs,{asChild:!0,children:e.jsxs(U,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",children:[r?e.jsx(os,{className:"h-4 w-4"}):e.jsx(Ae,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Toggle"})]})})})}),e.jsx(P,{className:"font-medium",children:t.date?Se(new Date(t.date),"dd MMM yyyy"):"-"}),e.jsx(P,{children:t.fullName}),e.jsx(P,{children:t.clientName}),e.jsx(P,{className:"hidden md:table-cell",children:t.location}),e.jsx(P,{children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm",children:t.shiftName}),e.jsx("span",{className:"text-xs text-muted-foreground",children:t.shiftStart&&t.shiftEnd?`${Se(new Date(`1970-01-01T${t.shiftStart}`),"HH:mm")} - ${Se(new Date(`1970-01-01T${t.shiftEnd}`),"HH:mm")}`:""})]})}),e.jsx(P,{className:"text-right",children:t.paidHours.toFixed(2)}),n&&e.jsxs(P,{className:"text-right",children:["£",((x=t.totalPay)==null?void 0:x.toFixed(2))||"0.00"]}),n&&e.jsxs(P,{className:"text-right font-medium",children:["£",((f=t.clientNet)==null?void 0:f.toFixed(2))||"0.00"]}),e.jsx(P,{children:(n||s==="manager")&&e.jsxs(Io,{children:[e.jsx(Po,{asChild:!0,children:e.jsxs(U,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(cs,{className:"h-4 w-4"})]})}),e.jsxs(un,{align:"end",children:[e.jsx(mn,{children:"Actions"}),e.jsxs(De,{onClick:j=>{j.stopPropagation(),o()},children:[e.jsx(qn,{className:"mr-2 h-4 w-4"})," Edit"]}),e.jsxs(De,{onClick:j=>{j.stopPropagation(),p()},className:"text-red-600",children:[e.jsx(ls,{className:"mr-2 h-4 w-4"})," Delete"]})]})]})})]}),e.jsx(X,{className:r?"":"hidden",children:e.jsx(P,{colSpan:n?10:8,className:"p-0 border-b-0",children:e.jsxs("div",{className:`bg-muted/50 p-4 grid grid-cols-1 ${n?"md:grid-cols-3":"md:grid-cols-2"} gap-4 text-sm shadow-inner`,children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Job Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"Site:"}),e.jsx("span",{children:t.site}),e.jsx("span",{className:"text-muted-foreground",children:"Job Name:"}),e.jsx("span",{children:t.jobName}),e.jsx("span",{className:"text-muted-foreground",children:"Status:"}),e.jsx(kn,{variant:"outline",className:"w-fit",children:t.jobStatus||"N/A"})]})]}),n&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Financial Breakdown"}),e.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"Pay Rate:"}),e.jsxs("span",{children:["£",((d=t.hourRate)==null?void 0:d.toFixed(2))||"0.00","/hr"]}),e.jsx("span",{className:"text-muted-foreground",children:"Charge Rate:"}),e.jsxs("span",{children:["£",((c=t.clientHourlyRate)==null?void 0:c.toFixed(2))||"0.00","/hr"]}),e.jsx("span",{className:"text-muted-foreground",children:"Total Charge:"}),e.jsxs("span",{children:["£",((h=t.totalCharge)==null?void 0:h.toFixed(2))||"0.00"]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Metadata"}),e.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"System ID:"}),e.jsx("span",{className:"font-mono text-xs",children:t.id})]})]})]})})})]})};export{sa as default};
