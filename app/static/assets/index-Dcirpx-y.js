import{ab as T,r as p,j as e,T as te,e as Y,B as P,I as $,k as se,l as re,m as ae,ac as le}from"./index-BfZYg0Ju.js";import{D as oe,T as ie}from"./DashboardLayout-p_xBApmi.js";import{L as ne}from"./label-DBPBdWET.js";import{T as z}from"./trash-2-Cr4nklwI.js";import{e as ue,f as M,P as ce,a as de,C as me,b as fe,d as he,s as be}from"./popover-Bb4GKTnQ.js";import{D as B,a as J,b as K,c as G,d as V,e as R}from"./dialog-4FWOn46z.js";import{P as U}from"./plus-BFUTgLsO.js";import"./users-LsBO_p4p.js";function pe(s,a){const u=T(s.start),t=T(s.end);let v=+u>+t;const k=v?+u:+t,m=v?t:u;m.setHours(0,0,0,0),m.setDate(1);let x=1;const j=[];for(;+m<=k;)j.push(T(m)),m.setMonth(m.getMonth()+x);return v?j.reverse():j}function xe(s){const a=T(s),u=a.getFullYear();return a.setFullYear(u+1,0,0),a.setHours(23,59,59,999),a}function ye(s,a){return s===null||s===0?"":a.isPercentage?`${s.toFixed(2)}%`:a.isCurrency?`£${s.toLocaleString("en-GB",{minimumFractionDigits:2,maximumFractionDigits:2})}`:s.toLocaleString("en-GB",{maximumFractionDigits:2})}function ge({rowId:s,colId:a,value:u,row:t,isActive:v,source:k,onFocus:m,onUpdate:x,onNavigate:j,updateRowFormula:S}){const[o,f]=p.useState(!1),[y,l]=p.useState(""),w=p.useRef(null),[_,N]=p.useState(!1),[n,r]=p.useState(t.formulaString||"");p.useEffect(()=>{r(t.formulaString||"")},[t.formulaString]);const h=p.useCallback(i=>{f(!0),l(i!==void 0?i:u!==null?String(u):""),setTimeout(()=>{var c;return(c=w.current)==null?void 0:c.focus()},0)},[u]),d=p.useCallback(()=>{f(!1);const i=parseFloat(y);x(y===""?null:isNaN(i)?u:i)},[y,x,u]),b=p.useCallback(()=>{N(!1),S&&n!==t.formulaString&&S(s,n)},[n,t.formulaString,s,S]),g=p.useCallback(i=>{i.key==="Enter"?d():i.key==="Escape"&&f(!1)},[d]);return p.useEffect(()=>{if(v&&!o&&!_){const i=c=>{["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(c.key)?(c.preventDefault(),j({ArrowUp:"up",ArrowDown:"down",ArrowLeft:"left",ArrowRight:"right"}[c.key])):!c.ctrlKey&&!c.altKey&&!c.metaKey&&c.key.length===1?h(c.key):c.key==="Enter"?(c.preventDefault(),h()):(c.key==="Backspace"||c.key==="Delete")&&x(null)};return window.addEventListener("keydown",i),()=>window.removeEventListener("keydown",i)}},[v,o,_,j,h,x]),o?e.jsx("input",{ref:w,type:"text",className:"w-full h-full px-2 py-1 outline-none bg-background text-center font-lato",value:y,onChange:i=>l(i.target.value),onBlur:d,onKeyDown:g}):e.jsxs(se,{delayDuration:800,children:[e.jsx(re,{asChild:!0,children:e.jsxs("div",{className:Y("w-full h-full px-2 py-1 cursor-cell flex items-center justify-center font-lato relative group",t.isHeader&&"font-bold",k==="manual"&&t.isAutoCalculated&&"bg-yellow-50/50"),tabIndex:-1,onClick:m,onDoubleClick:i=>{i.preventDefault(),h()},children:[ye(u,t),k==="manual"&&t.isAutoCalculated&&e.jsx("div",{className:"absolute top-0 right-0 w-2 h-2 bg-yellow-400 rounded-bl-full",title:"Manual Override"})]})}),(k||t.formulaString||t.isAutoCalculated)&&e.jsx(ae,{className:"p-3 min-w-[200px] pointer-events-auto",side:"bottom",children:e.jsxs("div",{className:"text-xs space-y-2",children:[(k||t.isAutoCalculated)&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-semibold text-muted-foreground",children:"Source:"}),e.jsx("span",{className:"capitalize",children:k??(t.isAutoCalculated?"calculated":void 0)})]}),t.formulaString&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"font-semibold text-muted-foreground",children:"Formula:"}),_?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx($,{value:n,onChange:i=>r(i.target.value),className:"h-6 text-xs",onKeyDown:i=>{i.key==="Enter"&&b(),i.key==="Escape"&&N(!1)}}),e.jsx(P,{size:"icon",variant:"ghost",className:"h-6 w-6",onClick:b,children:e.jsx("span",{className:"text-green-500",children:"✓"})})]}):e.jsxs("div",{className:"bg-muted px-2 py-1 rounded font-mono cursor-pointer hover:bg-muted/80 flex justify-between items-center group/formula",onClick:i=>{i.preventDefault(),N(!0),r(t.formulaString||"")},children:[t.formulaString,e.jsx("span",{className:"opacity-0 group-hover/formula:opacity-100 text-[10px] text-muted-foreground ml-2",children:"Edit"})]})]})]})})]})}function _e(s){let a="",u=s;for(;u>=0;)a=String.fromCharCode(u%26+65)+a,u=Math.floor(u/26)-1;return a}function Ce({rows:s,columns:a,data:u,activeCell:t,setActiveCell:v,updateCell:k,deleteRow:m,deleteColumn:x,navigateCell:j,updateRowFormula:S,renameColumn:o}){const[f,y]=p.useState(null);return e.jsxs("div",{className:"flex-1 overflow-auto relative border border-border rounded-md bg-background",children:[e.jsx(te,{children:e.jsxs("table",{className:"w-full border-collapse table-fixed text-sm",children:[e.jsxs("thead",{className:"sticky top-0 z-20 bg-muted/90 backdrop-blur-sm shadow-sm",children:[e.jsxs("tr",{children:[e.jsx("th",{className:"w-12 border-b border-border bg-muted p-1 text-center text-xs text-muted-foreground font-normal select-none relative group",children:e.jsx("div",{className:"absolute inset-0 bg-muted/50"})}),e.jsx("th",{className:"w-64 border-b border-r border-border bg-muted p-2 text-left font-medium text-muted-foreground"}),a.map((l,w)=>e.jsx("th",{className:"border-b border-r border-border bg-muted p-1 text-center text-xs font-normal text-muted-foreground select-none relative min-w-[120px]",children:_e(w)},`excel-${w}`))]}),e.jsxs("tr",{children:[e.jsx("th",{className:"w-12 border-b border-border bg-background p-2"}),e.jsx("th",{className:"w-64 border-b border-r border-border bg-background p-2 text-left font-semibold text-foreground",children:"Metric / Account"}),a.map(l=>e.jsx("th",{className:Y("relative border-b border-r border-border bg-background p-2 text-right font-semibold min-w-[120px]",l.isYearEnd?"text-primary/80 bg-primary/5":"text-foreground"),children:e.jsxs("div",{className:"flex items-center justify-end gap-2 group",children:[e.jsx("span",{className:"cursor-pointer hover:text-primary transition-colors py-1",onDoubleClick:()=>!l.isProtected&&y({id:l.id,type:"col",value:l.label}),children:l.label}),!l.isProtected&&e.jsx(P,{variant:"ghost",size:"icon",className:"h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity absolute top-1 right-1",onClick:()=>x(l.id),children:e.jsx(z,{className:"h-3 w-3 text-destructive"})})]})},l.id))]})]}),e.jsx("tbody",{children:s.map((l,w)=>e.jsxs("tr",{className:"group/row hover:bg-muted/30 transition-colors",children:[e.jsx("td",{className:"border-r border-b border-border bg-muted/30 p-2 text-center text-xs text-muted-foreground font-mono select-none sticky left-0 z-10 w-12 text-lato",children:w+1}),e.jsx("td",{className:"border-r border-b border-border p-2 font-medium bg-background relative w-64",children:e.jsxs("div",{className:"flex items-center justify-between group",children:[l.isHeader?e.jsx("span",{className:"font-bold text-primary",children:l.label}):e.jsx("span",{className:"cursor-pointer hover:text-primary transition-colors w-full",onDoubleClick:()=>!l.isAutoCalculated&&y({id:l.id,type:"row",value:l.label}),children:l.label}),!l.isAutoCalculated&&e.jsx(P,{variant:"ghost",size:"icon",className:"h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity absolute right-2",onClick:()=>m(l.id),children:e.jsx(z,{className:"h-3 w-3 text-destructive"})})]})}),a.map(_=>{var h;const N=(h=u[l.id])==null?void 0:h[_.id],n=(N==null?void 0:N.value)??null,r=(t==null?void 0:t.row)===l.id&&(t==null?void 0:t.col)===_.id;return e.jsx("td",{className:Y("border-r border-b border-border p-0 relative min-w-[120px]",r?"ring-2 ring-primary z-10":"",l.isHeader?"bg-muted/20 font-semibold":"",_.isYearEnd?"bg-primary/5 font-semibold":""),onClick:()=>v({row:l.id,col:_.id}),children:e.jsx(ge,{rowId:l.id,colId:_.id,value:n,row:l,isActive:r,onFocus:()=>v({row:l.id,col:_.id}),onUpdate:d=>k(l.id,_.id,d),onNavigate:j})},`${l.id}-${_.id}`)})]},l.id))})]})}),f&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-background/80 backdrop-blur-sm",onClick:()=>y(null),children:e.jsxs("div",{className:"bg-card p-4 rounded-lg shadow-lg border w-96",onClick:l=>l.stopPropagation(),children:[e.jsxs(ne,{children:["Edit ",f.type==="row"?"Row":"Column"," Label"]}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx($,{autoFocus:!0,value:f.value,onChange:l=>y({...f,value:l.target.value}),onKeyDown:l=>{l.key==="Enter"&&(f.type==="col"&&o&&o(f.id,f.value),y(null))}}),e.jsx(P,{onClick:()=>y(null),children:"Done"})]})]})})]})}const O=s=>{if(!(s!=null&&s.from)||!(s!=null&&s.to))return new Date().getFullYear(),[{id:"jan",label:"January",isProtected:!0},{id:"feb",label:"February",isProtected:!0},{id:"mar",label:"March",isProtected:!0},{id:"apr",label:"April",isProtected:!0},{id:"may",label:"May",isProtected:!0},{id:"jun",label:"June",isProtected:!0},{id:"jul",label:"July",isProtected:!0},{id:"aug",label:"August",isProtected:!0},{id:"sep",label:"September",isProtected:!0},{id:"oct",label:"October",isProtected:!0},{id:"nov",label:"November",isProtected:!0},{id:"dec",label:"December",isProtected:!0},{id:"year_end",label:"Year End",isProtected:!0,isYearEnd:!0}];const u=pe({start:le(s.from),end:ue(s.to)}).map(t=>({id:M(t,"MMM-yyyy").toLowerCase(),label:M(t,"MMM yyyy"),isProtected:!0}));return u.push({id:"year_end",label:"Period Total",isProtected:!0,isYearEnd:!0}),u},W=(s,a,u)=>{var t,v;try{const k=Object.keys(a).sort((j,S)=>S.length-j.length);let m=s;for(const j of k){const S=new RegExp(`\\b${j}\\b`,"g");if(S.test(m)){const o=((v=(t=a[j])==null?void 0:t[u])==null?void 0:v.value)??0;m=m.replace(S,`(${o})`)}}if(!/^[0-9+\-*/().\s]*$/.test(m))return null;const x=new Function(`return ${m}`)();return typeof x=="number"&&!isNaN(x)&&isFinite(x)?x:null}catch{return null}},I=[{id:"total_sales",label:"Total Sales",isAutoCalculated:!1,isCurrency:!0},{id:"sales_split_pct",label:"% Sales Split for the Year",isAutoCalculated:!1,isPercentage:!0},{id:"cost_sales_se",label:"Cost of Sales SE",isAutoCalculated:!1,isCurrency:!0},{id:"cost_sales_paye",label:"Cost of Sales PAYE Gross",isAutoCalculated:!1,isCurrency:!0},{id:"employee_ni",label:"Employee NI",isAutoCalculated:!1,isCurrency:!0},{id:"employee_pension",label:"Employee Pension",isAutoCalculated:!1,isCurrency:!0},{id:"total_cost_sales",label:"Total Cost of Sales",isAutoCalculated:!0,isCurrency:!0,isHeader:!0,formulaString:"cost_sales_se + cost_sales_paye + employee_ni + employee_pension"},{id:"apprenticeship_levy",label:"Apprenticeship Levy",isAutoCalculated:!1,isCurrency:!0},{id:"annual_leave",label:"Annual Leave Accrual",isAutoCalculated:!1,isCurrency:!0},{id:"other_expenses",label:"Other Expenses",isAutoCalculated:!1,isCurrency:!0},{id:"recruitment_cost",label:"Recruitment & Pass Cost",isAutoCalculated:!1,isCurrency:!0},{id:"overheads_mgmt",label:"Mgmt & Office Cost",isAutoCalculated:!1,isCurrency:!0},{id:"bank_interest",label:"Bank Interest",isAutoCalculated:!1,isCurrency:!0},{id:"cooperation_tax",label:"Cooperation Tax",isAutoCalculated:!1,isCurrency:!0},{id:"total_overheads",label:"Total Overheads",isAutoCalculated:!0,isCurrency:!0,isHeader:!0,formulaString:"apprenticeship_levy + annual_leave + other_expenses + recruitment_cost + overheads_mgmt + bank_interest + cooperation_tax"},{id:"total_cost",label:"Total Cost",isAutoCalculated:!0,isCurrency:!0,isHeader:!0,formulaString:"total_cost_sales + total_overheads"},{id:"worked_hours",label:"Total Worked Hours",isAutoCalculated:!1,isCurrency:!1},{id:"avg_hourly_charge",label:"Avg Hourly Charge",isAutoCalculated:!0,isCurrency:!0,formulaString:"total_sales / worked_hours"},{id:"gross_hourly_pay",label:"Gross Hourly Pay",isAutoCalculated:!0,isCurrency:!0,formulaString:"total_cost_sales / worked_hours"},{id:"gross_hourly_margin",label:"Gross Hourly Margin",isAutoCalculated:!0,isCurrency:!0,formulaString:"avg_hourly_charge - gross_hourly_pay"},{id:"net_cost_per_hour",label:"Net Cost per Hour",isAutoCalculated:!0,isCurrency:!0,formulaString:"total_cost / worked_hours"},{id:"gross_pl_value",label:"Gross P&L Value",isAutoCalculated:!0,isCurrency:!0,formulaString:"total_sales - cost_sales_se"},{id:"net_pl",label:"Net P&L",isAutoCalculated:!0,isCurrency:!0,formulaString:"total_sales - total_cost"},{id:"total_net_margin",label:"Total Net Margin",isAutoCalculated:!0,isCurrency:!0,formulaString:"net_pl / worked_hours"},{id:"hours_breakeven",label:"Hours for Breakeven",isAutoCalculated:!0,formulaString:"(other_expenses + overheads_mgmt) / gross_hourly_margin"},{id:"value_breakeven",label:"Total Value for Breakeven",isAutoCalculated:!0,isCurrency:!0,formulaString:"hours_breakeven * net_cost_per_hour"},{id:"avg_hourly_charge_2026",label:"Avg Hourly Charge Rate Future",isAutoCalculated:!0,isCurrency:!0,formulaString:"avg_hourly_charge * 1.06"},{id:"sales_budget_2026",label:"Projected Sales Budget 30% Uplift",isAutoCalculated:!0,isCurrency:!0,formulaString:"total_sales * 1.3"},{id:"sales_target_hours",label:"Sales Target in Hours",isAutoCalculated:!0,formulaString:"sales_budget_2026 / avg_hourly_charge_2026"},{id:"variance_2025",label:"Variance",isAutoCalculated:!0,formulaString:"sales_target_hours - worked_hours"}];function q(s,a){const u={};for(const t of s){u[t.id]={};for(const v of a)u[t.id][v.id]={value:null,isEditable:!t.isAutoCalculated&&!v.isYearEnd,source:"manual"}}return u}function E(s,a,u){var j,S;const t=JSON.parse(JSON.stringify(s));for(const o of u.filter(f=>!f.isYearEnd))for(const f of a)f.formulaString?t[f.id][o.id]={...t[f.id][o.id],value:W(f.formulaString,t,o.id),isEditable:!1,source:"calculated"}:f.formula&&(t[f.id][o.id]={...t[f.id][o.id],value:f.formula(t,f.id,o.id),isEditable:!1,source:"calculated"});const v=a.find(o=>o.id==="total_sales"),k=a.find(o=>o.id==="sales_split_pct"),m=u.find(o=>o.isYearEnd);if(v&&k&&m){let o=0;const f=u.filter(y=>!y.isYearEnd);o=f.reduce((y,l)=>{var w,_;return y+(((_=(w=t.total_sales)==null?void 0:w[l.id])==null?void 0:_.value)??0)},0);for(const y of f){const l=((S=(j=t.total_sales)==null?void 0:j[y.id])==null?void 0:S.value)??0,w=o!==0?l/o*100:0;t.sales_split_pct[y.id]={value:w,isEditable:!1,source:"calculated"}}t.sales_split_pct[m.id]={value:o!==0?100:0,isEditable:!1,source:"calculated"}}const x=u.find(o=>o.isYearEnd);if(x)for(const o of a){if(o.id==="sales_split_pct")continue;const f=u.filter(y=>!y.isYearEnd).reduce((y,l)=>{var w,_;return y+(((_=(w=t[o.id])==null?void 0:w[l.id])==null?void 0:_.value)??0)},0);o.formulaString||o.isAutoCalculated?o.formulaString?t[o.id][x.id]={value:W(o.formulaString,t,x.id),isEditable:!1,source:"calculated"}:o.formula?t[o.id][x.id]={value:o.formula(t,o.id,x.id),isEditable:!1,source:"calculated"}:t[o.id][x.id]={value:f,isEditable:!1,source:"calculated"}:t[o.id][x.id]={value:f,isEditable:!1,source:"calculated"}}return t}function ve(s){const[a,u]=p.useState(I),[t,v]=p.useState(()=>O(s)),[k,m]=p.useState(()=>E(q(I,O(s)),I,O(s))),[x,j]=p.useState(null);p.useEffect(()=>{const n=O(s);v(n);let r=q(a,n);s!=null&&s.from&&(s!=null&&s.to)?(async()=>{try{const d=M(s.from,"yyyy-MM-dd"),b=M(s.to,"yyyy-MM-dd"),g=localStorage.getItem("auth_token"),i=await fetch(`/api/financial-summary/metrics?start=${d}&end=${b}`,{headers:{Authorization:`Bearer ${g}`},credentials:"include"});if(i.status===401){console.error("Unauthorized: Redirecting to login"),window.location.href="/auth";return}if(i.ok){const c=i.headers.get("content-type");if(c&&c.indexOf("application/json")!==-1){const C=await i.json(),X={January:"jan",February:"feb",March:"mar",April:"apr",May:"may",June:"jun",July:"jul",August:"aug",September:"sep",October:"oct",November:"nov",December:"dec"};for(const[L,F]of Object.entries(C)){const[D,Z]=L.split("-"),H=X[Z];if(!H)continue;const A=`${H}-${D}`;n.find(ee=>ee.id===A)&&(r.total_sales&&r.total_sales[A]&&(r.total_sales[A].value=F.total_sales,r.total_sales[A].source="backend"),r.cost_sales_se&&r.cost_sales_se[A]&&(r.cost_sales_se[A].value=F.cost_sales_se,r.cost_sales_se[A].source="backend"),r.cost_sales_paye&&r.cost_sales_paye[A]&&(r.cost_sales_paye[A].value=F.cost_sales_paye,r.cost_sales_paye[A].source="backend"),r.worked_hours&&r.worked_hours[A]&&(r.worked_hours[A].value=F.total_hours,r.worked_hours[A].source="backend"))}try{const L=await fetch("/api/financial-summary/overrides",{headers:{Authorization:`Bearer ${g}`},credentials:"include"});if(L.ok){const F=await L.json();for(const D of F)r[D.row_id]&&r[D.row_id][D.col_id]!==void 0&&(r[D.row_id][D.col_id]={...r[D.row_id][D.col_id],value:D.value,source:"manual"})}}catch{}m(E(r,a,n))}else console.error("Received non-JSON response from API"),m(E(r,a,n))}else console.error("API Error",i.status,i.statusText),m(E(r,a,n))}catch(d){console.error("Failed to fetch metrics",d),m(E(r,a,n))}})():m(E(r,a,n))},[s]);const S=p.useCallback((n,r,h)=>{m(b=>{const g={...b};return g[n]={...g[n]},g[n][r]={...g[n][r],value:h,source:"manual"},E(g,a,t)});const d=localStorage.getItem("auth_token");fetch("/api/financial-summary/overrides",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`},credentials:"include",body:JSON.stringify({row_id:n,col_id:r,value:h})}).catch(b=>console.warn("Failed to save override:",b))},[a,t]),o=p.useCallback((n,r)=>{u(h=>{const d=h.map(b=>b.id===n?{...b,formulaString:r}:b);return m(b=>E(b,d,t)),d})},[t]),f=p.useCallback(n=>{const r=`custom_${Date.now()}`,h={id:r,label:n,isAutoCalculated:!1,isCurrency:!0};u(d=>{const b=[...d,h];return m(g=>{const i={...g};i[r]={};for(const c of t)i[r][c.id]={value:null,isEditable:!c.isYearEnd,source:"manual"};return E(i,b,t)}),b})},[t]),y=p.useCallback(n=>{u(r=>r.filter(h=>h.id!==n)),m(r=>{const h={...r};return delete h[n],h})},[]),l=p.useCallback(n=>{const r=`col_${Date.now()}`,h={id:r,label:n};v(d=>{const b=d.findIndex(i=>i.isYearEnd),g=[...d];return g.splice(b,0,h),m(i=>{const c={...i};for(const C of a)c[C.id]={...c[C.id]},c[C.id][r]={value:null,isEditable:!C.isAutoCalculated,source:"manual"};return E(c,a,g)}),g})},[a]),w=p.useCallback(n=>{v(r=>{const h=r.filter(d=>d.id!==n);return m(d=>{const b={...d};for(const g of Object.keys(b)){const{[n]:i,...c}=b[g];b[g]=c}return E(b,a,h)}),h})},[a]),_=p.useCallback((n,r)=>{v(h=>h.map(d=>d.id===n?{...d,label:r}:d))},[]),N=p.useCallback(n=>{if(!x)return;const r=a.filter(c=>!c.isAutoCalculated),h=t.filter(c=>!c.isYearEnd),d=r.findIndex(c=>c.id===x.row),b=h.findIndex(c=>c.id===x.col);if(d===-1||b===-1)return;let g=d,i=b;switch(n){case"up":g=Math.max(0,d-1);break;case"down":g=Math.min(r.length-1,d+1);break;case"left":i=Math.max(0,b-1);break;case"right":i=Math.min(h.length-1,b+1);break}j({row:r[g].id,col:h[i].id})},[x,a,t]);return{rows:a,columns:t,data:k,updateCell:S,updateRowFormula:o,addRow:f,deleteRow:y,addColumn:l,deleteColumn:w,renameColumn:_,activeCell:x,setActiveCell:j,navigateCell:N}}const Q="financial_summary_date_range";function je(){try{const s=localStorage.getItem(Q);if(s){const a=JSON.parse(s);return{from:new Date(a.from),to:new Date(a.to)}}}catch{}return{from:be(new Date),to:xe(new Date)}}function Me(){const[s,a]=p.useState(je),u=C=>{a(C),C!=null&&C.from&&(C!=null&&C.to)&&localStorage.setItem(Q,JSON.stringify({from:C.from.toISOString(),to:C.to.toISOString()}))},{rows:t,columns:v,data:k,activeCell:m,setActiveCell:x,updateCell:j,addRow:S,deleteRow:o,addColumn:f,deleteColumn:y,navigateCell:l,updateRowFormula:w}=ve(s),[_,N]=p.useState(""),[n,r]=p.useState(""),[h,d]=p.useState(!1),[b,g]=p.useState(!1),i=()=>{_.trim()&&(S(_.trim()),N(""),d(!1))},c=()=>{n.trim()&&(f(n.trim()),r(""),g(!1))};return e.jsx(oe,{noPadding:!0,fullWidth:!0,children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-border bg-card/50 shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx(ie,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-foreground",children:"Financial Summary."}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Annual budget and performance spreadsheet"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(ce,{children:[e.jsx(de,{asChild:!0,children:e.jsxs(P,{id:"date",variant:"outline",className:Y("w-[260px] justify-start text-left font-normal",!s&&"text-muted-foreground"),children:[e.jsx(me,{className:"mr-2 h-4 w-4"}),s!=null&&s.from?s.to?e.jsxs(e.Fragment,{children:[M(s.from,"LLL dd, y")," -"," ",M(s.to,"LLL dd, y")]}):M(s.from,"LLL dd, y"):e.jsx("span",{children:"Pick a date"})]})}),e.jsx(fe,{className:"w-auto p-0",align:"end",children:e.jsx(he,{initialFocus:!0,mode:"range",defaultMonth:s==null?void 0:s.from,selected:s,onSelect:u,numberOfMonths:2,captionLayout:"dropdown-buttons",fromYear:2020,toYear:2030})})]}),e.jsxs(B,{open:h,onOpenChange:d,children:[e.jsx(J,{asChild:!0,children:e.jsxs(P,{variant:"outline",size:"sm",children:[e.jsx(U,{className:"h-4 w-4 mr-1"})," Add Row"]})}),e.jsxs(K,{children:[e.jsx(G,{children:e.jsx(V,{children:"Add New Row"})}),e.jsx($,{placeholder:"Row label...",value:_,onChange:C=>N(C.target.value),onKeyDown:C=>C.key==="Enter"&&i()}),e.jsx(R,{children:e.jsx(P,{onClick:i,disabled:!_.trim(),children:"Add"})})]})]}),e.jsxs(B,{open:b,onOpenChange:g,children:[e.jsx(J,{asChild:!0,children:e.jsxs(P,{variant:"outline",size:"sm",children:[e.jsx(U,{className:"h-4 w-4 mr-1"})," Add Column"]})}),e.jsxs(K,{children:[e.jsx(G,{children:e.jsx(V,{children:"Add New Column"})}),e.jsx($,{placeholder:"Column label...",value:n,onChange:C=>r(C.target.value),onKeyDown:C=>C.key==="Enter"&&c()}),e.jsx(R,{children:e.jsx(P,{onClick:c,disabled:!n.trim(),children:"Add"})})]})]})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:e.jsx(Ce,{rows:t,columns:v,data:k,activeCell:m,setActiveCell:x,updateCell:j,deleteRow:o,deleteColumn:y,navigateCell:l,updateRowFormula:w})})]})})}export{Me as default};
