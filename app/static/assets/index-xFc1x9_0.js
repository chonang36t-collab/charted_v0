import{ab as F,r as x,j as e,T as ee,e as T,B as E,I as O,k as te,l as se,m as re,ac as ae}from"./index-CMe2uRZn.js";import{D as le,T as oe}from"./DashboardLayout-DmEMFtjV.js";import{L as ie}from"./label-CqqI5Hwu.js";import{T as H}from"./trash-2-Dk0mf_9s.js";import{e as ne,f as P,s as ue,P as de,a as ce,C as me,b as fe,d as be}from"./popover-zOwniTti.js";import{D as I,a as z,b as B,c as K,d as J,e as V}from"./dialog-Fc4j3dGH.js";import{P as G}from"./plus-B9FwX68p.js";import"./users-CHx3SRBU.js";function he(s,l){const n=F(s.start),t=F(s.end);let y=+n>+t;const w=y?+n:+t,f=y?t:n;f.setHours(0,0,0,0),f.setDate(1);let p=1;const v=[];for(;+f<=w;)v.push(F(f)),f.setMonth(f.getMonth()+p);return y?v.reverse():v}function pe(s){const l=F(s),n=l.getFullYear();return l.setFullYear(n+1,0,0),l.setHours(23,59,59,999),l}function xe(s,l){return s===null||s===0?"":l.isPercentage?`${s.toFixed(2)}%`:l.isCurrency?`£${s.toLocaleString("en-GB",{minimumFractionDigits:2,maximumFractionDigits:2})}`:s.toLocaleString("en-GB",{maximumFractionDigits:2})}function ge({rowId:s,colId:l,value:n,row:t,isActive:y,source:w,onFocus:f,onUpdate:p,onNavigate:v,updateRowFormula:k}){const[o,b]=x.useState(!1),[g,a]=x.useState(""),C=x.useRef(null),[_,S]=x.useState(!1),[d,r]=x.useState(t.formulaString||""),h=x.useCallback(()=>{b(!0),a(n!==null?String(n):""),setTimeout(()=>{var i;return(i=C.current)==null?void 0:i.focus()},0)},[n]),c=x.useCallback(()=>{b(!1);const i=parseFloat(g);p(g===""?null:isNaN(i)?n:i)},[g,p,n]),m=x.useCallback(()=>{S(!1),k&&d!==t.formulaString&&k(s,d)},[d,t.formulaString,s,k]),j=x.useCallback(i=>{i.key==="Enter"?c():i.key==="Escape"&&b(!1)},[c]);return x.useEffect(()=>{if(y&&!o&&!_){const i=u=>{["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(u.key)?(u.preventDefault(),v({ArrowUp:"up",ArrowDown:"down",ArrowLeft:"left",ArrowRight:"right"}[u.key])):!u.ctrlKey&&!u.altKey&&!u.metaKey&&u.key.length===1?(h(),a("")):u.key==="Enter"?(u.preventDefault(),h()):(u.key==="Backspace"||u.key==="Delete")&&p(null)};return window.addEventListener("keydown",i),()=>window.removeEventListener("keydown",i)}},[y,o,_,v,h,p]),o?e.jsx("input",{ref:C,type:"text",className:"w-full h-full px-2 py-1 outline-none bg-background text-center font-lato",value:g,onChange:i=>a(i.target.value),onBlur:c,onKeyDown:j}):e.jsxs(te,{delayDuration:300,children:[e.jsx(se,{asChild:!0,children:e.jsxs("div",{className:T("w-full h-full px-2 py-1 cursor-cell flex items-center justify-center font-lato relative group",t.isHeader&&"font-bold",w==="manual"&&t.isAutoCalculated&&"bg-yellow-50/50"),onClick:f,onDoubleClick:h,children:[xe(n,t),w==="manual"&&t.isAutoCalculated&&e.jsx("div",{className:"absolute top-0 right-0 w-2 h-2 bg-yellow-400 rounded-bl-full",title:"Manual Override"})]})}),(w||t.formulaString)&&e.jsx(re,{className:"p-3 min-w-[200px] pointer-events-auto",side:"bottom",children:e.jsxs("div",{className:"text-xs space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-semibold text-muted-foreground",children:"Source:"}),e.jsx("span",{children:w||"Unknown"})]}),t.formulaString&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"font-semibold text-muted-foreground",children:"Formula:"}),_?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(O,{value:d,onChange:i=>r(i.target.value),className:"h-6 text-xs",onKeyDown:i=>{i.key==="Enter"&&m(),i.key==="Escape"&&S(!1)}}),e.jsx(E,{size:"icon",variant:"ghost",className:"h-6 w-6",onClick:m,children:e.jsx("span",{className:"text-green-500",children:"✓"})})]}):e.jsxs("div",{className:"bg-muted px-2 py-1 rounded font-mono cursor-pointer hover:bg-muted/80 flex justify-between items-center group/formula",onClick:i=>{i.preventDefault(),S(!0),r(t.formulaString||"")},children:[t.formulaString,e.jsx("span",{className:"opacity-0 group-hover/formula:opacity-100 text-[10px] text-muted-foreground ml-2",children:"Edit"})]})]})]})})]})}function ye(s){let l="",n=s;for(;n>=0;)l=String.fromCharCode(n%26+65)+l,n=Math.floor(n/26)-1;return l}function _e({rows:s,columns:l,data:n,activeCell:t,setActiveCell:y,updateCell:w,deleteRow:f,deleteColumn:p,navigateCell:v,updateRowFormula:k,renameColumn:o}){const[b,g]=x.useState(null);return e.jsxs("div",{className:"flex-1 overflow-auto relative border border-border rounded-md bg-background",children:[e.jsx(ee,{children:e.jsxs("table",{className:"w-full border-collapse table-fixed text-sm",children:[e.jsxs("thead",{className:"sticky top-0 z-20 bg-muted/90 backdrop-blur-sm shadow-sm",children:[e.jsxs("tr",{children:[e.jsx("th",{className:"w-12 border-b border-border bg-muted p-1 text-center text-xs text-muted-foreground font-normal select-none relative group",children:e.jsx("div",{className:"absolute inset-0 bg-muted/50"})}),e.jsx("th",{className:"w-64 border-b border-r border-border bg-muted p-2 text-left font-medium text-muted-foreground"}),l.map((a,C)=>e.jsx("th",{className:"border-b border-r border-border bg-muted p-1 text-center text-xs font-normal text-muted-foreground select-none relative min-w-[120px]",children:ye(C)},`excel-${C}`))]}),e.jsxs("tr",{children:[e.jsx("th",{className:"w-12 border-b border-border bg-background p-2"}),e.jsx("th",{className:"w-64 border-b border-r border-border bg-background p-2 text-left font-semibold text-foreground",children:"Metric / Account"}),l.map(a=>e.jsx("th",{className:T("relative border-b border-r border-border bg-background p-2 text-right font-semibold min-w-[120px]",a.isYearEnd?"text-primary/80 bg-primary/5":"text-foreground"),children:e.jsxs("div",{className:"flex items-center justify-end gap-2 group",children:[e.jsx("span",{className:"cursor-pointer hover:text-primary transition-colors py-1",onDoubleClick:()=>!a.isProtected&&g({id:a.id,type:"col",value:a.label}),children:a.label}),!a.isProtected&&e.jsx(E,{variant:"ghost",size:"icon",className:"h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity absolute top-1 right-1",onClick:()=>p(a.id),children:e.jsx(H,{className:"h-3 w-3 text-destructive"})})]})},a.id))]})]}),e.jsx("tbody",{children:s.map((a,C)=>e.jsxs("tr",{className:"group/row hover:bg-muted/30 transition-colors",children:[e.jsx("td",{className:"border-r border-b border-border bg-muted/30 p-2 text-center text-xs text-muted-foreground font-mono select-none sticky left-0 z-10 w-12 text-lato",children:C+1}),e.jsx("td",{className:"border-r border-b border-border p-2 font-medium bg-background relative w-64",children:e.jsxs("div",{className:"flex items-center justify-between group",children:[a.isHeader?e.jsx("span",{className:"font-bold text-primary",children:a.label}):e.jsx("span",{className:"cursor-pointer hover:text-primary transition-colors w-full",onDoubleClick:()=>!a.isAutoCalculated&&g({id:a.id,type:"row",value:a.label}),children:a.label}),!a.isAutoCalculated&&e.jsx(E,{variant:"ghost",size:"icon",className:"h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity absolute right-2",onClick:()=>f(a.id),children:e.jsx(H,{className:"h-3 w-3 text-destructive"})})]})}),l.map(_=>{var h;const S=(h=n[a.id])==null?void 0:h[_.id],d=(S==null?void 0:S.value)??null,r=(t==null?void 0:t.row)===a.id&&(t==null?void 0:t.col)===_.id;return e.jsx("td",{className:T("border-r border-b border-border p-0 relative min-w-[120px]",r?"ring-2 ring-primary z-10":"",a.isHeader?"bg-muted/20 font-semibold":"",_.isYearEnd?"bg-primary/5 font-semibold":""),onClick:()=>y({row:a.id,col:_.id}),children:e.jsx(ge,{rowId:a.id,colId:_.id,value:d,row:a,isActive:r,onFocus:()=>y({row:a.id,col:_.id}),onUpdate:c=>w(a.id,_.id,c),onNavigate:v})},`${a.id}-${_.id}`)})]},a.id))})]})}),b&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-background/80 backdrop-blur-sm",onClick:()=>g(null),children:e.jsxs("div",{className:"bg-card p-4 rounded-lg shadow-lg border w-96",onClick:a=>a.stopPropagation(),children:[e.jsxs(ie,{children:["Edit ",b.type==="row"?"Row":"Column"," Label"]}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx(O,{autoFocus:!0,value:b.value,onChange:a=>g({...b,value:a.target.value}),onKeyDown:a=>{a.key==="Enter"&&(b.type==="col"&&o&&o(b.id,b.value),g(null))}}),e.jsx(E,{onClick:()=>g(null),children:"Done"})]})]})})]})}const L=s=>{if(!(s!=null&&s.from)||!(s!=null&&s.to))return new Date().getFullYear(),[{id:"jan",label:"January",isProtected:!0},{id:"feb",label:"February",isProtected:!0},{id:"mar",label:"March",isProtected:!0},{id:"apr",label:"April",isProtected:!0},{id:"may",label:"May",isProtected:!0},{id:"jun",label:"June",isProtected:!0},{id:"jul",label:"July",isProtected:!0},{id:"aug",label:"August",isProtected:!0},{id:"sep",label:"September",isProtected:!0},{id:"oct",label:"October",isProtected:!0},{id:"nov",label:"November",isProtected:!0},{id:"dec",label:"December",isProtected:!0},{id:"year_end",label:"Year End",isProtected:!0,isYearEnd:!0}];const n=he({start:ae(s.from),end:ne(s.to)}).map(t=>({id:P(t,"MMM-yyyy").toLowerCase(),label:P(t,"MMM yyyy"),isProtected:!0}));return n.push({id:"year_end",label:"Period Total",isProtected:!0,isYearEnd:!0}),n},U=(s,l,n)=>{var t,y;try{const w=Object.keys(l).sort((v,k)=>k.length-v.length);let f=s;for(const v of w){const k=new RegExp(`\\b${v}\\b`,"g");if(k.test(f)){const o=((y=(t=l[v])==null?void 0:t[n])==null?void 0:y.value)??0;f=f.replace(k,`(${o})`)}}if(!/^[0-9+\-*/().\s]*$/.test(f))return null;const p=new Function(`return ${f}`)();return typeof p=="number"&&!isNaN(p)&&isFinite(p)?p:null}catch{return null}},Y=[{id:"total_sales",label:"Total Sales",isAutoCalculated:!1,isCurrency:!0},{id:"sales_split_pct",label:"% Sales Split for the Year",isAutoCalculated:!1,isPercentage:!0},{id:"cost_sales_se",label:"Cost of Sales SE",isAutoCalculated:!1,isCurrency:!0},{id:"cost_sales_paye",label:"Cost of Sales PAYE Gross",isAutoCalculated:!1,isCurrency:!0},{id:"employee_ni",label:"Employee NI",isAutoCalculated:!1,isCurrency:!0},{id:"employee_pension",label:"Employee Pension",isAutoCalculated:!1,isCurrency:!0},{id:"total_cost_sales",label:"Total Cost of Sales",isAutoCalculated:!0,isCurrency:!0,isHeader:!0,formulaString:"cost_sales_se + cost_sales_paye + employee_ni + employee_pension"},{id:"apprenticeship_levy",label:"Apprenticeship Levy",isAutoCalculated:!1,isCurrency:!0},{id:"annual_leave",label:"Annual Leave Accrual",isAutoCalculated:!1,isCurrency:!0},{id:"other_expenses",label:"Other Expenses",isAutoCalculated:!1,isCurrency:!0},{id:"recruitment_cost",label:"Recruitment & Pass Cost",isAutoCalculated:!1,isCurrency:!0},{id:"overheads_mgmt",label:"Mgmt & Office Cost",isAutoCalculated:!1,isCurrency:!0},{id:"bank_interest",label:"Bank Interest",isAutoCalculated:!1,isCurrency:!0},{id:"cooperation_tax",label:"Cooperation Tax",isAutoCalculated:!1,isCurrency:!0},{id:"total_overheads",label:"Total Overheads",isAutoCalculated:!0,isCurrency:!0,isHeader:!0,formulaString:"apprenticeship_levy + annual_leave + other_expenses + recruitment_cost + overheads_mgmt + bank_interest + cooperation_tax"},{id:"total_cost",label:"Total Cost",isAutoCalculated:!0,isCurrency:!0,isHeader:!0,formulaString:"total_cost_sales + total_overheads"},{id:"worked_hours",label:"Total Worked Hours",isAutoCalculated:!1,isCurrency:!1},{id:"avg_hourly_charge",label:"Avg Hourly Charge",isAutoCalculated:!0,isCurrency:!0,formulaString:"total_sales / worked_hours"},{id:"gross_hourly_pay",label:"Gross Hourly Pay",isAutoCalculated:!0,isCurrency:!0,formulaString:"total_cost_sales / worked_hours"},{id:"gross_hourly_margin",label:"Gross Hourly Margin",isAutoCalculated:!0,isCurrency:!0,formulaString:"avg_hourly_charge - gross_hourly_pay"},{id:"net_cost_per_hour",label:"Net Cost per Hour",isAutoCalculated:!0,isCurrency:!0,formulaString:"total_cost / worked_hours"},{id:"gross_pl_value",label:"Gross P&L Value",isAutoCalculated:!0,isCurrency:!0,formulaString:"total_sales - cost_sales_se"},{id:"net_pl",label:"Net P&L",isAutoCalculated:!0,isCurrency:!0,formulaString:"total_sales - total_cost"},{id:"total_net_margin",label:"Total Net Margin",isAutoCalculated:!0,isCurrency:!0,formulaString:"net_pl / worked_hours"},{id:"hours_breakeven",label:"Hours for Breakeven",isAutoCalculated:!0,formulaString:"(other_expenses + overheads_mgmt) / gross_hourly_margin"},{id:"value_breakeven",label:"Total Value for Breakeven",isAutoCalculated:!0,isCurrency:!0,formulaString:"hours_breakeven * net_cost_per_hour"},{id:"avg_hourly_charge_2026",label:"Avg Hourly Charge Rate Future",isAutoCalculated:!0,isCurrency:!0,formulaString:"avg_hourly_charge * 1.06"},{id:"sales_budget_2026",label:"Projected Sales Budget 30% Uplift",isAutoCalculated:!0,isCurrency:!0,formulaString:"total_sales * 1.3"},{id:"sales_target_hours",label:"Sales Target in Hours",isAutoCalculated:!0,formulaString:"sales_budget_2026 / avg_hourly_charge_2026"},{id:"variance_2025",label:"Variance",isAutoCalculated:!0,formulaString:"sales_target_hours - worked_hours"}];function W(s,l){const n={};for(const t of s){n[t.id]={};for(const y of l)n[t.id][y.id]={value:null,isEditable:!t.isAutoCalculated&&!y.isYearEnd,source:"manual"}}return n}function A(s,l,n){var v,k;const t=JSON.parse(JSON.stringify(s));for(const o of n.filter(b=>!b.isYearEnd))for(const b of l)b.formulaString?t[b.id][o.id]={...t[b.id][o.id],value:U(b.formulaString,t,o.id),isEditable:!1,source:"calculated"}:b.formula&&(t[b.id][o.id]={...t[b.id][o.id],value:b.formula(t,b.id,o.id),isEditable:!1,source:"calculated"});const y=l.find(o=>o.id==="total_sales"),w=l.find(o=>o.id==="sales_split_pct"),f=n.find(o=>o.isYearEnd);if(y&&w&&f){let o=0;const b=n.filter(g=>!g.isYearEnd);o=b.reduce((g,a)=>{var C,_;return g+(((_=(C=t.total_sales)==null?void 0:C[a.id])==null?void 0:_.value)??0)},0);for(const g of b){const a=((k=(v=t.total_sales)==null?void 0:v[g.id])==null?void 0:k.value)??0,C=o!==0?a/o*100:0;t.sales_split_pct[g.id]={value:C,isEditable:!1,source:"calculated"}}t.sales_split_pct[f.id]={value:o!==0?100:0,isEditable:!1,source:"calculated"}}const p=n.find(o=>o.isYearEnd);if(p)for(const o of l){if(o.id==="sales_split_pct")continue;const b=n.filter(g=>!g.isYearEnd).reduce((g,a)=>{var C,_;return g+(((_=(C=t[o.id])==null?void 0:C[a.id])==null?void 0:_.value)??0)},0);o.formulaString||o.isAutoCalculated?o.formulaString?t[o.id][p.id]={value:U(o.formulaString,t,p.id),isEditable:!1,source:"calculated"}:o.formula?t[o.id][p.id]={value:o.formula(t,o.id,p.id),isEditable:!1,source:"calculated"}:t[o.id][p.id]={value:b,isEditable:!1,source:"calculated"}:t[o.id][p.id]={value:b,isEditable:!1,source:"calculated"}}return t}function Ce(s){const[l,n]=x.useState(Y),[t,y]=x.useState(()=>L(s)),[w,f]=x.useState(()=>A(W(Y,L(s)),Y,L(s))),[p,v]=x.useState(null);x.useEffect(()=>{const d=L(s);y(d);let r=W(l,d);s!=null&&s.from&&(s!=null&&s.to)?(async()=>{try{const c=P(s.from,"yyyy-MM-dd"),m=P(s.to,"yyyy-MM-dd"),j=localStorage.getItem("auth_token"),i=await fetch(`/api/financial-summary/metrics?start=${c}&end=${m}`,{headers:{Authorization:`Bearer ${j}`},credentials:"include"});if(i.status===401){console.error("Unauthorized: Redirecting to login"),window.location.href="/auth";return}if(i.ok){const u=i.headers.get("content-type");if(u&&u.indexOf("application/json")!==-1){const D=await i.json(),R={January:"jan",February:"feb",March:"mar",April:"apr",May:"may",June:"jun",July:"jul",August:"aug",September:"sep",October:"oct",November:"nov",December:"dec"};for(const[q,M]of Object.entries(D)){const[Q,X]=q.split("-"),$=R[X];if(!$)continue;const N=`${$}-${Q}`;d.find(Z=>Z.id===N)&&(r.total_sales&&r.total_sales[N]&&(r.total_sales[N].value=M.total_sales,r.total_sales[N].source="backend"),r.cost_sales_se&&r.cost_sales_se[N]&&(r.cost_sales_se[N].value=M.cost_sales_se,r.cost_sales_se[N].source="backend"),r.cost_sales_paye&&r.cost_sales_paye[N]&&(r.cost_sales_paye[N].value=M.cost_sales_paye,r.cost_sales_paye[N].source="backend"),r.worked_hours&&r.worked_hours[N]&&(r.worked_hours[N].value=M.total_hours,r.worked_hours[N].source="backend"))}f(A(r,l,d))}else console.error("Received non-JSON response from API"),f(A(r,l,d))}else console.error("API Error",i.status,i.statusText),f(A(r,l,d))}catch(c){console.error("Failed to fetch metrics",c),f(A(r,l,d))}})():f(A(r,l,d))},[s]);const k=x.useCallback((d,r,h)=>{f(c=>{const m={...c};return m[d]={...m[d]},m[d][r]={...m[d][r],value:h,source:"manual"},A(m,l,t)})},[l,t]),o=x.useCallback((d,r)=>{n(h=>{const c=h.map(m=>m.id===d?{...m,formulaString:r}:m);return f(m=>A(m,c,t)),c})},[t]),b=x.useCallback(d=>{const r=`custom_${Date.now()}`,h={id:r,label:d,isAutoCalculated:!1,isCurrency:!0};n(c=>{const m=[...c,h];return f(j=>{const i={...j};i[r]={};for(const u of t)i[r][u.id]={value:null,isEditable:!u.isYearEnd,source:"manual"};return A(i,m,t)}),m})},[t]),g=x.useCallback(d=>{n(r=>r.filter(h=>h.id!==d)),f(r=>{const h={...r};return delete h[d],h})},[]),a=x.useCallback(d=>{const r=`col_${Date.now()}`,h={id:r,label:d};y(c=>{const m=c.findIndex(i=>i.isYearEnd),j=[...c];return j.splice(m,0,h),f(i=>{const u={...i};for(const D of l)u[D.id]={...u[D.id]},u[D.id][r]={value:null,isEditable:!D.isAutoCalculated,source:"manual"};return A(u,l,j)}),j})},[l]),C=x.useCallback(d=>{y(r=>{const h=r.filter(c=>c.id!==d);return f(c=>{const m={...c};for(const j of Object.keys(m)){const{[d]:i,...u}=m[j];m[j]=u}return A(m,l,h)}),h})},[l]),_=x.useCallback((d,r)=>{y(h=>h.map(c=>c.id===d?{...c,label:r}:c))},[]),S=x.useCallback(d=>{if(!p)return;const r=l.filter(u=>!u.isAutoCalculated),h=t.filter(u=>!u.isYearEnd),c=r.findIndex(u=>u.id===p.row),m=h.findIndex(u=>u.id===p.col);if(c===-1||m===-1)return;let j=c,i=m;switch(d){case"up":j=Math.max(0,c-1);break;case"down":j=Math.min(r.length-1,c+1);break;case"left":i=Math.max(0,m-1);break;case"right":i=Math.min(h.length-1,m+1);break}v({row:r[j].id,col:h[i].id})},[p,l,t]);return{rows:l,columns:t,data:w,updateCell:k,updateRowFormula:o,addRow:b,deleteRow:g,addColumn:a,deleteColumn:C,renameColumn:_,activeCell:p,setActiveCell:v,navigateCell:S}}function De(){const[s,l]=x.useState({from:ue(new Date),to:pe(new Date)}),{rows:n,columns:t,data:y,activeCell:w,setActiveCell:f,updateCell:p,addRow:v,deleteRow:k,addColumn:o,deleteColumn:b,navigateCell:g,updateRowFormula:a}=Ce(s),[C,_]=x.useState(""),[S,d]=x.useState(""),[r,h]=x.useState(!1),[c,m]=x.useState(!1),j=()=>{C.trim()&&(v(C.trim()),_(""),h(!1))},i=()=>{S.trim()&&(o(S.trim()),d(""),m(!1))};return e.jsx(le,{noPadding:!0,fullWidth:!0,children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-border bg-card/50 shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx(oe,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-foreground",children:"Financial Summary."}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Annual budget and performance spreadsheet"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(de,{children:[e.jsx(ce,{asChild:!0,children:e.jsxs(E,{id:"date",variant:"outline",className:T("w-[260px] justify-start text-left font-normal",!s&&"text-muted-foreground"),children:[e.jsx(me,{className:"mr-2 h-4 w-4"}),s!=null&&s.from?s.to?e.jsxs(e.Fragment,{children:[P(s.from,"LLL dd, y")," -"," ",P(s.to,"LLL dd, y")]}):P(s.from,"LLL dd, y"):e.jsx("span",{children:"Pick a date"})]})}),e.jsx(fe,{className:"w-auto p-0",align:"end",children:e.jsx(be,{initialFocus:!0,mode:"range",defaultMonth:s==null?void 0:s.from,selected:s,onSelect:l,numberOfMonths:2,captionLayout:"dropdown-buttons",fromYear:2020,toYear:2030})})]}),e.jsxs(I,{open:r,onOpenChange:h,children:[e.jsx(z,{asChild:!0,children:e.jsxs(E,{variant:"outline",size:"sm",children:[e.jsx(G,{className:"h-4 w-4 mr-1"})," Add Row"]})}),e.jsxs(B,{children:[e.jsx(K,{children:e.jsx(J,{children:"Add New Row"})}),e.jsx(O,{placeholder:"Row label...",value:C,onChange:u=>_(u.target.value),onKeyDown:u=>u.key==="Enter"&&j()}),e.jsx(V,{children:e.jsx(E,{onClick:j,disabled:!C.trim(),children:"Add"})})]})]}),e.jsxs(I,{open:c,onOpenChange:m,children:[e.jsx(z,{asChild:!0,children:e.jsxs(E,{variant:"outline",size:"sm",children:[e.jsx(G,{className:"h-4 w-4 mr-1"})," Add Column"]})}),e.jsxs(B,{children:[e.jsx(K,{children:e.jsx(J,{children:"Add New Column"})}),e.jsx(O,{placeholder:"Column label...",value:S,onChange:u=>d(u.target.value),onKeyDown:u=>u.key==="Enter"&&i()}),e.jsx(V,{children:e.jsx(E,{onClick:i,disabled:!S.trim(),children:"Add"})})]})]})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:e.jsx(_e,{rows:n,columns:t,data:y,activeCell:w,setActiveCell:f,updateCell:p,deleteRow:k,deleteColumn:b,navigateCell:g,updateRowFormula:a})})]})})}export{De as default};
