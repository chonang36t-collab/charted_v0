import{r as s,a as g,A as x,u as y,j as e}from"./index-DOJfk6yY.js";import{D as v,L as j}from"./DashboardLayout-ps7RHYUd.js";import{f as h}from"./popover-DNqNyveK.js";import{c as D,D as L,L as S,M as w,A as N,R as C}from"./LoadingOverlay-CdeonaC2.js";import{B as p}from"./button-C9T-8Bfs.js";import{T as M}from"./users-QHrJIStF.js";import"./select-BJoH3pJ0.js";import"./badge-BH_9jPuK.js";import"./card-YQ9ZWLYX.js";import"./AreaChart-Aqdz0Eyd.js";const R=(r,t)=>{const[d,m]=s.useState(null),[u,c]=s.useState(!1),{toast:l}=g(),n=async()=>{c(!0);try{const o=new URLSearchParams({start:h(r.from,"yyyy-MM-dd"),end:h(r.to,"yyyy-MM-dd")});t&&t.length>0&&t.forEach(i=>o.append("locations",i));const a=await fetch(`${x.SALES_SUMMARY.replace("sales-summary","financial-summary")}?${o}`,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});if(a.ok){const i=await a.json();m(i)}else l({title:"Error",description:"Could not fetch financial data",variant:"destructive"})}catch{l({title:"Error",description:"Failed to connect to server",variant:"destructive"})}finally{c(!1)}};return s.useEffect(()=>{n()},[r,t]),{financialData:d,isLoading:u,refetch:n}};function P(){const r=y(),[t,d]=s.useState({from:new Date(2025,0,1),to:new Date(2025,8,30)}),[m,u]=s.useState(!1),[c,l]=s.useState(t),[n,o]=s.useState([]),{financialData:a,isLoading:i}=R(t,n),f=D(a,t);return e.jsx(v,{children:e.jsxs("div",{className:"flex flex-col h-screen",children:[e.jsx(L,{dateRange:t,onDateRangeChange:d,calendarOpen:m,onCalendarOpenChange:u,tempDateRange:c,onTempDateRangeChange:l,selectedLocations:n,onLocationsChange:o}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-2 px-1 py-1 bg-muted rounded-lg",children:[e.jsxs(p,{variant:"secondary",size:"sm",className:"gap-2 shadow-sm",children:[e.jsx(M,{className:"h-4 w-4"}),"Financial View"]}),e.jsxs(p,{variant:"ghost",size:"sm",className:"gap-2 text-muted-foreground hover:text-foreground",onClick:()=>r("/dashboard/operational"),children:[e.jsx(j,{className:"h-4 w-4"}),"Operational View"]})]})}),i&&e.jsx(S,{}),e.jsx(w,{metrics:f}),e.jsx(N,{salesData:a}),e.jsx(C,{data:(a==null?void 0:a.timeSeries)||[],aggregationLevel:(a==null?void 0:a.aggregationLevel)||"monthly"})]})})]})})}export{P as default};
