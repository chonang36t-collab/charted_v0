import{c as k,j as e,u as O,b as $,d as S,r as l,B as b}from"./index-2WjsGss6.js";import{U as A,L as N,D as H}from"./DashboardLayout-DBFARWzp.js";import{u as U,L as w,R as z}from"./LoadingOverlay-DWJcCDon.js";import{M as n,u as E,c as B,R as q}from"./RankingList-DbC5ze8z.js";import{D as I}from"./DashboardHeader-DfnZh7dP.js";import{P as f}from"./pound-sterling-BZ-WLBPg.js";import{C as W,a as G,b as J,d as K}from"./card-CRCtn11g.js";import{T as h}from"./users-CjddGF7O.js";import"./popover-BtNFMt9u.js";import"./generateCategoricalChart-J4N4nztS.js";import"./AreaChart-dGUxhkRH.js";import"./progress-CArLDkOp.js";import"./ellipsis-BBodAZxa.js";import"./locationUtils-Dem8sUoc.js";import"./index-CiktzzQ9.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=k("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]),X=({salesData:t,selectedMetric:a,onMetricSelect:i,onViewDetails:o})=>{var c,m,g,d;return e.jsxs("div",{className:"grid gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 w-full",children:[e.jsx(n,{title:"Avg Client Rate",value:`£${((c=t==null?void 0:t.avgClientPayPerHour)==null?void 0:c.toFixed(2))||"0.00"}`,icon:f,isSelected:a==="clientRate",onClick:()=>i==null?void 0:i("clientRate"),onViewDetails:()=>o==null?void 0:o("clientRate"),subtitle:"Per hour charged"}),e.jsx(n,{title:"Avg Staff Rate",value:`£${((m=t==null?void 0:t.avgStaffPayPerHour)==null?void 0:m.toFixed(2))||"0.00"}`,icon:A,isSelected:a==="staffRate",onClick:()=>i==null?void 0:i("staffRate"),onViewDetails:()=>o==null?void 0:o("staffRate"),subtitle:"Per hour paid"}),e.jsx(n,{title:"Total Overheads",value:`£${((g=t==null?void 0:t.totalOverheads)==null?void 0:g.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}))||"0.00"}`,icon:N,isSelected:a==="overheads",onClick:()=>i==null?void 0:i("overheads"),onViewDetails:()=>o==null?void 0:o("overheads"),subtitle:"Fixed & Variable expenses"}),e.jsx(n,{title:"Profit Margin",value:`${((d=t==null?void 0:t.profitMargin)==null?void 0:d.toFixed(1))||0}%`,icon:Q,isSelected:a==="profit",onClick:()=>i==null?void 0:i("profit"),onViewDetails:()=>o==null?void 0:o("profit"),subtitle:"Net margin (after overheads)"})]})},le=()=>{var j,R;const t=O();$();const{dateRange:a,setDateRange:i}=S(),[o,c]=l.useState(!1),[m,g]=l.useState(a),[d,L]=l.useState([]),[x,y]=l.useState([]),[r,u]=l.useState("revenue"),v=p=>{t(`/dashboard/metrics/${p}`)},{financialData:s,isLoading:F}=U(a,d,x),{topClientsRevenue:P,isLoadingClientsRev:T}=E(a,d,x),C=B(s,a);return e.jsx(H,{fullWidth:!0,children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx(I,{dateRange:a,onDateRangeChange:i,calendarOpen:o,onCalendarOpenChange:c,tempDateRange:m,onTempDateRangeChange:g,selectedLocations:d,onLocationsChange:L,selectedSites:x,onSitesChange:y}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsxs("div",{className:"px-4 pt-6 pb-6 space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-2 px-1 py-1 bg-muted rounded-lg",children:[e.jsxs(b,{variant:"secondary",size:"sm",className:"gap-2 shadow-sm",children:[e.jsx(h,{className:"h-4 w-4"}),"Financial View"]}),e.jsxs(b,{variant:"ghost",size:"sm",className:"gap-2 text-muted-foreground hover:text-foreground",onClick:()=>t("/dashboard/operational"),children:[e.jsx(N,{className:"h-4 w-4"}),"Operational View"]})]})}),F&&e.jsx(w,{}),e.jsxs("div",{className:"grid gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 w-full",children:[e.jsx(n,{title:"Total Revenue",value:`£${((j=s==null?void 0:s.totalRevenue)==null?void 0:j.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}))??"0.00"}`,subtitle:C.revenue.text,trend:C.revenue.trend,icon:f,isSelected:r==="revenue",onClick:()=>u("revenue"),onViewDetails:()=>v("revenue")}),e.jsx(n,{title:"Total Cost",value:`£${((R=s==null?void 0:s.totalCost)==null?void 0:R.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}))??"0.00"}`,subtitle:"Total expenses",icon:h,isSelected:r==="cost",onClick:()=>u("cost"),onViewDetails:()=>v("cost")}),e.jsx(n,{title:"Total Profit",value:`£${(((s==null?void 0:s.totalRevenue)??0)-((s==null?void 0:s.totalCost)??0)-((s==null?void 0:s.totalOverheads)??0)).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`,subtitle:"Net Profit",icon:h,isSelected:r==="profit",onClick:()=>u("profit"),onViewDetails:()=>v("profit")})]}),e.jsx(X,{salesData:s,selectedMetric:r,onMetricSelect:u,onViewDetails:v}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-7",children:[e.jsxs(W,{className:"col-span-5",children:[e.jsx(G,{children:e.jsxs(J,{children:[r==="revenue"&&"Revenue Overview",r==="cost"&&"Cost Overview",r==="profit"&&"Profit Trend",r==="shifts"&&"Shifts Trend",r==="clients"&&"New vs Returning Clients",r==="employees"&&"Active Employees Trend"]})}),e.jsx(K,{className:"pl-2",children:e.jsx(z,{data:(s==null?void 0:s.timeSeries)||[],aggregationLevel:(s==null?void 0:s.aggregationLevel)||"monthly",selectedMetric:r})})]}),e.jsx("div",{className:"col-span-2 flex flex-col gap-4 h-full",children:e.jsx(q,{title:"Top Clients (Revenue)",data:P,isLoading:T,valueFormatter:p=>`£${p.toLocaleString()}`,icon:e.jsx(f,{className:"h-4 w-4"}),className:"h-full",barColor:"bg-green-500"})})]})]})})]})})};export{le as FinancialDashboard,le as default};
