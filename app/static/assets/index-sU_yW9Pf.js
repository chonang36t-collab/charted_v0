import{e as Oe,r as i,j as e,c as M,y as vn,z as Ae,A as oe,g as ke,m as rt,C as Pe,P as G,i as y,k as se,h as J,D as wn,B,b as it,L as Ee,I as k,E as de,F as yn,G as ct,H as bn,J as Cn,K as Nn,M as Sn,N as Mn,O as Rn,Q as lt,U as _n,V as dt,W as In,Y as Pn,Z as En,$ as Dn,a0 as Tn,a1 as On}from"./index-Cmp3SBtg.js";import{a as An,b as Fe,D as kn}from"./DashboardLayout-CCxWjJqY.js";import{T as Fn,a as Ln,b as X,c as A,d as $n,e as P}from"./table-CcehA1j-.js";import{B as Gn}from"./badge-QmgZB8cE.js";import{u as ut,a as Le}from"./useMutation-BXVDRkyJ.js";import{d as Kn,D as Ze,a as et,b as tt,c as nt}from"./dialog-D-rSUdPV.js";import{o as Un,s as Y,c as $,b as ot,u as Bn,t as Vn,C as be,P as Hn,T as qn}from"./types-Dhy1j-9B.js";import{L as R}from"./label-Bpusw2KS.js";import{S as Ce,a as Ne,b as Se,c as Me,d as Z}from"./select-Dx--iTY3.js";import{C as zn,a as Wn,b as Yn,f as Xn,c as Jn,d as Qn,e as Zn,S as eo}from"./command-C2csuhY-.js";import{P as to,a as no,b as oo,f as Re}from"./popover-hS7Hrdx4.js";import{C as pt,a as so}from"./index-DxluRzuh.js";import{c as mt,R as ao,I as ro}from"./index-DRrp-lUW.js";import{E as io}from"./ellipsis-CTtsMHF5.js";import"./users-CCzvHyiO.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=Oe("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const co=Oe("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lo=Oe("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),ft=({className:t,...n})=>e.jsx("nav",{role:"navigation","aria-label":"pagination",className:M("mx-auto flex w-full justify-center",t),...n});ft.displayName="Pagination";const ht=i.forwardRef(({className:t,...n},o)=>e.jsx("ul",{ref:o,className:M("flex flex-row items-center gap-1",t),...n}));ht.displayName="PaginationContent";const ue=i.forwardRef(({className:t,...n},o)=>e.jsx("li",{ref:o,className:M("",t),...n}));ue.displayName="PaginationItem";const $e=({className:t,isActive:n,size:o="icon",...s})=>e.jsx("a",{"aria-current":n?"page":void 0,className:M(vn({variant:n?"outline":"ghost",size:o}),t),...s});$e.displayName="PaginationLink";const xt=({className:t,...n})=>e.jsxs($e,{"aria-label":"Go to previous page",size:"default",className:M("gap-1 pl-2.5",t),...n,children:[e.jsx(An,{className:"h-4 w-4"}),e.jsx("span",{children:"Previous"})]});xt.displayName="PaginationPrevious";const gt=({className:t,...n})=>e.jsxs($e,{"aria-label":"Go to next page",size:"default",className:M("gap-1 pr-2.5",t),...n,children:[e.jsx("span",{children:"Next"}),e.jsx(Fe,{className:"h-4 w-4"})]});gt.displayName="PaginationNext";const uo=t=>ut({queryKey:["records",t],queryFn:async()=>{const n=new URLSearchParams;n.append("page",t.page.toString()),n.append("limit",t.limit.toString()),t.sort_by&&n.append("sort_by",t.sort_by),t.sort_order&&n.append("sort_order",t.sort_order),t.search&&n.append("search",t.search),t.start&&n.append("start",t.start),t.end&&n.append("end",t.end),t.locations&&n.append("locations",t.locations),t.sites&&n.append("sites",t.sites),t.clients&&n.append("clients",t.clients);const o=await fetch(`${oe.RECORDS}?${n.toString()}`,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")}`},credentials:"include"});if(!o.ok){const s=await o.json().catch(()=>({}));throw new Error(s.error||"Failed to fetch records")}return o.json()},placeholderData:n=>n}),po=()=>ut({queryKey:["records-options"],queryFn:async()=>{const t=await fetch(`${oe.RECORDS}/options`,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});if(!t.ok)throw new Error("Failed to fetch options");return t.json()}}),mo=()=>{const t=Ae();return Le({mutationFn:async n=>{const o=await fetch(oe.RECORDS,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")}`},body:JSON.stringify(n)});if(!o.ok){const s=await o.json();throw new Error(s.error||"Failed to create record")}return o.json()},onSuccess:()=>{t.invalidateQueries({queryKey:["records"]})}})},fo=()=>{const t=Ae();return Le({mutationFn:async n=>{const{id:o,...s}=n,r=await fetch(`${oe.RECORDS}/${o}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")}`},body:JSON.stringify(s)});if(!r.ok){const a=await r.json();throw new Error(a.error||"Failed to update record")}return r.json()},onSuccess:()=>{t.invalidateQueries({queryKey:["records"]})}})},ho=()=>{const t=Ae();return Le({mutationFn:async n=>{const o=await fetch(`${oe.RECORDS}/${n}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});if(!o.ok){const s=await o.json();throw new Error(s.error||"Failed to delete record")}return o.json()},onSuccess:()=>{t.invalidateQueries({queryKey:["records"]})}})};var fe="Collapsible",[xo,na]=ke(fe),[go,Ge]=xo(fe),jt=i.forwardRef((t,n)=>{const{__scopeCollapsible:o,open:s,defaultOpen:r,disabled:a,onOpenChange:u,...m}=t,[x,f]=rt({prop:s,defaultProp:r??!1,onChange:u,caller:fe});return e.jsx(go,{scope:o,disabled:a,contentId:Pe(),open:x,onOpenToggle:i.useCallback(()=>f(d=>!d),[f]),children:e.jsx(G.div,{"data-state":Ue(x),"data-disabled":a?"":void 0,...m,ref:n})})});jt.displayName=fe;var vt="CollapsibleTrigger",wt=i.forwardRef((t,n)=>{const{__scopeCollapsible:o,...s}=t,r=Ge(vt,o);return e.jsx(G.button,{type:"button","aria-controls":r.contentId,"aria-expanded":r.open||!1,"data-state":Ue(r.open),"data-disabled":r.disabled?"":void 0,disabled:r.disabled,...s,ref:n,onClick:y(t.onClick,r.onOpenToggle)})});wt.displayName=vt;var Ke="CollapsibleContent",jo=i.forwardRef((t,n)=>{const{forceMount:o,...s}=t,r=Ge(Ke,t.__scopeCollapsible);return e.jsx(se,{present:o||r.open,children:({present:a})=>e.jsx(vo,{...s,ref:n,present:a})})});jo.displayName=Ke;var vo=i.forwardRef((t,n)=>{const{__scopeCollapsible:o,present:s,children:r,...a}=t,u=Ge(Ke,o),[m,x]=i.useState(s),f=i.useRef(null),d=J(n,f),c=i.useRef(0),h=c.current,j=i.useRef(0),l=j.current,C=u.open||m,v=i.useRef(C),b=i.useRef(void 0);return i.useEffect(()=>{const N=requestAnimationFrame(()=>v.current=!1);return()=>cancelAnimationFrame(N)},[]),wn(()=>{const N=f.current;if(N){b.current=b.current||{transitionDuration:N.style.transitionDuration,animationName:N.style.animationName},N.style.transitionDuration="0s",N.style.animationName="none";const F=N.getBoundingClientRect();c.current=F.height,j.current=F.width,v.current||(N.style.transitionDuration=b.current.transitionDuration,N.style.animationName=b.current.animationName),x(s)}},[u.open,s]),e.jsx(G.div,{"data-state":Ue(u.open),"data-disabled":u.disabled?"":void 0,id:u.contentId,hidden:!C,...a,ref:d,style:{"--radix-collapsible-content-height":h?`${h}px`:void 0,"--radix-collapsible-content-width":l?`${l}px`:void 0,...t.style},children:C&&r})});function Ue(t){return t?"open":"closed"}var wo=jt;const yo=wo,bo=wt;function Ie({options:t,value:n,onChange:o,placeholder:s="Select...",searchPlaceholder:r="Search...",emptyMessage:a="No results found.",className:u,disabled:m=!1}){var d;const[x,f]=i.useState(!1);return e.jsxs(to,{open:x,onOpenChange:f,children:[e.jsx(no,{asChild:!0,children:e.jsxs(B,{variant:"outline",role:"combobox","aria-expanded":x,className:M("w-full justify-between",u),disabled:m,children:[n?(d=t.find(c=>c.value===n))==null?void 0:d.label:s,e.jsx(zn,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(oo,{className:"w-[--radix-popover-trigger-width] p-0",align:"start",children:e.jsxs(Wn,{children:[e.jsx(Yn,{placeholder:r}),e.jsxs(Xn,{children:[e.jsx(Jn,{children:a}),e.jsx(Qn,{children:t.map(c=>e.jsxs(Zn,{value:c.label,onSelect:h=>{o(c.value===n?"":c.value),f(!1)},children:[e.jsx(pt,{className:M("mr-2 h-4 w-4",n===c.value?"opacity-100":"opacity-0")}),c.label]},c.value))})]})]})})]})}const Co=Un({date:Y().min(1,"Date is required"),employeeId:$.number().min(1,"Employee is required"),clientId:$.number().min(1,"Client is required"),jobId:$.number().min(1,"Job is required"),shiftId:$.number().min(1,"Shift is required"),startTime:Y().min(1,"Start time is required"),endTime:Y().min(1,"End time is required"),hours:$.number().min(.1,"Hours must be greater than 0"),hourRate:$.number().optional(),clientHourlyRate:$.number().optional(),job_name:Y().optional(),role:Y().optional(),jobStatus:Y().optional(),additions:$.number().optional(),deductions:$.number().optional(),self_employed:ot().optional(),dns:ot().optional()}),st=({record:t,onSuccess:n,onCancel:o})=>{const{role:s}=it(),r=s==="admin",{data:a,isLoading:u}=po(),m=mo(),x=fo(),[f,d]=i.useState(""),[c,h]=i.useState(""),j=!!t,l=Bn({resolver:Vn(Co),defaultValues:{date:(t==null?void 0:t.date)||new Date().toISOString().split("T")[0],employeeId:void 0,clientId:void 0,jobId:void 0,shiftId:void 0,startTime:t!=null&&t.shiftStart?t.shiftStart.substring(0,5):"09:00",endTime:t!=null&&t.shiftEnd?t.shiftEnd.substring(0,5):"17:00",hours:(t==null?void 0:t.paidHours)||8,hourRate:(t==null?void 0:t.hourRate)||0,clientHourlyRate:(t==null?void 0:t.clientHourlyRate)||0,job_name:(t==null?void 0:t.jobName)||"",role:"Travel Retail Specialist",jobStatus:(t==null?void 0:t.jobStatus)||"Currently Working - Full Airside Pass",additions:0,deductions:0,self_employed:!1,dns:!1}}),C=l.watch("startTime"),v=l.watch("endTime"),b=l.watch("shiftId"),N=i.useMemo(()=>a!=null&&a.jobs?Array.from(new Set(a.jobs.map(p=>p.location).filter(Boolean))):[],[a]),F=i.useMemo(()=>!(a!=null&&a.jobs)||!f?[]:Array.from(new Set(a.jobs.filter(p=>p.location===f).map(p=>p.site).filter(Boolean))),[a,f]);i.useEffect(()=>{if(t&&a){const p=a.employees.find(S=>S.name===t.fullName);p&&l.setValue("employeeId",p.id);const w=a.clients.find(S=>S.name===t.clientName);w&&l.setValue("clientId",w.id);const I=a.shifts.find(S=>S.name===t.shiftName);I&&l.setValue("shiftId",I.id);let E=a.jobs.find(S=>S.name===t.jobName&&S.site===t.site);E||(E=a.jobs.find(S=>S.site===t.site&&S.location===t.location)),E&&(l.setValue("jobId",E.id),d(E.location),h(E.site))}},[t,a,l]),i.useEffect(()=>{if(C&&v){const[p,w]=C.split(":").map(Number),[I,E]=v.split(":").map(Number);let S=p*60+w,U=I*60+E;U<S&&(U+=24*60);const ve=(U-S)/60;l.setValue("hours",parseFloat(ve.toFixed(2)))}},[C,v,l]),i.useEffect(()=>{var p;if(!j&&b&&(a!=null&&a.shifts)){const w=(p=a.shifts.find(I=>I.id===b))==null?void 0:p.name;w&&l.setValue("job_name",w)}},[b,j,a,l]),i.useEffect(()=>{if(f&&c&&(a!=null&&a.jobs)){const p=a.jobs.find(w=>w.location===f&&w.site===c);p&&l.setValue("jobId",p.id)}},[f,c,a,l]);const ie=p=>{j&&t?x.mutate({id:t.id,...p},{onSuccess:()=>{de.success("Record updated successfully"),n()},onError:w=>{de.error(`Failed to update record: ${w.message}`)}}):m.mutate(p,{onSuccess:()=>{de.success("Record created successfully"),n()},onError:w=>{de.error(`Failed to create record: ${w.message}`)}})},ce=m.isPending||x.isPending;if(u)return e.jsx("div",{className:"flex justify-center p-4",children:e.jsx(Ee,{className:"animate-spin"})});const le=(a==null?void 0:a.employees.map(p=>({value:p.id.toString(),label:p.name})))||[],q=(a==null?void 0:a.clients.map(p=>({value:p.id.toString(),label:p.name})))||[],je=(a==null?void 0:a.shifts.map(p=>({value:p.id.toString(),label:`${p.name} (${p.start.substring(0,5)}-${p.end.substring(0,5)})`})))||[];return e.jsxs("form",{onSubmit:l.handleSubmit(ie),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"date",children:"Date"}),e.jsx(k,{id:"date",type:"date",...l.register("date")}),l.formState.errors.date&&e.jsx("span",{className:"text-red-500 text-xs",children:l.formState.errors.date.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"startTime",children:"Start Time"}),e.jsx(k,{id:"startTime",type:"time",...l.register("startTime")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"endTime",children:"End Time"}),e.jsx(k,{id:"endTime",type:"time",...l.register("endTime")})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(R,{children:["Calculated Hours: ",l.watch("hours")]}),e.jsx(k,{type:"hidden",...l.register("hours")})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:"Employee"}),e.jsx(be,{control:l.control,name:"employeeId",render:({field:p})=>{var w;return e.jsx(Ie,{options:le,value:(w=p.value)==null?void 0:w.toString(),onChange:I=>p.onChange(Number(I)),placeholder:"Select Employee...",searchPlaceholder:"Search employees..."})}}),l.formState.errors.employeeId&&e.jsx("span",{className:"text-red-500 text-xs",children:l.formState.errors.employeeId.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:"Client"}),e.jsx(be,{control:l.control,name:"clientId",render:({field:p})=>{var w;return e.jsx(Ie,{options:q,value:(w=p.value)==null?void 0:w.toString(),onChange:I=>p.onChange(Number(I)),placeholder:"Select Client...",searchPlaceholder:"Search clients..."})}}),l.formState.errors.clientId&&e.jsx("span",{className:"text-red-500 text-xs",children:l.formState.errors.clientId.message})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:"Location"}),e.jsxs(Ce,{value:f,onValueChange:p=>{d(p),h("")},children:[e.jsx(Ne,{children:e.jsx(Se,{placeholder:"Select Location"})}),e.jsx(Me,{children:N.map(p=>e.jsx(Z,{value:p,children:p},p))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:"Site / Terminal"}),e.jsxs(Ce,{value:c,onValueChange:h,disabled:!f,children:[e.jsx(Ne,{children:e.jsx(Se,{placeholder:"Select Site"})}),e.jsx(Me,{children:F.map(p=>e.jsx(Z,{value:p,children:p},p))})]}),e.jsx("input",{type:"hidden",...l.register("jobId")}),l.formState.errors.jobId&&e.jsx("span",{className:"text-red-500 text-xs",children:"Job Selection Incomplete"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:"Shift"}),e.jsx(be,{control:l.control,name:"shiftId",render:({field:p})=>{var w;return e.jsx(Ie,{options:je,value:(w=p.value)==null?void 0:w.toString(),onChange:I=>p.onChange(Number(I)),placeholder:"Select Shift config...",searchPlaceholder:"Search shifts..."})}}),l.formState.errors.shiftId&&e.jsx("span",{className:"text-red-500 text-xs",children:l.formState.errors.shiftId.message})]}),(r||j)&&e.jsxs("div",{className:"border-t pt-4 grid grid-cols-2 gap-4 bg-muted/20 p-4 rounded-md",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:"Role"}),e.jsx(k,{...l.register("role")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:"Status"}),e.jsxs(Ce,{onValueChange:p=>l.setValue("jobStatus",p),defaultValue:l.getValues("jobStatus"),children:[e.jsx(Ne,{children:e.jsx(Se,{placeholder:"Status"})}),e.jsxs(Me,{children:[e.jsx(Z,{value:"Currently Working - Full Airside Pass",children:"Currently Working - Full Airside Pass"}),e.jsx(Z,{value:"Completed",children:"Completed"}),e.jsx(Z,{value:"Cancelled",children:"Cancelled"})]})]})]}),r&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"hourRate",children:"Pay Rate (£)"}),e.jsx(k,{id:"hourRate",type:"number",step:"0.01",...l.register("hourRate")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"clientHourlyRate",children:"Client Rate (£)"}),e.jsx(k,{id:"clientHourlyRate",type:"number",step:"0.01",...l.register("clientHourlyRate")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"additions",children:"Additions (£)"}),e.jsx(k,{id:"additions",type:"number",step:"0.01",...l.register("additions")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"deductions",children:"Deductions (£)"}),e.jsx(k,{id:"deductions",type:"number",step:"0.01",...l.register("deductions")})]})]})]}),e.jsxs(Kn,{className:"mt-6 flex justify-between items-center w-full",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:!j&&"Defaults: Role=Travel Retail, Additions=0, Deductions=0"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(B,{type:"button",variant:"outline",onClick:o,children:"Cancel"}),e.jsxs(B,{type:"submit",disabled:ce,children:[ce&&e.jsx(Ee,{className:"mr-2 h-4 w-4 animate-spin"}),j?"Update Record":"Create Record"]})]})]})]})};var De=["Enter"," "],No=["ArrowDown","PageUp","Home"],yt=["ArrowUp","PageDown","End"],So=[...No,...yt],Mo={ltr:[...De,"ArrowRight"],rtl:[...De,"ArrowLeft"]},Ro={ltr:["ArrowLeft"],rtl:["ArrowRight"]},ae="Menu",[te,_o,Io]=yn(ae),[V,bt]=ke(ae,[Io,ct,mt]),he=ct(),Ct=mt(),[Po,H]=V(ae),[Eo,re]=V(ae),Nt=t=>{const{__scopeMenu:n,open:o=!1,children:s,dir:r,onOpenChange:a,modal:u=!0}=t,m=he(n),[x,f]=i.useState(null),d=i.useRef(!1),c=lt(a),h=En(r);return i.useEffect(()=>{const j=()=>{d.current=!0,document.addEventListener("pointerdown",l,{capture:!0,once:!0}),document.addEventListener("pointermove",l,{capture:!0,once:!0})},l=()=>d.current=!1;return document.addEventListener("keydown",j,{capture:!0}),()=>{document.removeEventListener("keydown",j,{capture:!0}),document.removeEventListener("pointerdown",l,{capture:!0}),document.removeEventListener("pointermove",l,{capture:!0})}},[]),e.jsx(Dn,{...m,children:e.jsx(Po,{scope:n,open:o,onOpenChange:c,content:x,onContentChange:f,children:e.jsx(Eo,{scope:n,onClose:i.useCallback(()=>c(!1),[c]),isUsingKeyboardRef:d,dir:h,modal:u,children:s})})})};Nt.displayName=ae;var Do="MenuAnchor",Be=i.forwardRef((t,n)=>{const{__scopeMenu:o,...s}=t,r=he(o);return e.jsx(bn,{...r,...s,ref:n})});Be.displayName=Do;var Ve="MenuPortal",[To,St]=V(Ve,{forceMount:void 0}),Mt=t=>{const{__scopeMenu:n,forceMount:o,children:s,container:r}=t,a=H(Ve,n);return e.jsx(To,{scope:n,forceMount:o,children:e.jsx(se,{present:o||a.open,children:e.jsx(Tn,{asChild:!0,container:r,children:s})})})};Mt.displayName=Ve;var T="MenuContent",[Oo,He]=V(T),Rt=i.forwardRef((t,n)=>{const o=St(T,t.__scopeMenu),{forceMount:s=o.forceMount,...r}=t,a=H(T,t.__scopeMenu),u=re(T,t.__scopeMenu);return e.jsx(te.Provider,{scope:t.__scopeMenu,children:e.jsx(se,{present:s||a.open,children:e.jsx(te.Slot,{scope:t.__scopeMenu,children:u.modal?e.jsx(Ao,{...r,ref:n}):e.jsx(ko,{...r,ref:n})})})})}),Ao=i.forwardRef((t,n)=>{const o=H(T,t.__scopeMenu),s=i.useRef(null),r=J(n,s);return i.useEffect(()=>{const a=s.current;if(a)return Cn(a)},[]),e.jsx(qe,{...t,ref:r,trapFocus:o.open,disableOutsidePointerEvents:o.open,disableOutsideScroll:!0,onFocusOutside:y(t.onFocusOutside,a=>a.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>o.onOpenChange(!1)})}),ko=i.forwardRef((t,n)=>{const o=H(T,t.__scopeMenu);return e.jsx(qe,{...t,ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>o.onOpenChange(!1)})}),Fo=On("MenuContent.ScrollLock"),qe=i.forwardRef((t,n)=>{const{__scopeMenu:o,loop:s=!1,trapFocus:r,onOpenAutoFocus:a,onCloseAutoFocus:u,disableOutsidePointerEvents:m,onEntryFocus:x,onEscapeKeyDown:f,onPointerDownOutside:d,onFocusOutside:c,onInteractOutside:h,onDismiss:j,disableOutsideScroll:l,...C}=t,v=H(T,o),b=re(T,o),N=he(o),F=Ct(o),ie=_o(o),[ce,le]=i.useState(null),q=i.useRef(null),je=J(n,q,v.onContentChange),p=i.useRef(0),w=i.useRef(""),I=i.useRef(0),E=i.useRef(null),S=i.useRef("right"),U=i.useRef(0),ve=l?In:i.Fragment,gn=l?{as:Fo,allowPinchZoom:!0}:void 0,jn=g=>{var W,Je;const D=w.current+g,O=ie().filter(L=>!L.disabled),K=document.activeElement,we=(W=O.find(L=>L.ref.current===K))==null?void 0:W.textValue,ye=O.map(L=>L.textValue),Xe=Yo(ye,D,we),Q=(Je=O.find(L=>L.textValue===Xe))==null?void 0:Je.ref.current;(function L(Qe){w.current=Qe,window.clearTimeout(p.current),Qe!==""&&(p.current=window.setTimeout(()=>L(""),1e3))})(D),Q&&setTimeout(()=>Q.focus())};i.useEffect(()=>()=>window.clearTimeout(p.current),[]),Nn();const z=i.useCallback(g=>{var O,K;return S.current===((O=E.current)==null?void 0:O.side)&&Jo(g,(K=E.current)==null?void 0:K.area)},[]);return e.jsx(Oo,{scope:o,searchRef:w,onItemEnter:i.useCallback(g=>{z(g)&&g.preventDefault()},[z]),onItemLeave:i.useCallback(g=>{var D;z(g)||((D=q.current)==null||D.focus(),le(null))},[z]),onTriggerLeave:i.useCallback(g=>{z(g)&&g.preventDefault()},[z]),pointerGraceTimerRef:I,onPointerGraceIntentChange:i.useCallback(g=>{E.current=g},[]),children:e.jsx(ve,{...gn,children:e.jsx(Sn,{asChild:!0,trapped:r,onMountAutoFocus:y(a,g=>{var D;g.preventDefault(),(D=q.current)==null||D.focus({preventScroll:!0})}),onUnmountAutoFocus:u,children:e.jsx(Mn,{asChild:!0,disableOutsidePointerEvents:m,onEscapeKeyDown:f,onPointerDownOutside:d,onFocusOutside:c,onInteractOutside:h,onDismiss:j,children:e.jsx(ao,{asChild:!0,...F,dir:b.dir,orientation:"vertical",loop:s,currentTabStopId:ce,onCurrentTabStopIdChange:le,onEntryFocus:y(x,g=>{b.isUsingKeyboardRef.current||g.preventDefault()}),preventScrollOnEntryFocus:!0,children:e.jsx(Rn,{role:"menu","aria-orientation":"vertical","data-state":Bt(v.open),"data-radix-menu-content":"",dir:b.dir,...N,...C,ref:je,style:{outline:"none",...C.style},onKeyDown:y(C.onKeyDown,g=>{const O=g.target.closest("[data-radix-menu-content]")===g.currentTarget,K=g.ctrlKey||g.altKey||g.metaKey,we=g.key.length===1;O&&(g.key==="Tab"&&g.preventDefault(),!K&&we&&jn(g.key));const ye=q.current;if(g.target!==ye||!So.includes(g.key))return;g.preventDefault();const Q=ie().filter(W=>!W.disabled).map(W=>W.ref.current);yt.includes(g.key)&&Q.reverse(),zo(Q)}),onBlur:y(t.onBlur,g=>{g.currentTarget.contains(g.target)||(window.clearTimeout(p.current),w.current="")}),onPointerMove:y(t.onPointerMove,ne(g=>{const D=g.target,O=U.current!==g.clientX;if(g.currentTarget.contains(D)&&O){const K=g.clientX>U.current?"right":"left";S.current=K,U.current=g.clientX}}))})})})})})})});Rt.displayName=T;var Lo="MenuGroup",ze=i.forwardRef((t,n)=>{const{__scopeMenu:o,...s}=t;return e.jsx(G.div,{role:"group",...s,ref:n})});ze.displayName=Lo;var $o="MenuLabel",_t=i.forwardRef((t,n)=>{const{__scopeMenu:o,...s}=t;return e.jsx(G.div,{...s,ref:n})});_t.displayName=$o;var pe="MenuItem",at="menu.itemSelect",xe=i.forwardRef((t,n)=>{const{disabled:o=!1,onSelect:s,...r}=t,a=i.useRef(null),u=re(pe,t.__scopeMenu),m=He(pe,t.__scopeMenu),x=J(n,a),f=i.useRef(!1),d=()=>{const c=a.current;if(!o&&c){const h=new CustomEvent(at,{bubbles:!0,cancelable:!0});c.addEventListener(at,j=>s==null?void 0:s(j),{once:!0}),Pn(c,h),h.defaultPrevented?f.current=!1:u.onClose()}};return e.jsx(It,{...r,ref:x,disabled:o,onClick:y(t.onClick,d),onPointerDown:c=>{var h;(h=t.onPointerDown)==null||h.call(t,c),f.current=!0},onPointerUp:y(t.onPointerUp,c=>{var h;f.current||(h=c.currentTarget)==null||h.click()}),onKeyDown:y(t.onKeyDown,c=>{const h=m.searchRef.current!=="";o||h&&c.key===" "||De.includes(c.key)&&(c.currentTarget.click(),c.preventDefault())})})});xe.displayName=pe;var It=i.forwardRef((t,n)=>{const{__scopeMenu:o,disabled:s=!1,textValue:r,...a}=t,u=He(pe,o),m=Ct(o),x=i.useRef(null),f=J(n,x),[d,c]=i.useState(!1),[h,j]=i.useState("");return i.useEffect(()=>{const l=x.current;l&&j((l.textContent??"").trim())},[a.children]),e.jsx(te.ItemSlot,{scope:o,disabled:s,textValue:r??h,children:e.jsx(ro,{asChild:!0,...m,focusable:!s,children:e.jsx(G.div,{role:"menuitem","data-highlighted":d?"":void 0,"aria-disabled":s||void 0,"data-disabled":s?"":void 0,...a,ref:f,onPointerMove:y(t.onPointerMove,ne(l=>{s?u.onItemLeave(l):(u.onItemEnter(l),l.defaultPrevented||l.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:y(t.onPointerLeave,ne(l=>u.onItemLeave(l))),onFocus:y(t.onFocus,()=>c(!0)),onBlur:y(t.onBlur,()=>c(!1))})})})}),Go="MenuCheckboxItem",Pt=i.forwardRef((t,n)=>{const{checked:o=!1,onCheckedChange:s,...r}=t;return e.jsx(At,{scope:t.__scopeMenu,checked:o,children:e.jsx(xe,{role:"menuitemcheckbox","aria-checked":me(o)?"mixed":o,...r,ref:n,"data-state":Ye(o),onSelect:y(r.onSelect,()=>s==null?void 0:s(me(o)?!0:!o),{checkForDefaultPrevented:!1})})})});Pt.displayName=Go;var Et="MenuRadioGroup",[Ko,Uo]=V(Et,{value:void 0,onValueChange:()=>{}}),Dt=i.forwardRef((t,n)=>{const{value:o,onValueChange:s,...r}=t,a=lt(s);return e.jsx(Ko,{scope:t.__scopeMenu,value:o,onValueChange:a,children:e.jsx(ze,{...r,ref:n})})});Dt.displayName=Et;var Tt="MenuRadioItem",Ot=i.forwardRef((t,n)=>{const{value:o,...s}=t,r=Uo(Tt,t.__scopeMenu),a=o===r.value;return e.jsx(At,{scope:t.__scopeMenu,checked:a,children:e.jsx(xe,{role:"menuitemradio","aria-checked":a,...s,ref:n,"data-state":Ye(a),onSelect:y(s.onSelect,()=>{var u;return(u=r.onValueChange)==null?void 0:u.call(r,o)},{checkForDefaultPrevented:!1})})})});Ot.displayName=Tt;var We="MenuItemIndicator",[At,Bo]=V(We,{checked:!1}),kt=i.forwardRef((t,n)=>{const{__scopeMenu:o,forceMount:s,...r}=t,a=Bo(We,o);return e.jsx(se,{present:s||me(a.checked)||a.checked===!0,children:e.jsx(G.span,{...r,ref:n,"data-state":Ye(a.checked)})})});kt.displayName=We;var Vo="MenuSeparator",Ft=i.forwardRef((t,n)=>{const{__scopeMenu:o,...s}=t;return e.jsx(G.div,{role:"separator","aria-orientation":"horizontal",...s,ref:n})});Ft.displayName=Vo;var Ho="MenuArrow",Lt=i.forwardRef((t,n)=>{const{__scopeMenu:o,...s}=t,r=he(o);return e.jsx(_n,{...r,...s,ref:n})});Lt.displayName=Ho;var qo="MenuSub",[oa,$t]=V(qo),ee="MenuSubTrigger",Gt=i.forwardRef((t,n)=>{const o=H(ee,t.__scopeMenu),s=re(ee,t.__scopeMenu),r=$t(ee,t.__scopeMenu),a=He(ee,t.__scopeMenu),u=i.useRef(null),{pointerGraceTimerRef:m,onPointerGraceIntentChange:x}=a,f={__scopeMenu:t.__scopeMenu},d=i.useCallback(()=>{u.current&&window.clearTimeout(u.current),u.current=null},[]);return i.useEffect(()=>d,[d]),i.useEffect(()=>{const c=m.current;return()=>{window.clearTimeout(c),x(null)}},[m,x]),e.jsx(Be,{asChild:!0,...f,children:e.jsx(It,{id:r.triggerId,"aria-haspopup":"menu","aria-expanded":o.open,"aria-controls":r.contentId,"data-state":Bt(o.open),...t,ref:dt(n,r.onTriggerChange),onClick:c=>{var h;(h=t.onClick)==null||h.call(t,c),!(t.disabled||c.defaultPrevented)&&(c.currentTarget.focus(),o.open||o.onOpenChange(!0))},onPointerMove:y(t.onPointerMove,ne(c=>{a.onItemEnter(c),!c.defaultPrevented&&!t.disabled&&!o.open&&!u.current&&(a.onPointerGraceIntentChange(null),u.current=window.setTimeout(()=>{o.onOpenChange(!0),d()},100))})),onPointerLeave:y(t.onPointerLeave,ne(c=>{var j,l;d();const h=(j=o.content)==null?void 0:j.getBoundingClientRect();if(h){const C=(l=o.content)==null?void 0:l.dataset.side,v=C==="right",b=v?-5:5,N=h[v?"left":"right"],F=h[v?"right":"left"];a.onPointerGraceIntentChange({area:[{x:c.clientX+b,y:c.clientY},{x:N,y:h.top},{x:F,y:h.top},{x:F,y:h.bottom},{x:N,y:h.bottom}],side:C}),window.clearTimeout(m.current),m.current=window.setTimeout(()=>a.onPointerGraceIntentChange(null),300)}else{if(a.onTriggerLeave(c),c.defaultPrevented)return;a.onPointerGraceIntentChange(null)}})),onKeyDown:y(t.onKeyDown,c=>{var j;const h=a.searchRef.current!=="";t.disabled||h&&c.key===" "||Mo[s.dir].includes(c.key)&&(o.onOpenChange(!0),(j=o.content)==null||j.focus(),c.preventDefault())})})})});Gt.displayName=ee;var Kt="MenuSubContent",Ut=i.forwardRef((t,n)=>{const o=St(T,t.__scopeMenu),{forceMount:s=o.forceMount,...r}=t,a=H(T,t.__scopeMenu),u=re(T,t.__scopeMenu),m=$t(Kt,t.__scopeMenu),x=i.useRef(null),f=J(n,x);return e.jsx(te.Provider,{scope:t.__scopeMenu,children:e.jsx(se,{present:s||a.open,children:e.jsx(te.Slot,{scope:t.__scopeMenu,children:e.jsx(qe,{id:m.contentId,"aria-labelledby":m.triggerId,...r,ref:f,align:"start",side:u.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:d=>{var c;u.isUsingKeyboardRef.current&&((c=x.current)==null||c.focus()),d.preventDefault()},onCloseAutoFocus:d=>d.preventDefault(),onFocusOutside:y(t.onFocusOutside,d=>{d.target!==m.trigger&&a.onOpenChange(!1)}),onEscapeKeyDown:y(t.onEscapeKeyDown,d=>{u.onClose(),d.preventDefault()}),onKeyDown:y(t.onKeyDown,d=>{var j;const c=d.currentTarget.contains(d.target),h=Ro[u.dir].includes(d.key);c&&h&&(a.onOpenChange(!1),(j=m.trigger)==null||j.focus(),d.preventDefault())})})})})})});Ut.displayName=Kt;function Bt(t){return t?"open":"closed"}function me(t){return t==="indeterminate"}function Ye(t){return me(t)?"indeterminate":t?"checked":"unchecked"}function zo(t){const n=document.activeElement;for(const o of t)if(o===n||(o.focus(),document.activeElement!==n))return}function Wo(t,n){return t.map((o,s)=>t[(n+s)%t.length])}function Yo(t,n,o){const r=n.length>1&&Array.from(n).every(f=>f===n[0])?n[0]:n,a=o?t.indexOf(o):-1;let u=Wo(t,Math.max(a,0));r.length===1&&(u=u.filter(f=>f!==o));const x=u.find(f=>f.toLowerCase().startsWith(r.toLowerCase()));return x!==o?x:void 0}function Xo(t,n){const{x:o,y:s}=t;let r=!1;for(let a=0,u=n.length-1;a<n.length;u=a++){const m=n[a],x=n[u],f=m.x,d=m.y,c=x.x,h=x.y;d>s!=h>s&&o<(c-f)*(s-d)/(h-d)+f&&(r=!r)}return r}function Jo(t,n){if(!n)return!1;const o={x:t.clientX,y:t.clientY};return Xo(o,n)}function ne(t){return n=>n.pointerType==="mouse"?t(n):void 0}var Qo=Nt,Zo=Be,es=Mt,ts=Rt,ns=ze,os=_t,ss=xe,as=Pt,rs=Dt,is=Ot,cs=kt,ls=Ft,ds=Lt,us=Gt,ps=Ut,ge="DropdownMenu",[ms,sa]=ke(ge,[bt]),_=bt(),[fs,Vt]=ms(ge),Ht=t=>{const{__scopeDropdownMenu:n,children:o,dir:s,open:r,defaultOpen:a,onOpenChange:u,modal:m=!0}=t,x=_(n),f=i.useRef(null),[d,c]=rt({prop:r,defaultProp:a??!1,onChange:u,caller:ge});return e.jsx(fs,{scope:n,triggerId:Pe(),triggerRef:f,contentId:Pe(),open:d,onOpenChange:c,onOpenToggle:i.useCallback(()=>c(h=>!h),[c]),modal:m,children:e.jsx(Qo,{...x,open:d,onOpenChange:c,dir:s,modal:m,children:o})})};Ht.displayName=ge;var qt="DropdownMenuTrigger",zt=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:o,disabled:s=!1,...r}=t,a=Vt(qt,o),u=_(o);return e.jsx(Zo,{asChild:!0,...u,children:e.jsx(G.button,{type:"button",id:a.triggerId,"aria-haspopup":"menu","aria-expanded":a.open,"aria-controls":a.open?a.contentId:void 0,"data-state":a.open?"open":"closed","data-disabled":s?"":void 0,disabled:s,...r,ref:dt(n,a.triggerRef),onPointerDown:y(t.onPointerDown,m=>{!s&&m.button===0&&m.ctrlKey===!1&&(a.onOpenToggle(),a.open||m.preventDefault())}),onKeyDown:y(t.onKeyDown,m=>{s||(["Enter"," "].includes(m.key)&&a.onOpenToggle(),m.key==="ArrowDown"&&a.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(m.key)&&m.preventDefault())})})})});zt.displayName=qt;var hs="DropdownMenuPortal",Wt=t=>{const{__scopeDropdownMenu:n,...o}=t,s=_(n);return e.jsx(es,{...s,...o})};Wt.displayName=hs;var Yt="DropdownMenuContent",Xt=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:o,...s}=t,r=Vt(Yt,o),a=_(o),u=i.useRef(!1);return e.jsx(ts,{id:r.contentId,"aria-labelledby":r.triggerId,...a,...s,ref:n,onCloseAutoFocus:y(t.onCloseAutoFocus,m=>{var x;u.current||(x=r.triggerRef.current)==null||x.focus(),u.current=!1,m.preventDefault()}),onInteractOutside:y(t.onInteractOutside,m=>{const x=m.detail.originalEvent,f=x.button===0&&x.ctrlKey===!0,d=x.button===2||f;(!r.modal||d)&&(u.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Xt.displayName=Yt;var xs="DropdownMenuGroup",gs=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:o,...s}=t,r=_(o);return e.jsx(ns,{...r,...s,ref:n})});gs.displayName=xs;var js="DropdownMenuLabel",Jt=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:o,...s}=t,r=_(o);return e.jsx(os,{...r,...s,ref:n})});Jt.displayName=js;var vs="DropdownMenuItem",Qt=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:o,...s}=t,r=_(o);return e.jsx(ss,{...r,...s,ref:n})});Qt.displayName=vs;var ws="DropdownMenuCheckboxItem",Zt=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:o,...s}=t,r=_(o);return e.jsx(as,{...r,...s,ref:n})});Zt.displayName=ws;var ys="DropdownMenuRadioGroup",bs=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:o,...s}=t,r=_(o);return e.jsx(rs,{...r,...s,ref:n})});bs.displayName=ys;var Cs="DropdownMenuRadioItem",en=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:o,...s}=t,r=_(o);return e.jsx(is,{...r,...s,ref:n})});en.displayName=Cs;var Ns="DropdownMenuItemIndicator",tn=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:o,...s}=t,r=_(o);return e.jsx(cs,{...r,...s,ref:n})});tn.displayName=Ns;var Ss="DropdownMenuSeparator",nn=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:o,...s}=t,r=_(o);return e.jsx(ls,{...r,...s,ref:n})});nn.displayName=Ss;var Ms="DropdownMenuArrow",Rs=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:o,...s}=t,r=_(o);return e.jsx(ds,{...r,...s,ref:n})});Rs.displayName=Ms;var _s="DropdownMenuSubTrigger",on=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:o,...s}=t,r=_(o);return e.jsx(us,{...r,...s,ref:n})});on.displayName=_s;var Is="DropdownMenuSubContent",sn=i.forwardRef((t,n)=>{const{__scopeDropdownMenu:o,...s}=t,r=_(o);return e.jsx(ps,{...r,...s,ref:n,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});sn.displayName=Is;var Ps=Ht,Es=zt,Ds=Wt,an=Xt,rn=Jt,cn=Qt,ln=Zt,dn=en,un=tn,pn=nn,mn=on,fn=sn;const Ts=Ps,Os=Es,As=i.forwardRef(({className:t,inset:n,children:o,...s},r)=>e.jsxs(mn,{ref:r,className:M("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[state=open]:bg-accent focus:bg-accent",n&&"pl-8",t),...s,children:[o,e.jsx(Fe,{className:"ml-auto h-4 w-4"})]}));As.displayName=mn.displayName;const ks=i.forwardRef(({className:t,...n},o)=>e.jsx(fn,{ref:o,className:M("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n}));ks.displayName=fn.displayName;const hn=i.forwardRef(({className:t,sideOffset:n=4,...o},s)=>e.jsx(Ds,{children:e.jsx(an,{ref:s,sideOffset:n,className:M("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...o})}));hn.displayName=an.displayName;const Te=i.forwardRef(({className:t,inset:n,...o},s)=>e.jsx(cn,{ref:s,className:M("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",n&&"pl-8",t),...o}));Te.displayName=cn.displayName;const Fs=i.forwardRef(({className:t,children:n,checked:o,...s},r)=>e.jsxs(ln,{ref:r,className:M("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t),checked:o,...s,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(un,{children:e.jsx(pt,{className:"h-4 w-4"})})}),n]}));Fs.displayName=ln.displayName;const Ls=i.forwardRef(({className:t,children:n,...o},s)=>e.jsxs(dn,{ref:s,className:M("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t),...o,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(un,{children:e.jsx(co,{className:"h-2 w-2 fill-current"})})}),n]}));Ls.displayName=dn.displayName;const xn=i.forwardRef(({className:t,inset:n,...o},s)=>e.jsx(rn,{ref:s,className:M("px-2 py-1.5 text-sm font-semibold",n&&"pl-8",t),...o}));xn.displayName=rn.displayName;const $s=i.forwardRef(({className:t,...n},o)=>e.jsx(pn,{ref:o,className:M("-mx-1 my-1 h-px bg-muted",t),...n}));$s.displayName=pn.displayName;const aa=()=>{const[t,n]=i.useState({page:1,limit:20,sort_by:"date",sort_order:"desc",search:""}),{role:o}=it(),s=o==="admin",[r,a]=i.useState(""),[u,m]=i.useState(!1),[x,f]=i.useState(null),{data:d,isLoading:c,isError:h}=uo(t);i.useEffect(()=>{const v=setTimeout(()=>{n(b=>({...b,page:1,search:r}))},500);return()=>clearTimeout(v)},[r]);const j=v=>{v.preventDefault(),n(b=>({...b,page:1,search:r}))},l=v=>{n(b=>({...b,sort_by:v,sort_order:b.sort_by===v&&b.sort_order==="desc"?"asc":"desc"}))},C=(d==null?void 0:d.meta.pages)||1;return e.jsx(kn,{fullWidth:!0,children:e.jsxs("div",{className:"flex flex-col h-full space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Shift Records"})}),e.jsx(Ze,{open:u,onOpenChange:m,children:e.jsxs(et,{className:"max-w-2xl",children:[e.jsx(tt,{children:e.jsx(nt,{children:"Add New Shift Record"})}),e.jsx(st,{onSuccess:()=>m(!1),onCancel:()=>m(!1)})]})}),e.jsx(Ze,{open:!!x,onOpenChange:v=>!v&&f(null),children:e.jsxs(et,{className:"max-w-2xl",children:[e.jsx(tt,{children:e.jsx(nt,{children:"Edit Shift Record"})}),x&&e.jsx(st,{record:x,onSuccess:()=>f(null),onCancel:()=>f(null)})]})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("form",{onSubmit:j,className:"flex-1 max-w-sm flex gap-2",children:[e.jsx(k,{placeholder:"Search by name, client, or job...",value:r,onChange:v=>a(v.target.value)}),e.jsx(B,{type:"submit",variant:"secondary",children:e.jsx(eo,{className:"h-4 w-4"})})]}),(s||o==="manager")&&e.jsxs(B,{onClick:()=>m(!0),children:[e.jsx(lo,{className:"mr-2 h-4 w-4"})," Add Record"]}),e.jsxs("div",{className:"ml-auto text-sm text-muted-foreground",children:[(d==null?void 0:d.meta.total)||0," records found"]})]}),e.jsx("div",{className:"border rounded-md bg-white overflow-x-auto",children:e.jsxs(Fn,{children:[e.jsx(Ln,{children:e.jsxs(X,{children:[e.jsx(A,{className:"w-[30px]"}),e.jsxs(A,{className:"cursor-pointer",onClick:()=>l("date"),children:["Date ",e.jsx(_e,{className:"ml-2 h-4 w-4 inline"})]}),e.jsxs(A,{className:"cursor-pointer",onClick:()=>l("full_name"),children:["Employee ",e.jsx(_e,{className:"ml-2 h-4 w-4 inline"})]}),e.jsxs(A,{className:"cursor-pointer",onClick:()=>l("client_name"),children:["Client ",e.jsx(_e,{className:"ml-2 h-4 w-4 inline"})]}),e.jsx(A,{className:"hidden md:table-cell cursor-pointer",onClick:()=>l("location"),children:"Location"}),e.jsx(A,{children:"Shift"}),e.jsx(A,{className:"text-right",children:"Hours"}),s&&e.jsx(A,{className:"text-right",children:"Staff Pay"}),s&&e.jsx(A,{className:"text-right",children:"Client Pay"}),e.jsx(A,{className:"w-[50px]"})]})}),e.jsx($n,{children:c?e.jsx(X,{children:e.jsx(P,{colSpan:s?10:8,className:"h-24 text-center",children:e.jsx(Ee,{className:"h-6 w-6 animate-spin mx-auto"})})}):h?e.jsx(X,{children:e.jsx(P,{colSpan:s?10:8,className:"h-24 text-center text-red-500",children:"Failed to load records"})}):(d==null?void 0:d.data.length)===0?e.jsx(X,{children:e.jsx(P,{colSpan:s?10:8,className:"h-24 text-center",children:"No records found"})}):d==null?void 0:d.data.map(v=>e.jsx(Gs,{record:v,isAdmin:s,role:o,onEdit:()=>f(v)},v.id))})]})}),C>1&&e.jsx(ft,{children:e.jsxs(ht,{children:[e.jsx(ue,{children:e.jsx(xt,{onClick:()=>n(v=>({...v,page:Math.max(1,v.page-1)})),className:t.page===1?"pointer-events-none opacity-50":"cursor-pointer"})}),e.jsx(ue,{children:e.jsxs("div",{className:"flex items-center justify-center px-4 text-sm font-medium",children:["Page ",t.page," of ",C]})}),e.jsx(ue,{children:e.jsx(gt,{onClick:()=>n(v=>({...v,page:Math.min(C,v.page+1)})),className:t.page===C?"pointer-events-none opacity-50":"cursor-pointer"})})]})})]})})},Gs=({record:t,isAdmin:n,role:o,onEdit:s})=>{var x,f,d,c,h;const[r,a]=i.useState(!1),u=ho(),m=()=>{confirm("Are you sure you want to delete this record?")&&u.mutate(t.id)};return e.jsxs(e.Fragment,{children:[e.jsxs(X,{className:"group",children:[e.jsx(P,{children:e.jsx(yo,{open:r,onOpenChange:a,children:e.jsx(bo,{asChild:!0,children:e.jsxs(B,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",children:[r?e.jsx(so,{className:"h-4 w-4"}):e.jsx(Fe,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Toggle"})]})})})}),e.jsx(P,{className:"font-medium",children:t.date?Re(new Date(t.date),"dd MMM yyyy"):"-"}),e.jsx(P,{children:t.fullName}),e.jsx(P,{children:t.clientName}),e.jsx(P,{className:"hidden md:table-cell",children:t.location}),e.jsx(P,{children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm",children:t.shiftName}),e.jsx("span",{className:"text-xs text-muted-foreground",children:t.shiftStart&&t.shiftEnd?`${Re(new Date(`1970-01-01T${t.shiftStart}`),"HH:mm")} - ${Re(new Date(`1970-01-01T${t.shiftEnd}`),"HH:mm")}`:""})]})}),e.jsx(P,{className:"text-right",children:t.paidHours.toFixed(2)}),n&&e.jsxs(P,{className:"text-right",children:["£",((x=t.totalPay)==null?void 0:x.toFixed(2))||"0.00"]}),n&&e.jsxs(P,{className:"text-right font-medium",children:["£",((f=t.clientNet)==null?void 0:f.toFixed(2))||"0.00"]}),e.jsx(P,{children:(n||o==="manager")&&e.jsxs(Ts,{children:[e.jsx(Os,{asChild:!0,children:e.jsxs(B,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(io,{className:"h-4 w-4"})]})}),e.jsxs(hn,{align:"end",children:[e.jsx(xn,{children:"Actions"}),e.jsxs(Te,{onClick:j=>{j.stopPropagation(),s()},children:[e.jsx(Hn,{className:"mr-2 h-4 w-4"})," Edit"]}),e.jsxs(Te,{onClick:j=>{j.stopPropagation(),m()},className:"text-red-600",children:[e.jsx(qn,{className:"mr-2 h-4 w-4"})," Delete"]})]})]})})]}),e.jsx(X,{className:r?"":"hidden",children:e.jsx(P,{colSpan:n?10:8,className:"p-0 border-b-0",children:e.jsxs("div",{className:`bg-muted/50 p-4 grid grid-cols-1 ${n?"md:grid-cols-3":"md:grid-cols-2"} gap-4 text-sm shadow-inner`,children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Job Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"Site:"}),e.jsx("span",{children:t.site}),e.jsx("span",{className:"text-muted-foreground",children:"Job Name:"}),e.jsx("span",{children:t.jobName}),e.jsx("span",{className:"text-muted-foreground",children:"Status:"}),e.jsx(Gn,{variant:"outline",className:"w-fit",children:t.jobStatus||"N/A"})]})]}),n&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Financial Breakdown"}),e.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"Pay Rate:"}),e.jsxs("span",{children:["£",((d=t.hourRate)==null?void 0:d.toFixed(2))||"0.00","/hr"]}),e.jsx("span",{className:"text-muted-foreground",children:"Charge Rate:"}),e.jsxs("span",{children:["£",((c=t.clientHourlyRate)==null?void 0:c.toFixed(2))||"0.00","/hr"]}),e.jsx("span",{className:"text-muted-foreground",children:"Total Charge:"}),e.jsxs("span",{children:["£",((h=t.totalCharge)==null?void 0:h.toFixed(2))||"0.00"]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Metadata"}),e.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"System ID:"}),e.jsx("span",{className:"font-mono text-xs",children:t.id})]})]})]})})})]})};export{aa as default};
