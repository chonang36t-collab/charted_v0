const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MetricPalette-CtMNsRdf.js","assets/index-DaOTLCor.js","assets/index-DNHXE6zy.css","assets/card-DUJDBE5X.js","assets/trending-up-CGIax-tc.js","assets/popover-BVRVwqzf.js","assets/button-BCHlFOD_.js","assets/DashboardLayout-DL_4DLbb.js","assets/users-DcgYrbWh.js","assets/ChartCanvas-Ca_H45Fe.js","assets/badge-DWyE3nrF.js","assets/AreaChart-06a8FrF2.js","assets/BarChart-DzjfOfRH.js"])))=>i.map(i=>d[i]);
import{c as Ae,r as o,P as O,g as W,j as r,b as R,X as Me,a as et,S as tt,_ as Le}from"./index-DaOTLCor.js";import{u as q,R as at,P as $e,O as xe,a as ve,b as rt,T as Pe,c as Te,D as nt}from"./DashboardLayout-DL_4DLbb.js";import{L as ee}from"./label-B2SwccpK.js";import{e as st,S as lt,a as ot,b as it,c as ct,d as te}from"./select-5u3DUsLy.js";import{B as re}from"./button-BCHlFOD_.js";import{P as ue,b as me,c as fe,g as Ne,C as Ce,f as ae,d as Se}from"./popover-BVRVwqzf.js";import{B as ke}from"./badge-DWyE3nrF.js";import{C as dt,a as ut,b as mt,d as ft}from"./card-DUJDBE5X.js";import"./users-DcgYrbWh.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pt=Ae("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=Ae("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),xt=()=>{const[e,a]=o.useState({dimensions:[],metrics:[],chartType:"bar",dateRange:{from:void 0,to:void 0},customMetrics:[],chartData:[],draggedItem:void 0});return{state:e,setDimensions:l=>{a(f=>({...f,dimensions:l}))},setMetrics:l=>{a(f=>({...f,metrics:l}))},setChartType:l=>{a(f=>({...f,chartType:l}))},setDateRange:l=>{a(f=>({...f,dateRange:l}))},addCustomMetric:l=>{a(f=>({...f,customMetrics:[...f.customMetrics,l]}))},setChartData:l=>{a(f=>({...f,chartData:l}))},setDraggedItem:l=>{a(f=>({...f,draggedItem:l}))}}};var Ee=1,vt=.9,gt=.8,yt=.17,oe=.1,ie=.999,wt=.9999,bt=.99,jt=/[\\\/_+.#"@\[\(\{&]/,Nt=/[\\\/_+.#"@\[\(\{&]/g,Ct=/[\s-]/,Oe=/[\s-]/g;function pe(e,a,t,u,i,c,m){if(c===a.length)return i===e.length?Ee:bt;var s=`${i},${c}`;if(m[s]!==void 0)return m[s];for(var x=u.charAt(c),l=t.indexOf(x,i),f=0,y,S,N,M;l>=0;)y=pe(e,a,t,u,l+1,c+1,m),y>f&&(l===i?y*=Ee:jt.test(e.charAt(l-1))?(y*=gt,N=e.slice(i,l-1).match(Nt),N&&i>0&&(y*=Math.pow(ie,N.length))):Ct.test(e.charAt(l-1))?(y*=vt,M=e.slice(i,l-1).match(Oe),M&&i>0&&(y*=Math.pow(ie,M.length))):(y*=yt,i>0&&(y*=Math.pow(ie,l-i))),e.charAt(l)!==a.charAt(c)&&(y*=wt)),(y<oe&&t.charAt(l-1)===u.charAt(c+1)||u.charAt(c+1)===u.charAt(c)&&t.charAt(l-1)!==u.charAt(c))&&(S=pe(e,a,t,u,l+1,c+2,m),S*oe>y&&(y=S*oe)),y>f&&(f=y),l=t.indexOf(x,l+1);return m[s]=f,f}function Re(e){return e.toLowerCase().replace(Oe," ")}function St(e,a,t){return e=t&&t.length>0?`${e+" "+t.join(" ")}`:e,pe(e,a,Re(e),Re(a),0,0,{})}var X='[cmdk-group=""]',ce='[cmdk-group-items=""]',kt='[cmdk-group-heading=""]',ze='[cmdk-item=""]',De=`${ze}:not([aria-disabled="true"])`,he="cmdk-item-select",_="data-value",Et=(e,a,t)=>St(e,a,t),Fe=o.createContext(void 0),J=()=>o.useContext(Fe),Be=o.createContext(void 0),ge=()=>o.useContext(Be),_e=o.createContext(void 0),Ve=o.forwardRef((e,a)=>{let t=V(()=>{var n,p;return{search:"",value:(p=(n=e.value)!=null?n:e.defaultValue)!=null?p:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),u=V(()=>new Set),i=V(()=>new Map),c=V(()=>new Map),m=V(()=>new Set),s=qe(e),{label:x,children:l,value:f,onValueChange:y,filter:S,shouldFilter:N,loop:M,disablePointerSelection:K=!1,vimBindings:$=!0,...L}=e,U=q(),Q=q(),Y=q(),P=o.useRef(null),b=zt();B(()=>{if(f!==void 0){let n=f.trim();t.current.value=n,C.emit()}},[f]),B(()=>{b(6,I)},[]);let C=o.useMemo(()=>({subscribe:n=>(m.current.add(n),()=>m.current.delete(n)),snapshot:()=>t.current,setState:(n,p,v)=>{var d,g,w,A;if(!Object.is(t.current[n],p)){if(t.current[n]=p,n==="search")H(),F(),b(1,G);else if(n==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let E=document.getElementById(Y);E?E.focus():(d=document.getElementById(U))==null||d.focus()}if(b(7,()=>{var E;t.current.selectedItemId=(E=T())==null?void 0:E.id,C.emit()}),v||b(5,I),((g=s.current)==null?void 0:g.value)!==void 0){let E=p??"";(A=(w=s.current).onValueChange)==null||A.call(w,E);return}}C.emit()}},emit:()=>{m.current.forEach(n=>n())}}),[]),h=o.useMemo(()=>({value:(n,p,v)=>{var d;p!==((d=c.current.get(n))==null?void 0:d.value)&&(c.current.set(n,{value:p,keywords:v}),t.current.filtered.items.set(n,j(p,v)),b(2,()=>{F(),C.emit()}))},item:(n,p)=>(u.current.add(n),p&&(i.current.has(p)?i.current.get(p).add(n):i.current.set(p,new Set([n]))),b(3,()=>{H(),F(),t.current.value||G(),C.emit()}),()=>{c.current.delete(n),u.current.delete(n),t.current.filtered.items.delete(n);let v=T();b(4,()=>{H(),(v==null?void 0:v.getAttribute("id"))===n&&G(),C.emit()})}),group:n=>(i.current.has(n)||i.current.set(n,new Set),()=>{c.current.delete(n),i.current.delete(n)}),filter:()=>s.current.shouldFilter,label:x||e["aria-label"],getDisablePointerSelection:()=>s.current.disablePointerSelection,listId:U,inputId:Y,labelId:Q,listInnerRef:P}),[]);function j(n,p){var v,d;let g=(d=(v=s.current)==null?void 0:v.filter)!=null?d:Et;return n?g(n,t.current.search,p):0}function F(){if(!t.current.search||s.current.shouldFilter===!1)return;let n=t.current.filtered.items,p=[];t.current.filtered.groups.forEach(d=>{let g=i.current.get(d),w=0;g.forEach(A=>{let E=n.get(A);w=Math.max(E,w)}),p.push([d,w])});let v=P.current;k().sort((d,g)=>{var w,A;let E=d.getAttribute("id"),Z=g.getAttribute("id");return((w=n.get(Z))!=null?w:0)-((A=n.get(E))!=null?A:0)}).forEach(d=>{let g=d.closest(ce);g?g.appendChild(d.parentElement===g?d:d.closest(`${ce} > *`)):v.appendChild(d.parentElement===v?d:d.closest(`${ce} > *`))}),p.sort((d,g)=>g[1]-d[1]).forEach(d=>{var g;let w=(g=P.current)==null?void 0:g.querySelector(`${X}[${_}="${encodeURIComponent(d[0])}"]`);w==null||w.parentElement.appendChild(w)})}function G(){let n=k().find(v=>v.getAttribute("aria-disabled")!=="true"),p=n==null?void 0:n.getAttribute(_);C.setState("value",p||void 0)}function H(){var n,p,v,d;if(!t.current.search||s.current.shouldFilter===!1){t.current.filtered.count=u.current.size;return}t.current.filtered.groups=new Set;let g=0;for(let w of u.current){let A=(p=(n=c.current.get(w))==null?void 0:n.value)!=null?p:"",E=(d=(v=c.current.get(w))==null?void 0:v.keywords)!=null?d:[],Z=j(A,E);t.current.filtered.items.set(w,Z),Z>0&&g++}for(let[w,A]of i.current)for(let E of A)if(t.current.filtered.items.get(E)>0){t.current.filtered.groups.add(w);break}t.current.filtered.count=g}function I(){var n,p,v;let d=T();d&&(((n=d.parentElement)==null?void 0:n.firstChild)===d&&((v=(p=d.closest(X))==null?void 0:p.querySelector(kt))==null||v.scrollIntoView({block:"nearest"})),d.scrollIntoView({block:"nearest"}))}function T(){var n;return(n=P.current)==null?void 0:n.querySelector(`${ze}[aria-selected="true"]`)}function k(){var n;return Array.from(((n=P.current)==null?void 0:n.querySelectorAll(De))||[])}function se(n){let p=k()[n];p&&C.setState("value",p.getAttribute(_))}function le(n){var p;let v=T(),d=k(),g=d.findIndex(A=>A===v),w=d[g+n];(p=s.current)!=null&&p.loop&&(w=g+n<0?d[d.length-1]:g+n===d.length?d[0]:d[g+n]),w&&C.setState("value",w.getAttribute(_))}function ye(n){let p=T(),v=p==null?void 0:p.closest(X),d;for(;v&&!d;)v=n>0?Tt(v,X):Ot(v,X),d=v==null?void 0:v.querySelector(De);d?C.setState("value",d.getAttribute(_)):le(n)}let we=()=>se(k().length-1),be=n=>{n.preventDefault(),n.metaKey?we():n.altKey?ye(1):le(1)},je=n=>{n.preventDefault(),n.metaKey?se(0):n.altKey?ye(-1):le(-1)};return o.createElement(O.div,{ref:a,tabIndex:-1,...L,"cmdk-root":"",onKeyDown:n=>{var p;(p=L.onKeyDown)==null||p.call(L,n);let v=n.nativeEvent.isComposing||n.keyCode===229;if(!(n.defaultPrevented||v))switch(n.key){case"n":case"j":{$&&n.ctrlKey&&be(n);break}case"ArrowDown":{be(n);break}case"p":case"k":{$&&n.ctrlKey&&je(n);break}case"ArrowUp":{je(n);break}case"Home":{n.preventDefault(),se(0);break}case"End":{n.preventDefault(),we();break}case"Enter":{n.preventDefault();let d=T();if(d){let g=new Event(he);d.dispatchEvent(g)}}}}},o.createElement("label",{"cmdk-label":"",htmlFor:h.inputId,id:h.labelId,style:Bt},x),ne(e,n=>o.createElement(Be.Provider,{value:C},o.createElement(Fe.Provider,{value:h},n))))}),Rt=o.forwardRef((e,a)=>{var t,u;let i=q(),c=o.useRef(null),m=o.useContext(_e),s=J(),x=qe(e),l=(u=(t=x.current)==null?void 0:t.forceMount)!=null?u:m==null?void 0:m.forceMount;B(()=>{if(!l)return s.item(i,m==null?void 0:m.id)},[l]);let f=Ke(i,c,[e.value,e.children,c],e.keywords),y=ge(),S=z(b=>b.value&&b.value===f.current),N=z(b=>l||s.filter()===!1?!0:b.search?b.filtered.items.get(i)>0:!0);o.useEffect(()=>{let b=c.current;if(!(!b||e.disabled))return b.addEventListener(he,M),()=>b.removeEventListener(he,M)},[N,e.onSelect,e.disabled]);function M(){var b,C;K(),(C=(b=x.current).onSelect)==null||C.call(b,f.current)}function K(){y.setState("value",f.current,!0)}if(!N)return null;let{disabled:$,value:L,onSelect:U,forceMount:Q,keywords:Y,...P}=e;return o.createElement(O.div,{ref:W(c,a),...P,id:i,"cmdk-item":"",role:"option","aria-disabled":!!$,"aria-selected":!!S,"data-disabled":!!$,"data-selected":!!S,onPointerMove:$||s.getDisablePointerSelection()?void 0:K,onClick:$?void 0:M},e.children)}),Dt=o.forwardRef((e,a)=>{let{heading:t,children:u,forceMount:i,...c}=e,m=q(),s=o.useRef(null),x=o.useRef(null),l=q(),f=J(),y=z(N=>i||f.filter()===!1?!0:N.search?N.filtered.groups.has(m):!0);B(()=>f.group(m),[]),Ke(m,s,[e.value,e.heading,x]);let S=o.useMemo(()=>({id:m,forceMount:i}),[i]);return o.createElement(O.div,{ref:W(s,a),...c,"cmdk-group":"",role:"presentation",hidden:y?void 0:!0},t&&o.createElement("div",{ref:x,"cmdk-group-heading":"","aria-hidden":!0,id:l},t),ne(e,N=>o.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":t?l:void 0},o.createElement(_e.Provider,{value:S},N))))}),It=o.forwardRef((e,a)=>{let{alwaysRender:t,...u}=e,i=o.useRef(null),c=z(m=>!m.search);return!t&&!c?null:o.createElement(O.div,{ref:W(i,a),...u,"cmdk-separator":"",role:"separator"})}),At=o.forwardRef((e,a)=>{let{onValueChange:t,...u}=e,i=e.value!=null,c=ge(),m=z(l=>l.search),s=z(l=>l.selectedItemId),x=J();return o.useEffect(()=>{e.value!=null&&c.setState("search",e.value)},[e.value]),o.createElement(O.input,{ref:a,...u,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":x.listId,"aria-labelledby":x.labelId,"aria-activedescendant":s,id:x.inputId,type:"text",value:i?e.value:m,onChange:l=>{i||c.setState("search",l.target.value),t==null||t(l.target.value)}})}),Mt=o.forwardRef((e,a)=>{let{children:t,label:u="Suggestions",...i}=e,c=o.useRef(null),m=o.useRef(null),s=z(l=>l.selectedItemId),x=J();return o.useEffect(()=>{if(m.current&&c.current){let l=m.current,f=c.current,y,S=new ResizeObserver(()=>{y=requestAnimationFrame(()=>{let N=l.offsetHeight;f.style.setProperty("--cmdk-list-height",N.toFixed(1)+"px")})});return S.observe(l),()=>{cancelAnimationFrame(y),S.unobserve(l)}}},[]),o.createElement(O.div,{ref:W(c,a),...i,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":s,"aria-label":u,id:x.listId},ne(e,l=>o.createElement("div",{ref:W(m,x.listInnerRef),"cmdk-list-sizer":""},l)))}),Lt=o.forwardRef((e,a)=>{let{open:t,onOpenChange:u,overlayClassName:i,contentClassName:c,container:m,...s}=e;return o.createElement(at,{open:t,onOpenChange:u},o.createElement($e,{container:m},o.createElement(xe,{"cmdk-overlay":"",className:i}),o.createElement(ve,{"aria-label":e.label,"cmdk-dialog":"",className:c},o.createElement(Ve,{ref:a,...s}))))}),$t=o.forwardRef((e,a)=>z(t=>t.filtered.count===0)?o.createElement(O.div,{ref:a,...e,"cmdk-empty":"",role:"presentation"}):null),Pt=o.forwardRef((e,a)=>{let{progress:t,children:u,label:i="Loading...",...c}=e;return o.createElement(O.div,{ref:a,...c,"cmdk-loading":"",role:"progressbar","aria-valuenow":t,"aria-valuemin":0,"aria-valuemax":100,"aria-label":i},ne(e,m=>o.createElement("div",{"aria-hidden":!0},m)))}),D=Object.assign(Ve,{List:Mt,Item:Rt,Input:At,Group:Dt,Separator:It,Dialog:Lt,Empty:$t,Loading:Pt});function Tt(e,a){let t=e.nextElementSibling;for(;t;){if(t.matches(a))return t;t=t.nextElementSibling}}function Ot(e,a){let t=e.previousElementSibling;for(;t;){if(t.matches(a))return t;t=t.previousElementSibling}}function qe(e){let a=o.useRef(e);return B(()=>{a.current=e}),a}var B=typeof window>"u"?o.useEffect:o.useLayoutEffect;function V(e){let a=o.useRef();return a.current===void 0&&(a.current=e()),a}function z(e){let a=ge(),t=()=>e(a.snapshot());return o.useSyncExternalStore(a.subscribe,t,t)}function Ke(e,a,t,u=[]){let i=o.useRef(),c=J();return B(()=>{var m;let s=(()=>{var l;for(let f of t){if(typeof f=="string")return f.trim();if(typeof f=="object"&&"current"in f)return f.current?(l=f.current.textContent)==null?void 0:l.trim():i.current}})(),x=u.map(l=>l.trim());c.value(e,s,x),(m=a.current)==null||m.setAttribute(_,s),i.current=s}),i}var zt=()=>{let[e,a]=o.useState(),t=V(()=>new Map);return B(()=>{t.current.forEach(u=>u()),t.current=new Map},[e]),(u,i)=>{t.current.set(u,i),a({})}};function Ft(e){let a=e.type;return typeof a=="function"?a(e.props):"render"in a?a.render(e.props):e}function ne({asChild:e,children:a},t){return e&&o.isValidElement(a)?o.cloneElement(Ft(a),{ref:a.ref},t(a.props.children)):t(a)}var Bt={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const _t=$e,Ue=o.forwardRef(({className:e,...a},t)=>r.jsx(xe,{ref:t,className:R("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...a}));Ue.displayName=xe.displayName;const Vt=o.forwardRef(({className:e,children:a,...t},u)=>r.jsxs(_t,{children:[r.jsx(Ue,{}),r.jsxs(ve,{ref:u,className:R("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t,children:[a,r.jsxs(rt,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-accent data-[state=open]:text-muted-foreground hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[r.jsx(Me,{className:"h-4 w-4"}),r.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Vt.displayName=ve.displayName;const qt=o.forwardRef(({className:e,...a},t)=>r.jsx(Pe,{ref:t,className:R("text-lg font-semibold leading-none tracking-tight",e),...a}));qt.displayName=Pe.displayName;const Kt=o.forwardRef(({className:e,...a},t)=>r.jsx(Te,{ref:t,className:R("text-sm text-muted-foreground",e),...a}));Kt.displayName=Te.displayName;const Ye=o.forwardRef(({className:e,...a},t)=>r.jsx(D,{ref:t,className:R("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",e),...a}));Ye.displayName=D.displayName;const Ge=o.forwardRef(({className:e,...a},t)=>r.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[r.jsx(ht,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),r.jsx(D.Input,{ref:t,className:R("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",e),...a})]}));Ge.displayName=D.Input.displayName;const Ut=o.forwardRef(({className:e,...a},t)=>r.jsx(D.List,{ref:t,className:R("max-h-[300px] overflow-y-auto overflow-x-hidden",e),...a}));Ut.displayName=D.List.displayName;const He=o.forwardRef((e,a)=>r.jsx(D.Empty,{ref:a,className:"py-6 text-center text-sm",...e}));He.displayName=D.Empty.displayName;const Xe=o.forwardRef(({className:e,...a},t)=>r.jsx(D.Group,{ref:t,className:R("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",e),...a}));Xe.displayName=D.Group.displayName;const Yt=o.forwardRef(({className:e,...a},t)=>r.jsx(D.Separator,{ref:t,className:R("-mx-1 h-px bg-border",e),...a}));Yt.displayName=D.Separator.displayName;const We=o.forwardRef(({className:e,...a},t)=>r.jsx(D.Item,{ref:t,className:R("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50",e),...a}));We.displayName=D.Item.displayName;var Gt="Separator",Ie="horizontal",Ht=["horizontal","vertical"],Je=o.forwardRef((e,a)=>{const{decorative:t,orientation:u=Ie,...i}=e,c=Xt(u)?u:Ie,s=t?{role:"none"}:{"aria-orientation":c==="vertical"?c:void 0,role:"separator"};return r.jsx(O.div,{"data-orientation":c,...s,...i,ref:a})});Je.displayName=Gt;function Xt(e){return Ht.includes(e)}var Qe=Je;const Ze=o.forwardRef(({className:e,orientation:a="horizontal",decorative:t=!0,...u},i)=>r.jsx(Qe,{ref:i,decorative:t,orientation:a,className:R("shrink-0 bg-border",a==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...u}));Ze.displayName=Qe.displayName;function de({title:e,options:a,selected:t,onChange:u,placeholder:i="Select..."}){const[c,m]=o.useState(!1),s=l=>{t.includes(l)?u(t.filter(f=>f!==l)):u([...t,l])},x=l=>{l.stopPropagation(),u([])};return r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-xs font-medium text-muted-foreground",children:e}),r.jsxs(ue,{open:c,onOpenChange:m,children:[r.jsx(me,{asChild:!0,children:r.jsxs(re,{variant:"outline",role:"combobox","aria-expanded":c,className:"w-full justify-between h-auto min-h-[2.5rem] py-2 px-3",children:[r.jsxs("div",{className:"flex flex-wrap gap-1 items-center",children:[t.length===0&&r.jsx("span",{className:"text-muted-foreground font-normal",children:i}),t.length>0&&t.length<=3&&t.map(l=>r.jsx(ke,{variant:"secondary",className:"mr-1 mb-1",children:l},l)),t.length>3&&r.jsxs(ke,{variant:"secondary",className:"mr-1",children:[t.length," selected"]})]}),r.jsxs("div",{className:"flex items-center gap-2 shrink-0 opacity-50",children:[t.length>0&&r.jsx(Me,{className:"h-4 w-4 cursor-pointer hover:opacity-100",onClick:x}),r.jsx(pt,{className:"h-4 w-4"})]})]})}),r.jsx(fe,{className:"w-[200px] p-0",align:"start",children:r.jsxs(Ye,{children:[r.jsx(Ge,{placeholder:`Search ${e.toLowerCase()}...`}),r.jsxs(He,{children:["No ",e.toLowerCase()," found."]}),r.jsx(Xe,{className:"max-h-64 overflow-auto",children:a.map(l=>r.jsxs(We,{value:l,onSelect:()=>s(l),children:[r.jsx(st,{className:R("mr-2 h-4 w-4",t.includes(l)?"opacity-100":"opacity-0")}),l]},l))})]})})]})]})}function Wt({availableFilters:e,filters:a,onFilterChange:t}){const u=o.useMemo(()=>{if(a.locations.length===0){const s=new Set;return e.locations.forEach(x=>{x.sites.forEach(l=>s.add(l))}),Array.from(s).sort()}else{const s=new Set;return e.locations.filter(x=>a.locations.includes(x.name)).forEach(x=>{x.sites.forEach(l=>s.add(l))}),Array.from(s).sort()}},[e.locations,a.locations]),i=s=>{t({...a,clients:s})},c=s=>{t({...a,locations:s})},m=s=>{t({...a,sites:s})};return r.jsxs(dt,{className:"h-full flex flex-col",children:[r.jsx(ut,{className:"pb-3",children:r.jsx(mt,{className:"text-lg flex items-center gap-2",children:"ðŸŒªï¸ Filters"})}),r.jsxs(ft,{className:"space-y-4 flex-1 overflow-y-auto",children:[r.jsx(de,{title:"Clients",options:e.clients,selected:a.clients,onChange:i,placeholder:"All Clients"}),r.jsx(Ze,{}),r.jsx(de,{title:"Locations",options:e.locations.map(s=>s.name),selected:a.locations,onChange:c,placeholder:"All Locations"}),r.jsx(de,{title:"Sites",options:u,selected:a.sites,onChange:m,placeholder:"All Sites"})]})]})}const Jt=o.lazy(()=>Le(()=>import("./MetricPalette-CtMNsRdf.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]))),Qt=o.lazy(()=>Le(()=>import("./ChartCanvas-Ca_H45Fe.js"),__vite__mapDeps([9,1,2,10,11,12])));function ia(){const{state:e,setDimensions:a,setMetrics:t,setChartType:u,setDateRange:i,setChartData:c}=xt(),{toast:m}=et(),[s,x]=o.useState({from:new Date,to:Ne(new Date,30)}),[l,f]=o.useState({from:new Date,to:Ne(new Date,30)}),[y,S]=o.useState(!1),[N,M]=o.useState(!1),[K,$]=o.useState({clients:[],locations:[]}),[L,U]=o.useState({clients:[],locations:[],sites:[]});o.useEffect(()=>{(async()=>{try{const j=await fetch("/api/filters",{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});if(j.ok){const F=await j.json();$(F)}}catch(j){console.error("Error fetching filters:",j)}})()},[]);const Q=()=>{f(s)};o.useEffect(()=>{(async()=>{if(e.dimensions.length===0||e.metrics.length===0||!(l!=null&&l.from)||!(l!=null&&l.to)){c([]);return}const j=e.dimensions[0],F=e.metrics,G=ae(l.from,"yyyy-MM-dd"),H=ae(l.to,"yyyy-MM-dd");try{const I=new URLSearchParams;I.append("start",G),I.append("end",H),I.append("dimension",j),F.forEach(k=>I.append("metrics",k)),L.clients.forEach(k=>I.append("clients",k)),L.locations.forEach(k=>I.append("locations",k)),L.sites.forEach(k=>I.append("sites",k));const T=await fetch(`/api/chart-data?${I.toString()}`,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});if(T.ok){const k=await T.json();c(k)}else console.error("Failed to fetch chart data"),c([])}catch(I){console.error("Error fetching chart data:",I),c([])}})()},[e.dimensions,e.metrics,l,L]);const Y=h=>{h.type==="dimension"?e.dimensions.includes(h.name)||(a([h.name]),m({description:`Added ${h.name} to chart`,duration:2e3})):h.type==="metric"&&(e.metrics.includes(h.name)||(t([...e.metrics,h.name]),m({description:`Added ${h.name} to chart`,duration:2e3})))},P=h=>{h.type==="dimension"?e.dimensions.includes(h.name)&&(a(e.dimensions.filter(j=>j!==h.name)),m({description:`Removed ${h.name} from chart`,duration:2e3})):h.type==="metric"&&e.metrics.includes(h.name)&&(t(e.metrics.filter(j=>j!==h.name)),m({description:`Removed ${h.name} from chart`,duration:2e3}))},b=h=>{a(e.dimensions.filter(j=>j!==h))},C=h=>{t(e.metrics.filter(j=>j!==h))};return r.jsx(nt,{children:r.jsx("div",{className:"p-4 md:p-6 h-full flex flex-col",children:r.jsxs("div",{className:"space-y-6 h-full flex flex-col",children:[r.jsx("div",{className:"sticky lg:top-0 z-30 pb-4 border-b -mx-4 md:-mx-6 px-4 md:px-6 pt-2 shadow-sm bg-background",children:r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-8",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl md:text-3xl font-bold",children:"Chart Builder"}),r.jsx("p",{className:"text-muted-foreground text-sm md:text-base",children:"Click on metrics and dimensions to build your chart"})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row gap-1",children:[r.jsxs("div",{className:"w-full sm:w-48",children:[r.jsx(ee,{className:"text-xs text-muted-foreground",children:"Chart Type"}),r.jsxs(lt,{value:e.chartType,onValueChange:u,children:[r.jsx(ot,{className:"w-full",children:r.jsx(it,{placeholder:"Select chart type"})}),r.jsxs(ct,{children:[r.jsx(te,{value:"bar",children:"Bar Chart"}),r.jsx(te,{value:"line",children:"Line Chart"}),r.jsx(te,{value:"area",children:"Area Chart"}),r.jsx(te,{value:"pie",children:"Pie Chart"})]})]})]}),r.jsxs("div",{className:"w-full sm:w-48",children:[r.jsx(ee,{className:"text-xs text-muted-foreground",children:"From Date"}),r.jsxs(ue,{open:y,onOpenChange:S,children:[r.jsx(me,{asChild:!0,children:r.jsxs(re,{variant:"outline",className:R("w-full justify-start text-left font-normal",!(s!=null&&s.from)&&"text-muted-foreground"),children:[r.jsx(Ce,{className:"mr-2 h-4 w-4"}),s!=null&&s.from?ae(s.from,"LLL dd, y"):r.jsx("span",{children:"Pick a date"})]})}),r.jsx(fe,{className:"w-auto p-0",align:"start",children:r.jsx(Se,{mode:"single",selected:s==null?void 0:s.from,onSelect:h=>{x(j=>({...j,from:h})),S(!1)},defaultMonth:s==null?void 0:s.from,captionLayout:"dropdown-buttons",fromYear:2020,toYear:2030})})]})]}),r.jsxs("div",{className:"w-full sm:w-48",children:[r.jsx(ee,{className:"text-xs text-muted-foreground",children:"To Date"}),r.jsxs(ue,{open:N,onOpenChange:M,children:[r.jsx(me,{asChild:!0,children:r.jsxs(re,{variant:"outline",className:R("w-full justify-start text-left font-normal",!(s!=null&&s.to)&&"text-muted-foreground"),children:[r.jsx(Ce,{className:"mr-2 h-4 w-4"}),s!=null&&s.to?ae(s.to,"LLL dd, y"):r.jsx("span",{children:"Pick a date"})]})}),r.jsx(fe,{className:"w-auto p-0",align:"start",children:r.jsx(Se,{mode:"single",selected:s==null?void 0:s.to,onSelect:h=>{x(j=>({...j,to:h})),M(!1)},defaultMonth:s==null?void 0:s.to,captionLayout:"dropdown-buttons",fromYear:2020,toYear:2030,disabled:h=>h<((s==null?void 0:s.from)||new Date(0))})})]})]}),r.jsxs("div",{className:"w-full sm:w-auto",children:[r.jsx(ee,{className:"text-xs text-muted-foreground opacity-0",children:"Apply"}),r.jsx(re,{onClick:Q,className:"w-full",disabled:!(s!=null&&s.from)||!(s!=null&&s.to),children:"Apply Dates"})]})]})]})}),r.jsx("div",{className:"flex-1 min-h-0 overflow-hidden",children:r.jsx(o.Suspense,{fallback:r.jsx("div",{className:"flex-1 flex items-center justify-center",children:r.jsx(tt,{className:"h-8 w-8 rounded-full"})}),children:r.jsxs("div",{className:"flex-1 flex flex-col lg:flex-row gap-4 min-h-0 h-full",children:[r.jsxs("div",{className:"lg:w-72 shrink-0 h-full flex flex-col gap-4 overflow-hidden",children:[r.jsx("div",{className:"flex-1 min-h-0 overflow-y-auto pr-2",children:r.jsx(Jt,{selectedDimensions:e.dimensions,selectedMetrics:e.metrics,onItemClick:Y,onItemDoubleClick:P})}),r.jsx("div",{className:"h-1/3 min-h-[250px] shrink-0 overflow-y-auto pr-2",children:r.jsx(Wt,{availableFilters:K,filters:L,onFilterChange:U})})]}),r.jsx("div",{className:"flex-1 min-w-0 flex flex-col h-full overflow-y-auto",children:r.jsx("div",{className:"flex-1 flex flex-col min-h-0",children:r.jsx(Qt,{dimensions:e.dimensions,metrics:e.metrics,chartType:e.chartType,chartData:e.chartData,onRemoveDimension:b,onRemoveMetric:C})})})]})})})]})})})}export{ia as default};
