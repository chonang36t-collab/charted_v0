import{e as ge,r as y,f as ue,j as e,P as W,g as ee,h as je,i as Ce,k as ye,l as A,b as Ne,R as S,T as te,m as re,n as se,o as oe,X as ke,A as Pe}from"./index-BIm8U-WF.js";import{B as O}from"./button-BUooGhA3.js";import{a as we,P as z,b as U,g as X,c as G,C as ne,f as ae,d as ie,i as le,e as Se,s as K,h as Q}from"./locationUtils-BqXVJ2N8.js";import{u as Ee,C as Te,a as ce,S as _e,b as Ie,c as Fe,d as He,e as L}from"./select-CiYoD-rJ.js";import{B as de}from"./badge-B4zLmiKw.js";import{C as Me,a as Oe,b as Ae,d as qe}from"./card-CPYEXJ6G.js";function V(t,i){return we(t,-i)}const Ve=(t,i)=>{var c,h,o,k,w,T,I,F,q,B,Y,r,l,N,P;if(!t)return{revenue:{value:0,change:0,trend:"neutral",text:"No data available"},clientPay:{value:0,change:0,trend:"neutral",text:"No data available"},staffPay:{value:0,change:0,trend:"neutral",text:"No data available"},totalShifts:{value:0,change:0,trend:"neutral",text:"No data available"},paidHours:{value:0,change:0,trend:"neutral",text:"No data available"},uniqueEmployees:{value:0,change:0,trend:"neutral",text:"No data available"},avgShiftDuration:{value:0,change:0,trend:"neutral",text:"No data available"},totalClients:{value:0,change:0,trend:"neutral",text:"No data available"}};const d=t.totalRevenue||0,p=t.avgClientPayPerHour||0,v=t.avgStaffPayPerHour||0,n=((c=t.previousPeriod)==null?void 0:c.totalRevenue)||0,a=((h=t.previousPeriod)==null?void 0:h.avgClientPayPerHour)||0,m=((o=t.previousPeriod)==null?void 0:o.avgStaffPayPerHour)||0,s=(_,H)=>H>0?(_-H)/H*100:0,j=s(d,n),C=s(p,a),f=s(v,m),u=_=>_>0?"up":_<0?"down":"neutral",g=(_,H,$)=>{if(!H)return"No previous data";let M="";return $<=7?M="last week":$<=31?M="last month":$<=93?M="last quarter":M="last period",`${_>0?"+":""}${Math.abs(_).toFixed(1)}% from ${M}`},x=Math.ceil((i.to.getTime()-i.from.getTime())/(1e3*60*60*24)),b=!!t.previousPeriod;return{revenue:{value:d,change:j,trend:u(j),text:g(j,b,x)},clientPay:{value:p,change:C,trend:u(C),text:g(C,b,x)},staffPay:{value:v,change:f,trend:u(f),text:g(f,b,x)},totalShifts:{value:t.totalShifts,change:s(t.totalShifts,((k=t.previousPeriod)==null?void 0:k.totalShifts)||0),trend:u(s(t.totalShifts,((w=t.previousPeriod)==null?void 0:w.totalShifts)||0)),text:g(s(t.totalShifts,((T=t.previousPeriod)==null?void 0:T.totalShifts)||0),b,x)},paidHours:{value:t.totalPaidHours||0,change:s(t.totalPaidHours||0,((I=t.previousPeriod)==null?void 0:I.totalPaidHours)||0)||0,trend:u(s(t.totalPaidHours||0,((F=t.previousPeriod)==null?void 0:F.totalPaidHours)||0)),text:g(s(t.totalPaidHours||0,((q=t.previousPeriod)==null?void 0:q.totalPaidHours)||0),b,x)},uniqueEmployees:{value:t.uniqueEmployees,change:s(t.uniqueEmployees,((B=t.previousPeriod)==null?void 0:B.uniqueEmployees)||0),trend:u(s(t.uniqueEmployees,((Y=t.previousPeriod)==null?void 0:Y.uniqueEmployees)||0)),text:g(s(t.uniqueEmployees,((r=t.previousPeriod)==null?void 0:r.uniqueEmployees)||0),b,x)},avgShiftDuration:{value:t.totalPaidHours&&t.totalShifts?t.totalPaidHours/t.totalShifts:0,change:0,trend:"neutral",text:"Average hours per shift"},totalClients:{value:t.totalClients,change:s(t.totalClients,((l=t.previousPeriod)==null?void 0:l.totalClients)||0),trend:u(s(t.totalClients,((N=t.previousPeriod)==null?void 0:N.totalClients)||0)),text:g(s(t.totalClients,((P=t.previousPeriod)==null?void 0:P.totalClients)||0),b,x)}}};var R="Checkbox",[Be,Je]=ge(R),[Ye,Z]=Be(R);function Le(t){const{__scopeCheckbox:i,checked:d,children:p,defaultChecked:v,disabled:n,form:a,name:m,onCheckedChange:s,required:j,value:C="on",internal_do_not_use_render:f}=t,[u,g]=ye({prop:d,defaultProp:v??!1,onChange:s,caller:R}),[x,b]=y.useState(null),[c,h]=y.useState(null),o=y.useRef(!1),k=x?!!a||!!x.closest("form"):!0,w={checked:u,disabled:n,setChecked:g,control:x,setControl:b,name:m,form:a,value:C,hasConsumerStoppedPropagationRef:o,required:j,defaultChecked:E(v)?!1:v,isFormControl:k,bubbleInput:c,setBubbleInput:h};return e.jsx(Ye,{scope:i,...w,children:Re(f)?f(w):p})}var he="CheckboxTrigger",me=y.forwardRef(({__scopeCheckbox:t,onKeyDown:i,onClick:d,...p},v)=>{const{control:n,value:a,disabled:m,checked:s,required:j,setControl:C,setChecked:f,hasConsumerStoppedPropagationRef:u,isFormControl:g,bubbleInput:x}=Z(he,t),b=ue(v,C),c=y.useRef(s);return y.useEffect(()=>{const h=n==null?void 0:n.form;if(h){const o=()=>f(c.current);return h.addEventListener("reset",o),()=>h.removeEventListener("reset",o)}},[n,f]),e.jsx(W.button,{type:"button",role:"checkbox","aria-checked":E(s)?"mixed":s,"aria-required":j,"data-state":be(s),"data-disabled":m?"":void 0,disabled:m,value:a,...p,ref:b,onKeyDown:ee(i,h=>{h.key==="Enter"&&h.preventDefault()}),onClick:ee(d,h=>{f(o=>E(o)?!0:!o),x&&g&&(u.current=h.isPropagationStopped(),u.current||h.stopPropagation())})})});me.displayName=he;var D=y.forwardRef((t,i)=>{const{__scopeCheckbox:d,name:p,checked:v,defaultChecked:n,required:a,disabled:m,value:s,onCheckedChange:j,form:C,...f}=t;return e.jsx(Le,{__scopeCheckbox:d,checked:v,defaultChecked:n,disabled:m,required:a,onCheckedChange:j,name:p,form:C,value:s,internal_do_not_use_render:({isFormControl:u})=>e.jsxs(e.Fragment,{children:[e.jsx(me,{...f,ref:i,__scopeCheckbox:d}),u&&e.jsx(ve,{__scopeCheckbox:d})]})})});D.displayName=R;var xe="CheckboxIndicator",pe=y.forwardRef((t,i)=>{const{__scopeCheckbox:d,forceMount:p,...v}=t,n=Z(xe,d);return e.jsx(je,{present:p||E(n.checked)||n.checked===!0,children:e.jsx(W.span,{"data-state":be(n.checked),"data-disabled":n.disabled?"":void 0,...v,ref:i,style:{pointerEvents:"none",...t.style}})})});pe.displayName=xe;var fe="CheckboxBubbleInput",ve=y.forwardRef(({__scopeCheckbox:t,...i},d)=>{const{control:p,hasConsumerStoppedPropagationRef:v,checked:n,defaultChecked:a,required:m,disabled:s,name:j,value:C,form:f,bubbleInput:u,setBubbleInput:g}=Z(fe,t),x=ue(d,g),b=Ee(n),c=Ce(p);y.useEffect(()=>{const o=u;if(!o)return;const k=window.HTMLInputElement.prototype,T=Object.getOwnPropertyDescriptor(k,"checked").set,I=!v.current;if(b!==n&&T){const F=new Event("click",{bubbles:I});o.indeterminate=E(n),T.call(o,E(n)?!1:n),o.dispatchEvent(F)}},[u,b,n,v]);const h=y.useRef(E(n)?!1:n);return e.jsx(W.input,{type:"checkbox","aria-hidden":!0,defaultChecked:a??h.current,required:m,disabled:s,name:j,value:C,form:f,...i,tabIndex:-1,ref:x,style:{...i.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});ve.displayName=fe;function Re(t){return typeof t=="function"}function E(t){return t==="indeterminate"}function be(t){return E(t)?"indeterminate":t?"checked":"unchecked"}const J=y.forwardRef(({className:t,...i},d)=>e.jsx(D,{ref:d,className:A("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),...i,children:e.jsx(pe,{className:A("flex items-center justify-center text-current"),children:e.jsx(Te,{className:"h-4 w-4"})})}));J.displayName=D.displayName;const We=({dateRange:t,onDateRangeChange:i,calendarOpen:d,onCalendarOpenChange:p,tempDateRange:v,onTempDateRangeChange:n,selectedLocations:a=[],onLocationsChange:m})=>{const{role:s,locations:j}=Ne(),[C,f]=S.useState([]),[u,g]=S.useState(!1);S.useEffect(()=>{(async()=>{try{const l=await fetch(`${Pe.SALES_SUMMARY.replace("sales-summary","locations")}`,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`},credentials:"include"});if(l.ok){const N=await l.json();f(s==="admin"?N:N.filter(P=>j.includes(P)))}}catch(l){console.error("Failed to fetch locations:",l)}})()},[s,j]);const x=r=>{m&&(a.includes(r)?m(a.filter(l=>l!==r)):m([...a,r]))},b=r=>{const l=new Date;let N,P;switch(r){case"this-month":N=K(l),P=Q(l);break;case"last-month":N=K(V(l,1)),P=Q(V(l,1));break;case"last-3-months":N=K(V(l,2)),P=Q(l);break;case"this-year":N=new Date(l.getFullYear(),0,1),P=new Date(l.getFullYear(),11,31);break;default:return}i({from:N,to:P})},[c,h]=S.useState(t==null?void 0:t.from),[o,k]=S.useState(t==null?void 0:t.to),[w,T]=S.useState(!1),[I,F]=S.useState(!1);S.useEffect(()=>{h(t==null?void 0:t.from),k(t==null?void 0:t.to)},[t]);const q=r=>{r&&(h(r),o&&le(r,o)&&k(void 0))},B=r=>{r&&k(r)},Y=()=>{c&&o&&i({from:c,to:o})};return e.jsx("div",{className:"sticky top-0 z-40 bg-background border-b border-border",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Dashboard"}),e.jsx("p",{className:"text-muted-foreground",children:"Overview of your analytics"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[m&&e.jsxs(z,{open:u,onOpenChange:g,children:[e.jsx(U,{asChild:!0,children:e.jsxs(O,{variant:"outline",className:"w-auto min-w-[180px] justify-between text-left font-normal",children:[e.jsx("div",{className:"flex items-center gap-2 overflow-hidden mr-2",children:e.jsx("span",{className:"truncate",children:a.length===0?"All Locations":a.length===1?X(a[0]):`${a.length} locations`})}),e.jsx(ce,{className:"h-4 w-4 opacity-50 shrink-0"})]})}),e.jsx(G,{className:"w-[200px] p-0",align:"start",children:e.jsxs("div",{className:"p-2 max-h-[300px] overflow-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-2 hover:bg-muted rounded-sm cursor-pointer mb-1",onClick:r=>{r.stopPropagation(),m([])},children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(J,{checked:a.length===0,className:"pointer-events-none"}),e.jsx("span",{className:"text-sm font-medium",children:"All Locations"})]}),a.length>0&&e.jsx(O,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs text-muted-foreground hover:text-foreground",onClick:r=>{r.stopPropagation(),m([])},children:"Clear"})]}),e.jsx("div",{className:"h-px bg-border my-1"}),e.jsx(te,{children:C.map(r=>e.jsxs("div",{className:"flex items-center space-x-2 p-2 hover:bg-muted rounded-sm cursor-pointer",onClick:l=>{l.stopPropagation(),x(r)},children:[e.jsx(J,{checked:a.includes(r),className:"pointer-events-none"}),e.jsxs(re,{children:[e.jsx(se,{asChild:!0,children:e.jsx("span",{className:"text-sm truncate font-medium",children:X(r)})}),e.jsx(oe,{side:"right",children:e.jsx("p",{children:r})})]})]},r))})]})})]}),a.length>0&&m&&e.jsx("div",{className:"hidden lg:flex flex-wrap gap-1 items-center max-w-[300px]",children:e.jsxs(te,{children:[a.slice(0,3).map(r=>e.jsxs(re,{children:[e.jsx(se,{asChild:!0,children:e.jsxs(de,{variant:"secondary",className:"text-[10px] px-1 h-5 gap-1 max-w-[100px] truncate",children:[X(r),e.jsx(ke,{className:"h-2 w-2 cursor-pointer hover:text-destructive",onClick:l=>{l.stopPropagation(),x(r)}})]})}),e.jsx(oe,{children:e.jsx("p",{children:r})})]},r)),a.length>3&&e.jsxs(de,{variant:"secondary",className:"text-[10px] px-1 h-5",children:["+",a.length-3," more"]})]})}),e.jsxs(_e,{onValueChange:b,children:[e.jsxs(Ie,{className:"w-[140px]",children:[e.jsx(Fe,{placeholder:"Quick Select"}),e.jsx(ce,{className:"h-4 w-4 opacity-50"})]}),e.jsxs(He,{children:[e.jsx(L,{value:"this-month",children:"This Month"}),e.jsx(L,{value:"last-month",children:"Last Month"}),e.jsx(L,{value:"last-3-months",children:"Last 3 Months"}),e.jsx(L,{value:"this-year",children:"This Year"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(z,{open:w,onOpenChange:T,children:[e.jsx(U,{asChild:!0,children:e.jsxs(O,{variant:"outline",className:A("w-[140px] justify-start text-left font-normal",!c&&"text-muted-foreground"),children:[e.jsx(ne,{className:"mr-2 h-4 w-4"}),c?ae(c,"LLL dd, y"):"From"]})}),e.jsx(G,{className:"w-auto p-0",align:"start",children:e.jsx("div",{className:"p-3",children:e.jsx(ie,{mode:"single",selected:c,onSelect:q,initialFocus:!0,captionLayout:"dropdown-buttons",fromYear:new Date().getFullYear()-10,toYear:new Date().getFullYear()+1,disabled:r=>o?le(r,o):!1,className:"rounded-md border"})})})]}),e.jsx("div",{className:"text-muted-foreground",children:"to"}),e.jsxs(z,{open:I,onOpenChange:F,children:[e.jsx(U,{asChild:!0,children:e.jsxs(O,{variant:"outline",className:A("w-[140px] justify-start text-left font-normal",!o&&"text-muted-foreground"),disabled:!c,children:[e.jsx(ne,{className:"mr-2 h-4 w-4"}),o?ae(o,"LLL dd, y"):"To"]})}),e.jsx(G,{className:"w-auto p-0",align:"start",children:e.jsx("div",{className:"p-3",children:e.jsx(ie,{mode:"single",selected:o,onSelect:B,initialFocus:!0,captionLayout:"dropdown-buttons",fromYear:c?c.getFullYear():new Date().getFullYear()-10,toYear:new Date().getFullYear()+1,disabled:r=>c?Se(r,c):!1,className:"rounded-md border"})})})]}),e.jsx(O,{onClick:Y,disabled:!c||!o,className:"ml-2",children:"Apply"})]})]})]})})})};function Ze({title:t,value:i,change:d,trend:p="neutral"}){return e.jsxs(Me,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(Oe,{className:"flex flex-row items-center justify-between pb-2",children:e.jsx(Ae,{className:"text-sm font-medium text-muted-foreground",children:t})}),e.jsxs(qe,{children:[e.jsx("div",{className:"text-2xl font-bold",children:i}),d&&e.jsx("p",{className:A("text-xs mt-1",p==="up"&&"text-accent",p==="down"&&"text-destructive",p==="neutral"&&"text-muted-foreground"),children:d})]})]})}const De=()=>e.jsx("div",{className:"fixed inset-0 bg-background/80 backdrop-blur-sm z-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Loading Dashboard"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Fetching your data..."})]})]})});export{We as D,De as L,Ze as M,Ve as c};
