const applyCustomMetrics=(timeSeries,customMetrics,totalOverhead=0)=>{if(!customMetrics.length)return timeSeries;const proratedOverhead=totalOverhead/Math.max(1,timeSeries.length);return timeSeries.map(period=>{const periodWithCustom={...period};return customMetrics.forEach(metric=>{try{let formula=metric.formula.replace(/REV/g,period.revenue.toString()).replace(/COST/g,period.cost.toString()).replace(/HRS/g,period.paidHours.toString()).replace(/SHIFTS/g,period.totalShifts.toString()).replace(/OVH/g,proratedOverhead.toString());const value=eval(formula);periodWithCustom[metric.name]=isFinite(value)?value:0}catch(e){console.error(`Error calculating custom metric ${metric.name}:`,e),periodWithCustom[metric.name]=0}}),periodWithCustom})};export{applyCustomMetrics as a};
