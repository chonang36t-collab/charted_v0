import{R as h,j as e,d as $,A as Z}from"./index-BK59HRyT.js";import{B as A}from"./button-CtGU3ee1.js";import{a as R,P as z,b as B,C as I,f as V,c as W,d as _,i as q,e as D,s as F,g as M}from"./popover-B2tg9WvK.js";import{S as G,a as Q,b as X,c as U,d as p,C as ee}from"./select-8x8xp6aR.js";import{C as m,a as E,b as H,d as f}from"./card-BYJIr3cH.js";import{R as te,A as se,C as re,X as ne,Y as ae,T as le,L as oe,a as J}from"./AreaChart-DBQwwSos.js";function O(t,r){return R(t,-r)}const fe=(t,r)=>{var S,T,k;if(!t)return{revenue:{value:0,change:0,trend:"neutral",text:"No data available"},clientPay:{value:0,change:0,trend:"neutral",text:"No data available"},staffPay:{value:0,change:0,trend:"neutral",text:"No data available"}};const o=t.totalRevenue||0,i=t.avgClientPayPerHour||0,v=t.avgStaffPayPerHour||0,K=((S=t.previousPeriod)==null?void 0:S.totalRevenue)||0,L=((T=t.previousPeriod)==null?void 0:T.avgClientPayPerHour)||0,P=((k=t.previousPeriod)==null?void 0:k.avgStaffPayPerHour)||0,g=(c,x)=>x>0?(c-x)/x*100:0,y=g(o,K),N=g(i,L),n=g(v,P),j=c=>c>0?"up":c<0?"down":"neutral",a=(c,x,w)=>{if(!x)return"No previous data";let s="";return w<=7?s="last week":w<=31?s="last month":w<=93?s="last quarter":s="last period",`${c>0?"+":""}${Math.abs(c).toFixed(1)}% from ${s}`},d=Math.ceil((r.to.getTime()-r.from.getTime())/(1e3*60*60*24)),b=!!t.previousPeriod;return{revenue:{value:o,change:y,trend:j(y),text:a(y,b,d)},clientPay:{value:i,change:N,trend:j(N),text:a(N,b,d)},staffPay:{value:v,change:n,trend:j(n),text:a(n,b,d)}}},je=({dateRange:t,onDateRangeChange:r,calendarOpen:o,onCalendarOpenChange:i,tempDateRange:v,onTempDateRangeChange:K,selectedLocations:L=[],onLocationsChange:P})=>{const[g,y]=h.useState([]);h.useEffect(()=>{(async()=>{try{const l=await fetch(`${Z.SALES_SUMMARY.replace("sales-summary","locations")}`,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});if(l.ok){const u=await l.json();y(u)}}catch(l){console.error("Failed to fetch locations:",l)}})()},[]);const N=s=>{const l=new Date;let u,C;switch(s){case"this-month":u=F(l),C=M(l);break;case"last-month":u=F(O(l,1)),C=M(O(l,1));break;case"last-3-months":u=F(O(l,2)),C=M(l);break;case"this-year":u=new Date(l.getFullYear(),0,1),C=new Date(l.getFullYear(),11,31);break;default:return}r({from:u,to:C})},[n,j]=h.useState(t==null?void 0:t.from),[a,d]=h.useState(t==null?void 0:t.to),[b,S]=h.useState(!1),[T,k]=h.useState(!1);h.useEffect(()=>{j(t==null?void 0:t.from),d(t==null?void 0:t.to)},[t]);const c=s=>{s&&(j(s),a&&q(s,a)&&d(void 0))},x=s=>{s&&d(s)},w=()=>{n&&a&&r({from:n,to:a})};return e.jsx("div",{className:"sticky top-0 z-40 bg-background border-b border-border",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Dashboard"}),e.jsx("p",{className:"text-muted-foreground",children:"Overview of your analytics"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[P&&e.jsxs(G,{value:L[0]||"all",onValueChange:s=>P(s==="all"?[]:[s]),children:[e.jsx(Q,{className:"w-[180px]",children:e.jsx(X,{placeholder:"All Locations"})}),e.jsxs(U,{children:[e.jsx(p,{value:"all",children:"All Locations"}),g.map(s=>e.jsx(p,{value:s,children:s},s))]})]}),e.jsxs(G,{onValueChange:N,children:[e.jsxs(Q,{className:"w-[140px]",children:[e.jsx(X,{placeholder:"Quick Select"}),e.jsx(ee,{className:"h-4 w-4 opacity-50"})]}),e.jsxs(U,{children:[e.jsx(p,{value:"this-month",children:"This Month"}),e.jsx(p,{value:"last-month",children:"Last Month"}),e.jsx(p,{value:"last-3-months",children:"Last 3 Months"}),e.jsx(p,{value:"this-year",children:"This Year"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(z,{open:b,onOpenChange:S,children:[e.jsx(B,{asChild:!0,children:e.jsxs(A,{variant:"outline",className:$("w-[140px] justify-start text-left font-normal",!n&&"text-muted-foreground"),children:[e.jsx(I,{className:"mr-2 h-4 w-4"}),n?V(n,"LLL dd, y"):"From"]})}),e.jsx(W,{className:"w-auto p-0",align:"start",children:e.jsx("div",{className:"p-3",children:e.jsx(_,{mode:"single",selected:n,onSelect:c,initialFocus:!0,captionLayout:"dropdown-buttons",fromYear:new Date().getFullYear()-10,toYear:new Date().getFullYear()+1,disabled:s=>a?q(s,a):!1,className:"rounded-md border"})})})]}),e.jsx("div",{className:"text-muted-foreground",children:"to"}),e.jsxs(z,{open:T,onOpenChange:k,children:[e.jsx(B,{asChild:!0,children:e.jsxs(A,{variant:"outline",className:$("w-[140px] justify-start text-left font-normal",!a&&"text-muted-foreground"),disabled:!n,children:[e.jsx(I,{className:"mr-2 h-4 w-4"}),a?V(a,"LLL dd, y"):"To"]})}),e.jsx(W,{className:"w-auto p-0",align:"start",children:e.jsx("div",{className:"p-3",children:e.jsx(_,{mode:"single",selected:a,onSelect:x,initialFocus:!0,captionLayout:"dropdown-buttons",fromYear:n?n.getFullYear():new Date().getFullYear()-10,toYear:new Date().getFullYear()+1,disabled:s=>n?D(s,n):!1,className:"rounded-md border"})})})]}),e.jsx(A,{onClick:w,disabled:!n||!a,className:"ml-2",children:"Apply"})]})]})]})})})};function Y({title:t,value:r,change:o,trend:i="neutral"}){return e.jsxs(m,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(E,{className:"flex flex-row items-center justify-between pb-2",children:e.jsx(H,{className:"text-sm font-medium text-muted-foreground",children:t})}),e.jsxs(f,{children:[e.jsx("div",{className:"text-2xl font-bold",children:r}),o&&e.jsx("p",{className:$("text-xs mt-1",i==="up"&&"text-accent",i==="down"&&"text-destructive",i==="neutral"&&"text-muted-foreground"),children:o})]})]})}const pe=({metrics:t})=>e.jsxs("div",{className:"grid gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 w-full",children:[e.jsx(Y,{title:"Total Revenue",value:`£${t.revenue.value.toLocaleString()}`,change:t.revenue.text,trend:t.revenue.trend}),e.jsx(Y,{title:"Average Client Pay",value:`£${t.clientPay.value.toFixed(2)}`,change:t.clientPay.text,trend:t.clientPay.trend}),e.jsx(Y,{title:"Average Staff Pay",value:`£${t.staffPay.value.toFixed(2)}`,change:t.staffPay.text,trend:t.staffPay.trend})]}),ve=({salesData:t})=>{var r;return e.jsxs("div",{className:"grid gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 w-full",children:[e.jsx(m,{children:e.jsx(f,{className:"p-6",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Shifts"}),e.jsx("p",{className:"text-2xl font-bold",children:(t==null?void 0:t.totalShifts)||0})]})})})}),e.jsx(m,{children:e.jsx(f,{className:"p-6",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Clients"}),e.jsx("p",{className:"text-2xl font-bold",children:(t==null?void 0:t.totalClients)||0})]})})})}),e.jsx(m,{children:e.jsx(f,{className:"p-6",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Employees"}),e.jsx("p",{className:"text-2xl font-bold",children:(t==null?void 0:t.uniqueEmployees)||0})]})})})}),e.jsx(m,{children:e.jsx(f,{className:"p-6",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Profit Margin"}),e.jsxs("p",{className:"text-2xl font-bold",children:[((r=t==null?void 0:t.profitMargin)==null?void 0:r.toFixed(1))||0,"%"]})]})})})})]})},ie=({active:t,payload:r,label:o})=>t&&r&&r.length?e.jsxs("div",{className:"bg-background border border-border p-3 rounded-lg shadow-lg",children:[e.jsx("p",{className:"font-semibold text-foreground",children:o}),r.map((i,v)=>e.jsxs("p",{className:"text-sm",style:{color:i.color},children:[i.name,": £",Number(i.value).toLocaleString()]},v))]}):null,ge=({data:t,aggregationLevel:r})=>{const o={dataKey:"display",interval:0};return!t||t.length===0?e.jsxs(m,{children:[e.jsx(E,{children:e.jsx(H,{children:"Revenue vs Cost Trend"})}),e.jsx(f,{children:e.jsx("div",{className:"h-[400px] flex items-center justify-center",children:e.jsx("p",{className:"text-muted-foreground",children:"No data available for the selected period"})})})]}):e.jsxs(m,{children:[e.jsxs(E,{children:[e.jsx(H,{children:"Revenue vs Cost Trend"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[r==="daily"&&"Daily view",r==="weekly"&&"Weekly view",r==="monthly"&&"Monthly view"]})]}),e.jsx(f,{children:e.jsx("div",{className:"h-[400px]",children:e.jsx(te,{width:"100%",height:"100%",children:e.jsxs(se,{data:t,children:[e.jsx(re,{strokeDasharray:"3 3"}),e.jsx(ne,{dataKey:o.dataKey,tick:{fontSize:12},interval:o.interval}),e.jsx(ae,{}),e.jsx(le,{content:e.jsx(ie,{})}),e.jsx(oe,{}),e.jsx(J,{type:"monotone",dataKey:"revenue",name:"Revenue",stroke:"hsl(var(--primary))",fill:"hsl(var(--primary))",fillOpacity:.3,strokeWidth:2}),e.jsx(J,{type:"monotone",dataKey:"cost",name:"Cost",stroke:"hsl(var(--accent))",fill:"hsl(var(--accent))",fillOpacity:.3,strokeWidth:2})]})})})})]})},ye=()=>e.jsx("div",{className:"fixed inset-0 bg-background/80 backdrop-blur-sm z-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Loading Dashboard"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Fetching your data..."})]})]})});export{ve as A,je as D,ye as L,pe as M,ge as R,fe as c};
