import{ab as T,r as p,j as e,T as ee,e as F,B as E,I as Y,k as te,l as re,m as se,ac as ae}from"./index-DJIXzK9-.js";import{D as le,T as oe}from"./DashboardLayout-C_qde1jn.js";import{L as ie}from"./label-C-KBTemH.js";import{T as H}from"./trash-2-h9of-Lys.js";import{e as ne,f as D,s as ue,P as de,a as ce,C as me,b as fe,d as be}from"./popover-Bgjj0_Gs.js";import{D as I,a as z,b as B,c as J,d as K,e as G}from"./dialog-BQY6HI1x.js";import{P as V}from"./plus-CbWDBUWd.js";import"./users-C6KyAJbY.js";function he(r,a){const n=T(r.start),s=T(r.end);let y=+n>+s;const k=y?+n:+s,d=y?s:n;d.setHours(0,0,0,0),d.setDate(1);let f=1;const w=[];for(;+d<=k;)w.push(T(d)),d.setMonth(d.getMonth()+f);return y?w.reverse():w}function pe(r){const a=T(r),n=a.getFullYear();return a.setFullYear(n+1,0,0),a.setHours(23,59,59,999),a}function xe(r,a){return r===null||r===0?"":a.isPercentage?`${r.toFixed(2)}%`:a.isCurrency?`Â£${r.toLocaleString("en-GB",{minimumFractionDigits:2,maximumFractionDigits:2})}`:r.toLocaleString("en-GB",{maximumFractionDigits:2})}function ye({source:r,formula:a,value:n}){return e.jsxs("div",{className:"text-xs space-y-1",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Source:"})," ",r||"Unknown"]}),a&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Formula:"}),e.jsx("code",{className:"bg-muted px-1 rounded ml-1",children:a})]})]})}function ge({rowId:r,colId:a,value:n,row:s,isActive:y,source:k,onFocus:d,onUpdate:f,onNavigate:w}){const[v,i]=p.useState(!1),[u,x]=p.useState(""),o=p.useRef(null),g=p.useCallback(()=>{i(!0),x(n!==null?String(n):""),setTimeout(()=>{var l;return(l=o.current)==null?void 0:l.focus()},0)},[n]),_=p.useCallback(()=>{i(!1);const l=parseFloat(u);f(u===""?null:isNaN(l)?n:l)},[u,f,n]),S=p.useCallback(l=>{l.key==="Enter"?_():l.key==="Escape"&&i(!1)},[_]);return p.useEffect(()=>{if(y&&!v){const l=t=>{["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(t.key)?(t.preventDefault(),w({ArrowUp:"up",ArrowDown:"down",ArrowLeft:"left",ArrowRight:"right"}[t.key])):!t.ctrlKey&&!t.altKey&&!t.metaKey&&t.key.length===1?(g(),x("")):t.key==="Enter"?(t.preventDefault(),g()):(t.key==="Backspace"||t.key==="Delete")&&f(null)};return window.addEventListener("keydown",l),()=>window.removeEventListener("keydown",l)}},[y,v,w,g,f]),v?e.jsx("input",{ref:o,type:"text",className:"w-full h-full px-2 py-1 outline-none bg-background text-center font-lato",value:u,onChange:l=>x(l.target.value),onBlur:_,onKeyDown:S}):e.jsxs(te,{children:[e.jsx(re,{asChild:!0,children:e.jsx("div",{className:F("w-full h-full px-2 py-1 cursor-cell flex items-center justify-center font-lato",s.isHeader&&"font-bold"),onClick:d,onDoubleClick:g,children:xe(n,s)})}),k&&e.jsx(se,{children:e.jsx(ye,{source:k,value:n})})]})}function _e(r){let a="",n=r;for(;n>=0;)a=String.fromCharCode(n%26+65)+a,n=Math.floor(n/26)-1;return a}function Ce({rows:r,columns:a,data:n,activeCell:s,setActiveCell:y,updateCell:k,deleteRow:d,deleteColumn:f,navigateCell:w,updateRowFormula:v,renameColumn:i}){const[u,x]=p.useState(null);return e.jsxs("div",{className:"flex-1 overflow-auto relative border border-border rounded-md bg-background",children:[e.jsx(ee,{children:e.jsxs("table",{className:"w-full border-collapse table-fixed text-sm",children:[e.jsxs("thead",{className:"sticky top-0 z-20 bg-muted/90 backdrop-blur-sm shadow-sm",children:[e.jsxs("tr",{children:[e.jsx("th",{className:"w-12 border-b border-border bg-muted p-1 text-center text-xs text-muted-foreground font-normal select-none relative group",children:e.jsx("div",{className:"absolute inset-0 bg-muted/50"})}),e.jsx("th",{className:"w-64 border-b border-r border-border bg-muted p-2 text-left font-medium text-muted-foreground"}),a.map((o,g)=>e.jsx("th",{className:"border-b border-r border-border bg-muted p-1 text-center text-xs font-normal text-muted-foreground select-none relative min-w-[120px]",children:_e(g)},`excel-${g}`))]}),e.jsxs("tr",{children:[e.jsx("th",{className:"w-12 border-b border-border bg-background p-2"}),e.jsx("th",{className:"w-64 border-b border-r border-border bg-background p-2 text-left font-semibold text-foreground",children:"Metric / Account"}),a.map(o=>e.jsx("th",{className:F("relative border-b border-r border-border bg-background p-2 text-right font-semibold min-w-[120px]",o.isYearEnd?"text-primary/80 bg-primary/5":"text-foreground"),children:e.jsxs("div",{className:"flex items-center justify-end gap-2 group",children:[e.jsx("span",{className:"cursor-pointer hover:text-primary transition-colors py-1",onDoubleClick:()=>!o.isProtected&&x({id:o.id,type:"col",value:o.label}),children:o.label}),!o.isProtected&&e.jsx(E,{variant:"ghost",size:"icon",className:"h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity absolute top-1 right-1",onClick:()=>f(o.id),children:e.jsx(H,{className:"h-3 w-3 text-destructive"})})]})},o.id))]})]}),e.jsx("tbody",{children:r.map((o,g)=>e.jsxs("tr",{className:"group/row hover:bg-muted/30 transition-colors",children:[e.jsx("td",{className:"border-r border-b border-border bg-muted/30 p-2 text-center text-xs text-muted-foreground font-mono select-none sticky left-0 z-10 w-12 text-lato",children:g+1}),e.jsx("td",{className:"border-r border-b border-border p-2 font-medium bg-background relative w-64",children:e.jsxs("div",{className:"flex items-center justify-between group",children:[o.isHeader?e.jsx("span",{className:"font-bold text-primary",children:o.label}):e.jsx("span",{className:"cursor-pointer hover:text-primary transition-colors w-full",onDoubleClick:()=>!o.isAutoCalculated&&x({id:o.id,type:"row",value:o.label}),children:o.label}),!o.isAutoCalculated&&e.jsx(E,{variant:"ghost",size:"icon",className:"h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity absolute right-2",onClick:()=>d(o.id),children:e.jsx(H,{className:"h-3 w-3 text-destructive"})})]})}),a.map(_=>{var b;const S=(b=n[o.id])==null?void 0:b[_.id],l=(S==null?void 0:S.value)??null,t=(s==null?void 0:s.row)===o.id&&(s==null?void 0:s.col)===_.id;return e.jsx("td",{className:F("border-r border-b border-border p-0 relative min-w-[120px]",t?"ring-2 ring-primary z-10":"",o.isHeader?"bg-muted/20 font-semibold":"",_.isYearEnd?"bg-primary/5 font-semibold":""),onClick:()=>y({row:o.id,col:_.id}),children:e.jsx(ge,{rowId:o.id,colId:_.id,value:l,row:o,isActive:t,onFocus:()=>y({row:o.id,col:_.id}),onUpdate:m=>k(o.id,_.id,m),onNavigate:w})},`${o.id}-${_.id}`)})]},o.id))})]})}),u&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-background/80 backdrop-blur-sm",onClick:()=>x(null),children:e.jsxs("div",{className:"bg-card p-4 rounded-lg shadow-lg border w-96",onClick:o=>o.stopPropagation(),children:[e.jsxs(ie,{children:["Edit ",u.type==="row"?"Row":"Column"," Label"]}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx(Y,{autoFocus:!0,value:u.value,onChange:o=>x({...u,value:o.target.value}),onKeyDown:o=>{o.key==="Enter"&&(u.type==="col"&&i&&i(u.id,u.value),x(null))}}),e.jsx(E,{onClick:()=>x(null),children:"Done"})]})]})})]})}const L=r=>{if(!(r!=null&&r.from)||!(r!=null&&r.to))return new Date().getFullYear(),[{id:"jan",label:"January",isProtected:!0},{id:"feb",label:"February",isProtected:!0},{id:"mar",label:"March",isProtected:!0},{id:"apr",label:"April",isProtected:!0},{id:"may",label:"May",isProtected:!0},{id:"jun",label:"June",isProtected:!0},{id:"jul",label:"July",isProtected:!0},{id:"aug",label:"August",isProtected:!0},{id:"sep",label:"September",isProtected:!0},{id:"oct",label:"October",isProtected:!0},{id:"nov",label:"November",isProtected:!0},{id:"dec",label:"December",isProtected:!0},{id:"year_end",label:"Year End",isProtected:!0,isYearEnd:!0}];const n=he({start:ae(r.from),end:ne(r.to)}).map(s=>({id:D(s,"MMM-yyyy").toLowerCase(),label:D(s,"MMM yyyy"),isProtected:!0}));return n.push({id:"year_end",label:"Period Total",isProtected:!0,isYearEnd:!0}),n},U=(r,a,n)=>{var s,y;try{const k=Object.keys(a).sort((w,v)=>v.length-w.length);let d=r;for(const w of k){const v=new RegExp(`\\b${w}\\b`,"g");if(v.test(d)){const i=((y=(s=a[w])==null?void 0:s[n])==null?void 0:y.value)??0;d=d.replace(v,`(${i})`)}}if(!/^[0-9+\-*/().\s]*$/.test(d))return null;const f=new Function(`return ${d}`)();return typeof f=="number"&&!isNaN(f)&&isFinite(f)?f:null}catch{return null}},O=[{id:"total_sales",label:"Total Sales",isAutoCalculated:!1,isCurrency:!0},{id:"sales_split_pct",label:"% Sales Split for the Year",isAutoCalculated:!1,isPercentage:!0},{id:"cost_sales_se",label:"Cost of Sales SE",isAutoCalculated:!1,isCurrency:!0},{id:"cost_sales_paye",label:"Cost of Sales PAYE Gross",isAutoCalculated:!1,isCurrency:!0},{id:"employee_ni",label:"Employee NI",isAutoCalculated:!1,isCurrency:!0},{id:"employee_pension",label:"Employee Pension",isAutoCalculated:!1,isCurrency:!0},{id:"total_cost_sales",label:"Total Cost of Sales",isAutoCalculated:!0,isCurrency:!0,isHeader:!0,formulaString:"cost_sales_se + cost_sales_paye + employee_ni + employee_pension"},{id:"apprenticeship_levy",label:"Apprenticeship Levy",isAutoCalculated:!1,isCurrency:!0},{id:"annual_leave",label:"Annual Leave Accrual",isAutoCalculated:!1,isCurrency:!0},{id:"other_expenses",label:"Other Expenses",isAutoCalculated:!1,isCurrency:!0},{id:"recruitment_cost",label:"Recruitment & Pass Cost",isAutoCalculated:!1,isCurrency:!0},{id:"overheads_mgmt",label:"Mgmt & Office Cost",isAutoCalculated:!1,isCurrency:!0},{id:"bank_interest",label:"Bank Interest",isAutoCalculated:!1,isCurrency:!0},{id:"cooperation_tax",label:"Cooperation Tax",isAutoCalculated:!1,isCurrency:!0},{id:"total_overheads",label:"Total Overheads",isAutoCalculated:!0,isCurrency:!0,isHeader:!0,formulaString:"apprenticeship_levy + annual_leave + other_expenses + recruitment_cost + overheads_mgmt + bank_interest + cooperation_tax"},{id:"total_cost",label:"Total Cost",isAutoCalculated:!0,isCurrency:!0,isHeader:!0,formulaString:"total_cost_sales + total_overheads"},{id:"worked_hours",label:"Total Worked Hours",isAutoCalculated:!1,isCurrency:!1},{id:"avg_hourly_charge",label:"Avg Hourly Charge",isAutoCalculated:!0,isCurrency:!0,formulaString:"total_sales / worked_hours"},{id:"gross_hourly_pay",label:"Gross Hourly Pay",isAutoCalculated:!0,isCurrency:!0,formulaString:"total_cost_sales / worked_hours"},{id:"gross_hourly_margin",label:"Gross Hourly Margin",isAutoCalculated:!0,isCurrency:!0,formulaString:"avg_hourly_charge - gross_hourly_pay"},{id:"net_cost_per_hour",label:"Net Cost per Hour",isAutoCalculated:!0,isCurrency:!0,formulaString:"total_cost / worked_hours"},{id:"gross_pl_value",label:"Gross P&L Value",isAutoCalculated:!0,isCurrency:!0,formulaString:"total_sales - cost_sales_se"},{id:"net_pl",label:"Net P&L",isAutoCalculated:!0,isCurrency:!0,formulaString:"total_sales - total_cost"},{id:"total_net_margin",label:"Total Net Margin",isAutoCalculated:!0,isCurrency:!0,formulaString:"net_pl / worked_hours"},{id:"hours_breakeven",label:"Hours for Breakeven",isAutoCalculated:!0,formulaString:"(other_expenses + overheads_mgmt) / gross_hourly_margin"},{id:"value_breakeven",label:"Total Value for Breakeven",isAutoCalculated:!0,isCurrency:!0,formulaString:"hours_breakeven * net_cost_per_hour"},{id:"avg_hourly_charge_2026",label:"Avg Hourly Charge Rate Future",isAutoCalculated:!0,isCurrency:!0,formulaString:"avg_hourly_charge * 1.06"},{id:"sales_budget_2026",label:"Projected Sales Budget 30% Uplift",isAutoCalculated:!0,isCurrency:!0,formulaString:"total_sales * 1.3"},{id:"sales_target_hours",label:"Sales Target in Hours",isAutoCalculated:!0,formulaString:"sales_budget_2026 / avg_hourly_charge_2026"},{id:"variance_2025",label:"Variance",isAutoCalculated:!0,formulaString:"sales_target_hours - worked_hours"}];function R(r,a){const n={};for(const s of r){n[s.id]={};for(const y of a)n[s.id][y.id]={value:null,isEditable:!s.isAutoCalculated&&!y.isYearEnd,source:"manual"}}return n}function N(r,a,n){var w,v;const s=JSON.parse(JSON.stringify(r));for(const i of n.filter(u=>!u.isYearEnd))for(const u of a)u.formulaString?s[u.id][i.id]={...s[u.id][i.id],value:U(u.formulaString,s,i.id),isEditable:!1,source:"calculated"}:u.formula&&(s[u.id][i.id]={...s[u.id][i.id],value:u.formula(s,u.id,i.id),isEditable:!1,source:"calculated"});const y=a.find(i=>i.id==="total_sales"),k=a.find(i=>i.id==="sales_split_pct"),d=n.find(i=>i.isYearEnd);if(y&&k&&d){let i=0;const u=n.filter(x=>!x.isYearEnd);i=u.reduce((x,o)=>{var g,_;return x+(((_=(g=s.total_sales)==null?void 0:g[o.id])==null?void 0:_.value)??0)},0);for(const x of u){const o=((v=(w=s.total_sales)==null?void 0:w[x.id])==null?void 0:v.value)??0,g=i!==0?o/i*100:0;s.sales_split_pct[x.id]={value:g,isEditable:!1,source:"calculated"}}s.sales_split_pct[d.id]={value:i!==0?100:0,isEditable:!1,source:"calculated"}}const f=n.find(i=>i.isYearEnd);if(f)for(const i of a){if(i.id==="sales_split_pct")continue;const u=n.filter(x=>!x.isYearEnd).reduce((x,o)=>{var g,_;return x+(((_=(g=s[i.id])==null?void 0:g[o.id])==null?void 0:_.value)??0)},0);i.formulaString||i.isAutoCalculated?i.formulaString?s[i.id][f.id]={value:U(i.formulaString,s,f.id),isEditable:!1,source:"calculated"}:i.formula?s[i.id][f.id]={value:i.formula(s,i.id,f.id),isEditable:!1,source:"calculated"}:s[i.id][f.id]={value:u,isEditable:!1,source:"calculated"}:s[i.id][f.id]={value:u,isEditable:!1,source:"calculated"}}return s}function we(r){const[a,n]=p.useState(O),[s,y]=p.useState(()=>L(r)),[k,d]=p.useState(()=>N(R(O,L(r)),O,L(r))),[f,w]=p.useState(null);p.useEffect(()=>{const l=L(r);y(l);let t=R(a,l);r!=null&&r.from&&(r!=null&&r.to)?(async()=>{try{const m=D(r.from,"yyyy-MM-dd"),c=D(r.to,"yyyy-MM-dd"),j=localStorage.getItem("auth_token"),C=await fetch(`/api/financial-summary/metrics?start=${m}&end=${c}`,{headers:{Authorization:`Bearer ${j}`},credentials:"include"});if(C.status===401){console.error("Unauthorized: Redirecting to login"),window.location.href="/auth";return}if(C.ok){const h=C.headers.get("content-type");if(h&&h.indexOf("application/json")!==-1){const P=await C.json(),W={January:"jan",February:"feb",March:"mar",April:"apr",May:"may",June:"jun",July:"jul",August:"aug",September:"sep",October:"oct",November:"nov",December:"dec"};for(const[q,M]of Object.entries(P)){const[Q,X]=q.split("-"),$=W[X];if(!$)continue;const A=`${$}-${Q}`;l.find(Z=>Z.id===A)&&(t.total_sales&&t.total_sales[A]&&(t.total_sales[A].value=M.total_sales,t.total_sales[A].source="backend"),t.cost_sales_se&&t.cost_sales_se[A]&&(t.cost_sales_se[A].value=M.cost_sales_se,t.cost_sales_se[A].source="backend"),t.cost_sales_paye&&t.cost_sales_paye[A]&&(t.cost_sales_paye[A].value=M.cost_sales_paye,t.cost_sales_paye[A].source="backend"),t.worked_hours&&t.worked_hours[A]&&(t.worked_hours[A].value=M.total_hours,t.worked_hours[A].source="backend"))}d(N(t,a,l))}else console.error("Received non-JSON response from API"),d(N(t,a,l))}else console.error("API Error",C.status,C.statusText),d(N(t,a,l))}catch(m){console.error("Failed to fetch metrics",m),d(N(t,a,l))}})():d(N(t,a,l))},[r]);const v=p.useCallback((l,t,b)=>{d(m=>{const c={...m};return c[l]={...c[l]},c[l][t]={...c[l][t],value:b,source:"manual"},N(c,a,s)})},[a,s]),i=p.useCallback((l,t)=>{n(b=>{const m=b.map(c=>c.id===l?{...c,formulaString:t}:c);return d(c=>N(c,m,s)),m})},[s]),u=p.useCallback(l=>{const t=`custom_${Date.now()}`,b={id:t,label:l,isAutoCalculated:!1,isCurrency:!0};n(m=>{const c=[...m,b];return d(j=>{const C={...j};C[t]={};for(const h of s)C[t][h.id]={value:null,isEditable:!h.isYearEnd,source:"manual"};return N(C,c,s)}),c})},[s]),x=p.useCallback(l=>{n(t=>t.filter(b=>b.id!==l)),d(t=>{const b={...t};return delete b[l],b})},[]),o=p.useCallback(l=>{const t=`col_${Date.now()}`,b={id:t,label:l};y(m=>{const c=m.findIndex(C=>C.isYearEnd),j=[...m];return j.splice(c,0,b),d(C=>{const h={...C};for(const P of a)h[P.id]={...h[P.id]},h[P.id][t]={value:null,isEditable:!P.isAutoCalculated,source:"manual"};return N(h,a,j)}),j})},[a]),g=p.useCallback(l=>{y(t=>{const b=t.filter(m=>m.id!==l);return d(m=>{const c={...m};for(const j of Object.keys(c)){const{[l]:C,...h}=c[j];c[j]=h}return N(c,a,b)}),b})},[a]),_=p.useCallback((l,t)=>{y(b=>b.map(m=>m.id===l?{...m,label:t}:m))},[]),S=p.useCallback(l=>{if(!f)return;const t=a.filter(h=>!h.isAutoCalculated),b=s.filter(h=>!h.isYearEnd),m=t.findIndex(h=>h.id===f.row),c=b.findIndex(h=>h.id===f.col);if(m===-1||c===-1)return;let j=m,C=c;switch(l){case"up":j=Math.max(0,m-1);break;case"down":j=Math.min(t.length-1,m+1);break;case"left":C=Math.max(0,c-1);break;case"right":C=Math.min(b.length-1,c+1);break}w({row:t[j].id,col:b[C].id})},[f,a,s]);return{rows:a,columns:s,data:k,updateCell:v,updateRowFormula:i,addRow:u,deleteRow:x,addColumn:o,deleteColumn:g,renameColumn:_,activeCell:f,setActiveCell:w,navigateCell:S}}function Pe(){const[r,a]=p.useState({from:ue(new Date),to:pe(new Date)}),{rows:n,columns:s,data:y,activeCell:k,setActiveCell:d,updateCell:f,addRow:w,deleteRow:v,addColumn:i,deleteColumn:u,navigateCell:x,updateRowFormula:o}=we(r),[g,_]=p.useState(""),[S,l]=p.useState(""),[t,b]=p.useState(!1),[m,c]=p.useState(!1),j=()=>{g.trim()&&(w(g.trim()),_(""),b(!1))},C=()=>{S.trim()&&(i(S.trim()),l(""),c(!1))};return e.jsx(le,{noPadding:!0,fullWidth:!0,children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-border bg-card/50 shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx(oe,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-foreground",children:"Financial Summary."}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Annual budget and performance spreadsheet"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(de,{children:[e.jsx(ce,{asChild:!0,children:e.jsxs(E,{id:"date",variant:"outline",className:F("w-[260px] justify-start text-left font-normal",!r&&"text-muted-foreground"),children:[e.jsx(me,{className:"mr-2 h-4 w-4"}),r!=null&&r.from?r.to?e.jsxs(e.Fragment,{children:[D(r.from,"LLL dd, y")," -"," ",D(r.to,"LLL dd, y")]}):D(r.from,"LLL dd, y"):e.jsx("span",{children:"Pick a date"})]})}),e.jsx(fe,{className:"w-auto p-0",align:"end",children:e.jsx(be,{initialFocus:!0,mode:"range",defaultMonth:r==null?void 0:r.from,selected:r,onSelect:a,numberOfMonths:2,captionLayout:"dropdown-buttons",fromYear:2020,toYear:2030})})]}),e.jsxs(I,{open:t,onOpenChange:b,children:[e.jsx(z,{asChild:!0,children:e.jsxs(E,{variant:"outline",size:"sm",children:[e.jsx(V,{className:"h-4 w-4 mr-1"})," Add Row"]})}),e.jsxs(B,{children:[e.jsx(J,{children:e.jsx(K,{children:"Add New Row"})}),e.jsx(Y,{placeholder:"Row label...",value:g,onChange:h=>_(h.target.value),onKeyDown:h=>h.key==="Enter"&&j()}),e.jsx(G,{children:e.jsx(E,{onClick:j,disabled:!g.trim(),children:"Add"})})]})]}),e.jsxs(I,{open:m,onOpenChange:c,children:[e.jsx(z,{asChild:!0,children:e.jsxs(E,{variant:"outline",size:"sm",children:[e.jsx(V,{className:"h-4 w-4 mr-1"})," Add Column"]})}),e.jsxs(B,{children:[e.jsx(J,{children:e.jsx(K,{children:"Add New Column"})}),e.jsx(Y,{placeholder:"Column label...",value:S,onChange:h=>l(h.target.value),onKeyDown:h=>h.key==="Enter"&&C()}),e.jsx(G,{children:e.jsx(E,{onClick:C,disabled:!S.trim(),children:"Add"})})]})]})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:e.jsx(Ce,{rows:n,columns:s,data:y,activeCell:k,setActiveCell:d,updateCell:f,deleteRow:v,deleteColumn:u,navigateCell:x,updateRowFormula:o})})]})})}export{Pe as default};
