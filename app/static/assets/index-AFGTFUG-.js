const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MetricPalette-CY_On8BD.js","assets/index-BJiy8odN.js","assets/index-BoSx5LeJ.css","assets/card-ClAJ47U8.js","assets/trending-up--rpltb_Z.js","assets/popover-qZsJ34Yf.js","assets/button-CHTQkKGZ.js","assets/DashboardLayout-D1V24BW6.js","assets/users-C1EfjGbS.js","assets/ChartCanvas-B36zG8JM.js","assets/badge-BXDWAGM-.js","assets/AreaChart-DgvGnz9_.js","assets/BarChart-B1fBx44_.js"])))=>i.map(i=>d[i]);
import{c as Ie,r as s,P as O,g as J,j as a,b as R,X as De,a as Qe,S as Ze,_ as Ae}from"./index-BJiy8odN.js";import{u as K,R as et,P as Me,O as he,a as xe,b as tt,T as $e,c as Te,D as rt}from"./DashboardLayout-D1V24BW6.js";import{e as at,S as nt,a as st,b as lt,c as ot,d as te}from"./select-D9RpmEDB.js";import{B as ae}from"./button-CHTQkKGZ.js";import{P as de,b as ue,c as me,g as je,C as Ce,f as re,d as Ne}from"./popover-qZsJ34Yf.js";import{C as it,a as ct,b as dt,d as ut}from"./card-ClAJ47U8.js";import"./users-C1EfjGbS.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=Ie("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ft=Ie("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),pt=()=>{const[e,r]=s.useState({dimensions:[],metrics:[],chartType:"bar",dateRange:{from:void 0,to:void 0},customMetrics:[],chartData:[],draggedItem:void 0});return{state:e,setDimensions:l=>{r(u=>({...u,dimensions:l}))},setMetrics:l=>{r(u=>({...u,metrics:l}))},setChartType:l=>{r(u=>({...u,chartType:l}))},setDateRange:l=>{r(u=>({...u,dateRange:l}))},addCustomMetric:l=>{r(u=>({...u,customMetrics:[...u.customMetrics,l]}))},setChartData:l=>{r(u=>({...u,chartData:l}))},setDraggedItem:l=>{r(u=>({...u,draggedItem:l}))}}};var Se=1,ht=.9,xt=.8,vt=.17,oe=.1,ie=.999,gt=.9999,yt=.99,bt=/[\\\/_+.#"@\[\(\{&]/,wt=/[\\\/_+.#"@\[\(\{&]/g,jt=/[\s-]/,Le=/[\s-]/g;function fe(e,r,t,m,i,c,f){if(c===r.length)return i===e.length?Se:yt;var o=`${i},${c}`;if(f[o]!==void 0)return f[o];for(var p=m.charAt(c),l=t.indexOf(p,i),u=0,y,S,C,M;l>=0;)y=fe(e,r,t,m,l+1,c+1,f),y>u&&(l===i?y*=Se:bt.test(e.charAt(l-1))?(y*=xt,C=e.slice(i,l-1).match(wt),C&&i>0&&(y*=Math.pow(ie,C.length))):jt.test(e.charAt(l-1))?(y*=ht,M=e.slice(i,l-1).match(Le),M&&i>0&&(y*=Math.pow(ie,M.length))):(y*=vt,i>0&&(y*=Math.pow(ie,l-i))),e.charAt(l)!==r.charAt(c)&&(y*=gt)),(y<oe&&t.charAt(l-1)===m.charAt(c+1)||m.charAt(c+1)===m.charAt(c)&&t.charAt(l-1)!==m.charAt(c))&&(S=fe(e,r,t,m,l+1,c+2,f),S*oe>y&&(y=S*oe)),y>u&&(u=y),l=t.indexOf(p,l+1);return f[o]=u,u}function ke(e){return e.toLowerCase().replace(Le," ")}function Ct(e,r,t){return e=t&&t.length>0?`${e+" "+t.join(" ")}`:e,fe(e,r,ke(e),ke(r),0,0,{})}var W='[cmdk-group=""]',ce='[cmdk-group-items=""]',Nt='[cmdk-group-heading=""]',Pe='[cmdk-item=""]',Ee=`${Pe}:not([aria-disabled="true"])`,pe="cmdk-item-select",V="data-value",St=(e,r,t)=>Ct(e,r,t),Oe=s.createContext(void 0),Q=()=>s.useContext(Oe),ze=s.createContext(void 0),ve=()=>s.useContext(ze),Fe=s.createContext(void 0),_e=s.forwardRef((e,r)=>{let t=q(()=>{var n,h;return{search:"",value:(h=(n=e.value)!=null?n:e.defaultValue)!=null?h:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),m=q(()=>new Set),i=q(()=>new Map),c=q(()=>new Map),f=q(()=>new Set),o=Be(e),{label:p,children:l,value:u,onValueChange:y,filter:S,shouldFilter:C,loop:M,disablePointerSelection:U=!1,vimBindings:T=!0,...$}=e,Y=K(),Z=K(),G=K(),L=s.useRef(null),w=Pt();_(()=>{if(u!==void 0){let n=u.trim();t.current.value=n,N.emit()}},[u]),_(()=>{w(6,D)},[]);let N=s.useMemo(()=>({subscribe:n=>(f.current.add(n),()=>f.current.delete(n)),snapshot:()=>t.current,setState:(n,h,v)=>{var d,g,b,A;if(!Object.is(t.current[n],h)){if(t.current[n]=h,n==="search")X(),F(),w(1,H);else if(n==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let E=document.getElementById(G);E?E.focus():(d=document.getElementById(Y))==null||d.focus()}if(w(7,()=>{var E;t.current.selectedItemId=(E=P())==null?void 0:E.id,N.emit()}),v||w(5,D),((g=o.current)==null?void 0:g.value)!==void 0){let E=h??"";(A=(b=o.current).onValueChange)==null||A.call(b,E);return}}N.emit()}},emit:()=>{f.current.forEach(n=>n())}}),[]),x=s.useMemo(()=>({value:(n,h,v)=>{var d;h!==((d=c.current.get(n))==null?void 0:d.value)&&(c.current.set(n,{value:h,keywords:v}),t.current.filtered.items.set(n,j(h,v)),w(2,()=>{F(),N.emit()}))},item:(n,h)=>(m.current.add(n),h&&(i.current.has(h)?i.current.get(h).add(n):i.current.set(h,new Set([n]))),w(3,()=>{X(),F(),t.current.value||H(),N.emit()}),()=>{c.current.delete(n),m.current.delete(n),t.current.filtered.items.delete(n);let v=P();w(4,()=>{X(),(v==null?void 0:v.getAttribute("id"))===n&&H(),N.emit()})}),group:n=>(i.current.has(n)||i.current.set(n,new Set),()=>{c.current.delete(n),i.current.delete(n)}),filter:()=>o.current.shouldFilter,label:p||e["aria-label"],getDisablePointerSelection:()=>o.current.disablePointerSelection,listId:Y,inputId:G,labelId:Z,listInnerRef:L}),[]);function j(n,h){var v,d;let g=(d=(v=o.current)==null?void 0:v.filter)!=null?d:St;return n?g(n,t.current.search,h):0}function F(){if(!t.current.search||o.current.shouldFilter===!1)return;let n=t.current.filtered.items,h=[];t.current.filtered.groups.forEach(d=>{let g=i.current.get(d),b=0;g.forEach(A=>{let E=n.get(A);b=Math.max(E,b)}),h.push([d,b])});let v=L.current;k().sort((d,g)=>{var b,A;let E=d.getAttribute("id"),ee=g.getAttribute("id");return((b=n.get(ee))!=null?b:0)-((A=n.get(E))!=null?A:0)}).forEach(d=>{let g=d.closest(ce);g?g.appendChild(d.parentElement===g?d:d.closest(`${ce} > *`)):v.appendChild(d.parentElement===v?d:d.closest(`${ce} > *`))}),h.sort((d,g)=>g[1]-d[1]).forEach(d=>{var g;let b=(g=L.current)==null?void 0:g.querySelector(`${W}[${V}="${encodeURIComponent(d[0])}"]`);b==null||b.parentElement.appendChild(b)})}function H(){let n=k().find(v=>v.getAttribute("aria-disabled")!=="true"),h=n==null?void 0:n.getAttribute(V);N.setState("value",h||void 0)}function X(){var n,h,v,d;if(!t.current.search||o.current.shouldFilter===!1){t.current.filtered.count=m.current.size;return}t.current.filtered.groups=new Set;let g=0;for(let b of m.current){let A=(h=(n=c.current.get(b))==null?void 0:n.value)!=null?h:"",E=(d=(v=c.current.get(b))==null?void 0:v.keywords)!=null?d:[],ee=j(A,E);t.current.filtered.items.set(b,ee),ee>0&&g++}for(let[b,A]of i.current)for(let E of A)if(t.current.filtered.items.get(E)>0){t.current.filtered.groups.add(b);break}t.current.filtered.count=g}function D(){var n,h,v;let d=P();d&&(((n=d.parentElement)==null?void 0:n.firstChild)===d&&((v=(h=d.closest(W))==null?void 0:h.querySelector(Nt))==null||v.scrollIntoView({block:"nearest"})),d.scrollIntoView({block:"nearest"}))}function P(){var n;return(n=L.current)==null?void 0:n.querySelector(`${Pe}[aria-selected="true"]`)}function k(){var n;return Array.from(((n=L.current)==null?void 0:n.querySelectorAll(Ee))||[])}function se(n){let h=k()[n];h&&N.setState("value",h.getAttribute(V))}function le(n){var h;let v=P(),d=k(),g=d.findIndex(A=>A===v),b=d[g+n];(h=o.current)!=null&&h.loop&&(b=g+n<0?d[d.length-1]:g+n===d.length?d[0]:d[g+n]),b&&N.setState("value",b.getAttribute(V))}function ge(n){let h=P(),v=h==null?void 0:h.closest(W),d;for(;v&&!d;)v=n>0?Tt(v,W):Lt(v,W),d=v==null?void 0:v.querySelector(Ee);d?N.setState("value",d.getAttribute(V)):le(n)}let ye=()=>se(k().length-1),be=n=>{n.preventDefault(),n.metaKey?ye():n.altKey?ge(1):le(1)},we=n=>{n.preventDefault(),n.metaKey?se(0):n.altKey?ge(-1):le(-1)};return s.createElement(O.div,{ref:r,tabIndex:-1,...$,"cmdk-root":"",onKeyDown:n=>{var h;(h=$.onKeyDown)==null||h.call($,n);let v=n.nativeEvent.isComposing||n.keyCode===229;if(!(n.defaultPrevented||v))switch(n.key){case"n":case"j":{T&&n.ctrlKey&&be(n);break}case"ArrowDown":{be(n);break}case"p":case"k":{T&&n.ctrlKey&&we(n);break}case"ArrowUp":{we(n);break}case"Home":{n.preventDefault(),se(0);break}case"End":{n.preventDefault(),ye();break}case"Enter":{n.preventDefault();let d=P();if(d){let g=new Event(pe);d.dispatchEvent(g)}}}}},s.createElement("label",{"cmdk-label":"",htmlFor:x.inputId,id:x.labelId,style:zt},p),ne(e,n=>s.createElement(ze.Provider,{value:N},s.createElement(Oe.Provider,{value:x},n))))}),kt=s.forwardRef((e,r)=>{var t,m;let i=K(),c=s.useRef(null),f=s.useContext(Fe),o=Q(),p=Be(e),l=(m=(t=p.current)==null?void 0:t.forceMount)!=null?m:f==null?void 0:f.forceMount;_(()=>{if(!l)return o.item(i,f==null?void 0:f.id)},[l]);let u=Ve(i,c,[e.value,e.children,c],e.keywords),y=ve(),S=z(w=>w.value&&w.value===u.current),C=z(w=>l||o.filter()===!1?!0:w.search?w.filtered.items.get(i)>0:!0);s.useEffect(()=>{let w=c.current;if(!(!w||e.disabled))return w.addEventListener(pe,M),()=>w.removeEventListener(pe,M)},[C,e.onSelect,e.disabled]);function M(){var w,N;U(),(N=(w=p.current).onSelect)==null||N.call(w,u.current)}function U(){y.setState("value",u.current,!0)}if(!C)return null;let{disabled:T,value:$,onSelect:Y,forceMount:Z,keywords:G,...L}=e;return s.createElement(O.div,{ref:J(c,r),...L,id:i,"cmdk-item":"",role:"option","aria-disabled":!!T,"aria-selected":!!S,"data-disabled":!!T,"data-selected":!!S,onPointerMove:T||o.getDisablePointerSelection()?void 0:U,onClick:T?void 0:M},e.children)}),Et=s.forwardRef((e,r)=>{let{heading:t,children:m,forceMount:i,...c}=e,f=K(),o=s.useRef(null),p=s.useRef(null),l=K(),u=Q(),y=z(C=>i||u.filter()===!1?!0:C.search?C.filtered.groups.has(f):!0);_(()=>u.group(f),[]),Ve(f,o,[e.value,e.heading,p]);let S=s.useMemo(()=>({id:f,forceMount:i}),[i]);return s.createElement(O.div,{ref:J(o,r),...c,"cmdk-group":"",role:"presentation",hidden:y?void 0:!0},t&&s.createElement("div",{ref:p,"cmdk-group-heading":"","aria-hidden":!0,id:l},t),ne(e,C=>s.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":t?l:void 0},s.createElement(Fe.Provider,{value:S},C))))}),Rt=s.forwardRef((e,r)=>{let{alwaysRender:t,...m}=e,i=s.useRef(null),c=z(f=>!f.search);return!t&&!c?null:s.createElement(O.div,{ref:J(i,r),...m,"cmdk-separator":"",role:"separator"})}),It=s.forwardRef((e,r)=>{let{onValueChange:t,...m}=e,i=e.value!=null,c=ve(),f=z(l=>l.search),o=z(l=>l.selectedItemId),p=Q();return s.useEffect(()=>{e.value!=null&&c.setState("search",e.value)},[e.value]),s.createElement(O.input,{ref:r,...m,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":p.listId,"aria-labelledby":p.labelId,"aria-activedescendant":o,id:p.inputId,type:"text",value:i?e.value:f,onChange:l=>{i||c.setState("search",l.target.value),t==null||t(l.target.value)}})}),Dt=s.forwardRef((e,r)=>{let{children:t,label:m="Suggestions",...i}=e,c=s.useRef(null),f=s.useRef(null),o=z(l=>l.selectedItemId),p=Q();return s.useEffect(()=>{if(f.current&&c.current){let l=f.current,u=c.current,y,S=new ResizeObserver(()=>{y=requestAnimationFrame(()=>{let C=l.offsetHeight;u.style.setProperty("--cmdk-list-height",C.toFixed(1)+"px")})});return S.observe(l),()=>{cancelAnimationFrame(y),S.unobserve(l)}}},[]),s.createElement(O.div,{ref:J(c,r),...i,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":o,"aria-label":m,id:p.listId},ne(e,l=>s.createElement("div",{ref:J(f,p.listInnerRef),"cmdk-list-sizer":""},l)))}),At=s.forwardRef((e,r)=>{let{open:t,onOpenChange:m,overlayClassName:i,contentClassName:c,container:f,...o}=e;return s.createElement(et,{open:t,onOpenChange:m},s.createElement(Me,{container:f},s.createElement(he,{"cmdk-overlay":"",className:i}),s.createElement(xe,{"aria-label":e.label,"cmdk-dialog":"",className:c},s.createElement(_e,{ref:r,...o}))))}),Mt=s.forwardRef((e,r)=>z(t=>t.filtered.count===0)?s.createElement(O.div,{ref:r,...e,"cmdk-empty":"",role:"presentation"}):null),$t=s.forwardRef((e,r)=>{let{progress:t,children:m,label:i="Loading...",...c}=e;return s.createElement(O.div,{ref:r,...c,"cmdk-loading":"",role:"progressbar","aria-valuenow":t,"aria-valuemin":0,"aria-valuemax":100,"aria-label":i},ne(e,f=>s.createElement("div",{"aria-hidden":!0},f)))}),I=Object.assign(_e,{List:Dt,Item:kt,Input:It,Group:Et,Separator:Rt,Dialog:At,Empty:Mt,Loading:$t});function Tt(e,r){let t=e.nextElementSibling;for(;t;){if(t.matches(r))return t;t=t.nextElementSibling}}function Lt(e,r){let t=e.previousElementSibling;for(;t;){if(t.matches(r))return t;t=t.previousElementSibling}}function Be(e){let r=s.useRef(e);return _(()=>{r.current=e}),r}var _=typeof window>"u"?s.useEffect:s.useLayoutEffect;function q(e){let r=s.useRef();return r.current===void 0&&(r.current=e()),r}function z(e){let r=ve(),t=()=>e(r.snapshot());return s.useSyncExternalStore(r.subscribe,t,t)}function Ve(e,r,t,m=[]){let i=s.useRef(),c=Q();return _(()=>{var f;let o=(()=>{var l;for(let u of t){if(typeof u=="string")return u.trim();if(typeof u=="object"&&"current"in u)return u.current?(l=u.current.textContent)==null?void 0:l.trim():i.current}})(),p=m.map(l=>l.trim());c.value(e,o,p),(f=r.current)==null||f.setAttribute(V,o),i.current=o}),i}var Pt=()=>{let[e,r]=s.useState(),t=q(()=>new Map);return _(()=>{t.current.forEach(m=>m()),t.current=new Map},[e]),(m,i)=>{t.current.set(m,i),r({})}};function Ot(e){let r=e.type;return typeof r=="function"?r(e.props):"render"in r?r.render(e.props):e}function ne({asChild:e,children:r},t){return e&&s.isValidElement(r)?s.cloneElement(Ot(r),{ref:r.ref},t(r.props.children)):t(r)}var zt={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const Ft=Me,qe=s.forwardRef(({className:e,...r},t)=>a.jsx(he,{ref:t,className:R("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...r}));qe.displayName=he.displayName;const _t=s.forwardRef(({className:e,children:r,...t},m)=>a.jsxs(Ft,{children:[a.jsx(qe,{}),a.jsxs(xe,{ref:m,className:R("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t,children:[r,a.jsxs(tt,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-accent data-[state=open]:text-muted-foreground hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[a.jsx(De,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));_t.displayName=xe.displayName;const Bt=s.forwardRef(({className:e,...r},t)=>a.jsx($e,{ref:t,className:R("text-lg font-semibold leading-none tracking-tight",e),...r}));Bt.displayName=$e.displayName;const Vt=s.forwardRef(({className:e,...r},t)=>a.jsx(Te,{ref:t,className:R("text-sm text-muted-foreground",e),...r}));Vt.displayName=Te.displayName;const Ke=s.forwardRef(({className:e,...r},t)=>a.jsx(I,{ref:t,className:R("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",e),...r}));Ke.displayName=I.displayName;const Ue=s.forwardRef(({className:e,...r},t)=>a.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[a.jsx(ft,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),a.jsx(I.Input,{ref:t,className:R("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",e),...r})]}));Ue.displayName=I.Input.displayName;const qt=s.forwardRef(({className:e,...r},t)=>a.jsx(I.List,{ref:t,className:R("max-h-[300px] overflow-y-auto overflow-x-hidden",e),...r}));qt.displayName=I.List.displayName;const Ye=s.forwardRef((e,r)=>a.jsx(I.Empty,{ref:r,className:"py-6 text-center text-sm",...e}));Ye.displayName=I.Empty.displayName;const Ge=s.forwardRef(({className:e,...r},t)=>a.jsx(I.Group,{ref:t,className:R("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",e),...r}));Ge.displayName=I.Group.displayName;const Kt=s.forwardRef(({className:e,...r},t)=>a.jsx(I.Separator,{ref:t,className:R("-mx-1 h-px bg-border",e),...r}));Kt.displayName=I.Separator.displayName;const He=s.forwardRef(({className:e,...r},t)=>a.jsx(I.Item,{ref:t,className:R("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50",e),...r}));He.displayName=I.Item.displayName;var Ut="Separator",Re="horizontal",Yt=["horizontal","vertical"],Xe=s.forwardRef((e,r)=>{const{decorative:t,orientation:m=Re,...i}=e,c=Gt(m)?m:Re,o=t?{role:"none"}:{"aria-orientation":c==="vertical"?c:void 0,role:"separator"};return a.jsx(O.div,{"data-orientation":c,...o,...i,ref:r})});Xe.displayName=Ut;function Gt(e){return Yt.includes(e)}var We=Xe;const Je=s.forwardRef(({className:e,orientation:r="horizontal",decorative:t=!0,...m},i)=>a.jsx(We,{ref:i,decorative:t,orientation:r,className:R("shrink-0 bg-border",r==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...m}));Je.displayName=We.displayName;function B({title:e,options:r,selected:t,onChange:m,placeholder:i="Select..."}){const[c,f]=s.useState(!1),o=l=>{t.includes(l)?m(t.filter(u=>u!==l)):m([...t,l])},p=l=>{l.stopPropagation(),m([])};return a.jsxs("div",{className:"flex flex-col gap-1.5 min-w-[180px]",children:[a.jsx("label",{className:"text-xs font-medium text-muted-foreground",children:e}),a.jsxs(de,{open:c,onOpenChange:f,children:[a.jsx(ue,{asChild:!0,children:a.jsxs(ae,{variant:"outline",role:"combobox","aria-expanded":c,className:"w-full justify-between h-9 px-3 text-sm",children:[a.jsxs("div",{className:"flex flex-wrap gap-1 items-center overflow-hidden",children:[t.length===0&&a.jsx("span",{className:"text-muted-foreground font-normal truncate",children:i}),t.length>0&&a.jsx("span",{className:"truncate",children:t.length===1?t[0]:`${t.length} selected`})]}),a.jsxs("div",{className:"flex items-center gap-2 shrink-0 opacity-50 ml-2",children:[t.length>0&&a.jsx(De,{className:"h-3 w-3 cursor-pointer hover:opacity-100",onClick:p}),a.jsx(mt,{className:"h-3 w-3"})]})]})}),a.jsx(me,{className:"w-[200px] p-0",align:"start",children:a.jsxs(Ke,{children:[a.jsx(Ue,{placeholder:`Search ${e.toLowerCase()}...`}),a.jsxs(Ye,{children:["No ",e.toLowerCase()," found."]}),a.jsx(Ge,{className:"max-h-64 overflow-auto",children:r.map(l=>a.jsxs(He,{value:l,onSelect:()=>o(l),children:[a.jsx(at,{className:R("mr-2 h-4 w-4",t.includes(l)?"opacity-100":"opacity-0")}),l]},l))})]})})]})]})}function Ht({availableFilters:e,filters:r,onFilterChange:t,orientation:m="vertical"}){const i=s.useMemo(()=>{if(r.locations.length===0){const p=new Set;return e.locations.forEach(l=>{l.sites.forEach(u=>p.add(u))}),Array.from(p).sort()}else{const p=new Set;return e.locations.filter(l=>r.locations.includes(l.name)).forEach(l=>{l.sites.forEach(u=>p.add(u))}),Array.from(p).sort()}},[e.locations,r.locations]),c=p=>{t({...r,clients:p})},f=p=>{t({...r,locations:p})},o=p=>{t({...r,sites:p})};return m==="horizontal"?a.jsxs("div",{className:"flex flex-wrap items-end gap-4 p-1",children:[a.jsx("div",{className:"flex items-center gap-2 text-sm font-medium text-muted-foreground mr-2 pb-2",children:a.jsx("span",{children:"ðŸŒªï¸ Filters:"})}),a.jsx(B,{title:"Clients",options:e.clients,selected:r.clients,onChange:c,placeholder:"All Clients"}),a.jsx(B,{title:"Locations",options:e.locations.map(p=>p.name),selected:r.locations,onChange:f,placeholder:"All Locations"}),a.jsx(B,{title:"Sites",options:i,selected:r.sites,onChange:o,placeholder:"All Sites"})]}):a.jsxs(it,{className:"h-full flex flex-col",children:[a.jsx(ct,{className:"pb-3",children:a.jsx(dt,{className:"text-lg flex items-center gap-2",children:"ðŸŒªï¸ Filters"})}),a.jsxs(ut,{className:"space-y-4 flex-1 overflow-y-auto",children:[a.jsx(B,{title:"Clients",options:e.clients,selected:r.clients,onChange:c,placeholder:"All Clients"}),a.jsx(Je,{}),a.jsx(B,{title:"Locations",options:e.locations.map(p=>p.name),selected:r.locations,onChange:f,placeholder:"All Locations"}),a.jsx(B,{title:"Sites",options:i,selected:r.sites,onChange:o,placeholder:"All Sites"})]})]})}const Xt=s.lazy(()=>Ae(()=>import("./MetricPalette-CY_On8BD.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]))),Wt=s.lazy(()=>Ae(()=>import("./ChartCanvas-B36zG8JM.js"),__vite__mapDeps([9,1,2,10,11,12])));function nr(){const{state:e,setDimensions:r,setMetrics:t,setChartType:m,setDateRange:i,setChartData:c}=pt(),{toast:f}=Qe(),[o,p]=s.useState({from:new Date,to:je(new Date,30)}),[l,u]=s.useState({from:new Date,to:je(new Date,30)}),[y,S]=s.useState(!1),[C,M]=s.useState(!1),[U,T]=s.useState({clients:[],locations:[]}),[$,Y]=s.useState({clients:[],locations:[],sites:[]});s.useEffect(()=>{(async()=>{try{const j=await fetch("/api/filters",{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});if(j.ok){const F=await j.json();T(F)}}catch(j){console.error("Error fetching filters:",j)}})()},[]);const Z=()=>{u(o)};s.useEffect(()=>{(async()=>{if(e.dimensions.length===0||e.metrics.length===0||!(l!=null&&l.from)||!(l!=null&&l.to)){c([]);return}const j=e.dimensions[0],F=e.metrics,H=re(l.from,"yyyy-MM-dd"),X=re(l.to,"yyyy-MM-dd");try{const D=new URLSearchParams;D.append("start",H),D.append("end",X),D.append("dimension",j),F.forEach(k=>D.append("metrics",k)),$.clients.forEach(k=>D.append("clients",k)),$.locations.forEach(k=>D.append("locations",k)),$.sites.forEach(k=>D.append("sites",k));const P=await fetch(`/api/chart-data?${D.toString()}`,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});if(P.ok){const k=await P.json();c(k)}else console.error("Failed to fetch chart data"),c([])}catch(D){console.error("Error fetching chart data:",D),c([])}})()},[e.dimensions,e.metrics,l,$]);const G=x=>{x.type==="dimension"?e.dimensions.includes(x.name)||(r([x.name]),f({description:`Added ${x.name} to chart`,duration:2e3})):x.type==="metric"&&(e.metrics.includes(x.name)||(t([...e.metrics,x.name]),f({description:`Added ${x.name} to chart`,duration:2e3})))},L=x=>{x.type==="dimension"?e.dimensions.includes(x.name)&&(r(e.dimensions.filter(j=>j!==x.name)),f({description:`Removed ${x.name} from chart`,duration:2e3})):x.type==="metric"&&e.metrics.includes(x.name)&&(t(e.metrics.filter(j=>j!==x.name)),f({description:`Removed ${x.name} from chart`,duration:2e3}))},w=x=>{r(e.dimensions.filter(j=>j!==x))},N=x=>{t(e.metrics.filter(j=>j!==x))};return a.jsx(rt,{children:a.jsx("div",{className:"p-4 md:p-6 h-full flex flex-col",children:a.jsxs("div",{className:"space-y-4 h-full flex flex-col",children:[a.jsx("div",{className:"sticky lg:top-0 z-30 pb-2 border-b -mx-4 md:-mx-6 px-4 md:px-6 pt-1 shadow-sm bg-background",children:a.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[a.jsx("div",{children:a.jsx("h1",{className:"text-xl font-bold",children:"Chart Builder"})}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("div",{className:"w-32",children:a.jsxs(nt,{value:e.chartType,onValueChange:m,children:[a.jsx(st,{className:"h-8 text-xs",children:a.jsx(lt,{placeholder:"Chart Type"})}),a.jsxs(ot,{children:[a.jsx(te,{value:"bar",children:"Bar Chart"}),a.jsx(te,{value:"line",children:"Line Chart"}),a.jsx(te,{value:"area",children:"Area Chart"}),a.jsx(te,{value:"pie",children:"Pie Chart"})]})]})}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(de,{open:y,onOpenChange:S,children:[a.jsx(ue,{asChild:!0,children:a.jsxs(ae,{variant:"outline",className:R("w-32 justify-start text-left font-normal h-8 text-xs",!(o!=null&&o.from)&&"text-muted-foreground"),children:[a.jsx(Ce,{className:"mr-2 h-3 w-3"}),o!=null&&o.from?re(o.from,"MMM dd, y"):a.jsx("span",{children:"From"})]})}),a.jsx(me,{className:"w-auto p-0",align:"start",children:a.jsx(Ne,{mode:"single",selected:o==null?void 0:o.from,onSelect:x=>{p(j=>({...j,from:x})),S(!1)},defaultMonth:o==null?void 0:o.from,captionLayout:"dropdown-buttons",fromYear:2020,toYear:2030})})]}),a.jsx("span",{className:"text-muted-foreground text-xs",children:"-"}),a.jsxs(de,{open:C,onOpenChange:M,children:[a.jsx(ue,{asChild:!0,children:a.jsxs(ae,{variant:"outline",className:R("w-32 justify-start text-left font-normal h-8 text-xs",!(o!=null&&o.to)&&"text-muted-foreground"),children:[a.jsx(Ce,{className:"mr-2 h-3 w-3"}),o!=null&&o.to?re(o.to,"MMM dd, y"):a.jsx("span",{children:"To"})]})}),a.jsx(me,{className:"w-auto p-0",align:"start",children:a.jsx(Ne,{mode:"single",selected:o==null?void 0:o.to,onSelect:x=>{p(j=>({...j,to:x})),M(!1)},defaultMonth:o==null?void 0:o.to,captionLayout:"dropdown-buttons",fromYear:2020,toYear:2030,disabled:x=>x<((o==null?void 0:o.from)||new Date(0))})})]}),a.jsx(ae,{onClick:Z,size:"sm",className:"h-8 text-xs",disabled:!(o!=null&&o.from)||!(o!=null&&o.to),children:"Apply"})]})]})]})}),a.jsx("div",{className:"flex-1 min-h-0 overflow-hidden",children:a.jsx(s.Suspense,{fallback:a.jsx("div",{className:"flex-1 flex items-center justify-center",children:a.jsx(Ze,{className:"h-8 w-8 rounded-full"})}),children:a.jsxs("div",{className:"flex-1 flex flex-col lg:flex-row gap-4 min-h-0 h-full",children:[a.jsx("div",{className:"lg:w-72 shrink-0 h-full flex flex-col overflow-hidden",children:a.jsx("div",{className:"flex-1 min-h-0 overflow-y-auto pr-2",children:a.jsx(Xt,{selectedDimensions:e.dimensions,selectedMetrics:e.metrics,onItemClick:G,onItemDoubleClick:L})})}),a.jsxs("div",{className:"flex-1 min-w-0 flex flex-col h-full overflow-hidden",children:[a.jsx("div",{className:"shrink-0 pb-2 border-b mb-2",children:a.jsx(Ht,{availableFilters:U,filters:$,onFilterChange:Y,orientation:"horizontal"})}),a.jsx("div",{className:"flex-1 min-h-0 overflow-y-auto",children:a.jsx(Wt,{dimensions:e.dimensions,metrics:e.metrics,chartType:e.chartType,chartData:e.chartData,onRemoveDimension:w,onRemoveMetric:N})})]})]})})})]})})})}export{nr as default};
