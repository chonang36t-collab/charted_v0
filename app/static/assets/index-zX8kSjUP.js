var zt=e=>{throw TypeError(e)};var rt=(e,t,n)=>t.has(e)||zt("Cannot "+n);var l=(e,t,n)=>(rt(e,t,"read from private field"),n?n.call(e):t.get(e)),O=(e,t,n)=>t.has(e)?zt("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),I=(e,t,n,r)=>(rt(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),P=(e,t,n)=>(rt(e,t,"access private method"),n);import{c as It,y as ds,z as Wt,B as q,C as He,D as De,E as Qe,F as pt,G as Yt,H as Dn,I as Tn,J as On,K as Xt,L as Ye,M as Jt,N as Fn,r as i,O as hs,Q as ke,j as s,d as k,A as Le,g as Xe,m as _t,U as qe,P as z,i as R,k as $e,h as xe,s as An,b as fs,V as ps,q as Et,W as ms,Y as kn,Z as Ln,$ as $n,a0 as Un,a1 as xs,a2 as Gn,a3 as Kn,a4 as Bn,a5 as Vn}from"./index-T_FCZlXq.js";import{a as Hn,b as Pt,h as Qn,u as qn,c as zn,R as Wn,D as Yn}from"./DashboardLayout-DEuGe1C7.js";import{I as J}from"./input-vP6rdCsz.js";import{b as Xn,B as me}from"./button-CyG16ZRo.js";import{o as Jn,s as je,j as se,b as Zt,u as Zn,t as er,L as mt,C as ot,T as tr,c as sr,d as we,f as X,g as nr,h as G,P as rr,i as or}from"./types-eTlrXzqO.js";import{B as ar}from"./badge-S-1zzaNw.js";import{d as ir,D as es,a as ts,b as ss,c as ns}from"./dialog-CH8vLRsG.js";import{L}from"./label-GlUTRKi_.js";import{S as at,a as it,b as ct,c as lt,d as _e}from"./select-DGgbJLRf.js";import{C as cr,a as lr,b as ur,f as dr,c as hr,d as fr,e as pr,S as mr}from"./command-DNofn8MJ.js";import{P as xr,a as gr,b as vr,f as ut}from"./popover-CRpwizYy.js";import{C as gs,b as vs,a as br}from"./index-O4k-ZWSK.js";import{E as yr}from"./ellipsis-DCJoBLle.js";import"./users-CtluV95c.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=It("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jr=It("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wr=It("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);var K,w,Fe,$,he,Ce,ie,ce,Ae,Re,Se,fe,pe,le,Ne,N,Ee,xt,gt,vt,bt,yt,jt,wt,bs,ls,Cr=(ls=class extends ds{constructor(t,n){super();O(this,N);O(this,K);O(this,w);O(this,Fe);O(this,$);O(this,he);O(this,Ce);O(this,ie);O(this,ce);O(this,Ae);O(this,Re);O(this,Se);O(this,fe);O(this,pe);O(this,le);O(this,Ne,new Set);this.options=n,I(this,K,t),I(this,ce,null),I(this,ie,Wt()),this.options.experimental_prefetchInRender||l(this,ie).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(l(this,w).addObserver(this),rs(l(this,w),this.options)?P(this,N,Ee).call(this):this.updateResult(),P(this,N,bt).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Ct(l(this,w),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Ct(l(this,w),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,P(this,N,yt).call(this),P(this,N,jt).call(this),l(this,w).removeObserver(this)}setOptions(t){const n=this.options,r=l(this,w);if(this.options=l(this,K).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof q(this.options.enabled,l(this,w))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");P(this,N,wt).call(this),l(this,w).setOptions(this.options),n._defaulted&&!He(this.options,n)&&l(this,K).getQueryCache().notify({type:"observerOptionsUpdated",query:l(this,w),observer:this});const a=this.hasListeners();a&&os(l(this,w),r,this.options,n)&&P(this,N,Ee).call(this),this.updateResult(),a&&(l(this,w)!==r||q(this.options.enabled,l(this,w))!==q(n.enabled,l(this,w))||De(this.options.staleTime,l(this,w))!==De(n.staleTime,l(this,w)))&&P(this,N,xt).call(this);const o=P(this,N,gt).call(this);a&&(l(this,w)!==r||q(this.options.enabled,l(this,w))!==q(n.enabled,l(this,w))||o!==l(this,le))&&P(this,N,vt).call(this,o)}getOptimisticResult(t){const n=l(this,K).getQueryCache().build(l(this,K),t),r=this.createResult(n,t);return Sr(this,r)&&(I(this,$,r),I(this,Ce,this.options),I(this,he,l(this,w).state)),r}getCurrentResult(){return l(this,$)}trackResult(t,n){return new Proxy(t,{get:(r,a)=>(this.trackProp(a),n==null||n(a),Reflect.get(r,a))})}trackProp(t){l(this,Ne).add(t)}getCurrentQuery(){return l(this,w)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const n=l(this,K).defaultQueryOptions(t),r=l(this,K).getQueryCache().build(l(this,K),n);return r.fetch().then(()=>this.createResult(r,n))}fetch(t){return P(this,N,Ee).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),l(this,$)))}createResult(t,n){var g;const r=l(this,w),a=this.options,o=l(this,$),u=l(this,he),m=l(this,Ce),f=t!==r?t.state:l(this,Fe),{state:d}=t;let c={...d},v=!1,b;if(n._optimisticResults){const y=this.hasListeners(),T=!y&&rs(t,n),F=y&&os(t,r,n,a);(T||F)&&(c={...c,...On(d.data,t.options)}),n._optimisticResults==="isRestoring"&&(c.fetchStatus="idle")}let{error:h,errorUpdatedAt:S,status:x}=c;b=c.data;let C=!1;if(n.placeholderData!==void 0&&b===void 0&&x==="pending"){let y;o!=null&&o.isPlaceholderData&&n.placeholderData===(m==null?void 0:m.placeholderData)?(y=o.data,C=!0):y=typeof n.placeholderData=="function"?n.placeholderData((g=l(this,Se))==null?void 0:g.state.data,l(this,Se)):n.placeholderData,y!==void 0&&(x="success",b=Xt(o==null?void 0:o.data,y,n),v=!0)}if(n.select&&b!==void 0&&!C)if(o&&b===(u==null?void 0:u.data)&&n.select===l(this,Ae))b=l(this,Re);else try{I(this,Ae,n.select),b=n.select(b),b=Xt(o==null?void 0:o.data,b,n),I(this,Re,b),I(this,ce,null)}catch(y){I(this,ce,y)}l(this,ce)&&(h=l(this,ce),b=l(this,Re),S=Date.now(),x="error");const _=c.fetchStatus==="fetching",E=x==="pending",A=x==="error",Q=E&&_,Z=b!==void 0,M={status:x,fetchStatus:c.fetchStatus,isPending:E,isSuccess:x==="success",isError:A,isInitialLoading:Q,isLoading:Q,data:b,dataUpdatedAt:c.dataUpdatedAt,error:h,errorUpdatedAt:S,failureCount:c.fetchFailureCount,failureReason:c.fetchFailureReason,errorUpdateCount:c.errorUpdateCount,isFetched:c.dataUpdateCount>0||c.errorUpdateCount>0,isFetchedAfterMount:c.dataUpdateCount>f.dataUpdateCount||c.errorUpdateCount>f.errorUpdateCount,isFetching:_,isRefetching:_&&!E,isLoadingError:A&&!Z,isPaused:c.fetchStatus==="paused",isPlaceholderData:v,isRefetchError:A&&Z,isStale:Dt(t,n),refetch:this.refetch,promise:l(this,ie),isEnabled:q(n.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const y=D=>{M.status==="error"?D.reject(M.error):M.data!==void 0&&D.resolve(M.data)},T=()=>{const D=I(this,ie,M.promise=Wt());y(D)},F=l(this,ie);switch(F.status){case"pending":t.queryHash===r.queryHash&&y(F);break;case"fulfilled":(M.status==="error"||M.data!==F.value)&&T();break;case"rejected":(M.status!=="error"||M.error!==F.reason)&&T();break}}return M}updateResult(){const t=l(this,$),n=this.createResult(l(this,w),this.options);if(I(this,he,l(this,w).state),I(this,Ce,this.options),l(this,he).data!==void 0&&I(this,Se,l(this,w)),He(n,t))return;I(this,$,n);const r=()=>{if(!t)return!0;const{notifyOnChangeProps:a}=this.options,o=typeof a=="function"?a():a;if(o==="all"||!o&&!l(this,Ne).size)return!0;const u=new Set(o??l(this,Ne));return this.options.throwOnError&&u.add("error"),Object.keys(l(this,$)).some(m=>{const p=m;return l(this,$)[p]!==t[p]&&u.has(p)})};P(this,N,bs).call(this,{listeners:r()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&P(this,N,bt).call(this)}},K=new WeakMap,w=new WeakMap,Fe=new WeakMap,$=new WeakMap,he=new WeakMap,Ce=new WeakMap,ie=new WeakMap,ce=new WeakMap,Ae=new WeakMap,Re=new WeakMap,Se=new WeakMap,fe=new WeakMap,pe=new WeakMap,le=new WeakMap,Ne=new WeakMap,N=new WeakSet,Ee=function(t){P(this,N,wt).call(this);let n=l(this,w).fetch(this.options,t);return t!=null&&t.throwOnError||(n=n.catch(Qe)),n},xt=function(){P(this,N,yt).call(this);const t=De(this.options.staleTime,l(this,w));if(pt||l(this,$).isStale||!Yt(t))return;const r=Dn(l(this,$).dataUpdatedAt,t)+1;I(this,fe,setTimeout(()=>{l(this,$).isStale||this.updateResult()},r))},gt=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(l(this,w)):this.options.refetchInterval)??!1},vt=function(t){P(this,N,jt).call(this),I(this,le,t),!(pt||q(this.options.enabled,l(this,w))===!1||!Yt(l(this,le))||l(this,le)===0)&&I(this,pe,setInterval(()=>{(this.options.refetchIntervalInBackground||Tn.isFocused())&&P(this,N,Ee).call(this)},l(this,le)))},bt=function(){P(this,N,xt).call(this),P(this,N,vt).call(this,P(this,N,gt).call(this))},yt=function(){l(this,fe)&&(clearTimeout(l(this,fe)),I(this,fe,void 0))},jt=function(){l(this,pe)&&(clearInterval(l(this,pe)),I(this,pe,void 0))},wt=function(){const t=l(this,K).getQueryCache().build(l(this,K),this.options);if(t===l(this,w))return;const n=l(this,w);I(this,w,t),I(this,Fe,t.state),this.hasListeners()&&(n==null||n.removeObserver(this),t.addObserver(this))},bs=function(t){Ye.batch(()=>{t.listeners&&this.listeners.forEach(n=>{n(l(this,$))}),l(this,K).getQueryCache().notify({query:l(this,w),type:"observerResultsUpdated"})})},ls);function Rr(e,t){return q(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function rs(e,t){return Rr(e,t)||e.state.data!==void 0&&Ct(e,t,t.refetchOnMount)}function Ct(e,t,n){if(q(t.enabled,e)!==!1&&De(t.staleTime,e)!=="static"){const r=typeof n=="function"?n(e):n;return r==="always"||r!==!1&&Dt(e,t)}return!1}function os(e,t,n,r){return(e!==t||q(r.enabled,e)===!1)&&(!n.suspense||e.state.status!=="error")&&Dt(e,n)}function Dt(e,t){return q(t.enabled,e)!==!1&&e.isStaleByTime(De(t.staleTime,e))}function Sr(e,t){return!He(e.getCurrentResult(),t)}var ue,de,B,ne,re,Be,Rt,us,Nr=(us=class extends ds{constructor(t,n){super();O(this,re);O(this,ue);O(this,de);O(this,B);O(this,ne);I(this,ue,t),this.setOptions(n),this.bindMethods(),P(this,re,Be).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var r;const n=this.options;this.options=l(this,ue).defaultMutationOptions(t),He(this.options,n)||l(this,ue).getMutationCache().notify({type:"observerOptionsUpdated",mutation:l(this,B),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&Jt(n.mutationKey)!==Jt(this.options.mutationKey)?this.reset():((r=l(this,B))==null?void 0:r.state.status)==="pending"&&l(this,B).setOptions(this.options)}onUnsubscribe(){var t;this.hasListeners()||(t=l(this,B))==null||t.removeObserver(this)}onMutationUpdate(t){P(this,re,Be).call(this),P(this,re,Rt).call(this,t)}getCurrentResult(){return l(this,de)}reset(){var t;(t=l(this,B))==null||t.removeObserver(this),I(this,B,void 0),P(this,re,Be).call(this),P(this,re,Rt).call(this)}mutate(t,n){var r;return I(this,ne,n),(r=l(this,B))==null||r.removeObserver(this),I(this,B,l(this,ue).getMutationCache().build(l(this,ue),this.options)),l(this,B).addObserver(this),l(this,B).execute(t)}},ue=new WeakMap,de=new WeakMap,B=new WeakMap,ne=new WeakMap,re=new WeakSet,Be=function(){var n;const t=((n=l(this,B))==null?void 0:n.state)??Fn();I(this,de,{...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset})},Rt=function(t){Ye.batch(()=>{var n,r,a,o,u,m,p,f;if(l(this,ne)&&this.hasListeners()){const d=l(this,de).variables,c=l(this,de).context;(t==null?void 0:t.type)==="success"?((r=(n=l(this,ne)).onSuccess)==null||r.call(n,t.data,d,c),(o=(a=l(this,ne)).onSettled)==null||o.call(a,t.data,null,d,c)):(t==null?void 0:t.type)==="error"&&((m=(u=l(this,ne)).onError)==null||m.call(u,t.error,d,c),(f=(p=l(this,ne)).onSettled)==null||f.call(p,void 0,t.error,d,c))}this.listeners.forEach(d=>{d(l(this,de))})})},us),ys=i.createContext(!1),Mr=()=>i.useContext(ys);ys.Provider;function Ir(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var _r=i.createContext(Ir()),Er=()=>i.useContext(_r),Pr=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},Dr=e=>{i.useEffect(()=>{e.clearReset()},[e])},Tr=({result:e,errorResetBoundary:t,throwOnError:n,query:r,suspense:a})=>e.isError&&!t.isReset()&&!e.isFetching&&r&&(a&&e.data===void 0||hs(n,[e.error,r])),Or=e=>{if(e.suspense){const t=r=>r==="static"?r:Math.max(r??1e3,1e3),n=e.staleTime;e.staleTime=typeof n=="function"?(...r)=>t(n(...r)):t(n),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},Fr=(e,t)=>e.isLoading&&e.isFetching&&!t,Ar=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,as=(e,t,n)=>t.fetchOptimistic(e).catch(()=>{n.clearReset()});function kr(e,t,n){var c,v,b,h,S;const r=Mr(),a=Er(),o=ke(),u=o.defaultQueryOptions(e);(v=(c=o.getDefaultOptions().queries)==null?void 0:c._experimental_beforeQuery)==null||v.call(c,u),u._optimisticResults=r?"isRestoring":"optimistic",Or(u),Pr(u,a),Dr(a);const m=!o.getQueryCache().get(u.queryHash),[p]=i.useState(()=>new t(o,u)),f=p.getOptimisticResult(u),d=!r&&e.subscribed!==!1;if(i.useSyncExternalStore(i.useCallback(x=>{const C=d?p.subscribe(Ye.batchCalls(x)):Qe;return p.updateResult(),C},[p,d]),()=>p.getCurrentResult(),()=>p.getCurrentResult()),i.useEffect(()=>{p.setOptions(u)},[u,p]),Ar(u,f))throw as(u,p,a);if(Tr({result:f,errorResetBoundary:a,throwOnError:u.throwOnError,query:o.getQueryCache().get(u.queryHash),suspense:u.suspense}))throw f.error;if((h=(b=o.getDefaultOptions().queries)==null?void 0:b._experimental_afterQuery)==null||h.call(b,u,f),u.experimental_prefetchInRender&&!pt&&Fr(f,r)){const x=m?as(u,p,a):(S=o.getQueryCache().get(u.queryHash))==null?void 0:S.promise;x==null||x.catch(Qe).finally(()=>{p.updateResult()})}return u.notifyOnChangeProps?f:p.trackResult(f)}function js(e,t){return kr(e,Cr)}function Tt(e,t){const n=ke(),[r]=i.useState(()=>new Nr(n,e));i.useEffect(()=>{r.setOptions(e)},[r,e]);const a=i.useSyncExternalStore(i.useCallback(u=>r.subscribe(Ye.batchCalls(u)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),o=i.useCallback((u,m)=>{r.mutate(u,m).catch(Qe)},[r]);if(a.error&&hs(r.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:o,mutateAsync:a.mutate}}const ws=({className:e,...t})=>s.jsx("nav",{role:"navigation","aria-label":"pagination",className:k("mx-auto flex w-full justify-center",e),...t});ws.displayName="Pagination";const Cs=i.forwardRef(({className:e,...t},n)=>s.jsx("ul",{ref:n,className:k("flex flex-row items-center gap-1",e),...t}));Cs.displayName="PaginationContent";const Ve=i.forwardRef(({className:e,...t},n)=>s.jsx("li",{ref:n,className:k("",e),...t}));Ve.displayName="PaginationItem";const Ot=({className:e,isActive:t,size:n="icon",...r})=>s.jsx("a",{"aria-current":t?"page":void 0,className:k(Xn({variant:t?"outline":"ghost",size:n}),e),...r});Ot.displayName="PaginationLink";const Rs=({className:e,...t})=>s.jsxs(Ot,{"aria-label":"Go to previous page",size:"default",className:k("gap-1 pl-2.5",e),...t,children:[s.jsx(Hn,{className:"h-4 w-4"}),s.jsx("span",{children:"Previous"})]});Rs.displayName="PaginationPrevious";const Ss=({className:e,...t})=>s.jsxs(Ot,{"aria-label":"Go to next page",size:"default",className:k("gap-1 pr-2.5",e),...t,children:[s.jsx("span",{children:"Next"}),s.jsx(Pt,{className:"h-4 w-4"})]});Ss.displayName="PaginationNext";const Lr=e=>js({queryKey:["records",e],queryFn:async()=>{const t=new URLSearchParams;t.append("page",e.page.toString()),t.append("limit",e.limit.toString()),e.sort_by&&t.append("sort_by",e.sort_by),e.sort_order&&t.append("sort_order",e.sort_order),e.search&&t.append("search",e.search),e.start&&t.append("start",e.start),e.end&&t.append("end",e.end),e.locations&&t.append("locations",e.locations),e.sites&&t.append("sites",e.sites),e.clients&&t.append("clients",e.clients);const n=await fetch(`${Le.RECORDS}?${t.toString()}`,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")}`},credentials:"include"});if(!n.ok){const r=await n.json().catch(()=>({}));throw new Error(r.error||"Failed to fetch records")}return n.json()},placeholderData:t=>t}),$r=()=>js({queryKey:["records-options"],queryFn:async()=>{const e=await fetch(`${Le.RECORDS}/options`,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});if(!e.ok)throw new Error("Failed to fetch options");return e.json()}}),Ur=()=>{const e=ke();return Tt({mutationFn:async t=>{const n=await fetch(Le.RECORDS,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")}`},body:JSON.stringify(t)});if(!n.ok){const r=await n.json();throw new Error(r.error||"Failed to create record")}return n.json()},onSuccess:()=>{e.invalidateQueries({queryKey:["records"]})}})},Gr=()=>{const e=ke();return Tt({mutationFn:async t=>{const{id:n,...r}=t,a=await fetch(`${Le.RECORDS}/${n}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")}`},body:JSON.stringify(r)});if(!a.ok){const o=await a.json();throw new Error(o.error||"Failed to update record")}return a.json()},onSuccess:()=>{e.invalidateQueries({queryKey:["records"]})}})},Kr=()=>{const e=ke();return Tt({mutationFn:async t=>{const n=await fetch(`${Le.RECORDS}/${t}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});if(!n.ok){const r=await n.json();throw new Error(r.error||"Failed to delete record")}return n.json()},onSuccess:()=>{e.invalidateQueries({queryKey:["records"]})}})};var Je="Collapsible",[Br,Ka]=Xe(Je),[Vr,Ft]=Br(Je),Ns=i.forwardRef((e,t)=>{const{__scopeCollapsible:n,open:r,defaultOpen:a,disabled:o,onOpenChange:u,...m}=e,[p,f]=_t({prop:r,defaultProp:a??!1,onChange:u,caller:Je});return s.jsx(Vr,{scope:n,disabled:o,contentId:qe(),open:p,onOpenToggle:i.useCallback(()=>f(d=>!d),[f]),children:s.jsx(z.div,{"data-state":kt(p),"data-disabled":o?"":void 0,...m,ref:t})})});Ns.displayName=Je;var Ms="CollapsibleTrigger",Is=i.forwardRef((e,t)=>{const{__scopeCollapsible:n,...r}=e,a=Ft(Ms,n);return s.jsx(z.button,{type:"button","aria-controls":a.contentId,"aria-expanded":a.open||!1,"data-state":kt(a.open),"data-disabled":a.disabled?"":void 0,disabled:a.disabled,...r,ref:t,onClick:R(e.onClick,a.onOpenToggle)})});Is.displayName=Ms;var At="CollapsibleContent",Hr=i.forwardRef((e,t)=>{const{forceMount:n,...r}=e,a=Ft(At,e.__scopeCollapsible);return s.jsx($e,{present:n||a.open,children:({present:o})=>s.jsx(Qr,{...r,ref:t,present:o})})});Hr.displayName=At;var Qr=i.forwardRef((e,t)=>{const{__scopeCollapsible:n,present:r,children:a,...o}=e,u=Ft(At,n),[m,p]=i.useState(r),f=i.useRef(null),d=xe(t,f),c=i.useRef(0),v=c.current,b=i.useRef(0),h=b.current,S=u.open||m,x=i.useRef(S),C=i.useRef(void 0);return i.useEffect(()=>{const _=requestAnimationFrame(()=>x.current=!1);return()=>cancelAnimationFrame(_)},[]),An(()=>{const _=f.current;if(_){C.current=C.current||{transitionDuration:_.style.transitionDuration,animationName:_.style.animationName},_.style.transitionDuration="0s",_.style.animationName="none";const E=_.getBoundingClientRect();c.current=E.height,b.current=E.width,x.current||(_.style.transitionDuration=C.current.transitionDuration,_.style.animationName=C.current.animationName),p(r)}},[u.open,r]),s.jsx(z.div,{"data-state":kt(u.open),"data-disabled":u.disabled?"":void 0,id:u.contentId,hidden:!S,...o,ref:d,style:{"--radix-collapsible-content-height":v?`${v}px`:void 0,"--radix-collapsible-content-width":h?`${h}px`:void 0,...e.style},children:S&&a})});function kt(e){return e?"open":"closed"}var qr=Ns;const zr=qr,Wr=Is;function ht({options:e,value:t,onChange:n,placeholder:r="Select...",searchPlaceholder:a="Search...",emptyMessage:o="No results found.",className:u,disabled:m=!1}){var d;const[p,f]=i.useState(!1);return s.jsxs(xr,{open:p,onOpenChange:f,children:[s.jsx(gr,{asChild:!0,children:s.jsxs(me,{variant:"outline",role:"combobox","aria-expanded":p,className:k("w-full justify-between",u),disabled:m,children:[t?(d=e.find(c=>c.value===t))==null?void 0:d.label:r,s.jsx(cr,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),s.jsx(vr,{className:"w-full p-0",align:"start",children:s.jsxs(lr,{children:[s.jsx(ur,{placeholder:a}),s.jsxs(dr,{children:[s.jsx(hr,{children:o}),s.jsx(fr,{children:e.map(c=>s.jsxs(pr,{value:c.label,onSelect:v=>{n(c.value===t?"":c.value),f(!1)},children:[s.jsx(gs,{className:k("mr-2 h-4 w-4",t===c.value?"opacity-100":"opacity-0")}),c.label]},c.value))})]})]})})]})}const Yr=Jn({date:je().min(1,"Date is required"),employeeId:se.number().min(1,"Employee is required"),clientId:se.number().min(1,"Client is required"),jobId:se.number().min(1,"Job is required"),shiftId:se.number().min(1,"Shift is required"),startTime:je().min(1,"Start time is required"),endTime:je().min(1,"End time is required"),hours:se.number().min(.1,"Hours must be greater than 0"),hourRate:se.number().optional(),clientHourlyRate:se.number().optional(),job_name:je().optional(),role:je().optional(),jobStatus:je().optional(),additions:se.number().optional(),deductions:se.number().optional(),self_employed:Zt().optional(),dns:Zt().optional()}),is=({record:e,onSuccess:t,onCancel:n})=>{const{role:r}=fs(),a=r==="admin",{data:o,isLoading:u}=$r(),m=Ur(),p=Gr(),[f,d]=i.useState(""),[c,v]=i.useState(""),b=!!e,h=Zn({resolver:er(Yr),defaultValues:{date:(e==null?void 0:e.date)||new Date().toISOString().split("T")[0],employeeId:void 0,clientId:void 0,jobId:void 0,shiftId:void 0,startTime:e!=null&&e.shiftStart?e.shiftStart.substring(0,5):"09:00",endTime:e!=null&&e.shiftEnd?e.shiftEnd.substring(0,5):"17:00",hours:(e==null?void 0:e.paidHours)||8,hourRate:(e==null?void 0:e.hourRate)||0,clientHourlyRate:(e==null?void 0:e.clientHourlyRate)||0,job_name:(e==null?void 0:e.jobName)||"",role:"Travel Retail Specialist",jobStatus:(e==null?void 0:e.jobStatus)||"Currently Working - Full Airside Pass",additions:0,deductions:0,self_employed:!1,dns:!1}}),S=h.watch("startTime"),x=h.watch("endTime"),C=h.watch("shiftId"),_=i.useMemo(()=>o!=null&&o.jobs?Array.from(new Set(o.jobs.map(g=>g.location).filter(Boolean))):[],[o]),E=i.useMemo(()=>!(o!=null&&o.jobs)||!f?[]:Array.from(new Set(o.jobs.filter(g=>g.location===f).map(g=>g.site).filter(Boolean))),[o,f]);i.useEffect(()=>{if(e&&o){const g=o.employees.find(D=>D.name===e.fullName);g&&h.setValue("employeeId",g.id);const y=o.clients.find(D=>D.name===e.clientName);y&&h.setValue("clientId",y.id);const T=o.shifts.find(D=>D.name===e.shiftName);T&&h.setValue("shiftId",T.id);let F=o.jobs.find(D=>D.name===e.jobName&&D.site===e.site);F||(F=o.jobs.find(D=>D.site===e.site&&D.location===e.location)),F&&(h.setValue("jobId",F.id),d(F.location),v(F.site))}},[e,o,h]),i.useEffect(()=>{if(S&&x){const[g,y]=S.split(":").map(Number),[T,F]=x.split(":").map(Number);let D=g*60+y,oe=T*60+F;oe<D&&(oe+=24*60);const Me=(oe-D)/60;h.setValue("hours",parseFloat(Me.toFixed(2)))}},[S,x,h]),i.useEffect(()=>{var g;if(!b&&C&&(o!=null&&o.shifts)){const y=(g=o.shifts.find(T=>T.id===C))==null?void 0:g.name;y&&h.setValue("job_name",y)}},[C,b,o,h]),i.useEffect(()=>{if(f&&c&&(o!=null&&o.jobs)){const g=o.jobs.find(y=>y.location===f&&y.site===c);g&&h.setValue("jobId",g.id)}},[f,c,o,h]);const A=g=>{b&&e?p.mutate({id:e.id,...g},{onSuccess:t}):m.mutate(g,{onSuccess:t})},Q=m.isPending||p.isPending;if(u)return s.jsx("div",{className:"flex justify-center p-4",children:s.jsx(mt,{className:"animate-spin"})});const Z=(o==null?void 0:o.employees.map(g=>({value:g.id.toString(),label:g.name})))||[],W=(o==null?void 0:o.clients.map(g=>({value:g.id.toString(),label:g.name})))||[],M=(o==null?void 0:o.shifts.map(g=>({value:g.id.toString(),label:`${g.name} (${g.start.substring(0,5)}-${g.end.substring(0,5)})`})))||[];return s.jsxs("form",{onSubmit:h.handleSubmit(A),className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(L,{htmlFor:"date",children:"Date"}),s.jsx(J,{id:"date",type:"date",...h.register("date")}),h.formState.errors.date&&s.jsx("span",{className:"text-red-500 text-xs",children:h.formState.errors.date.message})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(L,{htmlFor:"startTime",children:"Start Time"}),s.jsx(J,{id:"startTime",type:"time",...h.register("startTime")})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(L,{htmlFor:"endTime",children:"End Time"}),s.jsx(J,{id:"endTime",type:"time",...h.register("endTime")})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(L,{children:["Calculated Hours: ",h.watch("hours")]}),s.jsx(J,{type:"hidden",...h.register("hours")})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(L,{children:"Employee"}),s.jsx(ot,{control:h.control,name:"employeeId",render:({field:g})=>{var y;return s.jsx(ht,{options:Z,value:(y=g.value)==null?void 0:y.toString(),onChange:T=>g.onChange(Number(T)),placeholder:"Select Employee...",searchPlaceholder:"Search employees..."})}}),h.formState.errors.employeeId&&s.jsx("span",{className:"text-red-500 text-xs",children:h.formState.errors.employeeId.message})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(L,{children:"Client"}),s.jsx(ot,{control:h.control,name:"clientId",render:({field:g})=>{var y;return s.jsx(ht,{options:W,value:(y=g.value)==null?void 0:y.toString(),onChange:T=>g.onChange(Number(T)),placeholder:"Select Client...",searchPlaceholder:"Search clients..."})}}),h.formState.errors.clientId&&s.jsx("span",{className:"text-red-500 text-xs",children:h.formState.errors.clientId.message})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(L,{children:"Location"}),s.jsxs(at,{value:f,onValueChange:g=>{d(g),v("")},children:[s.jsx(it,{children:s.jsx(ct,{placeholder:"Select Location"})}),s.jsx(lt,{children:_.map(g=>s.jsx(_e,{value:g,children:g},g))})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(L,{children:"Site / Terminal"}),s.jsxs(at,{value:c,onValueChange:v,disabled:!f,children:[s.jsx(it,{children:s.jsx(ct,{placeholder:"Select Site"})}),s.jsx(lt,{children:E.map(g=>s.jsx(_e,{value:g,children:g},g))})]}),s.jsx("input",{type:"hidden",...h.register("jobId")}),h.formState.errors.jobId&&s.jsx("span",{className:"text-red-500 text-xs",children:"Job Selection Incomplete"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(L,{children:"Shift"}),s.jsx(ot,{control:h.control,name:"shiftId",render:({field:g})=>{var y;return s.jsx(ht,{options:M,value:(y=g.value)==null?void 0:y.toString(),onChange:T=>g.onChange(Number(T)),placeholder:"Select Shift config...",searchPlaceholder:"Search shifts..."})}}),h.formState.errors.shiftId&&s.jsx("span",{className:"text-red-500 text-xs",children:h.formState.errors.shiftId.message})]}),(a||b)&&s.jsxs("div",{className:"border-t pt-4 grid grid-cols-2 gap-4 bg-muted/20 p-4 rounded-md",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(L,{children:"Role"}),s.jsx(J,{...h.register("role")})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(L,{children:"Status"}),s.jsxs(at,{onValueChange:g=>h.setValue("jobStatus",g),defaultValue:h.getValues("jobStatus"),children:[s.jsx(it,{children:s.jsx(ct,{placeholder:"Status"})}),s.jsxs(lt,{children:[s.jsx(_e,{value:"Currently Working - Full Airside Pass",children:"Currently Working - Full Airside Pass"}),s.jsx(_e,{value:"Completed",children:"Completed"}),s.jsx(_e,{value:"Cancelled",children:"Cancelled"})]})]})]}),a&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(L,{htmlFor:"hourRate",children:"Pay Rate (£)"}),s.jsx(J,{id:"hourRate",type:"number",step:"0.01",...h.register("hourRate")})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(L,{htmlFor:"clientHourlyRate",children:"Charge Rate (£)"}),s.jsx(J,{id:"clientHourlyRate",type:"number",step:"0.01",...h.register("clientHourlyRate")})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(L,{htmlFor:"additions",children:"Additions (£)"}),s.jsx(J,{id:"additions",type:"number",step:"0.01",...h.register("additions")})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(L,{htmlFor:"deductions",children:"Deductions (£)"}),s.jsx(J,{id:"deductions",type:"number",step:"0.01",...h.register("deductions")})]})]})]}),s.jsxs(ir,{className:"mt-6 flex justify-between items-center w-full",children:[s.jsx("div",{className:"text-xs text-muted-foreground",children:!b&&"Defaults: Role=Travel Retail, Additions=0, Deductions=0"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(me,{type:"button",variant:"outline",onClick:n,children:"Cancel"}),s.jsxs(me,{type:"submit",disabled:Q,children:[Q&&s.jsx(mt,{className:"mr-2 h-4 w-4 animate-spin"}),b?"Update Record":"Create Record"]})]})]})]})};var ft="rovingFocusGroup.onEntryFocus",Xr={bubbles:!1,cancelable:!0},Ue="RovingFocusGroup",[St,_s,Jr]=ps(Ue),[Zr,Es]=Xe(Ue,[Jr]),[eo,to]=Zr(Ue),Ps=i.forwardRef((e,t)=>s.jsx(St.Provider,{scope:e.__scopeRovingFocusGroup,children:s.jsx(St.Slot,{scope:e.__scopeRovingFocusGroup,children:s.jsx(so,{...e,ref:t})})}));Ps.displayName=Ue;var so=i.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:a=!1,dir:o,currentTabStopId:u,defaultCurrentTabStopId:m,onCurrentTabStopIdChange:p,onEntryFocus:f,preventScrollOnEntryFocus:d=!1,...c}=e,v=i.useRef(null),b=xe(t,v),h=vs(o),[S,x]=_t({prop:u,defaultProp:m??null,onChange:p,caller:Ue}),[C,_]=i.useState(!1),E=Et(f),A=_s(n),Q=i.useRef(!1),[Z,W]=i.useState(0);return i.useEffect(()=>{const M=v.current;if(M)return M.addEventListener(ft,E),()=>M.removeEventListener(ft,E)},[E]),s.jsx(eo,{scope:n,orientation:r,dir:h,loop:a,currentTabStopId:S,onItemFocus:i.useCallback(M=>x(M),[x]),onItemShiftTab:i.useCallback(()=>_(!0),[]),onFocusableItemAdd:i.useCallback(()=>W(M=>M+1),[]),onFocusableItemRemove:i.useCallback(()=>W(M=>M-1),[]),children:s.jsx(z.div,{tabIndex:C||Z===0?-1:0,"data-orientation":r,...c,ref:b,style:{outline:"none",...e.style},onMouseDown:R(e.onMouseDown,()=>{Q.current=!0}),onFocus:R(e.onFocus,M=>{const g=!Q.current;if(M.target===M.currentTarget&&g&&!C){const y=new CustomEvent(ft,Xr);if(M.currentTarget.dispatchEvent(y),!y.defaultPrevented){const T=A().filter(ee=>ee.focusable),F=T.find(ee=>ee.active),D=T.find(ee=>ee.id===S),Me=[F,D,...T].filter(Boolean).map(ee=>ee.ref.current);Os(Me,d)}}Q.current=!1}),onBlur:R(e.onBlur,()=>_(!1))})})}),Ds="RovingFocusGroupItem",Ts=i.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:a=!1,tabStopId:o,children:u,...m}=e,p=qe(),f=o||p,d=to(Ds,n),c=d.currentTabStopId===f,v=_s(n),{onFocusableItemAdd:b,onFocusableItemRemove:h,currentTabStopId:S}=d;return i.useEffect(()=>{if(r)return b(),()=>h()},[r,b,h]),s.jsx(St.ItemSlot,{scope:n,id:f,focusable:r,active:a,children:s.jsx(z.span,{tabIndex:c?0:-1,"data-orientation":d.orientation,...m,ref:t,onMouseDown:R(e.onMouseDown,x=>{r?d.onItemFocus(f):x.preventDefault()}),onFocus:R(e.onFocus,()=>d.onItemFocus(f)),onKeyDown:R(e.onKeyDown,x=>{if(x.key==="Tab"&&x.shiftKey){d.onItemShiftTab();return}if(x.target!==x.currentTarget)return;const C=oo(x,d.orientation,d.dir);if(C!==void 0){if(x.metaKey||x.ctrlKey||x.altKey||x.shiftKey)return;x.preventDefault();let E=v().filter(A=>A.focusable).map(A=>A.ref.current);if(C==="last")E.reverse();else if(C==="prev"||C==="next"){C==="prev"&&E.reverse();const A=E.indexOf(x.currentTarget);E=d.loop?ao(E,A+1):E.slice(A+1)}setTimeout(()=>Os(E))}}),children:typeof u=="function"?u({isCurrentTabStop:c,hasTabStop:S!=null}):u})})});Ts.displayName=Ds;var no={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function ro(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function oo(e,t,n){const r=ro(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return no[r]}function Os(e,t=!1){const n=document.activeElement;for(const r of e)if(r===n||(r.focus({preventScroll:t}),document.activeElement!==n))return}function ao(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var io=Ps,co=Ts,Nt=["Enter"," "],lo=["ArrowDown","PageUp","Home"],Fs=["ArrowUp","PageDown","End"],uo=[...lo,...Fs],ho={ltr:[...Nt,"ArrowRight"],rtl:[...Nt,"ArrowLeft"]},fo={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Ge="Menu",[Te,po,mo]=ps(Ge),[ge,As]=Xe(Ge,[mo,ms,Es]),Ze=ms(),ks=Es(),[xo,ve]=ge(Ge),[go,Ke]=ge(Ge),Ls=e=>{const{__scopeMenu:t,open:n=!1,children:r,dir:a,onOpenChange:o,modal:u=!0}=e,m=Ze(t),[p,f]=i.useState(null),d=i.useRef(!1),c=Et(o),v=vs(a);return i.useEffect(()=>{const b=()=>{d.current=!0,document.addEventListener("pointerdown",h,{capture:!0,once:!0}),document.addEventListener("pointermove",h,{capture:!0,once:!0})},h=()=>d.current=!1;return document.addEventListener("keydown",b,{capture:!0}),()=>{document.removeEventListener("keydown",b,{capture:!0}),document.removeEventListener("pointerdown",h,{capture:!0}),document.removeEventListener("pointermove",h,{capture:!0})}},[]),s.jsx(Kn,{...m,children:s.jsx(xo,{scope:t,open:n,onOpenChange:c,content:p,onContentChange:f,children:s.jsx(go,{scope:t,onClose:i.useCallback(()=>c(!1),[c]),isUsingKeyboardRef:d,dir:v,modal:u,children:r})})})};Ls.displayName=Ge;var vo="MenuAnchor",Lt=i.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,a=Ze(n);return s.jsx(kn,{...a,...r,ref:t})});Lt.displayName=vo;var $t="MenuPortal",[bo,$s]=ge($t,{forceMount:void 0}),Us=e=>{const{__scopeMenu:t,forceMount:n,children:r,container:a}=e,o=ve($t,t);return s.jsx(bo,{scope:t,forceMount:n,children:s.jsx($e,{present:n||o.open,children:s.jsx(Bn,{asChild:!0,container:a,children:r})})})};Us.displayName=$t;var H="MenuContent",[yo,Ut]=ge(H),Gs=i.forwardRef((e,t)=>{const n=$s(H,e.__scopeMenu),{forceMount:r=n.forceMount,...a}=e,o=ve(H,e.__scopeMenu),u=Ke(H,e.__scopeMenu);return s.jsx(Te.Provider,{scope:e.__scopeMenu,children:s.jsx($e,{present:r||o.open,children:s.jsx(Te.Slot,{scope:e.__scopeMenu,children:u.modal?s.jsx(jo,{...a,ref:t}):s.jsx(wo,{...a,ref:t})})})})}),jo=i.forwardRef((e,t)=>{const n=ve(H,e.__scopeMenu),r=i.useRef(null),a=xe(t,r);return i.useEffect(()=>{const o=r.current;if(o)return Qn(o)},[]),s.jsx(Gt,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:R(e.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),wo=i.forwardRef((e,t)=>{const n=ve(H,e.__scopeMenu);return s.jsx(Gt,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),Co=Vn("MenuContent.ScrollLock"),Gt=i.forwardRef((e,t)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:a,onOpenAutoFocus:o,onCloseAutoFocus:u,disableOutsidePointerEvents:m,onEntryFocus:p,onEscapeKeyDown:f,onPointerDownOutside:d,onFocusOutside:c,onInteractOutside:v,onDismiss:b,disableOutsideScroll:h,...S}=e,x=ve(H,n),C=Ke(H,n),_=Ze(n),E=ks(n),A=po(n),[Q,Z]=i.useState(null),W=i.useRef(null),M=xe(t,W,x.onContentChange),g=i.useRef(0),y=i.useRef(""),T=i.useRef(0),F=i.useRef(null),D=i.useRef("right"),oe=i.useRef(0),Me=h?Wn:i.Fragment,ee=h?{as:Co,allowPinchZoom:!0}:void 0,Pn=j=>{var ye,Qt;const V=y.current+j,Y=A().filter(te=>!te.disabled),ae=document.activeElement,st=(ye=Y.find(te=>te.ref.current===ae))==null?void 0:ye.textValue,nt=Y.map(te=>te.textValue),Ht=Fo(nt,V,st),Ie=(Qt=Y.find(te=>te.textValue===Ht))==null?void 0:Qt.ref.current;(function te(qt){y.current=qt,window.clearTimeout(g.current),qt!==""&&(g.current=window.setTimeout(()=>te(""),1e3))})(V),Ie&&setTimeout(()=>Ie.focus())};i.useEffect(()=>()=>window.clearTimeout(g.current),[]),qn();const be=i.useCallback(j=>{var Y,ae;return D.current===((Y=F.current)==null?void 0:Y.side)&&ko(j,(ae=F.current)==null?void 0:ae.area)},[]);return s.jsx(yo,{scope:n,searchRef:y,onItemEnter:i.useCallback(j=>{be(j)&&j.preventDefault()},[be]),onItemLeave:i.useCallback(j=>{var V;be(j)||((V=W.current)==null||V.focus(),Z(null))},[be]),onTriggerLeave:i.useCallback(j=>{be(j)&&j.preventDefault()},[be]),pointerGraceTimerRef:T,onPointerGraceIntentChange:i.useCallback(j=>{F.current=j},[]),children:s.jsx(Me,{...ee,children:s.jsx(zn,{asChild:!0,trapped:a,onMountAutoFocus:R(o,j=>{var V;j.preventDefault(),(V=W.current)==null||V.focus({preventScroll:!0})}),onUnmountAutoFocus:u,children:s.jsx(Ln,{asChild:!0,disableOutsidePointerEvents:m,onEscapeKeyDown:f,onPointerDownOutside:d,onFocusOutside:c,onInteractOutside:v,onDismiss:b,children:s.jsx(io,{asChild:!0,...E,dir:C.dir,orientation:"vertical",loop:r,currentTabStopId:Q,onCurrentTabStopIdChange:Z,onEntryFocus:R(p,j=>{C.isUsingKeyboardRef.current||j.preventDefault()}),preventScrollOnEntryFocus:!0,children:s.jsx($n,{role:"menu","aria-orientation":"vertical","data-state":nn(x.open),"data-radix-menu-content":"",dir:C.dir,..._,...S,ref:M,style:{outline:"none",...S.style},onKeyDown:R(S.onKeyDown,j=>{const Y=j.target.closest("[data-radix-menu-content]")===j.currentTarget,ae=j.ctrlKey||j.altKey||j.metaKey,st=j.key.length===1;Y&&(j.key==="Tab"&&j.preventDefault(),!ae&&st&&Pn(j.key));const nt=W.current;if(j.target!==nt||!uo.includes(j.key))return;j.preventDefault();const Ie=A().filter(ye=>!ye.disabled).map(ye=>ye.ref.current);Fs.includes(j.key)&&Ie.reverse(),To(Ie)}),onBlur:R(e.onBlur,j=>{j.currentTarget.contains(j.target)||(window.clearTimeout(g.current),y.current="")}),onPointerMove:R(e.onPointerMove,Oe(j=>{const V=j.target,Y=oe.current!==j.clientX;if(j.currentTarget.contains(V)&&Y){const ae=j.clientX>oe.current?"right":"left";D.current=ae,oe.current=j.clientX}}))})})})})})})});Gs.displayName=H;var Ro="MenuGroup",Kt=i.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return s.jsx(z.div,{role:"group",...r,ref:t})});Kt.displayName=Ro;var So="MenuLabel",Ks=i.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return s.jsx(z.div,{...r,ref:t})});Ks.displayName=So;var ze="MenuItem",cs="menu.itemSelect",et=i.forwardRef((e,t)=>{const{disabled:n=!1,onSelect:r,...a}=e,o=i.useRef(null),u=Ke(ze,e.__scopeMenu),m=Ut(ze,e.__scopeMenu),p=xe(t,o),f=i.useRef(!1),d=()=>{const c=o.current;if(!n&&c){const v=new CustomEvent(cs,{bubbles:!0,cancelable:!0});c.addEventListener(cs,b=>r==null?void 0:r(b),{once:!0}),Gn(c,v),v.defaultPrevented?f.current=!1:u.onClose()}};return s.jsx(Bs,{...a,ref:p,disabled:n,onClick:R(e.onClick,d),onPointerDown:c=>{var v;(v=e.onPointerDown)==null||v.call(e,c),f.current=!0},onPointerUp:R(e.onPointerUp,c=>{var v;f.current||(v=c.currentTarget)==null||v.click()}),onKeyDown:R(e.onKeyDown,c=>{const v=m.searchRef.current!=="";n||v&&c.key===" "||Nt.includes(c.key)&&(c.currentTarget.click(),c.preventDefault())})})});et.displayName=ze;var Bs=i.forwardRef((e,t)=>{const{__scopeMenu:n,disabled:r=!1,textValue:a,...o}=e,u=Ut(ze,n),m=ks(n),p=i.useRef(null),f=xe(t,p),[d,c]=i.useState(!1),[v,b]=i.useState("");return i.useEffect(()=>{const h=p.current;h&&b((h.textContent??"").trim())},[o.children]),s.jsx(Te.ItemSlot,{scope:n,disabled:r,textValue:a??v,children:s.jsx(co,{asChild:!0,...m,focusable:!r,children:s.jsx(z.div,{role:"menuitem","data-highlighted":d?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...o,ref:f,onPointerMove:R(e.onPointerMove,Oe(h=>{r?u.onItemLeave(h):(u.onItemEnter(h),h.defaultPrevented||h.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:R(e.onPointerLeave,Oe(h=>u.onItemLeave(h))),onFocus:R(e.onFocus,()=>c(!0)),onBlur:R(e.onBlur,()=>c(!1))})})})}),No="MenuCheckboxItem",Vs=i.forwardRef((e,t)=>{const{checked:n=!1,onCheckedChange:r,...a}=e;return s.jsx(Ws,{scope:e.__scopeMenu,checked:n,children:s.jsx(et,{role:"menuitemcheckbox","aria-checked":We(n)?"mixed":n,...a,ref:t,"data-state":Vt(n),onSelect:R(a.onSelect,()=>r==null?void 0:r(We(n)?!0:!n),{checkForDefaultPrevented:!1})})})});Vs.displayName=No;var Hs="MenuRadioGroup",[Mo,Io]=ge(Hs,{value:void 0,onValueChange:()=>{}}),Qs=i.forwardRef((e,t)=>{const{value:n,onValueChange:r,...a}=e,o=Et(r);return s.jsx(Mo,{scope:e.__scopeMenu,value:n,onValueChange:o,children:s.jsx(Kt,{...a,ref:t})})});Qs.displayName=Hs;var qs="MenuRadioItem",zs=i.forwardRef((e,t)=>{const{value:n,...r}=e,a=Io(qs,e.__scopeMenu),o=n===a.value;return s.jsx(Ws,{scope:e.__scopeMenu,checked:o,children:s.jsx(et,{role:"menuitemradio","aria-checked":o,...r,ref:t,"data-state":Vt(o),onSelect:R(r.onSelect,()=>{var u;return(u=a.onValueChange)==null?void 0:u.call(a,n)},{checkForDefaultPrevented:!1})})})});zs.displayName=qs;var Bt="MenuItemIndicator",[Ws,_o]=ge(Bt,{checked:!1}),Ys=i.forwardRef((e,t)=>{const{__scopeMenu:n,forceMount:r,...a}=e,o=_o(Bt,n);return s.jsx($e,{present:r||We(o.checked)||o.checked===!0,children:s.jsx(z.span,{...a,ref:t,"data-state":Vt(o.checked)})})});Ys.displayName=Bt;var Eo="MenuSeparator",Xs=i.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return s.jsx(z.div,{role:"separator","aria-orientation":"horizontal",...r,ref:t})});Xs.displayName=Eo;var Po="MenuArrow",Js=i.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,a=Ze(n);return s.jsx(Un,{...a,...r,ref:t})});Js.displayName=Po;var Do="MenuSub",[Ba,Zs]=ge(Do),Pe="MenuSubTrigger",en=i.forwardRef((e,t)=>{const n=ve(Pe,e.__scopeMenu),r=Ke(Pe,e.__scopeMenu),a=Zs(Pe,e.__scopeMenu),o=Ut(Pe,e.__scopeMenu),u=i.useRef(null),{pointerGraceTimerRef:m,onPointerGraceIntentChange:p}=o,f={__scopeMenu:e.__scopeMenu},d=i.useCallback(()=>{u.current&&window.clearTimeout(u.current),u.current=null},[]);return i.useEffect(()=>d,[d]),i.useEffect(()=>{const c=m.current;return()=>{window.clearTimeout(c),p(null)}},[m,p]),s.jsx(Lt,{asChild:!0,...f,children:s.jsx(Bs,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":a.contentId,"data-state":nn(n.open),...e,ref:xs(t,a.onTriggerChange),onClick:c=>{var v;(v=e.onClick)==null||v.call(e,c),!(e.disabled||c.defaultPrevented)&&(c.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:R(e.onPointerMove,Oe(c=>{o.onItemEnter(c),!c.defaultPrevented&&!e.disabled&&!n.open&&!u.current&&(o.onPointerGraceIntentChange(null),u.current=window.setTimeout(()=>{n.onOpenChange(!0),d()},100))})),onPointerLeave:R(e.onPointerLeave,Oe(c=>{var b,h;d();const v=(b=n.content)==null?void 0:b.getBoundingClientRect();if(v){const S=(h=n.content)==null?void 0:h.dataset.side,x=S==="right",C=x?-5:5,_=v[x?"left":"right"],E=v[x?"right":"left"];o.onPointerGraceIntentChange({area:[{x:c.clientX+C,y:c.clientY},{x:_,y:v.top},{x:E,y:v.top},{x:E,y:v.bottom},{x:_,y:v.bottom}],side:S}),window.clearTimeout(m.current),m.current=window.setTimeout(()=>o.onPointerGraceIntentChange(null),300)}else{if(o.onTriggerLeave(c),c.defaultPrevented)return;o.onPointerGraceIntentChange(null)}})),onKeyDown:R(e.onKeyDown,c=>{var b;const v=o.searchRef.current!=="";e.disabled||v&&c.key===" "||ho[r.dir].includes(c.key)&&(n.onOpenChange(!0),(b=n.content)==null||b.focus(),c.preventDefault())})})})});en.displayName=Pe;var tn="MenuSubContent",sn=i.forwardRef((e,t)=>{const n=$s(H,e.__scopeMenu),{forceMount:r=n.forceMount,...a}=e,o=ve(H,e.__scopeMenu),u=Ke(H,e.__scopeMenu),m=Zs(tn,e.__scopeMenu),p=i.useRef(null),f=xe(t,p);return s.jsx(Te.Provider,{scope:e.__scopeMenu,children:s.jsx($e,{present:r||o.open,children:s.jsx(Te.Slot,{scope:e.__scopeMenu,children:s.jsx(Gt,{id:m.contentId,"aria-labelledby":m.triggerId,...a,ref:f,align:"start",side:u.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:d=>{var c;u.isUsingKeyboardRef.current&&((c=p.current)==null||c.focus()),d.preventDefault()},onCloseAutoFocus:d=>d.preventDefault(),onFocusOutside:R(e.onFocusOutside,d=>{d.target!==m.trigger&&o.onOpenChange(!1)}),onEscapeKeyDown:R(e.onEscapeKeyDown,d=>{u.onClose(),d.preventDefault()}),onKeyDown:R(e.onKeyDown,d=>{var b;const c=d.currentTarget.contains(d.target),v=fo[u.dir].includes(d.key);c&&v&&(o.onOpenChange(!1),(b=m.trigger)==null||b.focus(),d.preventDefault())})})})})})});sn.displayName=tn;function nn(e){return e?"open":"closed"}function We(e){return e==="indeterminate"}function Vt(e){return We(e)?"indeterminate":e?"checked":"unchecked"}function To(e){const t=document.activeElement;for(const n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function Oo(e,t){return e.map((n,r)=>e[(t+r)%e.length])}function Fo(e,t,n){const a=t.length>1&&Array.from(t).every(f=>f===t[0])?t[0]:t,o=n?e.indexOf(n):-1;let u=Oo(e,Math.max(o,0));a.length===1&&(u=u.filter(f=>f!==n));const p=u.find(f=>f.toLowerCase().startsWith(a.toLowerCase()));return p!==n?p:void 0}function Ao(e,t){const{x:n,y:r}=e;let a=!1;for(let o=0,u=t.length-1;o<t.length;u=o++){const m=t[o],p=t[u],f=m.x,d=m.y,c=p.x,v=p.y;d>r!=v>r&&n<(c-f)*(r-d)/(v-d)+f&&(a=!a)}return a}function ko(e,t){if(!t)return!1;const n={x:e.clientX,y:e.clientY};return Ao(n,t)}function Oe(e){return t=>t.pointerType==="mouse"?e(t):void 0}var Lo=Ls,$o=Lt,Uo=Us,Go=Gs,Ko=Kt,Bo=Ks,Vo=et,Ho=Vs,Qo=Qs,qo=zs,zo=Ys,Wo=Xs,Yo=Js,Xo=en,Jo=sn,tt="DropdownMenu",[Zo,Va]=Xe(tt,[As]),U=As(),[ea,rn]=Zo(tt),on=e=>{const{__scopeDropdownMenu:t,children:n,dir:r,open:a,defaultOpen:o,onOpenChange:u,modal:m=!0}=e,p=U(t),f=i.useRef(null),[d,c]=_t({prop:a,defaultProp:o??!1,onChange:u,caller:tt});return s.jsx(ea,{scope:t,triggerId:qe(),triggerRef:f,contentId:qe(),open:d,onOpenChange:c,onOpenToggle:i.useCallback(()=>c(v=>!v),[c]),modal:m,children:s.jsx(Lo,{...p,open:d,onOpenChange:c,dir:r,modal:m,children:n})})};on.displayName=tt;var an="DropdownMenuTrigger",cn=i.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...a}=e,o=rn(an,n),u=U(n);return s.jsx($o,{asChild:!0,...u,children:s.jsx(z.button,{type:"button",id:o.triggerId,"aria-haspopup":"menu","aria-expanded":o.open,"aria-controls":o.open?o.contentId:void 0,"data-state":o.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...a,ref:xs(t,o.triggerRef),onPointerDown:R(e.onPointerDown,m=>{!r&&m.button===0&&m.ctrlKey===!1&&(o.onOpenToggle(),o.open||m.preventDefault())}),onKeyDown:R(e.onKeyDown,m=>{r||(["Enter"," "].includes(m.key)&&o.onOpenToggle(),m.key==="ArrowDown"&&o.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(m.key)&&m.preventDefault())})})})});cn.displayName=an;var ta="DropdownMenuPortal",ln=e=>{const{__scopeDropdownMenu:t,...n}=e,r=U(t);return s.jsx(Uo,{...r,...n})};ln.displayName=ta;var un="DropdownMenuContent",dn=i.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=rn(un,n),o=U(n),u=i.useRef(!1);return s.jsx(Go,{id:a.contentId,"aria-labelledby":a.triggerId,...o,...r,ref:t,onCloseAutoFocus:R(e.onCloseAutoFocus,m=>{var p;u.current||(p=a.triggerRef.current)==null||p.focus(),u.current=!1,m.preventDefault()}),onInteractOutside:R(e.onInteractOutside,m=>{const p=m.detail.originalEvent,f=p.button===0&&p.ctrlKey===!0,d=p.button===2||f;(!a.modal||d)&&(u.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});dn.displayName=un;var sa="DropdownMenuGroup",na=i.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=U(n);return s.jsx(Ko,{...a,...r,ref:t})});na.displayName=sa;var ra="DropdownMenuLabel",hn=i.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=U(n);return s.jsx(Bo,{...a,...r,ref:t})});hn.displayName=ra;var oa="DropdownMenuItem",fn=i.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=U(n);return s.jsx(Vo,{...a,...r,ref:t})});fn.displayName=oa;var aa="DropdownMenuCheckboxItem",pn=i.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=U(n);return s.jsx(Ho,{...a,...r,ref:t})});pn.displayName=aa;var ia="DropdownMenuRadioGroup",ca=i.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=U(n);return s.jsx(Qo,{...a,...r,ref:t})});ca.displayName=ia;var la="DropdownMenuRadioItem",mn=i.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=U(n);return s.jsx(qo,{...a,...r,ref:t})});mn.displayName=la;var ua="DropdownMenuItemIndicator",xn=i.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=U(n);return s.jsx(zo,{...a,...r,ref:t})});xn.displayName=ua;var da="DropdownMenuSeparator",gn=i.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=U(n);return s.jsx(Wo,{...a,...r,ref:t})});gn.displayName=da;var ha="DropdownMenuArrow",fa=i.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=U(n);return s.jsx(Yo,{...a,...r,ref:t})});fa.displayName=ha;var pa="DropdownMenuSubTrigger",vn=i.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=U(n);return s.jsx(Xo,{...a,...r,ref:t})});vn.displayName=pa;var ma="DropdownMenuSubContent",bn=i.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=U(n);return s.jsx(Jo,{...a,...r,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});bn.displayName=ma;var xa=on,ga=cn,va=ln,yn=dn,jn=hn,wn=fn,Cn=pn,Rn=mn,Sn=xn,Nn=gn,Mn=vn,In=bn;const ba=xa,ya=ga,ja=i.forwardRef(({className:e,inset:t,children:n,...r},a)=>s.jsxs(Mn,{ref:a,className:k("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[state=open]:bg-accent focus:bg-accent",t&&"pl-8",e),...r,children:[n,s.jsx(Pt,{className:"ml-auto h-4 w-4"})]}));ja.displayName=Mn.displayName;const wa=i.forwardRef(({className:e,...t},n)=>s.jsx(In,{ref:n,className:k("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));wa.displayName=In.displayName;const _n=i.forwardRef(({className:e,sideOffset:t=4,...n},r)=>s.jsx(va,{children:s.jsx(yn,{ref:r,sideOffset:t,className:k("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n})}));_n.displayName=yn.displayName;const Mt=i.forwardRef(({className:e,inset:t,...n},r)=>s.jsx(wn,{ref:r,className:k("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t&&"pl-8",e),...n}));Mt.displayName=wn.displayName;const Ca=i.forwardRef(({className:e,children:t,checked:n,...r},a)=>s.jsxs(Cn,{ref:a,className:k("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",e),checked:n,...r,children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(Sn,{children:s.jsx(gs,{className:"h-4 w-4"})})}),t]}));Ca.displayName=Cn.displayName;const Ra=i.forwardRef(({className:e,children:t,...n},r)=>s.jsxs(Rn,{ref:r,className:k("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",e),...n,children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(Sn,{children:s.jsx(jr,{className:"h-2 w-2 fill-current"})})}),t]}));Ra.displayName=Rn.displayName;const En=i.forwardRef(({className:e,inset:t,...n},r)=>s.jsx(jn,{ref:r,className:k("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...n}));En.displayName=jn.displayName;const Sa=i.forwardRef(({className:e,...t},n)=>s.jsx(Nn,{ref:n,className:k("-mx-1 my-1 h-px bg-muted",e),...t}));Sa.displayName=Nn.displayName;const Ha=()=>{const[e,t]=i.useState({page:1,limit:20,sort_by:"date",sort_order:"desc",search:""}),{role:n}=fs(),r=n==="admin",[a,o]=i.useState(""),[u,m]=i.useState(!1),[p,f]=i.useState(null),{data:d,isLoading:c,isError:v}=Lr(e),b=x=>{x.preventDefault(),t(C=>({...C,page:1,search:a}))},h=x=>{t(C=>({...C,sort_by:x,sort_order:C.sort_by===x&&C.sort_order==="desc"?"asc":"desc"}))},S=(d==null?void 0:d.meta.pages)||1;return s.jsx(Yn,{fullWidth:!0,children:s.jsxs("div",{className:"flex flex-col h-full space-y-4",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Shift Records"})}),s.jsx(es,{open:u,onOpenChange:m,children:s.jsxs(ts,{className:"max-w-2xl",children:[s.jsx(ss,{children:s.jsx(ns,{children:"Add New Shift Record"})}),s.jsx(is,{onSuccess:()=>m(!1),onCancel:()=>m(!1)})]})}),s.jsx(es,{open:!!p,onOpenChange:x=>!x&&f(null),children:s.jsxs(ts,{className:"max-w-2xl",children:[s.jsx(ss,{children:s.jsx(ns,{children:"Edit Shift Record"})}),p&&s.jsx(is,{record:p,onSuccess:()=>f(null),onCancel:()=>f(null)})]})}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("form",{onSubmit:b,className:"flex-1 max-w-sm flex gap-2",children:[s.jsx(J,{placeholder:"Search by name, client, or job...",value:a,onChange:x=>o(x.target.value)}),s.jsx(me,{type:"submit",variant:"secondary",children:s.jsx(mr,{className:"h-4 w-4"})})]}),(r||n==="manager")&&s.jsxs(me,{onClick:()=>m(!0),children:[s.jsx(wr,{className:"mr-2 h-4 w-4"})," Add Record"]}),s.jsxs("div",{className:"ml-auto text-sm text-muted-foreground",children:[(d==null?void 0:d.meta.total)||0," records found"]})]}),s.jsx("div",{className:"border rounded-md bg-white",children:s.jsxs(tr,{children:[s.jsx(sr,{children:s.jsxs(we,{children:[s.jsx(X,{className:"w-[30px]"}),s.jsxs(X,{className:"cursor-pointer",onClick:()=>h("date"),children:["Date ",s.jsx(dt,{className:"ml-2 h-4 w-4 inline"})]}),s.jsxs(X,{className:"cursor-pointer",onClick:()=>h("full_name"),children:["Employee ",s.jsx(dt,{className:"ml-2 h-4 w-4 inline"})]}),s.jsxs(X,{className:"cursor-pointer",onClick:()=>h("client_name"),children:["Client ",s.jsx(dt,{className:"ml-2 h-4 w-4 inline"})]}),s.jsx(X,{className:"hidden md:table-cell cursor-pointer",onClick:()=>h("location"),children:"Location"}),s.jsx(X,{children:"Shift"}),s.jsx(X,{className:"text-right",children:"Hours"}),r&&s.jsx(X,{className:"text-right",children:"Pay"}),r&&s.jsx(X,{className:"text-right",children:"Net"}),s.jsx(X,{className:"w-[50px]"})]})}),s.jsx(nr,{children:c?s.jsx(we,{children:s.jsx(G,{colSpan:r?10:8,className:"h-24 text-center",children:s.jsx(mt,{className:"h-6 w-6 animate-spin mx-auto"})})}):v?s.jsx(we,{children:s.jsx(G,{colSpan:r?10:8,className:"h-24 text-center text-red-500",children:"Failed to load records"})}):(d==null?void 0:d.data.length)===0?s.jsx(we,{children:s.jsx(G,{colSpan:r?10:8,className:"h-24 text-center",children:"No records found"})}):d==null?void 0:d.data.map(x=>s.jsx(Na,{record:x,isAdmin:r,role:n,onEdit:()=>f(x)},x.id))})]})}),S>1&&s.jsx(ws,{children:s.jsxs(Cs,{children:[s.jsx(Ve,{children:s.jsx(Rs,{onClick:()=>t(x=>({...x,page:Math.max(1,x.page-1)})),className:e.page===1?"pointer-events-none opacity-50":"cursor-pointer"})}),s.jsx(Ve,{children:s.jsxs("div",{className:"flex items-center justify-center px-4 text-sm font-medium",children:["Page ",e.page," of ",S]})}),s.jsx(Ve,{children:s.jsx(Ss,{onClick:()=>t(x=>({...x,page:Math.min(S,x.page+1)})),className:e.page===S?"pointer-events-none opacity-50":"cursor-pointer"})})]})})]})})},Na=({record:e,isAdmin:t,role:n,onEdit:r})=>{var p,f,d,c,v;const[a,o]=i.useState(!1),u=Kr(),m=()=>{confirm("Are you sure you want to delete this record?")&&u.mutate(e.id)};return s.jsxs(s.Fragment,{children:[s.jsxs(we,{className:"group",children:[s.jsx(G,{children:s.jsx(zr,{open:a,onOpenChange:o,children:s.jsx(Wr,{asChild:!0,children:s.jsxs(me,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",children:[a?s.jsx(br,{className:"h-4 w-4"}):s.jsx(Pt,{className:"h-4 w-4"}),s.jsx("span",{className:"sr-only",children:"Toggle"})]})})})}),s.jsx(G,{className:"font-medium",children:e.date?ut(new Date(e.date),"dd MMM yyyy"):"-"}),s.jsx(G,{children:e.fullName}),s.jsx(G,{children:e.clientName}),s.jsx(G,{className:"hidden md:table-cell",children:e.location}),s.jsx(G,{children:s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-sm",children:e.shiftName}),s.jsx("span",{className:"text-xs text-muted-foreground",children:e.shiftStart&&e.shiftEnd?`${ut(new Date(`1970-01-01T${e.shiftStart}`),"HH:mm")} - ${ut(new Date(`1970-01-01T${e.shiftEnd}`),"HH:mm")}`:""})]})}),s.jsx(G,{className:"text-right",children:e.paidHours.toFixed(2)}),t&&s.jsxs(G,{className:"text-right",children:["£",((p=e.totalPay)==null?void 0:p.toFixed(2))||"0.00"]}),t&&s.jsxs(G,{className:"text-right font-medium",children:["£",((f=e.clientNet)==null?void 0:f.toFixed(2))||"0.00"]}),s.jsx(G,{children:(t||n==="manager")&&s.jsxs(ba,{children:[s.jsx(ya,{asChild:!0,children:s.jsxs(me,{variant:"ghost",className:"h-8 w-8 p-0",children:[s.jsx("span",{className:"sr-only",children:"Open menu"}),s.jsx(yr,{className:"h-4 w-4"})]})}),s.jsxs(_n,{align:"end",children:[s.jsx(En,{children:"Actions"}),s.jsxs(Mt,{onClick:b=>{b.stopPropagation(),r()},children:[s.jsx(rr,{className:"mr-2 h-4 w-4"})," Edit"]}),s.jsxs(Mt,{onClick:b=>{b.stopPropagation(),m()},className:"text-red-600",children:[s.jsx(or,{className:"mr-2 h-4 w-4"})," Delete"]})]})]})})]}),s.jsx(we,{className:a?"":"hidden",children:s.jsx(G,{colSpan:t?10:8,className:"p-0 border-b-0",children:s.jsxs("div",{className:`bg-muted/50 p-4 grid grid-cols-1 ${t?"md:grid-cols-3":"md:grid-cols-2"} gap-4 text-sm shadow-inner`,children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold mb-2",children:"Job Details"}),s.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[s.jsx("span",{className:"text-muted-foreground",children:"Site:"}),s.jsx("span",{children:e.site}),s.jsx("span",{className:"text-muted-foreground",children:"Job Name:"}),s.jsx("span",{children:e.jobName}),s.jsx("span",{className:"text-muted-foreground",children:"Status:"}),s.jsx(ar,{variant:"outline",className:"w-fit",children:e.jobStatus||"N/A"})]})]}),t&&s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold mb-2",children:"Financial Breakdown"}),s.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[s.jsx("span",{className:"text-muted-foreground",children:"Pay Rate:"}),s.jsxs("span",{children:["£",((d=e.hourRate)==null?void 0:d.toFixed(2))||"0.00","/hr"]}),s.jsx("span",{className:"text-muted-foreground",children:"Charge Rate:"}),s.jsxs("span",{children:["£",((c=e.clientHourlyRate)==null?void 0:c.toFixed(2))||"0.00","/hr"]}),s.jsx("span",{className:"text-muted-foreground",children:"Total Charge:"}),s.jsxs("span",{children:["£",((v=e.totalCharge)==null?void 0:v.toFixed(2))||"0.00"]})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold mb-2",children:"Metadata"}),s.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[s.jsx("span",{className:"text-muted-foreground",children:"System ID:"}),s.jsx("span",{className:"font-mono text-xs",children:e.id})]})]})]})})})]})};export{Ha as default};
